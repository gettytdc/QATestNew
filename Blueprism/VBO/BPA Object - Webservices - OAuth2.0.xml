<process name="Webservices - OAuth2.0" version="6.7.0.0" narrative="Business Object for authorization using OAuth2.0" type="object" runmode="Exclusive" preferredid="9cd0a967-eb01-4e38-bc91-31ace18db7eb">
  <appdef>
    <element name="Application Root">
      <id>0309f0b3-8c71-468a-b6e2-ce934f4511bf</id>
      <type>Application</type>
      <basetype>Application</basetype>
      <datatype>unknown</datatype>
      <diagnose>False</diagnose>
    </element>
  </appdef>
  <view>
    <camerax>0</camerax>
    <cameray>0</cameray>
    <zoom>1</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="daf2aeae-ccbf-47e7-be80-d7f9f7cda452" type="CleanUp" published="True">
    <name>Clean Up</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="67318fea-06de-4ab4-b24e-c296aa10321f" type="Normal" published="True">
    <name>Request</name>
    <view>
      <camerax>260</camerax>
      <cameray>69</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7652b71d-b844-4e53-b2af-59d9ec31a0ac" type="Normal" published="False">
    <name>Request Token</name>
    <view>
      <camerax>0</camerax>
      <cameray>-7</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="1cfc2c33-3381-4972-abb6-b529f18cfa44" type="Normal" published="False">
    <name>Request Resource</name>
    <view>
      <camerax>320</camerax>
      <cameray>193</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="28c240f1-b990-40b4-95fc-035aea399ac1" type="Normal" published="False">
    <name>Refresh Token</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7ae9fd1e-48b3-41c1-9b9d-a822c0f60126" type="Normal" published="True">
    <name>Load Certificate</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <stage stageid="45775d87-040d-40a6-b73b-5971c041501c" name="Start" type="Start">
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>8a5639e4-7770-49e5-961e-6e539e072fe3</onsuccess>
  </stage>
  <stage stageid="8a5639e4-7770-49e5-961e-6e539e072fe3" name="End" type="End">
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="c3627a11-b60c-467d-b514-2a81e17d44d5" name="Stage1" type="ProcessInfo">
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <references>
      <reference>System.Data.dll</reference>
      <reference>System.Xml.dll</reference>
      <reference>System.Drawing.dll</reference>
    </references>
    <imports>
      <import>System</import>
      <import>System.Drawing</import>
      <import>Microsoft.VisualBasic</import>
      <import>System.Text</import>
      <import>System.Security.Cryptography</import>
    </imports>
    <language>visualbasic</language>
    <globalcode><![CDATA[]]></globalcode>
    <code><![CDATA[Private Shared ReadOnly Jan1st1970 As New DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc)

Public Shared Function currentTimeMillis() As Long
	Return CLng((DateTime.UtcNow - Jan1st1970).TotalMilliseconds)
End Function]]></code>
  </stage>
  <stage stageid="16647fe3-8725-4eb4-ac44-7f2a3d396da2" name="Clean Up" type="SubSheetInfo">
    <subsheetid>daf2aeae-ccbf-47e7-be80-d7f9f7cda452</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d6b6c2e2-5fe2-4ce9-9c12-3ca7d86e4172" name="Start" type="Start">
    <subsheetid>daf2aeae-ccbf-47e7-be80-d7f9f7cda452</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>bf7a5e90-a6ba-48df-bc5f-f87e6dd329e9</onsuccess>
  </stage>
  <stage stageid="bf7a5e90-a6ba-48df-bc5f-f87e6dd329e9" name="End" type="End">
    <subsheetid>daf2aeae-ccbf-47e7-be80-d7f9f7cda452</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="1358dda6-d7a9-42b3-a857-9cee53b075a1" name="Request" type="SubSheetInfo">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>Request a token and then use it immediately to request the resource</narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="49eac0fa-75de-4797-ae9d-1793392b2cc5" name="Start" type="Start">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Token URL" narrative="The url for the token request" stage="Token URL" />
      <input type="text" name="Resource URL" narrative="The url for the resource" stage="Resource URL" />
      <input type="text" name="Username" narrative="Username for HTTP Basic auth" stage="Username" />
      <input type="password" name="Password" narrative="Password for HTTP Basic auth" stage="Password" />
      <input type="collection" name="Token" narrative="Token data in a collection" stage="Token" />
      <input type="text" name="Certificate ID" narrative="The id of the client authentication certificate" stage="Certificate ID" />
      <input type="text" name="Method" narrative="HTTP Method" stage="Method" />
      <input type="text" name="Content Type" narrative="HTTP Content Type" stage="Content Type" />
      <input type="text" name="Body" narrative="HTTP Body" stage="Body" />
    </inputs>
    <onsuccess>f8f33cad-f70a-4f0f-a3af-e78ddb123389</onsuccess>
  </stage>
  <stage stageid="f29a7d05-311f-4d69-bb79-a295ed678ee7" name="new" type="Note">
    <subsheetid>daf2aeae-ccbf-47e7-be80-d7f9f7cda452</subsheetid>
    <narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>230</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="8f9725ca-938f-4127-a1b7-abacdad87e9d" name="new" type="Note">
    <narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>230</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="3fb70227-b46b-4284-9d51-1cf18d58d84a" name="Token URL" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>-105</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9c05a019-4565-449b-a509-0526e280254e" name="Resource URL" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>-105</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="019eb6f8-4781-4098-aee7-11fa57c63a63" name="Username" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>270</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="02a7084c-766b-462e-8696-feca3622186b" name="Password" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>330</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d4e3bc71-0a4e-4e05-a931-979d5e4b87ed" name="Request Token" type="SubSheetInfo">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="2cd4ceab-8e1d-41d0-ba80-1c33daf765f9" name="End" type="End">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="Token" narrative="The resulting token as a collection" stage="Token" />
    </outputs>
  </stage>
  <stage stageid="14735bd9-9b52-4305-83b9-050508831c0a" name="Request Token" type="Action">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Request URL]" />
      <input type="text" name="Body" narrative="The body text of the HTTP request" expr="&quot;grant_type=client_credentials&quot;" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="" />
      <input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/x-www-form-urlencoded&quot;" />
      <input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" />
      <input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="" />
      <input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="&quot;application/json&quot;" />
      <input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="[Username]" />
      <input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="[Password]" />
      <input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="[Certificate ID]" />
      <input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="True" />
    </inputs>
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
    </outputs>
    <onsuccess>ca7a6451-d288-4763-9b1c-24b9399ad05e</onsuccess>
    <resource object="Utility - HTTP" action="HTTP Request" />
  </stage>
  <stage stageid="1683c17c-6c04-4bb6-b020-4715f06f7c08" name="Result" type="Data">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>90</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ca7a6451-d288-4763-9b1c-24b9399ad05e" name="Parse JSON" type="Action">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="json" expr="[Result]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" stage="Token" />
    </outputs>
    <onsuccess>2cd4ceab-8e1d-41d0-ba80-1c33daf765f9</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="d0931d2f-5f90-42c5-b30a-420eb0e53315" name="Token" type="Collection">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>90</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6f7bca05-6f56-44bc-b1bc-a6650093c669" name="Request URL" type="Data">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>90</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a017716c-2c9e-4970-9e12-0001d03a8612" name="Start" type="Start">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Request URL" narrative="The url for the token request" stage="Request URL" />
      <input type="text" name="Username" narrative="Username for HTTP Basic auth" stage="Username" />
      <input type="password" name="Password" narrative="Password for HTTP Basic auth" stage="Password" />
      <input type="text" name="Certificate ID" narrative="The id of the client authentication certificate" stage="Certificate ID" />
    </inputs>
    <onsuccess>14735bd9-9b52-4305-83b9-050508831c0a</onsuccess>
  </stage>
  <stage stageid="7c8fcfbe-eba5-406d-8704-0c95499a43a3" name="Username" type="Data">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4d1983e3-95b7-44d5-82fb-affade540f80" name="Password" type="Data">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a9ebba89-880f-4f91-9b86-6b60d3b593f1" name="Request Token" type="SubSheet">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>120</displayx>
    <displayy>30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Request URL" narrative="The url for the token request" expr="[Token URL]" />
      <input type="text" name="Username" narrative="Username for HTTP Basic auth" expr="[Username]" />
      <input type="password" name="Password" narrative="Password for HTTP Basic auth" expr="[Password]" />
      <input type="text" name="Certificate ID" narrative="The id of the client authentication certificate" expr="[Certificate ID]" />
    </inputs>
    <outputs>
      <output type="collection" name="Token" narrative="The resulting token as a collection" stage="Token" />
    </outputs>
    <onsuccess>4fb0385d-aa21-497c-b051-d7180524f54b</onsuccess>
    <processid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</processid>
  </stage>
  <stage stageid="ded9724a-ffe3-4375-88b2-0149c26055cb" name="Request Resource" type="SubSheetInfo">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="2f9ca3d9-381d-435c-81a9-50c40b3d7f80" name="End" type="End">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>240</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Result" stage="Result" />
    </outputs>
  </stage>
  <stage stageid="ffaaa3bd-1c38-401f-9078-52a6c4cd59b2" name="Get Access Token" type="Calculation">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>894804c9-f098-42f0-a061-70e59c75bc6d</onsuccess>
    <calculation expression="[ResultData.access_token]" stage="Access Token" />
  </stage>
  <stage stageid="0dfeedf9-28ff-4299-ab83-e162c09bb214" name="Access Token" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>225</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1120a7e2-3a7b-47db-bb24-00dc8f53e672" name="Request Resource" type="Action">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>195</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Resource URL]" />
      <input type="text" name="Body" narrative="The body text of the HTTP request" expr="[Body]" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="" />
      <input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="[Content Type]" />
      <input type="text" name="Method" narrative="The method of the HTTP request." expr="[Method]" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" />
      <input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" />
      <input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="" />
      <input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" />
      <input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" />
      <input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="[Certificate ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
    </outputs>
    <onsuccess>2f9ca3d9-381d-435c-81a9-50c40b3d7f80</onsuccess>
    <resource object="Utility - HTTP" action="HTTP Request" />
  </stage>
  <stage stageid="894804c9-f098-42f0-a061-70e59c75bc6d" name="Add Row" type="Action">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to be modified" expr="&quot;Headers&quot;" />
    </inputs>
    <onsuccess>488dfdc4-eed9-4fe0-ac8b-ee3428d07149</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="c6b185a9-11b7-4975-a383-baf0304e4fca" name="Headers" type="Collection">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>225</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Authorization" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="488dfdc4-eed9-4fe0-ac8b-ee3428d07149" name="Set Auth" type="Calculation">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>1120a7e2-3a7b-47db-bb24-00dc8f53e672</onsuccess>
    <calculation expression="&quot;Bearer &quot; &amp; [Access Token]" stage="Headers.Authorization" />
  </stage>
  <stage stageid="33d3eda7-7c80-4dd9-96c3-f810a377efea" name="Token Type" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>225</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a7572632-0116-49be-862c-ebda9ae96b3b" name="Token Type" type="ChoiceStart">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <groupid>4e1cfb66-0bef-4124-a7b9-c8805be5ee9c</groupid>
    <choices>
      <choice expression="Lower([Token Type]) = &quot;bearer&quot;">
        <name>Bearer</name>
        <distance>60</distance>
        <ontrue>ffaaa3bd-1c38-401f-9078-52a6c4cd59b2</ontrue>
      </choice>
      <choice expression="Lower([Token Type]) = &quot;mac&quot;">
        <name>MAC</name>
        <distance>105</distance>
        <ontrue>c838ffd2-6697-474c-bcf5-245a8bd5f149</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="7682a7be-bcb9-4249-a237-7d6ca90f1eba" name="Otherwise1" type="ChoiceEnd">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>55e01eb9-1362-4f39-928b-676accdf1759</onsuccess>
    <groupid>4e1cfb66-0bef-4124-a7b9-c8805be5ee9c</groupid>
  </stage>
  <stage stageid="c838ffd2-6697-474c-bcf5-245a8bd5f149" name="Get MAC Header" type="Code">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-105</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="macKey" expr="[MAC Key]" />
      <input type="text" name="macID" expr="[MAC ID]" />
      <input type="text" name="domainName" expr="[Domain]" />
    </inputs>
    <outputs>
      <output type="text" name="accessToken" stage="Access Token" />
    </outputs>
    <onsuccess>d87bdfbf-df9a-4c03-a3d5-b919507debee</onsuccess>
    <code><![CDATA[Dim key As Byte() = Encoding.UTF8.GetBytes(macKey)
Dim mac As New HMACSHA1(key)

Dim epoch As Long = currentTimeMillis()
Dim timestamp As Long = epoch \ 1000

Dim ts As String = timestamp.ToString()

'notifications.e2.app.aexp.com is hardcoded here but will change depending on the environment.
'Each of the environments (Dev, Test and Prod) will have their own host name
Dim baseString As String = _
	  ts & vbLf _
    & ts & vbLf _
	& "POST" & vbLf _
	& "%2Faaa%2F" & vbLf _
	& domainName & vbLf _
	& "443" & vbLf _
	& vbLf

Dim baseBytes As Byte() = Encoding.UTF8.GetBytes(baseString)
Dim rawHmac As Byte() = mac.ComputeHash(baseBytes)
Dim macValue As String = Convert.ToBase64String(rawHmac)

Dim sb As New StringBuilder()
sb.Append("id=""")
sb.Append(macID)
sb.Append(""",ts=""")
sb.Append(ts)
sb.Append(""",nonce=""")
sb.Append(ts)
sb.Append(""",mac=""")
sb.Append(macValue)
sb.Append("""")

accessToken = sb.ToString()
]]></code>
  </stage>
  <stage stageid="14c6d072-a68c-4004-b6af-a2b8bea0d8d8" name="End" type="End">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-105</displayx>
    <displayy>240</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Result" stage="Result" />
    </outputs>
  </stage>
  <stage stageid="7890b5bd-d874-4614-867b-fbe8d908ed1a" name="Request Resource" type="Action">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>-105</displayx>
    <displayy>195</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Resource URL]" />
      <input type="text" name="Body" narrative="The body text of the HTTP request" expr="" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="" />
      <input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/json&quot;" />
      <input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;GET&quot;" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" />
      <input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" />
      <input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="" />
      <input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" />
      <input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" />
      <input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="[Certificate ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
    </outputs>
    <onsuccess>14c6d072-a68c-4004-b6af-a2b8bea0d8d8</onsuccess>
    <resource object="Utility - HTTP" action="HTTP Request" />
  </stage>
  <stage stageid="d87bdfbf-df9a-4c03-a3d5-b919507debee" name="Add Row" type="Action">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>-105</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to be modified" expr="&quot;Headers&quot;" />
    </inputs>
    <onsuccess>416074df-5112-4888-ad6c-991fb3b3474c</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="416074df-5112-4888-ad6c-991fb3b3474c" name="Set Auth" type="Calculation">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>-105</displayx>
    <displayy>150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>7890b5bd-d874-4614-867b-fbe8d908ed1a</onsuccess>
    <calculation expression="&quot;MAC &quot; &amp; [Access Token]" stage="Headers.Authorization" />
  </stage>
  <stage stageid="55e01eb9-1362-4f39-928b-676accdf1759" name="Exception1" type="Exception">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>195</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="" detail="&quot;Unknown Token Type&quot;" />
  </stage>
  <stage stageid="121d6fb5-4e5a-47bb-8058-b9f1b72d0f86" name="Get Token Type" type="Calculation">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>a7572632-0116-49be-862c-ebda9ae96b3b</onsuccess>
    <calculation expression="[ResultData.token_type]" stage="Token Type" />
  </stage>
  <stage stageid="dbb0e412-52d3-4384-aed3-264bf402b427" name="Resource URL" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>225</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="af874112-9010-423a-ae9e-17007d17f62c" name="Start" type="Start">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Resource URL" narrative="The url for the resource" stage="Resource URL" />
      <input type="text" name="Username" narrative="Username for HTTP Basic auth" stage="Username" />
      <input type="password" name="Password" narrative="Password for HTTP Basic auth" stage="Password" />
      <input type="collection" name="Token" narrative="Token data in a collection" stage="ResultData" />
      <input type="text" name="Certificate ID" narrative="The id of the client authentication certificate" stage="Certificate ID" />
      <input type="text" name="Method" narrative="HTTP Method" stage="Method" />
      <input type="text" name="Content Type" narrative="HTTP Content Type" stage="Content Type" />
      <input type="text" name="Body" narrative="HTTP Body" stage="Body" />
    </inputs>
    <onsuccess>121d6fb5-4e5a-47bb-8058-b9f1b72d0f86</onsuccess>
  </stage>
  <stage stageid="ad15b1d1-b73c-4186-a115-2b62679dfce3" name="Username" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7535c438-0949-449e-83bd-c1df3bd1ae59" name="Password" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>345</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="09684205-735c-4e93-9335-22224e1567a5" name="ResultData" type="Collection">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>405</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4fb0385d-aa21-497c-b051-d7180524f54b" name="Request Resource" type="SubSheet">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>120</displayx>
    <displayy>135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Resource URL" narrative="The url for the resource" expr="[Resource URL]" />
      <input type="text" name="Username" narrative="Username for HTTP Basic auth" expr="[Username]" />
      <input type="password" name="Password" narrative="Password for HTTP Basic auth" expr="[Password]" />
      <input type="collection" name="Token" narrative="Token data in a collection" expr="[Token]" />
      <input type="text" name="Certificate ID" narrative="The id of the client authentication certificate" expr="[Certificate ID]" />
      <input type="text" name="Method" narrative="HTTP Method" expr="[Method]" />
      <input type="text" name="Content Type" narrative="HTTP Content Type" expr="[Content Type]" />
      <input type="text" name="Body" narrative="HTTP Body" expr="[Body]" />
    </inputs>
    <outputs>
      <output type="text" name="Result" stage="Result" />
    </outputs>
    <onsuccess>8f6bf73c-8f61-4f3b-9be7-0c3e9569315b</onsuccess>
    <processid>1cfc2c33-3381-4972-abb6-b529f18cfa44</processid>
  </stage>
  <stage stageid="8f6bf73c-8f61-4f3b-9be7-0c3e9569315b" name="End1" type="End">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>120</displayx>
    <displayy>270</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="Token" narrative="Token data in a collection" stage="Token" />
      <output type="text" name="Result" narrative="The result of the request" stage="Result" />
    </outputs>
  </stage>
  <stage stageid="66542415-bebb-40cc-bd9e-5cdb486a1d14" name="Result" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>225</displayx>
    <displayy>195</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="95a72b66-67a3-40c4-aa7a-5c95dcd11b29" name="Result" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>270</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="fed22b00-60a7-461a-84bf-1cc1e2c20ed0" name="Refresh Token" type="SubSheetInfo">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="5b768c95-9372-4316-ac26-e4f86459ad89" name="End" type="End">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="f5677136-b1ec-4657-94b7-36376cc9f13d" name="Start" type="Start">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Request URL" narrative="The url for the token request" stage="Request URL" />
      <input type="text" name="Username" narrative="Username for HTTP Basic auth" stage="Username" />
      <input type="password" name="Password" narrative="Password for HTTP Basic auth" stage="Password" />
      <input type="collection" name="Token" narrative="Token data in a collection" stage="Token" />
    </inputs>
    <onsuccess>c176a1c4-7f84-4fc9-a276-727b91852d79</onsuccess>
  </stage>
  <stage stageid="c176a1c4-7f84-4fc9-a276-727b91852d79" name="Refresh Token" type="Action">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Request URL]" />
      <input type="text" name="Body" narrative="The body text of the HTTP request" expr="&quot;grant_type=refresh_token&amp;refresh_token=&quot; &amp; [Token.refresh_token]" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="" />
      <input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/x-www-form-urlencoded&quot;" />
      <input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" />
      <input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="" />
      <input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="&quot;application/json&quot;" />
      <input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="[Username]" />
      <input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="[Password]" />
    </inputs>
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
    </outputs>
    <onsuccess>5b768c95-9372-4316-ac26-e4f86459ad89</onsuccess>
    <resource object="Utility - HTTP" action="HTTP Request" />
  </stage>
  <stage stageid="e20dcd70-ebf1-416a-a3c2-1468f525809a" name="Request URL" type="Data">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <narrative>
    </narrative>
    <displayx>90</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="61b9983f-e15b-4496-bcec-49f4faf1070b" name="Username" type="Data">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6eedacbc-6f3c-409a-bbc6-de3dcce2b593" name="Password" type="Data">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2e2c47b8-ffab-4216-9657-51a9b74960b2" name="Token" type="Collection">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="721bd85c-0f81-4a98-9c95-2a4fd7799ff5" name="Result" type="Data">
    <subsheetid>28c240f1-b990-40b4-95fc-035aea399ac1</subsheetid>
    <narrative>
    </narrative>
    <displayx>-60</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="09e72fd2-38b2-48e7-944b-6c507d4d00bf" name="MAC Key" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="fec9423c-6e89-4396-bfd3-111d790478fa" name="MAC ID" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="129d13ec-0ee1-4b67-82a5-fbff307d203c" name="Domain" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cc9eee36-8f24-42d9-8138-a82a978bdb44" name="NON WORKING - Under development" type="Block">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-255</displayx>
    <displayy>0</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>270</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="c0de3cf8-6c50-42b9-aacf-c2327acf9356" name="Token" type="Collection">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>390</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f8f33cad-f70a-4f0f-a3af-e78ddb123389" name="Token Row Count" type="Action">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection whose rows are to be counted" expr="&quot;Token&quot;" />
    </inputs>
    <outputs>
      <output type="number" name="Count" narrative="The number of rows counted in the collection" stage="Count" />
    </outputs>
    <onsuccess>f5ab79a6-f113-44f5-83aa-0fa96a1ef7d7</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" />
  </stage>
  <stage stageid="77fed05c-6b21-488a-bfcc-d76320b583c1" name="Count" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>-60</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f5ab79a6-f113-44f5-83aa-0fa96a1ef7d7" name="Token Empty" type="Decision">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Count]=0" />
    <ontrue>a9ebba89-880f-4f91-9b86-6b60d3b593f1</ontrue>
    <onfalse>a19404db-3052-4350-8fd8-9b2ca20b304d</onfalse>
  </stage>
  <stage stageid="a19404db-3052-4350-8fd8-9b2ca20b304d" name="anchor1" type="Anchor">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>135</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>4fb0385d-aa21-497c-b051-d7180524f54b</onsuccess>
  </stage>
  <stage stageid="490b22f5-ccb6-4798-b1da-86b9e0216db7" name="Load Certificate" type="SubSheetInfo">
    <subsheetid>7ae9fd1e-48b3-41c1-9b9d-a822c0f60126</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="da16d9e4-7e4a-4967-994c-b342aa89736e" name="End" type="End">
    <subsheetid>7ae9fd1e-48b3-41c1-9b9d-a822c0f60126</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Certificate ID" stage="Certificate ID" />
    </outputs>
  </stage>
  <stage stageid="54d1754a-7e02-4b40-855d-3fe5d945202b" name="Load" type="Action">
    <subsheetid>7ae9fd1e-48b3-41c1-9b9d-a822c0f60126</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Filename" narrative="OPTIONAL: The full path to a file containing the certificate" expr="[Filename]" />
      <input type="text" name="Subject" narrative="OPTIONAL: The subject of the certificate if loading from the store" expr="[Subject]" />
      <input type="password" name="Password" narrative="OPTIONAL: The password to load the certificate if needed" expr="[Password]" />
    </inputs>
    <outputs>
      <output type="text" name="Certificate ID" narrative="The ID of the certificate" stage="Certificate ID" />
    </outputs>
    <onsuccess>da16d9e4-7e4a-4967-994c-b342aa89736e</onsuccess>
    <resource object="Utility - HTTP" action="Load Certificate" />
  </stage>
  <stage stageid="d5f5cd2d-3aa4-4310-b403-6efd0ce446c0" name="Certificate ID" type="Data">
    <subsheetid>7ae9fd1e-48b3-41c1-9b9d-a822c0f60126</subsheetid>
    <narrative>
    </narrative>
    <displayx>90</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a1019723-a7e7-431c-a168-1503598e04e2" name="Start" type="Start">
    <subsheetid>7ae9fd1e-48b3-41c1-9b9d-a822c0f60126</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Filename" narrative="OPTIONAL: The full path to a file containing the certificate" stage="Filename" />
      <input type="text" name="Subject" narrative="OPTIONAL: The subject of the certificate if loading from the store" stage="Subject" />
      <input type="password" name="Password" narrative="OPTIONAL: The password to load the certificate if needed" stage="Password" />
    </inputs>
    <onsuccess>54d1754a-7e02-4b40-855d-3fe5d945202b</onsuccess>
  </stage>
  <stage stageid="c31cc48e-ec21-4038-91b9-1682bae939af" name="Password" type="Data">
    <subsheetid>7ae9fd1e-48b3-41c1-9b9d-a822c0f60126</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f6df3764-dcc7-4043-8421-f34731b2df9c" name="Subject" type="Data">
    <subsheetid>7ae9fd1e-48b3-41c1-9b9d-a822c0f60126</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="20146d7e-e545-4e86-bc22-69ce3c23fff5" name="Filename" type="Data">
    <subsheetid>7ae9fd1e-48b3-41c1-9b9d-a822c0f60126</subsheetid>
    <narrative>
    </narrative>
    <displayx>90</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="18cff729-a04a-4d34-91c9-80e1428679ad" name="Certificate ID" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>450</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f1c0ddf2-dd2f-440a-973e-a5a235079020" name="Certificate ID" type="Data">
    <subsheetid>7652b71d-b844-4e53-b2af-59d9ec31a0ac</subsheetid>
    <narrative>
    </narrative>
    <displayx>-60</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="968061dc-e7ea-4d0e-8476-6a41cbbe9970" name="Certificate ID" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>525</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="48562cbe-1f7f-4334-b7c2-f4c7409f2ac3" name="Method" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>465</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="27a2c2f2-d405-4f86-ad60-bbc346beb763" name="Method" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>510</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0a010495-6036-41e9-8142-3f4050ceeba8" name="Content Type" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>585</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6a4e8f78-0708-40cc-afae-5adc724e9ff2" name="Body" type="Data">
    <subsheetid>1cfc2c33-3381-4972-abb6-b529f18cfa44</subsheetid>
    <narrative>
    </narrative>
    <displayx>645</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1ef8820a-31cf-4ad0-82c0-61cf077afe8d" name="Content Type" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>570</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="99cdc666-eea1-4822-8131-b19f910b1e97" name="Body" type="Data">
    <subsheetid>67318fea-06de-4ab4-b24e-c296aa10321f</subsheetid>
    <narrative>
    </narrative>
    <displayx>630</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
</process>