<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link type="text/css" href="AutomateHelp.css" rel="stylesheet"/>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>故障排除—日志记录</title>
	<script type="text/javascript" src="script/imagezoom.js"></script>
</head>

<body class="slick troubleshooting">
	<div class="header">
		<h1 class="pagetitle">故障排除</h1>
		<h2>日志记录</h2>
    </div>
    <h3>简介</h3>
    <p>
 诊断日志记录的作用是在应用程序执行时提供更多信息。记录的错误和警告可以帮助查明最终用户可能无法立即发现的系统内故障。可以临时启用更详细的日志记录，以方便用户在解决问题时更好地了解应用程序行为。
    </p>
    <p>
 Blue Prism 使用经过验证的可靠库 NLog 来输出和记录日志信息。用户可以调整在全局或应用程序的特定区域中记录的信息量。还可以从各种日志输出目标（包括 Windows 事件日志、文本文件等）中进行选择。
    </p>
    <h3>配置</h3>
    <p>
 Blue Prism 提供适合大多数环境的标准日志配置。在安装过程中，配置文件将安装到系统的 CommonApplicationData 特殊文件夹中的 Blue Prism 特定文件夹中，通常为 C:\ProgramData\Blue Prism Limited\Blue Prism。每个应用程序都有单独的配置文件：
    </p>
    <ul>
        <li>适用于服务器的 Server.NLog.config</li>
        <li>适用于交互式客户端/资源 PC 的 Automate.NLog.config</li>
    </ul>
    <p>
 默认配置将“信息”级别及以上的日志条目（包括警告、错误和严重错误）定向到 Windows 事件日志。此外，还配置了文本文件日志记录，但默认情况下这种日志记录仅用于严重错误，即导致应用程序崩溃的未处理异常。这可确保崩溃信息可用，即使在 Windows 事件日志记录错误失败时也不受影响。
    </p>
    <p>
 在正常使用 Blue Prism 期间，您不需要自行修改日志配置文件。在调查产品问题时，客户服务通常会提供备用日志配置文件。
    </p>
    <p>
 请注意，修改日志记录配置可能会影响应用程序的性能，如果在生产环境中进行修改，则应特别小心。
    </p>
    <p>对于技术娴熟的客户，以下链接可以提供其他有用信息。</p>
    <ul>
        <li><a href="https://github.com/NLog/NLog/wiki/Tutorial">NLog Github 存储库—基础教程</a></li>
        <li><a href="https://nlog-project.org/config/">NLog 官方网站—配置选项</a></li>
    </ul>
    <h3>标准配置</h3>
    <p>
 以下是有关标准配置的更多详细信息：
    </p>
    <h4>Windows 事件日志</h4>
    <p>“信息”及以上级别的日志条目将定向到 Windows 事件日志。</p>
    <p>事件日志设置在 `&#60code&#62&#60target name="app-eventlog" ...&#60&#47code&#62` 元素中定义。这是通过配置结尾处的以下元素启用的：</p>
    <ul>
        <li>&#60code&#62&#60logger name="*" minlevel="Info" writeTo="app-eventlog" &#47&#62&#60&#47code&#62</li>
    </ul>
    <p>
 主事件日志被称为“Blue Prism”（与以前版本的 Blue Prism 一样）。事件日志源将根据信息是由资源 PC、服务器还是交互式客户端记录的（也与先前版本匹配）而有所不同。
    </p>
    <h4>日志文件</h4>
    <p>
 日志文件配置为写入“CommonApplicationData”特殊文件夹中的 Blue Prism 特定目录，通常为 C:\ProgramData\Blue Prism Limited\Blue Prism\Logs。根据正在运行的应用程序（交互式客户端、服务器或资源 PC）生成单独的日志文件，并为每个资源 PC 生成唯一的文件名。
    </p>
    <p>
 默认情况下，文本文件日志记录仅用于严重错误，即导致应用程序崩溃的未处理异常。这可确保崩溃信息可用，即使在 Windows 事件日志记录错误失败时也不受影响。预期做法是只有在需要更详细的调试信息且客户服务部门建议客户进行必要的配置更改时，才启用详细的文本文件日志记录。
    </p>
    <p>
 文本文件日志记录的参数在 &#60code&#62&#60target name="app-logfile" ...&#60&#47code&#62 元素中定义，并由配置文件末尾的以下元素控制：
    </p>
    <ul>
        <li>&#60code&#62&#60logger name="*" minlevel="Fatal" writeTo="app-logfile" &#47&#62&#60&#47code&#62</li>
    </ul>
    <p>标准配置包括合理的日志存档和轮换机制，当文件达到 10MB 时存档文件并保留最多 10 个存档文件。</p>
    <p>以下是日志文件中的行示例：</p>
    <ul>
        <li>2019-01-14 13:07:59.2395 DEBUG BluePrism.AutomateAppCore.clsResourceConnection BP0188:8182 - Beginning update. 当前状态：离线</li>
    </ul>
    <p>标准配置中定义的此文本格式包含以下元素：</p>
    <ul>
        <li>日期和时间 (UTC)</li>
        <li>日志级别 (DEBUG、INFO、WARN、ERROR、FATAL)</li>
        <li>记录器名称—这用于标识日志条目所源自的应用程序部分</li>
        <li>日志消息</li>
        <li>错误详细信息（仅在条目包含错误信息时提供）。这记录在主日志条目下的新行中。</li>
    </ul>
    <p>可以通过编辑配置来启用整个应用程序的调试级别的文本文件日志记录，如下所示：</p>
    <ul>
        <li>&#60code&#62&#60logger name="*" minlevel="Debug" writeTo="app-logfile" &#47&#62&#60&#47code&#62</li>
    </ul>
    <p>还可以将调试级别日志记录限制到应用程序的特定区域：</p>
    <ul>
        <li>&#60logger name="*" minlevel="Fatal" writeTo="app-logfile" &#47&#62</li>
        <li>&#60logger name="BluePrism.AutomateAppCore" minlevel="Debug" writeTo="app-logfile" &#47&#62</li>
    </ul>
</body>