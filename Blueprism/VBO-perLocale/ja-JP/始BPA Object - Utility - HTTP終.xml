<?xml version="1.0" encoding="utf-8"?>
<process name="始Utility - HTTP終" version="6.2.0.2669" bpversion="6.2.0.2669" narrative="始Communicates with web services using the HTTP protocol.終" type="object" runmode="Exclusive" preferredid="6efb1579-126a-4563-b2e9-3d9e432c1a79">
  <appdef>
    <element name="Application Root">
      <id>2ba17e26-49eb-43ed-84dd-c40e67e990b0</id>
      <type>Application</type>
      <basetype>Application</basetype>
      <datatype>unknown</datatype>
      <diagnose>False</diagnose>
    </element>
  </appdef>
  <view>
    <camerax>0</camerax>
    <cameray>42</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="925e0261-2b2e-41ed-b555-4c5ccf8a00fc" type="CleanUp" published="True">
    <name>始Clean Up終</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="f3a55ad6-3bfa-4401-baa9-0e50afe42879" type="Normal" published="True">
    <name>始Post終</name>
    <view>
      <camerax>109</camerax>
      <cameray>56</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ecff5a78-99b1-4ecb-a356-a075c487ef71" type="Normal" published="True">
    <name>始Post JSON終</name>
    <view>
      <camerax>28</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="d30e8f45-db72-40d2-9f17-9700006fe152" type="Normal" published="True">
    <name>始HTTP Request終</name>
    <view>
      <camerax>50</camerax>
      <cameray>47</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="519a0dc7-b254-478b-b2ed-c7883124e31b" type="Normal" published="True">
    <name>始Load Certificate終</name>
    <view>
      <camerax>0</camerax>
      <cameray>84</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="704436d5-f51b-4369-b763-a4fdc6e894c2" type="Normal" published="True">
    <name>始URL Encode終</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="bee831af-f964-4218-87f3-d3378e2eab10" name="Start" type="Start">
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>071f13b7-de3d-4625-9498-9da634d452b4</onsuccess>
  </stage>
  <stage stageid="11e111be-101c-4df7-9d5c-910a10c02e2d" name="End" type="End">
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="9c4d6f4e-1d32-4d1f-a37d-f279b42fa480" name="Stage1" type="ProcessInfo">
    <narrative></narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <references>
      <reference>System.Data.dll</reference>
      <reference>System.Web.dll</reference>
      <reference>System.Xml.dll</reference>
      <reference>System.Web.dll</reference>
      <reference>Newtonsoft.Json.dll</reference>
      <reference>System.Net.Http.dll</reference>
    </references>
    <imports>
      <import>System</import>
      <import>System.Net</import>
      <import>System.Data</import>
      <import>System.Security.Cryptography.X509Certificates</import>
      <import>System.Collections.Generic</import>
      <import>System.Web</import>
      <import>System.Media</import>
      <import>System.IO</import>
      <import>System.Text</import>
      <import>Newtonsoft.Json</import>
      <import>System.Net.Http.Headers</import>
    </imports>
    <language>visualbasic</language>
    <globalcode><![CDATA[

]]></globalcode>
    <code><![CDATA[Private m_Certificates As New Dictionary(Of String, X509Certificate2)

Private Function GetCertificate(ByVal subject As String) As X509Certificate2
	Dim store As New X509Store(StoreName.My, StoreLocation.LocalMachine)
	Try
		store.Open(OpenFlags.ReadOnly)
		Dim certs As X509Certificate2Collection = store.Certificates.Find(X509FindType.FindBySubjectName, subject, True)
		For Each cert As X509Certificate2 In certs
			Return cert
		Next
	Finally
		store.Close()
	End Try
	Return Nothing
End Function

Function ToDictionary(webResponse As HttpWebResponse ) As Dictionary(Of String, String)

	Dim dict = New Dictionary(Of String, String)()

	For index As Integer = 0 To webResponse.Headers.Count - 1

		If webResponse.Headers.Keys.Count -1 >= index Then

			dict.Add(webResponse.Headers.Keys(index), webResponse.Headers(index) )

		End if

	Next

	Return dict

End Function]]></code>
  </stage>
  <stage stageid="b48af877-43b3-4056-b8b4-88bac82a5c80" name="Clean Up" type="SubSheetInfo">
    <subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid>
    <narrative></narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d35cb9b6-000c-45e5-9a29-9001404a21d0" name="Start" type="Start">
    <subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>f1054fe8-46c8-42ab-b236-5b07592ec5eb</onsuccess>
  </stage>
  <stage stageid="f1054fe8-46c8-42ab-b236-5b07592ec5eb" name="End" type="End">
    <subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="ab202953-451b-4e7c-8cd5-c050e06e286a" name="Post" type="SubSheetInfo">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative>始Sends a message to HTTP endpoint using the POST method. The collection data is encoded using "application/x-www-form-urlencoded"終</narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="e2777b38-8eba-4a04-a611-28bcd6c4add6" name="Start" type="Start">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP Post data to" stage="Address URL" />
      <input type="collection" name="Post Data" narrative="A collection of values to send as Post data" stage="Post Data" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" />
      <input type="collection" name="Headers" narrative="OPTIONAL: HTTP Headers" stage="Headers" />
      <input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" />
    </inputs>
    <onsuccess>e42b0caa-40c1-4a89-a873-f6977581053b</onsuccess>
  </stage>
  <stage stageid="f51a79a9-1213-484c-bedc-065f44051a02" name="End" type="End">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
      <output type="text" name="Post Headers" narrative="The headers related to the Post query" stage="ResultHeadersJson" />
    </outputs>
  </stage>
  <stage stageid="14154308-012d-47e4-a707-8ca80b73651e" name="new" type="Note">
    <subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid>
    <narrative>始Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.終</narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>230</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="4228ae7a-9bb3-4de4-9bbf-00e32d925ecf" name="new" type="Note">
    <narrative>始Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.終</narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>230</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="e42b0caa-40c1-4a89-a873-f6977581053b" name="Get Body" type="Code">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="postData" expr="[Post Data]" />
    </inputs>
    <outputs>
      <output type="text" name="body" stage="Body" />
    </outputs>
    <onsuccess>e9085eba-5f15-4b65-91ed-41abf7c6917f</onsuccess>
    <code><![CDATA[Dim sb As New System.Text.StringBuilder
For Each r As DataRow In postData.Rows
	Dim first As Boolean = True
	For Each c As DataColumn In postData.Columns
		If first Then
			first = False
		Else
			sb.Append("&")
		End If
		Dim columnName As String = c.ColumnName
		Dim encodedCol As String = System.Web.HttpUtility.UrlEncode(columnName)
		sb.Append(encodedCol)
		sb.Append("=")
		Dim val As String = r(columnName).ToString
		Dim encodedVal As String = System.Web.HttpUtility.UrlEncode(val)
		sb.Append(encodedVal)
	Next
	Exit For 'Only one row is allowed
Next

body=sb.ToString()
]]></code>
  </stage>
  <stage stageid="1c58d0fb-9a9b-4d2f-861f-5c22ab835c31" name="Result" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-225</displayx>
    <displayy>270</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b98abed4-9669-476c-87d9-3f485683d049" name="Address URL" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f4c2a5eb-36de-4904-a963-a8513b7e8840" name="Post Data" type="Collection">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="071f13b7-de3d-4625-9498-9da634d452b4" name="Setup" type="Code">
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>11e111be-101c-4df7-9d5c-910a10c02e2d</onsuccess>
    <code><![CDATA[System.Net.ServicePointManager.Expect100Continue = False]]></code>
  </stage>
  <stage stageid="f6ed43b3-714e-4161-b44b-b60490592281" name="Proxy Password" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc></initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bcedbed1-3ed7-42d7-8f16-7e2071c3e187" name="Proxy Username" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="66afe5b7-37e4-4ed7-a9fc-a78e1ab8890c" name="Proxy URL" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>30</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="be7856fe-4027-4226-8caa-851bb6e7df21" name="Use Proxy" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>30</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="38c313e6-bc0d-49e5-a6ab-4042a0682d3d" name="Post JSON" type="SubSheetInfo">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative>始Sends a message to HTTP endpoint using the POST method. The action expects a raw string and sets the content type to "application/json"終</narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="37166627-b66b-4a9c-a321-539933de2123" name="End" type="End">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-15</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
      <output type="text" name="Result Headers" narrative="The headers related to the Post Query" stage="ResultHeadersJson" />
    </outputs>
  </stage>
  <stage stageid="878a70a1-d658-4563-b27c-245f947b74be" name="Result" type="Data">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-255</displayx>
    <displayy>195</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6875cda6-dbbe-47b6-ab82-b62f89c90a88" name="JSON" type="Data">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-165</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4956e14f-001c-4406-a401-38c63ff06696" name="Start" type="Start">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-15</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP Post data to" stage="Address URL" />
      <input type="text" name="JSON" narrative="The JSON to send" stage="JSON" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" />
      <input type="collection" name="Headers" narrative="OPTIONAL: Headers Collection" stage="Headers" />
    </inputs>
    <onsuccess>6b571f09-555c-45a8-9475-957d41cafb24</onsuccess>
  </stage>
  <stage stageid="696696c8-af04-4075-aea0-a8024e2431fe" name="Address URL" type="Data">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-255</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="582df200-7287-4dc1-a9a2-6c9e09276f77" name="Proxy Password" type="Data">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-165</displayx>
    <displayy>75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc></initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="924eb1dd-b782-4f71-82b6-9923ea0093ec" name="Proxy Username" type="Data">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-255</displayx>
    <displayy>75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ed09a5ed-6c7b-4dd3-9bf0-8df61da66ea3" name="Proxy URL" type="Data">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-165</displayx>
    <displayy>30</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5e35c8d6-3f97-4ae4-8566-35fb0981e145" name="Use Proxy" type="Data">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-255</displayx>
    <displayy>30</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4a9fcaf1-4310-45cb-a775-ebfadc75ac8a" name="Headers" type="Collection">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>120</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9e64259d-1a91-444b-8620-b8cd186832d1" name="Accept" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>120</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="58e7a470-3ec3-4033-bb19-0fee1bdcaaed" name="HTTP Request" type="SubSheetInfo">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative>始Sends a message to HTTP endpoint using the specified HTTP method and content-type終</narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d0a11dcd-f002-46b5-aff6-1026c3be2da8" name="End" type="End">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>0</displayx>
    <displayy>75</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
      <output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" />
    </outputs>
  </stage>
  <stage stageid="1fa7def4-c6a8-4325-9bc8-2c6027c0b8e8" name="HTTP Request" type="Code">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>0</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="addressURL" expr="[Address URL]" />
      <input type="text" name="body" expr="[Body]" />
      <input type="text" name="contentType" expr="[Content Type]" />
      <input type="text" name="method" expr="[Method]" />
      <input type="text" name="proxyURL" expr="[Proxy URL]" />
      <input type="flag" name="useProxy" expr="[Use Proxy]" />
      <input type="text" name="proxyUsername" expr="[Proxy Username]" />
      <input type="password" name="proxyPassword" expr="[Proxy Password]" />
      <input type="collection" name="headers" expr="[Headers]" />
      <input type="text" name="accept" expr="[Accept]" />
      <input type="text" name="username" expr="[Username]" />
      <input type="password" name="password" expr="[Password]" />
      <input type="text" name="certID" expr="[Certificate ID]" />
      <input type="flag" name="forcePreAuth" expr="[Force Pre Authorization]" />
      <input type="flag" name="usingFile" expr="[File]" />
    </inputs>
    <outputs>
      <output type="text" name="resultData" stage="Result" />
      <output type="text" name="resultHeadersJson" stage="ResultHeadersJson" />
    </outputs>
    <onsuccess>d0a11dcd-f002-46b5-aff6-1026c3be2da8</onsuccess>
    <code><![CDATA[Try
	Dim request As WebRequest = WebRequest.Create(addressURL)

	If forcePreAuth Then
	   'Sometimes a web server will require the authorisation header in the initial request
	   'In which case we have to add the basic authorization header manually.
	   Dim bytes() As Byte = System.Text.Encoding.UTF8.GetBytes(String.Format("{0}:{1}",username,password))
	   Dim base64 As String = Convert.ToBase64String(bytes)
	   request.Headers.Add("Authorization", "Basic " & base64)
	Else
	  If Not String.IsNullOrEmpty(username) AndAlso Not String.IsNullOrEmpty(password) Then
		request.Credentials = New NetworkCredential(username,password)
	  End If
	End If

	If useProxy Then
		Dim proxyURI As New Uri(proxyURL)
		Dim proxy As New WebProxy(proxyURI, True)
		Dim proxyCred As New NetworkCredential(proxyUsername, proxyPassword)
		Dim credCache As New CredentialCache()
		credCache.Add(proxyURI, "Basic", proxyCred)
		proxy.UseDefaultCredentials = False
		proxy.Credentials = credCache
		request.Proxy = proxy
	End If

	request.Method = method
	request.ContentType = contentType

	Dim httpRequest As HttpWebRequest = TryCast(request, HttpWebRequest)
	If httpRequest IsNot Nothing Then
	  If Not String.IsNullOrEmpty(accept) Then
		httpRequest.Accept = accept
	  End If
	  If Not String.IsNullOrEmpty(certID) Then
		httpRequest.ClientCertificates.Add(m_Certificates(certID))
	  End If
	End If

	For Each r As DataRow In headers.Rows
		For Each c As DataColumn In headers.Columns
			Dim columnName As String = c.ColumnName
			Dim val As String = r(columnName).ToString
			request.Headers.Add(columnName,val)
		Next
		Exit For 'Only one row is allowed
	Next

	' Normal stream writer, we aren't encoding a file etc.
	If Not usingFile Then

		If Not String.IsNullOrEmpty(body) Then
		  Dim requestStream As IO.Stream = request.GetRequestStream()
		  Using sw As New IO.StreamWriter(requestStream, New Text.UTF8Encoding(False))
			sw.Write(body)
		  End Using
		End If

	Else If usingFile Then
		' Prep the request body
		Dim byteArray = File.ReadAllBytes( body )
		Dim requestStream As IO.Stream = request.GetRequestStream()
		requestStream.Write(byteArray,0, byteArray.Length)
End If

	Using response As WebResponse = request.GetResponse()
	  resultHeadersJson = JsonConvert.SerializeObject(ToDictionary(response))
	  Dim responseStream As IO.Stream = response.GetResponseStream()
	  Dim sr As New IO.StreamReader(responseStream)
	  resultData = sr.ReadToEnd()
	End Using

Catch e As WebException

	Using response As WebResponse = e.Response
		Dim httpResponse As HttpWebResponse = CType(response, HttpWebResponse)
		Using data As Stream = response.GetResponseStream()
			Using reader = New StreamReader(data)
				Dim text As String = reader.ReadToEnd()
				resultData = resultData + text
			End Using

		End Using
	End Using

End Try]]></code>
  </stage>
  <stage stageid="96e2df5a-429a-4030-9565-b8cbbf7be6b3" name="Result" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-225</displayx>
    <displayy>375</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8f28cc4e-4ae2-4b01-ad23-0b632027d627" name="Body" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e305dce1-1fd7-459b-8211-27c26350676d" name="Block1" type="Block">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-60</displayx>
    <displayy>-45</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0e0138a9-ccaa-44b1-b742-ad843c39aca1" name="Recover1" type="Recover">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>90</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>0645751f-e202-459a-b704-5fb0e0cbebe7</onsuccess>
  </stage>
  <stage stageid="0645751f-e202-459a-b704-5fb0e0cbebe7" name="Exception1" type="Exception">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>210</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="d8c39895-52d1-45ad-8cd0-be309896d0e5" name="Start" type="Start">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>0</displayx>
    <displayy>-75</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP data to" stage="Address URL" />
      <input type="text" name="Body" narrative="The body text of the HTTP request" stage="Body" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" />
      <input type="text" name="Content Type" narrative="The content type of the HTTP request." stage="Content Type" />
      <input type="text" name="Method" narrative="The method of the HTTP request." stage="Method" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" />
      <input type="collection" name="Headers" narrative="OPTIONAL: Headers" stage="Headers" />
      <input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" />
      <input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" stage="Username" />
      <input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" stage="Password" />
      <input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" stage="Certificate ID" />
      <input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" stage="Force Pre Authorization" />
      <input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" stage="File" />
    </inputs>
    <onsuccess>1fa7def4-c6a8-4325-9bc8-2c6027c0b8e8</onsuccess>
  </stage>
  <stage stageid="c4e87c4e-8150-4a15-8fc5-ddc736b949ae" name="Address URL" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="038a7411-25dc-456c-8007-bb82f3d94de7" name="Proxy Password" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>210</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc></initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8ef02e3a-8214-4163-b44d-a5081ed8b9e4" name="Proxy Username" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>210</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1c6f3a8d-428e-4a61-815c-f32a8a117ae3" name="Proxy URL" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>165</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5c4cc5f6-0531-4375-b9c1-3fcb529dde9b" name="Use Proxy" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>165</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4a98d0d5-c3b8-42fb-933f-2168265f12d6" name="Content Type" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>30</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="fc9f21c4-39ba-4135-8356-f9a516bf6b99" name="Method" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>30</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6b571f09-555c-45a8-9475-957d41cafb24" name="HTTP Request" type="SubSheet">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-15</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Address URL]" />
      <input type="text" name="Body" narrative="The body text of the HTTP request" expr="[JSON]" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="[Use Proxy]" />
      <input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/json&quot;" />
      <input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="[Proxy URL]" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="[Proxy Username]" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="[Proxy Password]" />
      <input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" />
      <input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="" />
      <input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" />
      <input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" />
      <input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" />
      <input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" />
      <input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
      <output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" />
    </outputs>
    <onsuccess>37166627-b66b-4a9c-a321-539933de2123</onsuccess>
    <processid>d30e8f45-db72-40d2-9f17-9700006fe152</processid>
  </stage>
  <stage stageid="33b3447c-a55e-4af3-be35-6cb5624d6a4f" name="Headers" type="Collection">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ac16a164-f018-4111-949f-3db9d4d873d9" name="Accept" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="23c8dd77-277a-4aac-8df7-31c951626abd" name="Body" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-195</displayx>
    <displayy>195</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e9085eba-5f15-4b65-91ed-41abf7c6917f" name="HTTP Request" type="SubSheet">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Address URL]" />
      <input type="text" name="Body" narrative="The body text of the HTTP request" expr="[Body]" />
      <input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="[Use Proxy]" />
      <input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/x-www-form-urlencoded&quot;" />
      <input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" />
      <input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="[Proxy URL]" />
      <input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="[Proxy Username]" />
      <input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="[Proxy Password]" />
      <input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" />
      <input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="[Accept]" />
      <input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" />
      <input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" />
      <input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" />
      <input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" />
      <input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Result" narrative="The result from the Post query." stage="Result" />
      <output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" />
    </outputs>
    <onsuccess>f51a79a9-1213-484c-bedc-065f44051a02</onsuccess>
    <processid>d30e8f45-db72-40d2-9f17-9700006fe152</processid>
  </stage>
  <stage stageid="4bd01e67-49a4-4082-be0d-df1bb9cecb13" name="Username" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>255</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="dac70b0c-83cb-4605-8f7b-d1d8d21922d3" name="Password" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>255</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc></initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9091a189-b87b-4ed7-9747-1e1e9fe657f6" name="Load Certificate" type="SubSheetInfo">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <narrative></narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="3cff8803-c15f-4ab4-a032-d0afb9fa20ae" name="Start" type="Start">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Filename" narrative="OPTIONAL: The full path to a file containing the certificate" stage="Filename" />
      <input type="text" name="Subject" narrative="OPTIONAL: The subject of the certificate if loading from the store" stage="Subject" />
      <input type="password" name="Password" narrative="OPTIONAL: The password to load the certificate if needed" stage="Password" />
    </inputs>
    <onsuccess>8962b858-f6e2-413c-9ceb-3d80dee88de2</onsuccess>
  </stage>
  <stage stageid="17fddf56-07f2-4942-8515-e1b183458a7f" name="End" type="End">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Certificate ID" narrative="The ID of the certificate" stage="Certificate ID" />
    </outputs>
  </stage>
  <stage stageid="e9b8de2b-8e54-4772-b186-046ca262c94c" name="Filename" type="Data">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5f0ec822-a1c0-4b6b-91ba-739b0b2762b8" name="Subject" type="Data">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8962b858-f6e2-413c-9ceb-3d80dee88de2" name="Load" type="Code">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="filename" expr="[Filename]" />
      <input type="password" name="password" expr="[Password]" />
      <input type="text" name="subject" expr="[Subject]" />
    </inputs>
    <outputs>
      <output type="text" name="thumbprint" stage="Certificate ID" />
    </outputs>
    <onsuccess>17fddf56-07f2-4942-8515-e1b183458a7f</onsuccess>
    <code><![CDATA[Dim cert As X509Certificate2 = Nothing
If Not String.IsNullOrEmpty(filename) Then
  cert = New X509Certificate2(filename,password)
End If

If Not String.IsNullOrEmpty(subject) Then
  cert=GetCertificate(subject)
End If

thumbprint = cert.Thumbprint
m_Certificates.Add(thumbprint,cert)
]]></code>
  </stage>
  <stage stageid="745e7557-7761-4078-8ff7-334b6873f126" name="Certificate ID" type="Data">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <narrative></narrative>
    <displayx>-195</displayx>
    <displayy>120</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="471ae54f-286f-4472-b48c-114fc7d04bf9" name="Password" type="Data">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>30</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc></initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="452476e7-b29f-4e5f-999a-c67789bbb0db" name="Certificate ID" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>300</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5de144f5-aa91-46e0-8f9c-ac8495d2ab0c" name="Force Pre Authorization" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-240</displayx>
    <displayy>120</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c83483da-e145-4802-8407-a40cf74fc86a" name="URL Encode" type="SubSheetInfo">
    <subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid>
    <narrative></narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="f640efd4-cb34-48ee-b07d-de356b07b09b" name="Start" type="Start">
    <subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="URL" narrative="The URL to encode" stage="URL" />
    </inputs>
    <onsuccess>d0c241bd-a746-44fc-9fdd-5f73a4c55bf9</onsuccess>
  </stage>
  <stage stageid="0d4cffb2-879f-49d1-b815-43da8446a39c" name="End" type="End">
    <subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="URL" narrative="The encoded URL" stage="URL" />
    </outputs>
  </stage>
  <stage stageid="d0c241bd-a746-44fc-9fdd-5f73a4c55bf9" name="Encode URL" type="Code">
    <subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="URL" expr="[URL]" />
    </inputs>
    <outputs>
      <output type="text" name="Encoded URL" stage="URL" />
    </outputs>
    <onsuccess>0d4cffb2-879f-49d1-b815-43da8446a39c</onsuccess>
    <code><![CDATA[
Encoded_URL = HttpUtility.UrlEncode( URL )]]></code>
  </stage>
  <stage stageid="7a1cd30a-feef-4786-89fd-cf1838f4dfaa" name="URL" type="Data">
    <subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid>
    <narrative></narrative>
    <displayx>-180</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e627cc07-7d3a-40bd-a02a-0a2952f079d0" name="Headers" type="Collection">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-255</displayx>
    <displayy>120</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="FF6600" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="495a88d6-260c-4b89-a04c-64a12af7b759" name="File" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>120</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="765d4221-5509-4c70-97c4-a946b7d3d186" name="ResultHeadersJson" type="Data">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>375</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ea993d2e-35df-484b-9c46-a2d69a172ceb" name="ResultHeadersJson" type="Data">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <narrative></narrative>
    <displayx>-165</displayx>
    <displayy>195</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="031e4c4f-fa80-4e54-b2ab-847483e49414" name="ResultHeadersJson" type="Data">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <narrative></narrative>
    <displayx>-150</displayx>
    <displayy>270</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="caabb2b2-6772-4932-8ad6-0695d1a170d9" name="Inputs" type="Block">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-300</displayx>
    <displayy>-45</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>195</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ae023e33-e349-4bf0-80e0-7e3794a1dbc2" name="Protected Variables" type="Block">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-270</displayx>
    <displayy>165</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="76b976d1-2b36-4ea6-8c01-04fa5ea31f20" name="Outputs" type="Block">
    <subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-300</displayx>
    <displayy>240</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4b809006-50ee-41b3-b1db-2bc0165f895f" name="Inputs" type="Block">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-315</displayx>
    <displayy>-45</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>195</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="2e4c34da-85e1-4b3d-86a2-de7a6b10fcf6" name="Outputs" type="Block">
    <subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-315</displayx>
    <displayy>165</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="cad4106c-2c71-48d0-960d-4d2c78a91eff" name="Inputs" type="Block">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-300</displayx>
    <displayy>-45</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>375</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="a42642fa-1d93-42e4-942a-cb7a7087efef" name="Outputs" type="Block">
    <subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-300</displayx>
    <displayy>345</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4a325f2f-9650-490c-b4bb-61928ef10e68" name="Inputs" type="Block">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-300</displayx>
    <displayy>-45</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>105</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="67c03883-48e2-4ef1-8e3a-98ca0652e901" name="Outputs" type="Block">
    <subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-300</displayx>
    <displayy>90</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="1d4b7d60-b4f9-48d1-8e90-6759e1bfc573" name="Input / Output" type="Block">
    <subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid>
    <loginhibit />
    <narrative></narrative>
    <displayx>-285</displayx>
    <displayy>-45</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
</process>