<process name="Fixed Browser Extension Port Setting" version="1.0" bpversion="6.9.0.26172" narrative="Automated process to ensure that Fixed Browser Port Setting can be enabled and disabled." byrefcollection="true" preferredid="f55611c6-bc8f-4619-97ee-7e06793cf9d7" published="true">
  <view>
    <camerax>0</camerax>
    <cameray>45</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="5d280717-4709-4433-9fdc-8b8cdffda190" type="Normal" published="False">
    <name>Set up</name>
    <view>
      <camerax>0</camerax>
      <cameray>21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca" type="Normal" published="False">
    <name>Enable Fixed Browser Port Setting</name>
    <view>
      <camerax>0</camerax>
      <cameray>-12</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="fd42f724-9e15-422e-8d69-b85e705cf763" name="Start" type="Start">
    <display x="45" y="-165" />
    <onsuccess>be4b9caf-79ee-4afc-8f99-c377c5b7a11a</onsuccess>
  </stage>
  <stage stageid="17fcc8b2-a935-4910-895f-946222bb0044" name="End" type="End">
    <display x="45" y="255" />
  </stage>
  <stage stageid="9c6531e5-49f5-4015-a9a9-98f991884593" name="Stage1" type="ProcessInfo">
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="4c71a8fb-2ca4-4c3d-a642-b6683098ed74" name="Set up" type="SubSheetInfo">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="c7cb902f-8d05-4456-8d15-954bfe4ad485" name="Start" type="Start">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>044167e7-0626-4d1f-99e1-bb7218da88c4</onsuccess>
  </stage>
  <stage stageid="23f339aa-8f2a-4ad4-92e0-82c8fb9eecef" name="End" type="End">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <display x="-45" y="135" />
  </stage>
  <stage stageid="044167e7-0626-4d1f-99e1-bb7218da88c4" name="Launch and Get PID" type="Action">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="120" h="30" />
    <outputs>
      <output type="number" name="pid" friendlyname="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>e5c2ff05-103e-413c-9010-3b708ae2d47e</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="aa0d6659-9897-4365-a216-c9b4bb757fe1" name="Sign In (admin)" type="Action">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="0" w="120" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" expr="&quot;admin&quot;" />
      <input type="password" name="Password" friendlyname="Password" expr="&quot;admin&quot;" />
      <input type="password" name="New Password" friendlyname="New Password" narrative="If this is your first login it will prompt you to change the password." expr="" />
      <input type="flag" name="Expect Password Reset" friendlyname="Expect Password Reset" expr="" />
      <input type="flag" name="Expected License Wizard" friendlyname="Expected License Wizard" expr="" />
      <input type="flag" name="Sign in Active Directorry" friendlyname="Sign in Active Directorry" narrative="Do you want sign in using Active Directory" expr="" />
      <input type="flag" name="Sign in" friendlyname="Sign in" narrative="Do you want sign in using legacy sso environment" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Error Message" friendlyname="Error Message" narrative="Error message received while Login" stage="Sign In Error" />
    </outputs>
    <onsuccess>fecfc381-267d-4840-a150-75cc93de905a</onsuccess>
    <resource object="Blue Prism" action="Sign In" />
  </stage>
  <stage stageid="fecfc381-267d-4840-a150-75cc93de905a" name="Browse to System" type="Action">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="45" w="120" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>cc2907d0-42a2-4b43-b35e-3252ccf25fe6</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="e5c2ff05-103e-413c-9010-3b708ae2d47e" name="Attach to System" type="Action">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-45" w="120" h="30" />
    <inputs>
      <input type="number" name="pid" friendlyname="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>aa0d6659-9897-4365-a216-c9b4bb757fe1</onsuccess>
    <resource object="Blue Prism - System (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="96133fdc-22e6-4fb2-bd28-98c3131d1547" name="Sign In Error" type="Data">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <display x="-195" y="-15" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9e4a7be7-74fe-4bc8-b393-1cc9653cb372" name="Set up" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="45" y="-60" w="180" h="30" />
    <onsuccess>b9570dd2-46f4-400e-bc91-37dd532d697a</onsuccess>
    <processid>5d280717-4709-4433-9fdc-8b8cdffda190</processid>
  </stage>
  <stage stageid="cc2907d0-42a2-4b43-b35e-3252ccf25fe6" name="Browse to Settings" type="Action">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="90" w="120" h="30" />
    <inputs>
      <input type="text" name="Tree Name" friendlyname="Tree Name" narrative="Name of the tree to be extended." expr="&quot;System&quot;" />
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Settings&quot;" />
      <input type="text" name="Sub Item Name" friendlyname="Sub Item Name" narrative="Name of the sub item to be clicked on." expr="" />
      <input type="flag" name="Select Item Method?" friendlyname="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" friendlyname="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" friendlyname="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>23f339aa-8f2a-4ad4-92e0-82c8fb9eecef</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="b5aaee23-41f4-4ad3-b4a9-fa1be33de532" name="Enable Fixed Browser Port Setting" type="SubSheetInfo">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="f7b6eb8b-64ff-4607-b70d-60c172d86c6f" name="Start" type="Start">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>1048d4ed-496f-43f7-9794-a4f56e2fbcf9</onsuccess>
  </stage>
  <stage stageid="9c461fd0-321b-4ccc-8dc9-cfe694066662" name="End" type="End">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="-45" y="135" />
  </stage>
  <stage stageid="1048d4ed-496f-43f7-9794-a4f56e2fbcf9" name="Read checkbox" type="Action">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="120" h="30" />
    <outputs>
      <output type="flag" name="Is Use Fixed Browser Extension Port selected?" friendlyname="Is Use Fixed Browser Extension Port selected?" narrative="Enable Fixed Browser Status" stage="Is selected? (Initial)" />
    </outputs>
    <onsuccess>8ed64c1f-fb97-4312-a8b7-b215f6648573</onsuccess>
    <resource object="Blue Prism - System - System" action="Get Use Fixed Browser Extension Port" />
  </stage>
  <stage stageid="f0566745-6323-4753-891d-c7c7076903ca" name="Set checkbox" type="Action">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="0" w="120" h="30" />
    <inputs>
      <input type="flag" name="Enable Fixed Browser Status" friendlyname="Enable Fixed Browser Status" narrative="The status to set for Fixed Browser" expr="&quot;True&quot;" />
    </inputs>
    <onsuccess>e744d287-7a61-4eb1-b57c-b4e60752287d</onsuccess>
    <resource object="Blue Prism - System - System" action="Set Use Fixed Browser Extension Port" />
  </stage>
  <stage stageid="cf7daa5f-fc19-4915-bd57-28c503a632f8" name="Enable Fixed Browser Port Setting" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="45" y="90" w="180" h="30" />
    <onsuccess>3b6aa4cf-7c74-47c5-a949-ba60278916ff</onsuccess>
    <processid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</processid>
  </stage>
  <stage stageid="be4b9caf-79ee-4afc-8f99-c377c5b7a11a" name="Note1" type="Note">
    <narrative>GIVEN Blue Prism is launched with default port setting</narrative>
    <display x="45" y="-105" w="300" h="30" />
    <font family="Segoe UI" size="12" style="Bold" color="FF0000" />
    <onsuccess>9e4a7be7-74fe-4bc8-b393-1cc9653cb372</onsuccess>
  </stage>
  <stage stageid="b9570dd2-46f4-400e-bc91-37dd532d697a" name="Note1" type="Note">
    <narrative>WHEN 'Use fixed browser extension port (31924) only' value is checked
THEN the setting is enabled
</narrative>
    <display x="45" y="30" w="300" h="60" />
    <font family="Segoe UI" size="12" style="Bold" color="FF0000" />
    <onsuccess>cf7daa5f-fc19-4915-bd57-28c503a632f8</onsuccess>
  </stage>
  <stage stageid="e744d287-7a61-4eb1-b57c-b4e60752287d" name="Read checkbox" type="Action">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="45" w="120" h="30" />
    <outputs>
      <output type="flag" name="Is Use Fixed Browser Extension Port selected?" friendlyname="Is Use Fixed Browser Extension Port selected?" narrative="Enable Fixed Browser Status" stage="Is selected? (After)" />
    </outputs>
    <onsuccess>26211834-d232-4819-9e40-4378458530dd</onsuccess>
    <resource object="Blue Prism - System - System" action="Get Use Fixed Browser Extension Port" />
  </stage>
  <stage stageid="8ed64c1f-fb97-4312-a8b7-b215f6648573" name="Is the checkbox selected?" type="Decision">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="-45" y="-45" w="120" h="30" />
    <decision expression="[Is selected? (Initial)]" />
    <ontrue>37ab9352-6c9e-40d5-88e8-c3f2a6a7a947</ontrue>
    <onfalse>f0566745-6323-4753-891d-c7c7076903ca</onfalse>
  </stage>
  <stage stageid="37ab9352-6c9e-40d5-88e8-c3f2a6a7a947" name="Fail" type="Exception">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="45" y="-45" w="30" h="30" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;'Use fixed browser extension port (31924) only' is selected when expected to be un-ticked&quot;" />
  </stage>
  <stage stageid="189653c6-7d07-41e9-b2cb-3bb0178d1bc9" name="Fail" type="Exception">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="45" y="90" w="30" h="30" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;'Use fixed browser extension port (31924) only' is not selected when expected to be selected&quot;" />
  </stage>
  <stage stageid="26211834-d232-4819-9e40-4378458530dd" name="Is the checkbox selected?" type="Decision">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="-45" y="90" w="120" h="30" />
    <decision expression="[Is selected? (After)]" />
    <ontrue>9c461fd0-321b-4ccc-8dc9-cfe694066662</ontrue>
    <onfalse>189653c6-7d07-41e9-b2cb-3bb0178d1bc9</onfalse>
  </stage>
  <stage stageid="fe617c4d-d255-4e7a-a7ca-09d01e84f34a" name="Output" type="Block">
    <subsheetid>5d280717-4709-4433-9fdc-8b8cdffda190</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5dca8141-68a0-4fad-a61e-ae896d73bea7" name="Recover" type="Recover">
    <loginhibit />
    <display x="255" y="0" />
    <onsuccess>068562a3-09a2-40cc-8ab3-4a59b26645e5</onsuccess>
  </stage>
  <stage stageid="068562a3-09a2-40cc-8ab3-4a59b26645e5" name="Exception" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="255" y="45" w="90" h="30" />
    <onsuccess>bbf74594-785c-4d97-ae22-980d9bc476e4</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="bbf74594-785c-4d97-ae22-980d9bc476e4" name="Resume" type="Resume">
    <loginhibit />
    <display x="255" y="90" />
    <onsuccess>242a8cd1-7475-4168-a6d0-cf69f2c86cbe</onsuccess>
  </stage>
  <stage stageid="242a8cd1-7475-4168-a6d0-cf69f2c86cbe" name="Anchor1" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="255" y="150" w="10" h="10" />
    <onsuccess>3b6aa4cf-7c74-47c5-a949-ba60278916ff</onsuccess>
  </stage>
  <stage stageid="1d533fdf-f921-45f2-af24-5434784280da" name="Failed?" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0e05fe8f-b6c4-41be-a097-1ec274d8a340" name="Exception" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-195" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="49097c39-9303-40a5-8fb5-c1d55526ae39" name="Local Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="cd5e4b0b-dcd0-4826-9c35-6efe5e63b439" name="pid" type="Data">
    <display x="-195" y="120" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="ae26b79c-37cd-45b0-91a7-99f22a1214b7" name="Global Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-270" y="90" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5eb913e8-1299-4b57-9b94-2fb3c72e245e" name="Failed?" type="Decision">
    <display x="45" y="195" w="90" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>0f93abb4-54ee-4f56-88bc-b07612a0271a</ontrue>
    <onfalse>17fcc8b2-a935-4910-895f-946222bb0044</onfalse>
  </stage>
  <stage stageid="0f93abb4-54ee-4f56-88bc-b07612a0271a" name="Re-Throw" type="Exception">
    <display x="150" y="195" />
    <exception localized="yes" type="RETHROW" detail="[Exception]" />
  </stage>
  <stage stageid="a5e4f1d8-aa78-4ea7-a2cd-2059435d84eb" name="Cleanup block" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-105" y="-30" w="420" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="70b84e23-d05e-44ae-8336-df6f42cb0089" name="Local variables" type="Block">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="3b6aa4cf-7c74-47c5-a949-ba60278916ff" name="Exit Blue Prism" type="Action">
    <loginhibit onsuccess="true" />
    <display x="45" y="150" w="90" h="30" />
    <onsuccess>5eb913e8-1299-4b57-9b94-2fb3c72e245e</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="6f019d99-cdbf-4e96-9dd8-7d0e5fd5382d" name="Is selected? (Initial)" type="Data">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="-195" y="-15" w="150" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a09ea166-7731-466b-a766-7cd7b4a2927b" name="Is selected? (After)" type="Data">
    <subsheetid>0a3dbf08-d9ba-47f0-982d-ad6e1aa67bca</subsheetid>
    <display x="-195" y="15" w="150" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
</process>