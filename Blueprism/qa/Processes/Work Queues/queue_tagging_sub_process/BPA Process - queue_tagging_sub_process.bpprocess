<process name="queue_tagging_sub_process" version="1.0" bpversion="7.0.0.40159" narrative="" byrefcollection="true" preferredid="973114c7-a71d-4e81-a310-0bc318570f40" published="true">
  <view>
    <camerax>15</camerax>
    <cameray>411</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="9e356b5e-b886-4c44-86b4-77be5e477b57" type="Normal" published="False">
    <name>Setup</name>
    <view>
      <camerax>0</camerax>
      <cameray>84</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4" type="Normal" published="False">
    <name>Scenario 1</name>
    <view>
      <camerax>0</camerax>
      <cameray>63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="16d64835-dfd8-4edb-9b77-eb8fcf213b0e" type="Normal" published="False">
    <name>Scenario 2</name>
    <view>
      <camerax>0</camerax>
      <cameray>63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="4599c0dc-27fe-4fbc-a5fe-e4ccb908aded" type="Normal" published="False">
    <name>Scenario 3</name>
    <view>
      <camerax>0</camerax>
      <cameray>63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="5294d562-ed57-4de0-9a81-bdf5d0b41a1b" type="Normal" published="False">
    <name>Scenario 4</name>
    <view>
      <camerax>0</camerax>
      <cameray>21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="f6515136-7f7a-4987-8fcf-901f33fa93e6" type="Normal" published="False">
    <name>Scenario 5</name>
    <view>
      <camerax>0</camerax>
      <cameray>42</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="82670fab-f041-48b3-8cfe-a63603098df0" type="Normal" published="False">
    <name>Scenario 6</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="fca14152-b09b-4e10-82f2-0e12445c8ac2" type="Normal" published="False">
    <name>Cleanup</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="5726dc53-877a-4c35-a15e-21fd2ea8f6ab" name="Stage1" type="ProcessInfo">
    <display x="-240" y="-135" w="150" h="90" />
  </stage>
  <stage stageid="aa990edc-2fc7-47cc-99b9-e1d5ca5f66aa" name="Start" type="Start">
    <display x="15" y="-165" />
    <onsuccess>b00b9c5e-a20f-4b73-84a2-1a59024a5632</onsuccess>
  </stage>
  <stage stageid="7d9767ff-d011-4b27-b2e7-e04177e2e330" name="End" type="End">
    <display x="15" y="690" />
  </stage>
  <stage stageid="1eab2eba-3adc-4368-bed3-e9a856144151" name="Cleanup" type="Block">
    <display x="-150" y="-45" w="405" h="615" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="81f08cdf-1a80-422f-b705-450be6f18a3e" name="Local Variables" type="Block">
    <display x="-315" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="64fa0f7c-be5d-484a-83c9-165ec358d9bc" name="Failed?" type="Data">
    <display x="-240" y="60" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="d5d7b49d-de06-4956-b867-064cec367376" name="Exception" type="Data">
    <display x="-240" y="90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="1b819353-42ac-490b-a034-66c523666241" name="Failed?" type="Decision">
    <display x="15" y="645" w="120" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>d4fe9f9c-e98d-497f-a0e9-5807ef4224cb</ontrue>
    <onfalse>7d9767ff-d011-4b27-b2e7-e04177e2e330</onfalse>
  </stage>
  <stage stageid="d4fe9f9c-e98d-497f-a0e9-5807ef4224cb" name="RETHROW" type="Exception">
    <display x="120" y="645" />
    <exception type="RETHROW" detail="[Exception]" />
  </stage>
  <stage stageid="59370d6b-45f5-4bfb-9aa3-ebbeb763a74c" name="Resume" type="Resume">
    <display x="210" y="75" />
    <onsuccess>4ee9182a-a162-48ee-9c0b-3aa8f7bd37a7</onsuccess>
  </stage>
  <stage stageid="6ef24d38-6388-4f07-954b-1aa6d7318eb0" name="Exception Calc" type="MultipleCalculation">
    <display x="210" y="30" />
    <onsuccess>59370d6b-45f5-4bfb-9aa3-ebbeb763a74c</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="a6e4adf8-43eb-4b1c-be98-4978ec09ab7b" name="Global Variables" type="Block">
    <display x="-315" y="-75" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="184ead6c-f33a-43ae-8b7e-f691460aad11" name="Scenario 1" type="SubSheetInfo">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <display x="-135" y="-30" w="150" h="90" />
  </stage>
  <stage stageid="be3c2d38-aae2-4c90-aacb-53b8e5d03023" name="Start" type="Start">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <display x="15" y="-60" />
    <onsuccess>ee2b4bc0-47db-4cc6-a8a5-262094b90000</onsuccess>
  </stage>
  <stage stageid="c2a38a93-a10a-4ed4-8360-965b8994459c" name="End" type="End">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <display x="15" y="165" />
  </stage>
  <stage stageid="f8d42d9d-2af3-446e-80ba-9512f0f660df" name="Scenario 1" type="SubSheet">
    <display x="15" y="30" w="300" h="30" />
    <onsuccess>b259c88b-fea6-46ed-b364-e584cf768340</onsuccess>
    <processid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</processid>
  </stage>
  <stage stageid="34c8a8b7-2f3a-4fa9-87e4-9d0fcb068077" name="Scenario 2" type="SubSheetInfo">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <display x="-135" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="1e6a18bd-05f8-4269-83e5-ac6ac990f9dd" name="Start" type="Start">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>8cc4fdbb-bf5c-435f-b68a-8f7d3ae283c2</onsuccess>
  </stage>
  <stage stageid="e25fec58-3feb-44c6-95a8-a2ee5661b1f8" name="End" type="End">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <display x="15" y="75" />
  </stage>
  <stage stageid="babf42d6-68de-4535-bc42-37b858e7a39f" name="Scenario 3" type="SubSheetInfo">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="-135" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="e8e9bf67-a172-40ad-bd96-779c9db954a6" name="Start" type="Start">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>a83aebfa-a885-493f-b9dd-ec6ad16f21cd</onsuccess>
  </stage>
  <stage stageid="34dc3de9-8125-4d07-9d53-e9d4e570c081" name="End" type="End">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="15" y="210" />
  </stage>
  <stage stageid="e1e443a2-cc25-4ad8-8051-289830cb7f0e" name="Scenario 2" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="300" h="30" />
    <onsuccess>53a44df5-d666-4a97-b7db-58c52731b63f</onsuccess>
    <processid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</processid>
  </stage>
  <stage stageid="5ef2eeef-ebba-4625-b20e-e89c7cef87b5" name="Scenario 3" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="240" w="300" h="30" />
    <onsuccess>7da1f6ba-b5d5-4232-aea4-18f47e8d9630</onsuccess>
    <processid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</processid>
  </stage>
  <stage stageid="b00b9c5e-a20f-4b73-84a2-1a59024a5632" name="Note1" type="Note">
    <narrative>GIVEN the queue has an item on it</narrative>
    <display x="15" y="-120" w="300" h="30" />
    <onsuccess>a7754444-7343-41b7-babc-8525cae8ffa4</onsuccess>
  </stage>
  <stage stageid="f77bb683-d463-4c5b-acf6-73870e4b79cf" name="Note1" type="Note">
    <narrative>WHEN a sub process tries to add a tag to the locked item
THEN the tag can be added</narrative>
    <display x="15" y="-15" w="300" h="30" />
    <onsuccess>f8d42d9d-2af3-446e-80ba-9512f0f660df</onsuccess>
  </stage>
  <stage stageid="b259c88b-fea6-46ed-b364-e584cf768340" name="Note1" type="Note">
    <narrative>WHEN a sub process tries to remove a tag from the locked item
THEN The tag is removed</narrative>
    <display x="15" y="75" w="300" h="30" />
    <onsuccess>e1e443a2-cc25-4ad8-8051-289830cb7f0e</onsuccess>
  </stage>
  <stage stageid="53a44df5-d666-4a97-b7db-58c52731b63f" name="Note1" type="Note">
    <narrative>WHEN an unrelated process tries to remove a tag from the locked item
THEN The tag isn't removed
AND an error is thrown</narrative>
    <display x="15" y="180" w="300" h="60" />
    <onsuccess>5ef2eeef-ebba-4625-b20e-e89c7cef87b5</onsuccess>
  </stage>
  <stage stageid="431dd513-3df0-4581-802f-2504ff9d0f0f" name="Add Tag to locked item" type="Process">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <inputs>
      <input type="text" name="Tag" friendlyname="Tag" expr="&quot;secondTag&quot;" />
      <input type="text" name="Item ID" friendlyname="Item ID" expr="[Item ID]" />
    </inputs>
    <onsuccess>beea2333-5172-4747-84db-df1deb53b27a</onsuccess>
    <processid>b386de8e-9f70-4ba9-869a-50fbd79dcf92</processid>
  </stage>
  <stage stageid="8cc4fdbb-bf5c-435f-b68a-8f7d3ae283c2" name="Untag Locked Item" type="Process">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" expr="[Item ID]" />
      <input type="text" name="Tag" friendlyname="Tag" expr="&quot;secondTag&quot;" />
    </inputs>
    <onsuccess>99b6af9e-594d-4921-8792-9f5d67b26527</onsuccess>
    <processid>86fe91cc-6fc6-40d6-971c-5032114b9a76</processid>
  </stage>
  <stage stageid="d5d48253-2485-43b5-b6dd-e3abf6ce371f" name="Locked Items" type="Collection">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <display x="-135" y="15" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" displayname="Item IDs" />
      <field name="Locked" type="datetime" description="The date/time when the item was locked" displayname="Locked" />
    </collectioninfo>
  </stage>
  <stage stageid="ee2b4bc0-47db-4cc6-a8a5-262094b90000" name="Get Next item" type="Action">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative>
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue" expr="&quot;BP_4044&quot;" />
      <input type="text" name="Key Filter" friendlyname="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" friendlyname="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>431dd513-3df0-4581-802f-2504ff9d0f0f</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" />
  </stage>
  <stage stageid="98b3b0d1-efa9-4b06-85c8-70da5aa2165a" name="Local Variables" type="Block">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="001cb037-0465-4f48-83ba-345e337a1ec7" name="Locked Items" type="Collection">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <display x="-135" y="60" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a83aebfa-a885-493f-b9dd-ec6ad16f21cd" name="Remove Tag via seperate Process" type="Action">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/run &quot;&quot;BP_4044 Child Process Remove Tag&quot;&quot; /resource &quot;&amp;[Resource]&amp;&quot; /startp &quot;&quot;&lt;inputs&gt; &lt;input name='Item ID' type='text' value='&quot;&amp;[Item ID]&amp;&quot;' /&gt; &lt;input name='Tag' type='text' value='firstTag' /&gt;&lt;/inputs&gt;&quot;&quot;&quot;&#xA;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="Output" />
    </outputs>
    <onsuccess>dd8e2ccc-dc36-4699-ab4b-daf1f920535d</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="4ee9182a-a162-48ee-9c0b-3aa8f7bd37a7" name="Anchor1" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="210" y="600" w="10" h="10" />
    <onsuccess>9454c086-81b5-4c22-bb4e-7885040fdbc0</onsuccess>
  </stage>
  <stage stageid="f0b9424c-3a92-46d5-b496-005842c32e36" name="Note1" type="Note">
    <narrative>WHEN a sub process tries to add a tag to an unlocked item
THEN the tag can be added</narrative>
    <display x="15" y="405" w="300" h="30" />
    <onsuccess>802da13a-41bf-42f5-90d1-79c63db02b11</onsuccess>
  </stage>
  <stage stageid="d9431773-ec0e-4c50-9916-4610669aabbb" name="Scenario 4" type="SubSheetInfo">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="-135" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="c46e8f4f-7100-4c33-9c48-a9c5b0397a49" name="Scenario 4" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="360" w="300" h="30" />
    <onsuccess>f0b9424c-3a92-46d5-b496-005842c32e36</onsuccess>
    <processid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</processid>
  </stage>
  <stage stageid="7d6e5f74-51c7-4d1a-9ec8-6c34c705a9c5" name="Setup" type="SubSheetInfo">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <display x="-120" y="-30" w="150" h="90" />
  </stage>
  <stage stageid="a0b7f7bb-b262-40d3-aca5-1444ba63c26c" name="Start" type="Start">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <display x="30" y="-60" />
    <onsuccess>9e644be5-d916-425a-b102-6079828bfaa4</onsuccess>
  </stage>
  <stage stageid="d8fe3455-3c33-423c-8fd4-12d783eeca5e" name="End" type="End">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <display x="30" y="255" />
  </stage>
  <stage stageid="9e644be5-d916-425a-b102-6079828bfaa4" name="Start Resource" type="Action">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="-15" w="120" h="30" />
    <inputs>
      <input type="flag" name="SSO" friendlyname="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="SingleSignon()" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="&quot;admin&quot;" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to use for the resource. Only used if Username is given" expr="&quot;admin&quot;" />
      <input type="number" name="Port" friendlyname="Port" narrative="The port number on which the resource PC should listen" expr="4044" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" friendlyname="Process ID" narrative="The PID of the newly created process" stage="" />
    </outputs>
    <onsuccess>0507ca3e-c31b-4ff5-b8ca-13e5b59d149b</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="0507ca3e-c31b-4ff5-b8ca-13e5b59d149b" name="Get Resource" type="Calculation">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="30" w="120" h="30" />
    <onsuccess>48805d3c-6712-4361-920b-3421a25e2d97</onsuccess>
    <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;)&amp;&quot;:4044&quot;" stage="Resource" />
  </stage>
  <stage stageid="9208230b-e465-497e-bdc7-2c2bd1cc0f99" name="Resource" type="Data">
    <display x="-240" y="-45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="edeefc31-166b-4089-bb79-dd8be03ecd04" name="Item ID" type="Data">
    <display x="-240" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="a64ded2c-78d2-4988-955f-f7c421291626" name="Numbers" type="Collection">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <display x="-120" y="60" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="numberField" type="number" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="numberField" type="number" value="1" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="f6edd289-52c4-486b-b6f1-14713d16312a" name="Add Items To A queue" type="Action">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="30" y="120" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="&quot;BP_4044&quot;" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Numbers]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;firstTag&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="">
        <validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" />
      </input>
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="" />
    </outputs>
    <onsuccess>f55c3767-12e1-49f4-9610-96765d23d17d</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="a79f19e5-c407-475f-892c-4dcb230b6c0a" name="Local Variables" type="Block">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="30" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="a7754444-7343-41b7-babc-8525cae8ffa4" name="Setup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="300" h="30" />
    <onsuccess>f77bb683-d463-4c5b-acf6-73870e4b79cf</onsuccess>
    <processid>9e356b5e-b886-4c44-86b4-77be5e477b57</processid>
  </stage>
  <stage stageid="7da1f6ba-b5d5-4232-aea4-18f47e8d9630" name="Note1" type="Note">
    <narrative>WHEN an unrelated process tries to add a tag to the locked item
THEN The tag isn't added
AND an error is thrown</narrative>
    <display x="15" y="300" w="300" h="60" />
    <onsuccess>c46e8f4f-7100-4c33-9c48-a9c5b0397a49</onsuccess>
  </stage>
  <stage stageid="10641cee-d022-45ac-ab7e-16ce42976be5" name="Output" type="Data">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="-135" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f4260a54-ccb2-4a54-94a2-801e8ac407fc" name="Local Variables" type="Block">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-15" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="cfa453e0-efd4-4bfb-802c-20264ff40604" name="Local Variables" type="Block">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-15" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="f55c3767-12e1-49f4-9610-96765d23d17d" name="Publish Remove Tag Process" type="Action">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="165" w="120" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/publish &quot;&quot;BP_4044 Child Process Remove Tag&quot;&quot;&quot;&#xA;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="" />
    </outputs>
    <onsuccess>8cacf150-04f2-4818-82f7-b1c8b9810c85</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="dd8e2ccc-dc36-4699-ab4b-daf1f920535d" name="Get Session ID" type="Calculation">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="120" h="30" />
    <onsuccess>0cb6f9b9-3cdf-4f18-ac04-22d28151038f</onsuccess>
    <calculation expression="Right([Output], 38)" stage="Session ID" />
  </stage>
  <stage stageid="7d3e5637-385d-4748-8212-ccea12436da8" name="Session ID" type="Data">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="-135" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0cb6f9b9-3cdf-4f18-ac04-22d28151038f" name="Get Session Status" type="Action">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <inputs>
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/status &quot;&amp;[Session ID]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="Status" />
    </outputs>
    <onsuccess>e28b67c9-9ccf-42b3-9551-148a6ba89556</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="eae862ea-9253-4087-a7a6-6a3ee6704c9e" name="Get Session Log" type="Action">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="120" h="30" />
    <inputs>
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/getlog &quot;&amp;[Session ID]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="Log" />
    </outputs>
    <onsuccess>9202aca0-ca54-411e-9c2e-333e22c4e8ee</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="bdb410b4-a97b-4fe2-8214-5a1dfca71c21" name="Log" type="Data">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="-135" y="105" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="57c9a4fd-b95a-4aff-b07f-4b52d5fa0053" name="Status" type="Data">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="-135" y="75" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9202aca0-ca54-411e-9c2e-333e22c4e8ee" name="Check session failed correctly?" type="Decision">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="15" y="165" w="120" h="30" />
    <decision expression="InStr([Log], &quot;Log for session &quot;&amp;[Session ID])&lt;&gt;0&#xA;AND&#xA;InStr([Log], &quot;Work Queues::Untag Item,ERROR: Internal : This work queue item is locked by another process.&quot;)&lt;&gt;0" />
    <ontrue>34dc3de9-8125-4d07-9d53-e9d4e570c081</ontrue>
    <onfalse>bf2cf95c-afb8-47ae-a4e6-d769145cc3e8</onfalse>
  </stage>
  <stage stageid="e28b67c9-9ccf-42b3-9551-148a6ba89556" name="Session Failed?" type="Decision">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="15" y="75" w="120" h="30" />
    <decision expression="InStr([Status], &quot;Session:&quot;&amp;[Session ID])&lt;&gt;0&#xA;AND&#xA;InStr([Status], &quot;Status:Failed&quot;)&lt;&gt;0" />
    <ontrue>eae862ea-9253-4087-a7a6-6a3ee6704c9e</ontrue>
    <onfalse>231b9fda-02c2-4988-a651-60b2e56aa733</onfalse>
  </stage>
  <stage stageid="231b9fda-02c2-4988-a651-60b2e56aa733" name="FAIL" type="Exception">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="105" y="75" w="30" h="30" />
    <exception localized="yes" type="SystemException" detail="&quot;It seems the session didnt fail like it should have.&quot;" />
  </stage>
  <stage stageid="bf2cf95c-afb8-47ae-a4e6-d769145cc3e8" name="FAIL" type="Exception">
    <subsheetid>4599c0dc-27fe-4fbc-a5fe-e4ccb908aded</subsheetid>
    <display x="105" y="165" w="30" h="30" />
    <exception localized="yes" type="SystemException" detail="&quot;It seems the session didnt fail with the expected error message.&quot;" />
  </stage>
  <stage stageid="9648ddde-b8a0-4156-a87b-882a95954bab" name="Start" type="Start">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>d4979e7a-9d35-4e52-a14c-050ac0b6dada</onsuccess>
  </stage>
  <stage stageid="7701ec23-8c93-419f-b45d-0c8891983c1f" name="End" type="End">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="15" y="210" />
  </stage>
  <stage stageid="d4979e7a-9d35-4e52-a14c-050ac0b6dada" name="Add Tag via seperate Process" type="Action">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/run &quot;&quot;BP_4044 Child Process Add Tag&quot;&quot; /resource &quot;&amp;[Resource]&amp;&quot; /startp &quot;&quot;&lt;inputs&gt; &lt;input name='Item ID' type='text' value='&quot;&amp;[Item ID]&amp;&quot;' /&gt; &lt;input name='Tag' type='text' value='thirdTag' /&gt;&lt;/inputs&gt;&quot;&quot;&quot;&#xA;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="Output" />
    </outputs>
    <onsuccess>22a613b6-20b9-4bd0-b737-56e6fdfa42b9</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="b96aab36-4f87-460f-9722-450026115f03" name="Output" type="Data">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="-135" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c7558722-a616-44da-bdc6-4b8ab26869f0" name="Local Variables" type="Block">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-15" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="22a613b6-20b9-4bd0-b737-56e6fdfa42b9" name="Get Session ID" type="Calculation">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="120" h="30" />
    <onsuccess>96703ab8-9079-4554-8105-25b658014108</onsuccess>
    <calculation expression="Right([Output], 38)" stage="Session ID" />
  </stage>
  <stage stageid="649049f2-a344-4658-aa10-6fe690a4b6f3" name="Session ID" type="Data">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="-135" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="96703ab8-9079-4554-8105-25b658014108" name="Get Session Status" type="Action">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <inputs>
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/status &quot;&amp;[Session ID]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="Status" />
    </outputs>
    <onsuccess>cbff8c83-db83-4aaf-a315-eb03386759ab</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="c222e17f-f86c-4dc2-b485-2ae587ed4bff" name="Get Session Log" type="Action">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="120" h="30" />
    <inputs>
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/getlog &quot;&amp;[Session ID]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="Log" />
    </outputs>
    <onsuccess>b892aa66-4db4-4871-823c-68c0646f3764</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="9ef43966-3d83-4591-9d15-6a0486ba34f1" name="Log" type="Data">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="-135" y="105" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3f5cb6f1-220d-49cd-a134-13970df3121e" name="Status" type="Data">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="-135" y="75" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b892aa66-4db4-4871-823c-68c0646f3764" name="Check session failed correctly?" type="Decision">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="15" y="165" w="120" h="30" />
    <decision expression="InStr([Log], &quot;Log for session &quot;&amp;[Session ID])&lt;&gt;0&#xA;AND&#xA;InStr([Log], &quot;Work Queues::Tag Item,ERROR: Internal : This work queue item is locked by another process.&quot;)&lt;&gt;0" />
    <ontrue>7701ec23-8c93-419f-b45d-0c8891983c1f</ontrue>
    <onfalse>a2ddaf30-236c-4977-8a24-5b53432804d7</onfalse>
  </stage>
  <stage stageid="cbff8c83-db83-4aaf-a315-eb03386759ab" name="Session Failed?" type="Decision">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="15" y="75" w="120" h="30" />
    <decision expression="InStr([Status], &quot;Session:&quot;&amp;[Session ID])&lt;&gt;0&#xA;AND&#xA;InStr([Status], &quot;Status:Failed&quot;)&lt;&gt;0" />
    <ontrue>c222e17f-f86c-4dc2-b485-2ae587ed4bff</ontrue>
    <onfalse>bc9e5136-26f8-4ba0-a4a2-e5538dbd60d0</onfalse>
  </stage>
  <stage stageid="bc9e5136-26f8-4ba0-a4a2-e5538dbd60d0" name="FAIL" type="Exception">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="105" y="75" w="30" h="30" />
    <exception localized="yes" type="SystemException" detail="&quot;It seems the session didnt fail like it should have.&quot;" />
  </stage>
  <stage stageid="a2ddaf30-236c-4977-8a24-5b53432804d7" name="FAIL" type="Exception">
    <subsheetid>5294d562-ed57-4de0-9a81-bdf5d0b41a1b</subsheetid>
    <display x="105" y="165" w="30" h="30" />
    <exception localized="yes" type="SystemException" detail="&quot;It seems the session didnt fail with the expected error message.&quot;" />
  </stage>
  <stage stageid="8cacf150-04f2-4818-82f7-b1c8b9810c85" name="Publish Add Tag Process" type="Action">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="210" w="120" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/publish &quot;&quot;BP_4044 Child Process Add Tag&quot;&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="" />
    </outputs>
    <onsuccess>d8fe3455-3c33-423c-8fd4-12d783eeca5e</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="48805d3c-6712-4361-920b-3421a25e2d97" name="Create Queue" type="Action">
    <subsheetid>9e356b5e-b886-4c44-86b4-77be5e477b57</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="75" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to be created" expr="&quot;BP_4044&quot;" />
      <input type="text" name="Key Field" friendlyname="Key Field" narrative="The key column to use in the collection which makes up a queue item" expr="" />
      <input type="number" name="Max Attempts" friendlyname="Max Attempts" narrative="The maximum number of retry attempts for the queue. Default: 5" expr="" />
    </inputs>
    <onsuccess>f6edd289-52c4-486b-b6f1-14713d16312a</onsuccess>
    <resource object="Queue Utils" action="Create Queue" />
  </stage>
  <stage stageid="e186fde2-558a-4c22-a57b-28124a2c6727" name="Cleanup" type="SubSheetInfo">
    <subsheetid>fca14152-b09b-4e10-82f2-0e12445c8ac2</subsheetid>
    <display x="-135" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="552ce813-3c4d-4724-91d0-9f587d786762" name="Start" type="Start">
    <subsheetid>fca14152-b09b-4e10-82f2-0e12445c8ac2</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>10c5eccb-1131-486c-b7ad-8fd36666b449</onsuccess>
  </stage>
  <stage stageid="c92666a5-fb36-43eb-81fd-f8aee23577eb" name="End" type="End">
    <subsheetid>fca14152-b09b-4e10-82f2-0e12445c8ac2</subsheetid>
    <display x="15" y="120" />
  </stage>
  <stage stageid="10c5eccb-1131-486c-b7ad-8fd36666b449" name="Stop Resource" type="Action">
    <subsheetid>fca14152-b09b-4e10-82f2-0e12445c8ac2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <inputs>
      <input type="number" name="Port" friendlyname="Port" narrative="The port number whose resource should be stopped" expr="4044" />
    </inputs>
    <onsuccess>8c4ccf77-5dc7-476f-b956-c07109bb839d</onsuccess>
    <resource object="Resource Manager" action="Stop Resource" />
  </stage>
  <stage stageid="8c4ccf77-5dc7-476f-b956-c07109bb839d" name="UnPublish Remove Tag Process" type="Action">
    <subsheetid>fca14152-b09b-4e10-82f2-0e12445c8ac2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/unpublish &quot;&quot;BP_4044 Child Process Remove Tag&quot;&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="" />
    </outputs>
    <onsuccess>828cf4ad-a369-4df9-b5b3-a531b52fd28c</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="828cf4ad-a369-4df9-b5b3-a531b52fd28c" name="UnPublish Add Tag Process" type="Action">
    <subsheetid>fca14152-b09b-4e10-82f2-0e12445c8ac2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="&quot;admin&quot;" />
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/unpublish &quot;&quot;BP_4044 Child Process Add Tag&quot;&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="" />
    </outputs>
    <onsuccess>2eb7132a-6c36-4376-8d1e-0c3492928b98</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="2eb7132a-6c36-4376-8d1e-0c3492928b98" name="Destroy Queue" type="Action">
    <subsheetid>fca14152-b09b-4e10-82f2-0e12445c8ac2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="75" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to delete" expr="&quot;BP_4044&quot;" />
    </inputs>
    <onsuccess>c92666a5-fb36-43eb-81fd-f8aee23577eb</onsuccess>
    <resource object="Queue Utils" action="Destroy Queue" />
  </stage>
  <stage stageid="9454c086-81b5-4c22-bb4e-7885040fdbc0" name="Cleanup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="600" w="120" h="30" />
    <onsuccess>1b819353-42ac-490b-a034-66c523666241</onsuccess>
    <processid>fca14152-b09b-4e10-82f2-0e12445c8ac2</processid>
  </stage>
  <stage stageid="e6885eca-5807-499b-9b8e-eae48b01b36a" name="Recover" type="Recover">
    <loginhibit />
    <display x="210" y="-15" />
    <onsuccess>6ef24d38-6388-4f07-954b-1aa6d7318eb0</onsuccess>
  </stage>
  <stage stageid="f48686ff-71ac-40f5-aa33-f8a2943f5f64" name="Scenario 5" type="SubSheetInfo">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <display x="-135" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="e1338d54-9808-49b8-a9cb-3b0e972d2d89" name="Start" type="Start">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>ce557aee-3112-4bad-a716-31cdfe80eb6a</onsuccess>
  </stage>
  <stage stageid="85ca65f0-1bea-4e0b-8af3-953ca0d0dcb3" name="End" type="End">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <display x="15" y="120" />
  </stage>
  <stage stageid="ce557aee-3112-4bad-a716-31cdfe80eb6a" name="Unlock Item" type="Action">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Unlocks a currently locked work queue item</narrative>
    <display x="15" y="-60" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the work queue item which should be unlocked" expr="[Item ID]" />
    </inputs>
    <outputs>
      <output type="flag" name="Unlocked" friendlyname="Unlocked" narrative="Whether the item was unlocked as a result of this action or not. If the item had finished being worked elsewhere before this action had run, this will be 'False'" stage="" />
    </outputs>
    <onsuccess>b61f2e98-ac57-4461-a17a-95aefae3a929</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Unlock Item" />
  </stage>
  <stage stageid="4d8f41e1-4ab6-4413-97eb-0dac2b21bc39" name="Note1" type="Note">
    <narrative>WHEN a sub process tries to remove a tag from an unlocked item
THEN the tag can be removed</narrative>
    <display x="15" y="495" w="300" h="30" />
    <onsuccess>25991287-ab32-40bf-9438-1b9ddb113758</onsuccess>
  </stage>
  <stage stageid="1cc270de-6269-4f00-a7b4-4f9c96018c67" name="Scenario 6" type="SubSheetInfo">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <display x="-135" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="b61f2e98-ac57-4461-a17a-95aefae3a929" name="Add Tag to unlocked item" type="Process">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="Tag" friendlyname="Tag" expr="&quot;fourthTag&quot;" />
      <input type="text" name="Item ID" friendlyname="Item ID" expr="[Item ID]" />
    </inputs>
    <onsuccess>29a0ef5f-0b2f-4b18-bd92-f853d88b26aa</onsuccess>
    <processid>b386de8e-9f70-4ba9-869a-50fbd79dcf92</processid>
  </stage>
  <stage stageid="6415c12b-4962-4589-932d-ace002032b8f" name="Start" type="Start">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>8c6dd382-8600-45c7-b0aa-9b4f1075feac</onsuccess>
  </stage>
  <stage stageid="6d249ff8-8961-4e83-a9b9-d6633a09e17d" name="End" type="End">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <display x="15" y="75" />
  </stage>
  <stage stageid="8c6dd382-8600-45c7-b0aa-9b4f1075feac" name="Untag Locked Item" type="Process">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" expr="[Item ID]" />
      <input type="text" name="Tag" friendlyname="Tag" expr="&quot;fourthTag&quot;" />
    </inputs>
    <onsuccess>4b7582c6-af7a-47b6-8d74-7069b4b4ee7a</onsuccess>
    <processid>86fe91cc-6fc6-40d6-971c-5032114b9a76</processid>
  </stage>
  <stage stageid="af35a4a0-fbc4-4860-a970-1310be299087" name="Locked Items" type="Collection">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <display x="-135" y="15" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" displayname="Item IDs" />
      <field name="Locked" type="datetime" description="The date/time when the item was locked" displayname="Locked" />
    </collectioninfo>
  </stage>
  <stage stageid="f6c134d0-d943-46e3-8619-f34bb3f6b449" name="Local Variables" type="Block">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-15" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="802da13a-41bf-42f5-90d1-79c63db02b11" name="Scenario 5" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="450" w="300" h="30" />
    <onsuccess>4d8f41e1-4ab6-4413-97eb-0dac2b21bc39</onsuccess>
    <processid>f6515136-7f7a-4987-8fcf-901f33fa93e6</processid>
  </stage>
  <stage stageid="25991287-ab32-40bf-9438-1b9ddb113758" name="Scenario 6" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="540" w="300" h="30" />
    <onsuccess>9454c086-81b5-4c22-bb4e-7885040fdbc0</onsuccess>
    <processid>82670fab-f041-48b3-8cfe-a63603098df0</processid>
  </stage>
  <stage stageid="29a0ef5f-0b2f-4b18-bd92-f853d88b26aa" name="Get Item Data" type="Action">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get data relating to an item in a queue. You do not need to have a lock on the item to do this.</narrative>
    <display x="15" y="30" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to get data from. An error will be raised if this item does not exist." expr="[Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Key" friendlyname="Key" narrative="The key value of the item." stage="" />
      <output type="number" name="Priority" friendlyname="Priority" narrative="The priority of the item" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
      <output type="timespan" name="Worktime" friendlyname="Worktime" narrative="The total time spent on this item (including previous attempts)" stage="" />
      <output type="timespan" name="Attempt Worktime" friendlyname="Attempt Worktime" narrative="The amount of time spent on this particular attempt of the item" stage="" />
      <output type="datetime" name="Loaded DateTime" friendlyname="Loaded DateTime" narrative="The date and time at which this item was first loaded into the queue." stage="" />
      <output type="datetime" name="Deferred DateTime" friendlyname="Deferred DateTime" narrative="The date and time at which this item has been deferred to. Empty if this item has not been deferred." stage="" />
      <output type="datetime" name="Completed DateTime" friendlyname="Completed DateTime" narrative="The date and time at which this item was marked as complete. Empty if this item has not been marked as complete" stage="" />
      <output type="datetime" name="Exception DateTime" friendlyname="Exception DateTime" narrative="The date and time at which this item was marked as an exception. Empty if there has never been an exception on this item." stage="" />
      <output type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="The exception reason recorded against this item." stage="" />
      <output type="text" name="Tags" friendlyname="Tags" narrative="The semi-colon separated set of tags which apply to the item. " stage="Tags" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
    </outputs>
    <onsuccess>660a105e-964a-4143-b7cb-f8c75ed8452f</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item Data" />
  </stage>
  <stage stageid="660a105e-964a-4143-b7cb-f8c75ed8452f" name="New Tag Added?" type="Decision">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <display x="15" y="75" w="120" h="30" />
    <decision expression="[Tags]=&quot;firstTag;fourthTag&quot;" />
    <ontrue>85ca65f0-1bea-4e0b-8af3-953ca0d0dcb3</ontrue>
    <onfalse>022cdcd1-967b-4e0a-aa76-689858e15dfb</onfalse>
  </stage>
  <stage stageid="022cdcd1-967b-4e0a-aa76-689858e15dfb" name="FAIL" type="Exception">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <display x="105" y="75" w="30" h="30" />
    <exception localized="yes" type="" detail="&quot;The fourth tag wasnt added when the item was unlock and added via a sub process&quot;" />
  </stage>
  <stage stageid="7aa8ad78-324a-461c-b65f-9327d41e08e7" name="Tags" type="Data">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <display x="-135" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a23d869a-0306-4e39-bded-6c6d6d2eb9d9" name="Local Variables" type="Block">
    <subsheetid>f6515136-7f7a-4987-8fcf-901f33fa93e6</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="99b6af9e-594d-4921-8792-9f5d67b26527" name="Get Item Data" type="Action">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get data relating to an item in a queue. You do not need to have a lock on the item to do this.</narrative>
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to get data from. An error will be raised if this item does not exist." expr="[Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Key" friendlyname="Key" narrative="The key value of the item." stage="" />
      <output type="number" name="Priority" friendlyname="Priority" narrative="The priority of the item" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
      <output type="timespan" name="Worktime" friendlyname="Worktime" narrative="The total time spent on this item (including previous attempts)" stage="" />
      <output type="timespan" name="Attempt Worktime" friendlyname="Attempt Worktime" narrative="The amount of time spent on this particular attempt of the item" stage="" />
      <output type="datetime" name="Loaded DateTime" friendlyname="Loaded DateTime" narrative="The date and time at which this item was first loaded into the queue." stage="" />
      <output type="datetime" name="Deferred DateTime" friendlyname="Deferred DateTime" narrative="The date and time at which this item has been deferred to. Empty if this item has not been deferred." stage="" />
      <output type="datetime" name="Completed DateTime" friendlyname="Completed DateTime" narrative="The date and time at which this item was marked as complete. Empty if this item has not been marked as complete" stage="" />
      <output type="datetime" name="Exception DateTime" friendlyname="Exception DateTime" narrative="The date and time at which this item was marked as an exception. Empty if there has never been an exception on this item." stage="" />
      <output type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="The exception reason recorded against this item." stage="" />
      <output type="text" name="Tags" friendlyname="Tags" narrative="The semi-colon separated set of tags which apply to the item. " stage="Tags" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
    </outputs>
    <onsuccess>54f4f06f-b672-453e-b609-98e9b36af81c</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item Data" />
  </stage>
  <stage stageid="54f4f06f-b672-453e-b609-98e9b36af81c" name="&quot;secondTag&quot; Removed?" type="Decision">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <display x="15" y="30" w="120" h="30" />
    <decision expression="[Tags]=&quot;firstTag&quot;" />
    <ontrue>e25fec58-3feb-44c6-95a8-a2ee5661b1f8</ontrue>
    <onfalse>5a6a37fc-d937-4367-9ec6-6ccd2f1988f2</onfalse>
  </stage>
  <stage stageid="5a6a37fc-d937-4367-9ec6-6ccd2f1988f2" name="FAIL" type="Exception">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <display x="105" y="30" w="30" h="30" />
    <exception localized="yes" type="" detail="&quot;The second tag wasnt removed when the item was locked and removed via a sub process&quot;" />
  </stage>
  <stage stageid="ba733189-7245-4093-b583-060bf1968804" name="Tags" type="Data">
    <subsheetid>16d64835-dfd8-4edb-9b77-eb8fcf213b0e</subsheetid>
    <display x="-135" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="beea2333-5172-4747-84db-df1deb53b27a" name="Get Item Data" type="Action">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get data relating to an item in a queue. You do not need to have a lock on the item to do this.</narrative>
    <display x="15" y="75" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to get data from. An error will be raised if this item does not exist." expr="[Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Key" friendlyname="Key" narrative="The key value of the item." stage="" />
      <output type="number" name="Priority" friendlyname="Priority" narrative="The priority of the item" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
      <output type="timespan" name="Worktime" friendlyname="Worktime" narrative="The total time spent on this item (including previous attempts)" stage="" />
      <output type="timespan" name="Attempt Worktime" friendlyname="Attempt Worktime" narrative="The amount of time spent on this particular attempt of the item" stage="" />
      <output type="datetime" name="Loaded DateTime" friendlyname="Loaded DateTime" narrative="The date and time at which this item was first loaded into the queue." stage="" />
      <output type="datetime" name="Deferred DateTime" friendlyname="Deferred DateTime" narrative="The date and time at which this item has been deferred to. Empty if this item has not been deferred." stage="" />
      <output type="datetime" name="Completed DateTime" friendlyname="Completed DateTime" narrative="The date and time at which this item was marked as complete. Empty if this item has not been marked as complete" stage="" />
      <output type="datetime" name="Exception DateTime" friendlyname="Exception DateTime" narrative="The date and time at which this item was marked as an exception. Empty if there has never been an exception on this item." stage="" />
      <output type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="The exception reason recorded against this item." stage="" />
      <output type="text" name="Tags" friendlyname="Tags" narrative="The semi-colon separated set of tags which apply to the item. " stage="Tags" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
    </outputs>
    <onsuccess>15f4e205-db25-4ccb-96a4-b2e42b848d63</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item Data" />
  </stage>
  <stage stageid="15f4e205-db25-4ccb-96a4-b2e42b848d63" name="&quot;secondTag&quot; Added?" type="Decision">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <display x="15" y="120" w="120" h="30" />
    <decision expression="[Tags]=&quot;firstTag;secondTag&quot;" />
    <ontrue>c2a38a93-a10a-4ed4-8360-965b8994459c</ontrue>
    <onfalse>1e1c10a7-64a8-499e-b1e9-e6cb6da0e40e</onfalse>
  </stage>
  <stage stageid="1e1c10a7-64a8-499e-b1e9-e6cb6da0e40e" name="FAIL" type="Exception">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <display x="105" y="120" w="30" h="30" />
    <exception localized="yes" type="" detail="&quot;The second tag wasnt added when the item was locked and added via a sub process&quot;" />
  </stage>
  <stage stageid="9e252a78-c872-4e58-9146-15847814237a" name="Tags" type="Data">
    <subsheetid>4ac5e6c0-4a35-4f52-a97b-21bc64ad44f4</subsheetid>
    <display x="-135" y="90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4b7582c6-af7a-47b6-8d74-7069b4b4ee7a" name="Get Item Data" type="Action">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get data relating to an item in a queue. You do not need to have a lock on the item to do this.</narrative>
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to get data from. An error will be raised if this item does not exist." expr="[Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Key" friendlyname="Key" narrative="The key value of the item." stage="" />
      <output type="number" name="Priority" friendlyname="Priority" narrative="The priority of the item" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
      <output type="timespan" name="Worktime" friendlyname="Worktime" narrative="The total time spent on this item (including previous attempts)" stage="" />
      <output type="timespan" name="Attempt Worktime" friendlyname="Attempt Worktime" narrative="The amount of time spent on this particular attempt of the item" stage="" />
      <output type="datetime" name="Loaded DateTime" friendlyname="Loaded DateTime" narrative="The date and time at which this item was first loaded into the queue." stage="" />
      <output type="datetime" name="Deferred DateTime" friendlyname="Deferred DateTime" narrative="The date and time at which this item has been deferred to. Empty if this item has not been deferred." stage="" />
      <output type="datetime" name="Completed DateTime" friendlyname="Completed DateTime" narrative="The date and time at which this item was marked as complete. Empty if this item has not been marked as complete" stage="" />
      <output type="datetime" name="Exception DateTime" friendlyname="Exception DateTime" narrative="The date and time at which this item was marked as an exception. Empty if there has never been an exception on this item." stage="" />
      <output type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="The exception reason recorded against this item." stage="" />
      <output type="text" name="Tags" friendlyname="Tags" narrative="The semi-colon separated set of tags which apply to the item. " stage="Tags" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
    </outputs>
    <onsuccess>a4a186b9-56b1-4a9e-bf8c-9f1c2421bbd8</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item Data" />
  </stage>
  <stage stageid="a4a186b9-56b1-4a9e-bf8c-9f1c2421bbd8" name="New Tag Removed?" type="Decision">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <display x="15" y="30" w="120" h="30" />
    <decision expression="[Tags]=&quot;firstTag&quot;" />
    <ontrue>6d249ff8-8961-4e83-a9b9-d6633a09e17d</ontrue>
    <onfalse>3a1f0228-160d-4300-bcec-1e3248e97683</onfalse>
  </stage>
  <stage stageid="3a1f0228-160d-4300-bcec-1e3248e97683" name="FAIL" type="Exception">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <display x="105" y="30" w="30" h="30" />
    <exception localized="yes" type="" detail="&quot;The fourth tag wasnt removed when the item was unlock and removed via a sub process&quot;" />
  </stage>
  <stage stageid="50a84b33-eb8a-4336-88a6-c2eb91a624a7" name="Tags" type="Data">
    <subsheetid>82670fab-f041-48b3-8cfe-a63603098df0</subsheetid>
    <display x="-135" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
</process>