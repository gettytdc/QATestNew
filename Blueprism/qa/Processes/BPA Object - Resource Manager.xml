<process name="Resource Manager" version="1.0" bpversion="6.7.0.16957" narrative="Object to provide access to starting and stopping resources" byrefcollection="true" type="object" runmode="Exclusive" preferredid="34af1ba0-878a-4f09-9d73-e3c580f3f81b">
  <appdef>
    <element name="Resource Manager">
      <id>0ec4a18b-4405-457c-a695-050fcb906663</id>
      <element name="Hide Button">
        <id>4f0ddde7-9586-425f-9fa1-167ed2c307a4</id>
        <type>Button</type>
        <basetype>Button</basetype>
        <datatype>text</datatype>
        <diagnose>False</diagnose>
        <attributes>
          <attribute name="WindowText" inuse="True">
            <ProcessValue datatype="text" value="Hide" />
          </attribute>
          <attribute name="ClassName" inuse="True">
            <ProcessValue datatype="text" value="WindowsForms10.BUTTON" />
          </attribute>
          <attribute name="CtrlID">
            <ProcessValue datatype="number" value="0" />
          </attribute>
          <attribute name="X">
            <ProcessValue datatype="number" value="334" />
          </attribute>
          <attribute name="Y">
            <ProcessValue datatype="number" value="150" />
          </attribute>
          <attribute name="Width">
            <ProcessValue datatype="number" value="76" />
          </attribute>
          <attribute name="Height">
            <ProcessValue datatype="number" value="27" />
          </attribute>
          <attribute name="Visible">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="ScreenVisible">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="Enabled" inuse="True">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="Active">
            <ProcessValue datatype="flag" value="False" />
          </attribute>
          <attribute name="Ordinal">
            <ProcessValue datatype="number" value="2" />
          </attribute>
          <attribute name="ChildCount">
            <ProcessValue datatype="number" value="0" />
          </attribute>
          <attribute name="AncestorsText">
            <ProcessValue datatype="text" value="Blue Prism - Resource PC (Port 8181) &lt;UNKNOWN&gt; " />
          </attribute>
          <attribute name="AncestorCount">
            <ProcessValue datatype="number" value="2" />
          </attribute>
          <attribute name="TypeName">
            <ProcessValue datatype="text" value="System.Windows.Forms.Button" />
          </attribute>
          <attribute name="ScreenBounds">
            <ProcessValue datatype="text" value="RECT:1512,443,469,1587" />
          </attribute>
          <attribute name="Style">
            <ProcessValue datatype="number" value="1442918144" />
          </attribute>
          <attribute name="pWindowText">
            <ProcessValue datatype="text" value="Blue Prism - Resource PC (Port 8181)" />
          </attribute>
          <attribute name="pClassName">
            <ProcessValue datatype="text" value="WindowsForms10.Window" />
          </attribute>
          <attribute name="pCtrlID">
            <ProcessValue datatype="number" value="0" />
          </attribute>
          <attribute name="pX">
            <ProcessValue datatype="number" value="1170" />
          </attribute>
          <attribute name="pY">
            <ProcessValue datatype="number" value="262" />
          </attribute>
          <attribute name="pWidth">
            <ProcessValue datatype="number" value="515" />
          </attribute>
          <attribute name="pHeight">
            <ProcessValue datatype="number" value="220" />
          </attribute>
          <attribute name="pVisible">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="pScreenVisible">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="pEnabled">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="pActive">
            <ProcessValue datatype="flag" value="False" />
          </attribute>
          <attribute name="pOrdinal">
            <ProcessValue datatype="number" value="1" />
          </attribute>
          <attribute name="pChildCount">
            <ProcessValue datatype="number" value="6" />
          </attribute>
          <attribute name="pStyle">
            <ProcessValue datatype="number" value="1442918144" />
          </attribute>
          <attribute name="MatchIndex">
            <ProcessValue datatype="number" value="1" />
          </attribute>
          <attribute name="MatchReverse">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
        </attributes>
      </element>
      <type>Application</type>
      <basetype>Application</basetype>
      <datatype>unknown</datatype>
      <diagnose>False</diagnose>
    </element>
    <apptypeinfo>
      <id>Win32Launch</id>
      <parameters>
        <parameter>
          <name>Path</name>
          <value>C:\Program Files\Blue Prism Limited\Blue Prism Automate\Automate.exe</value>
        </parameter>
        <parameter>
          <name>CommandLineParams</name>
          <value>
          </value>
        </parameter>
        <parameter>
          <name>WorkingDirectory</name>
          <value>
          </value>
        </parameter>
        <parameter>
          <name>NonInvasive</name>
          <value>True</value>
        </parameter>
        <parameter>
          <name>ProcessMode</name>
          <value>Internal</value>
        </parameter>
        <parameter>
          <name>ExternalProcessTimeout</name>
          <value>0</value>
        </parameter>
        <parameter>
          <name>Options</name>
          <value>
          </value>
        </parameter>
      </parameters>
    </apptypeinfo>
  </appdef>
  <view>
    <camerax>0</camerax>
    <cameray>0</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="e036928b-eef3-4fd8-b81f-dffb65ae31da" type="CleanUp" published="True">
    <name>Clean Up</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b6ff1809-19b3-4573-95ed-141a2c2df740" type="Normal" published="True">
    <name>Start Resource</name>
    <view>
      <camerax>0</camerax>
      <cameray>225</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="1f8a6b75-593a-4526-9e29-3213a5244755" type="Normal" published="True">
    <name>Stop Resource</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="2bcc9581-2a31-4880-bc35-01710f62bb17" type="Normal" published="True">
    <name>Kill Resource</name>
    <view>
      <camerax>0</camerax>
      <cameray>28</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="6ef6cfc3-2cf1-4f8d-af72-52be220577ab" type="Normal" published="True">
    <name>Hide Runtime Resource</name>
    <view>
      <camerax>0</camerax>
      <cameray>147</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="6ed1fe2f-e833-43f3-8d49-a94a691bd05b" type="Normal" published="False">
    <name>Read Connection</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="8fb779ce-88cb-418f-be62-d3ef6e8e4858" name="Start" type="Start">
    <loginhibit />
    <display x="15" y="-105" />
    <onsuccess>5200c884-c643-4ba1-b284-b4c988419deb</onsuccess>
  </stage>
  <stage stageid="5200c884-c643-4ba1-b284-b4c988419deb" name="End" type="End">
    <loginhibit />
    <display x="15" y="90" />
  </stage>
  <stage stageid="afc23022-07c4-4afb-9e51-5e7b699e20c8" name="Stage1" type="ProcessInfo">
    <display x="-195" y="-105" w="150" h="90" />
    <references>
      <reference>System.Data.dll</reference>
      <reference>System.Xml.dll</reference>
      <reference>System.Drawing.dll</reference>
      <reference>System.dll</reference>
    </references>
    <imports>
      <import>System</import>
      <import>System.Drawing</import>
      <import>System.Diagnostics</import>
      <import>System.Net</import>
    </imports>
    <language>csharp</language>
    <globalcode><![CDATA[]]></globalcode>
    <code><![CDATA[]]></code>
  </stage>
  <stage stageid="c677712c-aedd-4969-96dc-9250e10debd3" name="Clean Up" type="SubSheetInfo">
    <subsheetid>e036928b-eef3-4fd8-b81f-dffb65ae31da</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="b021b0e3-5533-4615-acda-550426a9eb4b" name="Start" type="Start">
    <subsheetid>e036928b-eef3-4fd8-b81f-dffb65ae31da</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <onsuccess>b65096cd-6c58-4765-b950-c32a770561b1</onsuccess>
  </stage>
  <stage stageid="b65096cd-6c58-4765-b950-c32a770561b1" name="End" type="End">
    <subsheetid>e036928b-eef3-4fd8-b81f-dffb65ae31da</subsheetid>
    <loginhibit />
    <display x="15" y="90" />
  </stage>
  <stage stageid="7053feb1-114b-40b3-b2b8-e96cc9ccea5b" name="Start Resource" type="SubSheetInfo">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <narrative>Starts a locally running resource on this PC</narrative>
    <display x="-195" y="-120" w="150" h="90" />
  </stage>
  <stage stageid="af457401-2b25-4c74-bcaf-23d001917e03" name="Start" type="Start">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="-150" />
    <inputs>
      <input type="flag" name="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" stage="SSO" />
      <input type="text" name="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" stage="Username" />
      <input type="password" name="Password" narrative="The password to use for the resource. Only used if Username is given" stage="Password" />
      <input type="number" name="Port" narrative="The port number on which the resource PC should listen" stage="Port" />
    </inputs>
    <onsuccess>b792ff6a-eed3-4870-9166-4df336cbcb2a</onsuccess>
  </stage>
  <stage stageid="1b126794-f520-48d5-b7b6-b200c50ad4ee" name="End" type="End">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="270" />
    <outputs>
      <output type="number" name="Process ID" narrative="The PID of the newly created process" stage="Process ID" />
    </outputs>
  </stage>
  <stage stageid="e8ca3b8d-2c2e-402a-a6e3-c4d554c2bafe" name="Note1" type="Note">
    <subsheetid>e036928b-eef3-4fd8-b81f-dffb65ae31da</subsheetid>
    <narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative>
    <display x="-180" y="60" w="180" h="230" />
  </stage>
  <stage stageid="78803698-e706-4c3d-8281-418d362df851" name="Note2" type="Note">
    <narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative>
    <display x="-180" y="60" w="180" h="230" />
  </stage>
  <stage stageid="1b44867c-8cfe-4f50-a098-5aeed07bdf90" name="Username" type="Data">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <display x="-195" y="-30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1cceebc1-a478-4113-8bdc-f04ccaedf766" name="Password" type="Data">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <display x="-195" y="0" w="120" h="30" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e813c55f-d325-4060-bc98-b4c1020d0308" name="SSO" type="Data">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <display x="-195" y="30" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cd8ebf4f-9a6b-445b-bde8-4a4ef43a241f" name="Port" type="Data">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <display x="-195" y="60" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="33e5acbd-1046-4245-baeb-0a5641419652" name="Automate EXE" type="Data">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="-195" y="210" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5e05484a-7e30-4d13-a032-0e70cdd93f0f" name="Inputs" type="Block">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="-270" y="-60" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
  </stage>
  <stage stageid="b59d9ac3-60ab-4469-a09f-fe7fceae445d" name="Env Vars" type="Block">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="-270" y="180" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC00" />
  </stage>
  <stage stageid="fbca92d9-29d5-43b9-9272-3c1e051abb43" name="Locals" type="Block">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="-270" y="255" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="808080" />
  </stage>
  <stage stageid="91a3e304-3714-4fb3-8c62-fa7a264705ce" name="Command Line" type="Data">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <display x="-195" y="285" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0bea470e-42d7-4769-bacf-9304bc048eb0" name="&amp; /sso" type="Calculation">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="75" y="0" />
    <onsuccess>916d6b71-84c2-4394-a23a-dcd18f3580bd</onsuccess>
    <calculation expression="[Command Line] &amp; &quot; /sso&quot;" stage="Command Line" />
  </stage>
  <stage stageid="4c765e07-b3e1-450b-b633-d144460697eb" name="&amp; /user" type="Calculation">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="135" y="0" />
    <onsuccess>46510d3d-6b74-4784-b69d-e63409769717</onsuccess>
    <calculation expression="[Command Line] &amp; &quot; /user &quot; &amp; [Username] &amp; &quot; &quot; &amp; [Password]" stage="Command Line" />
  </stage>
  <stage stageid="916d6b71-84c2-4394-a23a-dcd18f3580bd" name="Anchor1" type="Anchor">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="75" y="30" w="10" h="10" />
    <onsuccess>a749fe06-d375-447a-97f9-ee137e95a0ba</onsuccess>
  </stage>
  <stage stageid="46510d3d-6b74-4784-b69d-e63409769717" name="Anchor2" type="Anchor">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="135" y="30" w="10" h="10" />
    <onsuccess>916d6b71-84c2-4394-a23a-dcd18f3580bd</onsuccess>
  </stage>
  <stage stageid="697b8509-5519-480d-ae91-986b5a3b56ee" name="&amp; /public" type="Calculation">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="195" y="0" />
    <onsuccess>5ed647d8-d945-47b3-8347-d503c4468a94</onsuccess>
    <calculation expression="[Command Line] &amp; &quot; /public&quot;" stage="Command Line" />
  </stage>
  <stage stageid="5ed647d8-d945-47b3-8347-d503c4468a94" name="Anchor2" type="Anchor">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="195" y="30" w="10" h="10" />
    <onsuccess>46510d3d-6b74-4784-b69d-e63409769717</onsuccess>
  </stage>
  <stage stageid="df56083a-48f0-4c64-925d-fc4353ea85a7" name="Auth Type" type="ChoiceStart">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="-45" />
    <groupid>8ef9d34e-9495-4b1f-be81-24e9dbc21213</groupid>
    <choices>
      <choice expression="[SSO]">
        <name>SSO?</name>
        <distance>60</distance>
        <ontrue>0bea470e-42d7-4769-bacf-9304bc048eb0</ontrue>
      </choice>
      <choice expression="[Username] &lt;&gt; &quot;&quot;">
        <name>Username?</name>
        <distance>120</distance>
        <ontrue>4c765e07-b3e1-450b-b633-d144460697eb</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="c2050d03-185a-4584-a5d1-838036f4d974" name="Public" type="ChoiceEnd">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="195" y="-45" />
    <onsuccess>697b8509-5519-480d-ae91-986b5a3b56ee</onsuccess>
    <groupid>8ef9d34e-9495-4b1f-be81-24e9dbc21213</groupid>
  </stage>
  <stage stageid="b792ff6a-eed3-4870-9166-4df336cbcb2a" name="&amp; /resourcepc" type="Calculation">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="-90" />
    <onsuccess>df56083a-48f0-4c64-925d-fc4353ea85a7</onsuccess>
    <calculation expression="[Command Line] &amp; &quot; /resourcepc&quot;" stage="Command Line" />
  </stage>
  <stage stageid="a749fe06-d375-447a-97f9-ee137e95a0ba" name="Port?" type="Decision">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="30" />
    <decision expression="[Port] &lt;&gt; 0" />
    <ontrue>0b2f24ff-c3b0-43e2-917f-775e13bb5fe3</ontrue>
    <onfalse>337ef20e-476e-4a2b-8331-1d30626a7178</onfalse>
  </stage>
  <stage stageid="0b2f24ff-c3b0-43e2-917f-775e13bb5fe3" name="&amp; /port" type="Calculation">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="75" />
    <onsuccess>7832b63b-f9fb-4067-867a-053247b7d867</onsuccess>
    <calculation expression="[Command Line] &amp; &quot; /port &quot; &amp; [Port]" stage="Command Line" />
  </stage>
  <stage stageid="cc39e1a3-4c76-4d55-ad83-4922a8e8fd94" name="Anchor4" type="Anchor">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="-60" y="135" w="10" h="10" />
    <onsuccess>7832b63b-f9fb-4067-867a-053247b7d867</onsuccess>
  </stage>
  <stage stageid="7832b63b-f9fb-4067-867a-053247b7d867" name="Start Resource" type="Code">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="135" w="90" h="30" />
    <inputs>
      <input type="text" name="exe" expr="[Automate EXE]" />
      <input type="text" name="args" expr="[Command Line]" />
    </inputs>
    <outputs>
      <output type="number" name="pid" stage="ProcessId" />
    </outputs>
    <onsuccess>f488302d-48d1-4bcf-b0ef-527ebebdd9d7</onsuccess>
    <code><![CDATA[Process p = Process.Start(new ProcessStartInfo() {
	FileName = exe,
	Arguments = args,
	UseShellExecute = false
});
pid = p.Id;
]]></code>
  </stage>
  <stage stageid="04dde012-d2b9-423e-8e80-d9bacf734d24" name="ProcessId" type="Data">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <display x="-195" y="315" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f488302d-48d1-4bcf-b0ef-527ebebdd9d7" name="Processes::Add Row" type="Action">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="180" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Processes&quot;" />
    </inputs>
    <onsuccess>5bd09000-df0f-49b3-af9e-eeeeef94e722</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="5bd09000-df0f-49b3-af9e-eeeeef94e722" name="Set Process ID" type="MultipleCalculation">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="15" y="225" w="90" h="30" />
    <onsuccess>1b126794-f520-48d5-b7b6-b200c50ad4ee</onsuccess>
    <steps>
      <calculation expression="[ProcessId]" stage="Processes.Process ID" />
      <calculation expression="[Port]" stage="Processes.Port" />
      <calculation expression="[ProcessId]" stage="Process ID" />
    </steps>
  </stage>
  <stage stageid="337ef20e-476e-4a2b-8331-1d30626a7178" name="Port:=8181" type="Calculation">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <narrative>To go into the collection, set the default port even if we don't explicitly add it to our command line args</narrative>
    <display x="-60" y="30" />
    <onsuccess>cc39e1a3-4c76-4d55-ad83-4922a8e8fd94</onsuccess>
    <calculation expression="8181" stage="Port" />
  </stage>
  <stage stageid="c36cec70-290f-4f4b-aaa2-464b35b4b4a0" name="Process ID" type="Data">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <display x="-195" y="135" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c5bbb804-6a49-43c5-969d-25177917e551" name="Outputs" type="Block">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="-270" y="105" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
  </stage>
  <stage stageid="96082d51-eb32-44d5-bca1-5a8ca1466c87" name="Stop Resource" type="SubSheetInfo">
    <subsheetid>1f8a6b75-593a-4526-9e29-3213a5244755</subsheetid>
    <narrative>Stops a locally running resource using the HTTP interface.
Note that currently there is no response checking from the resource in question</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="ddf37c4c-123d-4367-8b3e-f1e4187241c0" name="Start" type="Start">
    <subsheetid>1f8a6b75-593a-4526-9e29-3213a5244755</subsheetid>
    <loginhibit />
    <display x="0" y="-135" />
    <inputs>
      <input type="number" name="Port" narrative="The port number whose resource should be stopped" stage="Port" />
    </inputs>
    <onsuccess>c5732c58-8ace-414f-80e7-1b82ba0fb7a1</onsuccess>
  </stage>
  <stage stageid="99f2084b-29d3-4443-b09e-2279ffd00688" name="End" type="End">
    <subsheetid>1f8a6b75-593a-4526-9e29-3213a5244755</subsheetid>
    <loginhibit />
    <display x="0" y="-45" />
  </stage>
  <stage stageid="6a443f0c-bf94-46fd-bfd2-835e714800d0" name="Processes" type="Collection">
    <loginhibit />
    <display x="180" y="-105" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="Port" type="number" description="The port number on which the resource is listening" />
      <field name="Process ID" type="number" description="The process ID for the resource on this port" />
    </collectioninfo>
  </stage>
  <stage stageid="a1d4b05c-0535-4662-a27f-e2956a766a02" name="Globals" type="Block">
    <loginhibit />
    <display x="105" y="-135" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="41f0ca15-f70d-4998-9429-0ac511947744" name="Port" type="Data">
    <subsheetid>1f8a6b75-593a-4526-9e29-3213a5244755</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bfe03da2-abd6-4952-9120-f655b00525c6" name="Inputs" type="Block">
    <subsheetid>1f8a6b75-593a-4526-9e29-3213a5244755</subsheetid>
    <loginhibit />
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
  </stage>
  <stage stageid="c5732c58-8ace-414f-80e7-1b82ba0fb7a1" name="Stop Resource via HTTP" type="Code">
    <subsheetid>1f8a6b75-593a-4526-9e29-3213a5244755</subsheetid>
    <loginhibit />
    <display x="0" y="-90" w="120" h="30" />
    <inputs>
      <input type="number" name="port" expr="[Port]" />
    </inputs>
    <onsuccess>99f2084b-29d3-4443-b09e-2279ffd00688</onsuccess>
    <code><![CDATA[using (var wc = new WebClient())
	wc.DownloadString("http://localhost:" + port + "/shutdown");]]></code>
  </stage>
  <stage stageid="527bdab0-f058-454e-9024-6ad7c4bcaf73" name="Kill Resource" type="SubSheetInfo">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <narrative>Kills the resource running locally on the given port.
Throws a ResourceNotFoundException if the port does not correspond to a resource started by this VBO.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="8767c6c1-47a7-4fd8-8e38-e353abf413e9" name="Start" type="Start">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="60" y="-135" />
    <inputs>
      <input type="number" name="Port" narrative="The port number of the resource PC to kill" stage="Port" />
    </inputs>
    <onsuccess>560c1427-1812-4a60-9e50-7eca53cc4dd5</onsuccess>
  </stage>
  <stage stageid="ab5dd906-559f-4705-823f-012082ff089d" name="End" type="End">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="-45" y="165" />
  </stage>
  <stage stageid="249bdbee-3889-42b5-a412-b61033a8987f" name="Port" type="Data">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2bf0df35-1553-456a-8c16-c4e028fc8eab" name="Inputs" type="Block">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
  </stage>
  <stage stageid="dcc26a19-d5a5-4932-aef4-4ceaa632eccd" name="Locals" type="Block">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="-270" y="30" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="808080" />
  </stage>
  <stage stageid="9c80735f-2be0-4951-8cb4-dd4db5a68c3f" name="ProcessId" type="Data">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <display x="-195" y="60" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="560c1427-1812-4a60-9e50-7eca53cc4dd5" name="For Each Resource Process" type="LoopStart">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="60" y="-75" w="90" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>42209164-b997-41ab-be39-3410f23faabd</onsuccess>
    <groupid>0f08ac15-15e2-47af-b3f2-58e99b79c38b</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Processes</loopdata>
  </stage>
  <stage stageid="30912239-8277-45d2-a40f-49d863efb4bc" name="For Each Resource Process" type="LoopEnd">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="60" y="15" w="90" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>3c29e719-9706-4620-a8c1-d0ed6bab47b6</onsuccess>
    <groupid>0f08ac15-15e2-47af-b3f2-58e99b79c38b</groupid>
  </stage>
  <stage stageid="80c5090d-2aa8-435e-a977-f6674a496dc2" name="Find the Process ID" type="Block">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="-105" y="-105" w="225" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="42209164-b997-41ab-be39-3410f23faabd" name="Is This The Port We're Looking For?" type="Decision">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="60" y="-30" w="90" h="30" />
    <decision expression="[Processes.Port] = [Port]" />
    <ontrue>4b219429-4ef9-4ef1-8e35-03a32073701a</ontrue>
    <onfalse>30912239-8277-45d2-a40f-49d863efb4bc</onfalse>
  </stage>
  <stage stageid="4b219429-4ef9-4ef1-8e35-03a32073701a" name="ProcessId := Processes.Process ID" type="Calculation">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="-45" y="-30" w="90" h="30" />
    <onsuccess>fcedf521-b669-401e-bb94-fbdc3bf06e3b</onsuccess>
    <calculation expression="[Processes.Process ID]" stage="ProcessId" />
  </stage>
  <stage stageid="3c29e719-9706-4620-a8c1-d0ed6bab47b6" name="FAIL" type="Exception">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <display x="150" y="15" w="30" h="30" />
    <exception type="ResourceNotFoundException" detail="&quot;No resource with the port number '&quot; &amp; [Port] &amp; &quot;' was recognised by this action&quot;" />
  </stage>
  <stage stageid="fcedf521-b669-401e-bb94-fbdc3bf06e3b" name="Kill The Process" type="Code">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="-45" y="75" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" expr="[ProcessId]" />
    </inputs>
    <onsuccess>1f1ae6df-cc72-4a84-9625-2a804bcc7357</onsuccess>
    <code><![CDATA[try
{
	using (var proc = Process.GetProcessById((int)pid))
		proc.Kill();
}
// Ignore ArgExceptions - it just means the process is no
// longer running... which is fine.
catch (ArgumentException) {}
]]></code>
  </stage>
  <stage stageid="1f1ae6df-cc72-4a84-9625-2a804bcc7357" name="Remove the row from our collection" type="Action">
    <subsheetid>2bcc9581-2a31-4880-bc35-01710f62bb17</subsheetid>
    <loginhibit />
    <display x="-45" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Processes&quot;" />
    </inputs>
    <onsuccess>ab5dd906-559f-4705-823f-012082ff089d</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove Row" />
  </stage>
  <stage stageid="65389e2d-9847-4e48-978e-282909146762" name="Set Command Line Args" type="Block">
    <subsheetid>b6ff1809-19b3-4573-95ed-141a2c2df740</subsheetid>
    <loginhibit />
    <display x="-105" y="-120" w="345" h="225" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b1eb2b1a-e321-4304-b90b-6f1d106e42e8" name="Hide Runtime Resource" type="SubSheetInfo">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <narrative>Hides the runtime resource.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="7f17a14a-0f92-42cb-8a5d-33eb4b9b5d41" name="Start" type="Start">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <preconditions>
      <condition narrative="None." />
    </preconditions>
    <postconditions>
      <condition narrative="None." />
    </postconditions>
    <display x="15" y="-105" w="90" h="30" />
    <inputs>
      <input type="number" name="Process ID" stage="Process ID" />
    </inputs>
    <onsuccess>76847a9d-30cf-4292-b2c1-2ad07eae0ef2</onsuccess>
  </stage>
  <stage stageid="6048e226-02fc-42dc-ac14-88eaac3f171b" name="End" type="End">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="75" y="330" w="90" h="30" />
  </stage>
  <stage stageid="b90c5ee8-ada8-40b3-a688-0dac26ee56f1" name="Attach BP" type="Navigate">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="15" y="75" w="90" h="30" />
    <onsuccess>9ec91e39-6a71-44af-be99-14379da62085</onsuccess>
    <step>
      <element id="0ec4a18b-4405-457c-a695-050fcb906663" />
      <action>
        <id>AttachApplication</id>
        <arguments>
          <argument>
            <id>WindowTitlesCollection</id>
            <value>
            </value>
          </argument>
          <argument>
            <id>WindowTitle</id>
            <value>
            </value>
          </argument>
          <argument>
            <id>ProcessName</id>
            <value>
            </value>
          </argument>
          <argument>
            <id>ProcessID</id>
            <value>[Process ID]</value>
          </argument>
          <argument>
            <id>Username</id>
            <value>
            </value>
          </argument>
          <argument>
            <id>ChildIndex</id>
            <value>
            </value>
          </argument>
        </arguments>
      </action>
    </step>
  </stage>
  <stage stageid="78fe76cc-2a58-4d33-b78b-c061d88b521d" name="Press Hide" type="Navigate">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="75" y="210" w="90" h="30" />
    <onsuccess>54d60928-d460-4b94-bada-4a76eec34529</onsuccess>
    <step>
      <element id="4f0ddde7-9586-425f-9fa1-167ed2c307a4" />
      <action>
        <id>Press</id>
      </action>
    </step>
  </stage>
  <stage stageid="8f812ae7-aace-406c-b324-c43fb577b448" name="Read Connection" type="SubSheetInfo">
    <subsheetid>6ed1fe2f-e833-43f3-8d49-a94a691bd05b</subsheetid>
    <narrative>Reads whether the object is already attached.</narrative>
    <display x="-150" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="8dec8b84-704f-4874-95a9-9d8cc010d9fe" name="Start" type="Start">
    <subsheetid>6ed1fe2f-e833-43f3-8d49-a94a691bd05b</subsheetid>
    <loginhibit />
    <preconditions>
      <condition narrative="None." />
    </preconditions>
    <postconditions>
      <condition narrative="None." />
    </postconditions>
    <display x="30" y="-135" w="90" h="30" />
    <onsuccess>745f3b07-94f0-4901-959a-10cb95c4f1aa</onsuccess>
  </stage>
  <stage stageid="b37056bd-6a9b-40f2-85bb-b4052da59913" name="End" type="End">
    <subsheetid>6ed1fe2f-e833-43f3-8d49-a94a691bd05b</subsheetid>
    <loginhibit />
    <display x="30" y="-15" w="90" h="30" />
    <outputs>
      <output type="flag" name="Connected" narrative="Connected" stage="Connected" />
    </outputs>
  </stage>
  <stage stageid="745f3b07-94f0-4901-959a-10cb95c4f1aa" name="Read Connection" type="Read">
    <subsheetid>6ed1fe2f-e833-43f3-8d49-a94a691bd05b</subsheetid>
    <loginhibit />
    <display x="30" y="-75" w="90" h="30" />
    <onsuccess>b37056bd-6a9b-40f2-85bb-b4052da59913</onsuccess>
    <step stage="Connected">
      <element id="0ec4a18b-4405-457c-a695-050fcb906663" />
      <action>
        <id>IsConnected</id>
      </action>
    </step>
  </stage>
  <stage stageid="89bc5cf2-71e4-4961-84f5-8d624eb5fbc3" name="Connected" type="Data">
    <subsheetid>6ed1fe2f-e833-43f3-8d49-a94a691bd05b</subsheetid>
    <display x="-150" y="-15" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9d2cc39d-41be-4f73-b03c-f2e462f7dfc0" name="Output Variables" type="Block">
    <subsheetid>6ed1fe2f-e833-43f3-8d49-a94a691bd05b</subsheetid>
    <loginhibit />
    <display x="-225" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="76847a9d-30cf-4292-b2c1-2ad07eae0ef2" name="Read Connection" type="SubSheet">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="15" y="-45" w="90" h="30" />
    <outputs>
      <output type="flag" name="Connected" narrative="Connected" stage="Connected" />
    </outputs>
    <onsuccess>c3c90295-b850-48ec-9688-a32f040b4c7f</onsuccess>
    <processid>6ed1fe2f-e833-43f3-8d49-a94a691bd05b</processid>
  </stage>
  <stage stageid="f2f8b635-0d2f-4f66-a9b1-c78d5d6227a6" name="Connected" type="Data">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c3c90295-b850-48ec-9688-a32f040b4c7f" name="Connected?" type="Decision">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="15" y="15" w="90" h="30" />
    <decision expression="[Connected]" />
    <ontrue>7a53b986-e0ce-4554-b41c-8f13b5466fa6</ontrue>
    <onfalse>b90c5ee8-ada8-40b3-a688-0dac26ee56f1</onfalse>
  </stage>
  <stage stageid="dc98c0ff-15ac-4bf0-9b81-0531b582a254" name="Time Out" type="WaitEnd">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="135" y="150" w="60" h="60" />
    <onsuccess>233e644b-879a-49fe-88da-884931dc84e6</onsuccess>
    <groupid>049466cb-7ff4-4087-b962-473d0c781c86</groupid>
  </stage>
  <stage stageid="9ec91e39-6a71-44af-be99-14379da62085" name="Wait Button" type="WaitStart">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="15" y="150" w="60" h="60" />
    <groupid>049466cb-7ff4-4087-b962-473d0c781c86</groupid>
    <choices>
      <choice reply="True">
        <name>Hide Button Check Exists</name>
        <distance>60</distance>
        <ontrue>78fe76cc-2a58-4d33-b78b-c061d88b521d</ontrue>
        <element id="4f0ddde7-9586-425f-9fa1-167ed2c307a4" />
        <condition>
          <id>CheckExists</id>
        </condition>
        <comparetype>Equal</comparetype>
      </choice>
    </choices>
    <timeout>60</timeout>
  </stage>
  <stage stageid="00ec12c9-d715-460f-939f-ee49dd700ed7" name="Local Variables" type="Block">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="7a53b986-e0ce-4554-b41c-8f13b5466fa6" name="Anchor3" type="Anchor">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="-60" y="15" w="10" h="10" />
    <onsuccess>4ee0c182-ae2d-42a4-8bab-c4cb0aa6c630</onsuccess>
  </stage>
  <stage stageid="4ee0c182-ae2d-42a4-8bab-c4cb0aa6c630" name="Anchor5" type="Anchor">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="-60" y="150" w="10" h="10" />
    <onsuccess>9ec91e39-6a71-44af-be99-14379da62085</onsuccess>
  </stage>
  <stage stageid="233e644b-879a-49fe-88da-884931dc84e6" name="End1" type="End">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="240" y="150" w="90" h="30" />
  </stage>
  <stage stageid="aa7964d2-6aa0-4c06-8c91-db073b230920" name="Process ID" type="Data">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <display x="-195" y="60" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2ba8e1cc-e603-4966-adf6-1d647cff40ec" name="Input Variables" type="Block">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="-270" y="30" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="54d60928-d460-4b94-bada-4a76eec34529" name="Detach BP" type="Navigate">
    <subsheetid>6ef6cfc3-2cf1-4f8d-af72-52be220577ab</subsheetid>
    <loginhibit />
    <display x="75" y="270" w="90" h="30" />
    <onsuccess>6048e226-02fc-42dc-ac14-88eaac3f171b</onsuccess>
    <step>
      <element id="0ec4a18b-4405-457c-a695-050fcb906663" />
      <action>
        <id>DetachApplication</id>
      </action>
    </step>
  </stage>
</process>