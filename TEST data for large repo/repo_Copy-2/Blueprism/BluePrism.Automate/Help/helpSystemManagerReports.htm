<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" href="AutomateHelp.css" rel="stylesheet" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <title>System Manager - Reporting</title>
</head>

<body>
    <div class="header">
        <h1 class="pagetitle">Reporting</h1>
    </div>

    <h3>MI Reporting</h3>
    <p>Dashboard information is based upon information stored within the Blue Prism
    database. The source data for each dashboard Tile is an individual SQL Server
    Stored Procedure (a saved query) which retrieves data from special management
    information tables in the database schema. For more information about data sources
    for Tiles, see <a href="dataSources.htm">Data Sources.</a></p>
    
    <p>The source tables for the data that is collectively called Management Information
    (MI) are populated from data is captured when utilisation and productivity statistics
    are enabled in the Reporting screen.</p>
    
    <p>There are three types of tables in the database which store MI data:</p>
    <ul>
      <li><b>Daily Raw Data</b> – contain usage statistics for the current day</li>
      <li><b>Daily Consolidated Data</b> – contain consolidated statistics for the defined daily retention period</li>
      <li><b>Monthly Consolidated Data</b> – contain consolidated statistics for the defined monthly retention period</li>
    </ul>

    <p>The Daily Raw Data tables are populated by enabling the collection of usage and
    productivity statistics. To enable the recording of statistics:</p>
    <ul>
      <li>Click on <b>System -> Reporting</b>. This reveals the <b>MI Reporting</b> settings.</li>
      <li>To enable statistics collection select the checkbox <b>Collect utilisation and productivity statistics.</b></li>
    </ul>
    
    <h4 id="MIRefresh">MI data refresh settings</h4>
    <p>When the collection of statistics is enabled then there are two options to control
    the task of refreshing the statistics data. The refresh task moves data from the Daily
    Raw Data tables, aggregated, and then transfers it into the Daily and Monthly Consolidated
    Data tables.</p>
    <ul>
      <li>Automatically refresh statistics daily at specified time</li>
      <ul>
        <li>Uses the Blue Prism Server service to run the refresh task</li>
        <li>Moves data from the raw tables into the consolidated tables</li>
        <li>Deletes any data that has exceeded the retention settings</li>
      </ul>
      <li>Use external tools to refresh statistics</li>
      <p>Where the MI statistics are not being refreshed automatically by Blue Prism, then
      the stored procedure ‘usp_RefreshMI’ can be configured to be executed each night. Options
      for achieving this include:</p>
      <ul>
        <li>Setting up a scheduled task using the <b>SQL Server Agent</b></li>
        <li>Using a Windows scheduled task to execute the stored procedure via the <b>SQLCMD</b> utility</li>
        <li>Designing and scheduling a Blue Prism process which uses the “Data - SQL Server” Visual Business Object</li>
      </ul>
    </ul>

    <h4>Retention period settings</h4>
    <p>Daily and monthly data sets can be retained for a defined period. The exact numbers
    of days and months can be set using the spin controls in the MI Reporting settings page.
    Any changes to these settings need to be applied using the <b>Apply</b> button.</p>

    <p>The number of days and months determines the amount of data that is kept within the
    Daily and Monthly Consolidated Data tables. Data which exceeds the defined retention period
    setting will be automatically deleted from the consolidated tables when the data is refreshed
    (see <a href="#MIRefresh">MI data refresh settings</a>). The data from the Daily Raw Data
    tables is transferred to the Daily Consolidated Data tables when the daily refresh job is
    triggered, and the Raw tables are then emptied.</p>
    
    <h3>System Reports</h3>
    <p>System reports allow a system Administrator to gather useful information
    that can be used for analysing and debugging an installation.</p>

   <p>To run a report simply select the required report from the list and click
   the 'Generate' button. You will be presented with a 'Save As' dialog where
   you should choose a file name and click save.</p>
</body>
</html>
