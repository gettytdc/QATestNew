<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link type="text/css" href="AutomateHelp.css" rel="stylesheet"/>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>トラブルシューティング - メインフレーム統合</title>
	<script type="text/javascript" src="script/imagezoom.js"></script>
</head>

<body class="slick troubleshooting">
	<div class="header">
		<h1 class="pagetitle">トラブルシューティング</h1>
		<h2>メインフレーム統合</h2>
	</div>
	
	<h3>はじめに</h3>
	<p>このページには、Blue Prism内でメインフレームの自動化を使用する際のよくある問題と推奨される解決方法がいくつかあります。</p>

	<h5>メインフレームアプリを起動すると、次のようなエラーメッセージが表示されます。「DLL 'HLLAPI32.DLL' をロードできません：指定されたモジュールが見つかりませんでした」</h5>
	
	<p>これは、メインフレームインストールがそのインストールディレクトリをWindows <code>PATH</code>環境変数に追加していないことによります。
	</p>
	
	<p>この問題を解決するには、Windowsの［コントロールパネル］で［<code>システムプロパティ</code>］を開き、「<code>詳細設定</code>」に移動し、［<code>環境変数</code>］ボタンをクリックして参照ファイルを含むディレクトリへのパスを、セミコロンで始まるPATH変数に追加します。</p>
	
	
	<h5>メインフレームアプリが、プロセスが完了またはリセットすると終了してしまう</h5>

	<p>Blue Prismビジュアルビジネスオブジェクトがメインフレームにアクセスすると、ターミナルエミュレーターを介してそのメインフレームに接続し、そのエミュレーターを介した通信を処理します。</p>
	
	<p>VBOを使用するプロセスが完了またはリセットされると、VBOはターミナルエミュレーター内で開かれた接続を閉じます。</p>
	
	<p>一部のエミュレーターはメインフレーム接続と対応するウィンドウを開いたままにしますが、一部（特に一部のEHLLAPIエミュレーター）は自動的に終了し、切断プロセスの一部としてメインフレームへの接続を切断します。プロセスが正常にログアウトしていない場合、これによりユーザーがメインフレームセッションにログインしたままになる可能性があります。</p>
	
	<p>これを回避するには、エミュレーターを別々に起動し、VBO内の適切なアクションを使用してそれに接続することです。これでVBOがリセットされたときにメインフレームセッションが終了しないようになります。</p>
	
	<p>もう1つの方法は、アプリケーションパラメーターで追加の<a href="helpApplicationParameters.htm#Options">nodisconnectオプション</a>を設定することです。</p>

	<p>その代わりに、セッションがVBOの<a href="helpInitAndCleanup.htm#cleanup">クリーンアップ</a>ページで確実にログアウトされるように注意する必要があります。</p>

	<h5>カーソル位置の設定が機能していない</h5>

	<p>Terminal Emulator APIがカーソル位置の設定をサポートしている場合でも、基盤となるメインフレームアプリケーションはサポートしていない可能性があります。この場合、カーソルの動きにまったく気付かないか、カーソルが動く可能性がありますが、その後のテキスト入力はカーソルを前の位置に戻します。この動作はアプリケーションそのもので定義されているため、変更できません。</p>

	<h5>既存のセッションに接続する</h5>

	<p>（E）HLLAPIベースのターミナルエミュレーターのみが既存のセッションへの接続を許可します。Blue Prismとメインフレームアプリケーションの両方でセッション識別子が設定されると（短縮名で呼ばれることもあります）、ナビゲートステージ内のアタッチアクションを使用して既存のセッションにアタッチできます。</p>

	<h5>同じリソースで2つのセッションを同時に実行した場合に予期しない結果が生じます。</h5>

	<p>同じWindowsプロセス内から複数のセッションを擬似的に実行する際に、（E）HLLAPIベースのターミナルエミュレーターは使用できません。これはAPIにおける設計上の制限です。</p>

	<p>この制限を回避するには2通りの方法があります。2つ（またはそれ以上）の別々のResource PCインスタンスを使用でき、このインスタンスに対してプロセスを実行できます。V4.2以降、より簡単な解決方法は、（アプリケーションモデラーで設定された）外部のプロセスモードオプションのいずれかを使用して、アプリケーションマネージャーを問題のビジネスオブジェクトに対し個別のWindowsプロセスとして実行することです。</p>

    <h5>Attachmate Reflection（.NET API）</h5>

    <p>Reflection .NET APIを使用するには、Reflectionインストーラーから<b>Application Programmer Interface</b>コンポーネントを選択する必要があります。詳細については、ターミナルエミュレーション設定のサポートガイドを参照してください。</p>

    <h5>IBMパーソナルコミュニケーター - 国際的な考慮事項</h5>

    <p>2バイトの文字セット（DBCS）でIBMパーソナルコミュニケーターを使用している場合。Shitf-In/Shift-Outの文字を表示するオプションは、.wsセッションファイルで設定できます。
        <ul>
            <li>.wsファイルでSoSiToSpace=Yの場合、SO/SIはスペース（0x20）に変換されます。</li>
            <li>SoSiToSpace=Nの場合wsファイルの場合、SO/SIは同等のSO/SI（0x0e/0x0f）に変換されます。</li>
            <li>SoSiToSpace変数が設定されていない場合は、SoSiToSpace=Nとして扱われます。</li>
        </ul>
 SoSiToSpace値は、iniファイルの[DBCS]セクションの下に配置する必要があります。Windowsのメモ帳以外のテキストエディターを使用してファイルを編集することをお勧めします。メモ帳にASCII以外のデータが含まれていると、ファイルが破損する可能性があるためです。</p>
    <p>例：</p>
    <ul>
        <li>[DBCS]</li>
        <li>SoSiToSpace=Y</li>
    </ul>
    <div class="captioned-image section-screenshot">
    <a title=".wsセッションファイルを設定する - クリックして拡大表示" href="Graphics/example-ws-sessionfile.png">
    <img src="Graphics/example-ws-sessionfile.png" alt=".wsセッションファイルを設定する - クリックして拡大表示"/></a>
    </div>
    

