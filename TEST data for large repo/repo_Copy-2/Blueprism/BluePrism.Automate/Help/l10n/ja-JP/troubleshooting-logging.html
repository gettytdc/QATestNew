<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link type="text/css" href="AutomateHelp.css" rel="stylesheet"/>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>トラブルシューティング - ロギング</title>
	<script type="text/javascript" src="script/imagezoom.js"></script>
</head>

<body class="slick troubleshooting">
	<div class="header">
		<h1 class="pagetitle">トラブルシューティング</h1>
		<h2>ログ</h2>
    </div>
    <h3>はじめに</h3>
    <p>
 診断ロギングの目的は、アプリケーションの実行時に利用可能な情報を増やすことです。ログに記録されたエラーと警告は、エンドユーザーにすぐには明らかにならない可能性があるシステム内の障害を特定するのに役立ちます。より詳細なロギングを一時的に有効すると、問題のトラブルシューティング時にアプリケーションがどのように動作しているかを分かりやすく図で示すことができます。
    </p>
    <p>
 Blue PrismはNLogと呼ばれる、実績があり信頼できるライブラリを利用して、ログ情報を出力し記録します。ユーザーは、グローバルまたはアプリケーションの特定の領域に記録される情報量を微調整できます。Windowsイベントログやテキストファイルなどのさまざまなログ出力先から選択することもできます。
    </p>
    <h3>構成</h3>
    <p>
 Blue Prismはほぼすべての環境に適する標準的なログ構成を提供しています。インストール中、構成ファイルは、システムのCommonApplicationDataの特別フォルダー（C:\ProgramData\Blue Prism Limited\Blue Prism）内のBlue Prismの特定のフォルダーにインストールされます。次のようにアプリケーションごとに別々の構成ファイルがあります。
    </p>
    <ul>
        <li>サーバーにはServer.NLog.config</li>
        <li>インタラクティブクライアントまたはリソースPCにはAutomate.NLog.config</li>
    </ul>
    <p>
 デフォルトの構成では、「情報」レベル以上（警告、エラー、致命的なエラーを含む）のログ入力がWindowsイベントログに送信されます。テキストファイルのロギングも構成されますが、デフォルトでは致命的なエラー（アプリケーションのクラッシュの原因となった未処理の例外など）にのみ使用されます。これにより、Windowsイベントログへのエラーの記録に失敗した場合でも、クラッシュに関する情報が利用できるようになります。
    </p>
    <p>
 Blue Prismを普通に使っている間は、自分でログ構成ファイルに変更を加える必要はありません。製品の問題を調査する場合、カスタマーサービスは通常、代わりとなるログ構成ファイルを提供します。
    </p>
    <p>
 ロギング構成に変更を加えるとアプリケーションの性能に影響を及ぼす可能性があるため、本番環境内を修正する場合は特に注意する必要があります。
    </p>
    <p>技術に関する情報をさらにご希望の場合は、次のリンクから役立つ詳細情報にアクセスしてください。</p>
    <ul>
        <li><a href="https://github.com/NLog/NLog/wiki/Tutorial">NLog Githubレポジトリ - 基本のチュートリアル</a></li>
        <li><a href="https://nlog-project.org/config/">NLogオフィシャルWebサイト - 構成オプション</a></li>
    </ul>
    <h3>標準構成</h3>
    <p>
 ここでは、標準構成に関する詳細をいくつか説明します。
    </p>
    <h4>Windowsイベントログ</h4>
    <p>「情報」レベル以上のログ入力は、Windowsイベントログに送信されます。</p>
    <p>イベントログ設定は `&#60code&#62&#60target name="app-eventlog" ...&#60&#47code&#62` の要素内で定義されます。これは構成終了時に次の要素で有効になります。</p>
    <ul>
        <li>&#60code&#62&#60logger name="*" minlevel="Info" writeTo="app-eventlog" &#47&#62&#60&#47code&#62</li>
    </ul>
    <p>
 メインのイベントログは「Blue Prism」（Blue Prismの以前のバージョンと同じ）で呼ばれます。イベントログのソースは、情報がリソースPC、サーバーまたはインタラクティブクライアントによりログに記録されるかどうかによって異なります（これも以前のバージョンと同様）。
    </p>
    <h4>ログファイル</h4>
    <p>
 ログファイルは、「CommonApplicationData」特殊フォルダー内のBlue Prism固有のディレクトリ（通常はC:¥ProgramData¥Blue Prism Limited¥Blue Prism¥Logs）に書き込まれるように構成されています。個別のログファイルは、実行中のアプリケーション（インタラクティブクライアント、サーバー、またはリソースPC）に基づいて生成され、各リソースPCに一意のファイル名が生成されます。
    </p>
    <p>
 テキストファイルのロギングは、デフォルトで致命的なエラー（アプリケーションのクラッシュの原因となる未処理の例外など）に限定されています。これにより、Windowsイベントログへのエラーの記録に失敗した場合でも、クラッシュに関する情報が利用できるようになります。より詳細なデバッグ情報が必要な場合にのみ詳細なテキストファイルロギングが有効になること、カスタマーサービスが必要な構成変更について顧客にアドバイスすることが期待されています。
    </p>
    <p>
 テキストファイルのロギングのパラメーターは、&#60code&#62&#60target name="app-logfile" ...&#60&#47code&#62エレメント内に定義され、構成終了時の次の要素により制御されます。
    </p>
    <ul>
        <li>&#60code&#62&#60logger name="*" minlevel="Fatal" writeTo="app-logfile" &#47&#62&#60&#47code&#62</li>
    </ul>
    <p>標準構成には、賢明なログアーカイブと回転機構が含まれています。ファイルが10MBに達し、アーカイブするファイルを最大10個保持する場合にファイルがアーカイブされます。</p>
    <p>以下はログファイルのラインの例です。</p>
    <ul>
        <li>2019-01-14 13:07:59.2395 DEBUG BluePrism.AutomateAppCore.clsResourceConnection BP0188:8182 - アップデートの開始。現在の状態：オフライン</li>
    </ul>
    <p>標準構成で定義されているこのテキストの形式には、以下の要素が含まれています。</p>
    <ul>
        <li>日時（UTC）</li>
        <li>ログレベル（DEBUG、INFO、WARN、ERROR、FATAL）</li>
        <li>ロガー名 - ログ入力が作成されるアプリケーションの部分を識別します。</li>
        <li>ログメッセージ</li>
        <li>エラーの詳細（入力にエラー情報が含まれている場合のみ提供されます）。これはメインのログ入力の下の新しい行に記録されます。</li>
    </ul>
    <p>アプリケーション全体のデバッグレベルのテキストファイルのロギングは、次のように構成を編集すると有効にできます。</p>
    <ul>
        <li>&#60code&#62&#60logger name="*" minlevel="Debug" writeTo="app-logfile" &#47&#62&#60&#47code&#62</li>
    </ul>
    <p>これで、アプリケーションの特定の領域へのデバッグレベルのロギングを制限することもできます。</p>
    <ul>
        <li>&#60logger name="*" minlevel="Fatal" writeTo="app-logfile" &#47&#62</li>
        <li>&#60logger name="BluePrism.AutomateAppCore" minlevel="Debug" writeTo="app-logfile" &#47&#62</li>
    </ul>
</body>