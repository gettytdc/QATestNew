<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" href="AutomateHelp.css" rel="stylesheet" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <title>Login Agent</title>
    <script type="text/javascript" src="script/imagezoom.js"></script>
    <style type="text/css">
        h3, h4 {
            clear: left !important;
        }

        span.filter {
            color: #666;
            font-weight: bold;
        }

        div.section-screenshot, div.screenshot {
            width: 100px;
        }

        ul.nobullets li, dl.nobullets dt {
            list-style-type: none;
        }
    </style>
</head>

<body class="slick">
    <div class="header">
        <h1 class="pagetitle">Login Agent</h1>
    </div>
    <div class="captioned-image overview-screenshot nozoom">
        <a href="Graphics/control-room-with-login-agent-resources.png"
           title="Control Room showing Login Agent Runtime Resource">
            <img src="Graphics/control-room-with-login-agent-resources.png"
                 alt="Control Room showing Login Agent Runtime Resource" />
        </a>
    </div>
    <p> Blue Prism Login Agent is a component that extends the capabilities of a Blue Prism Runtime 
    Resource by providing a mechanism that can execute a secure log in on a Windows 
    device.</p>
    <p>Login Agent essentially allows a Runtime Resource:
    </p>
    <ul>
        <li>to receive instructions prior to the device being logged into to Windows 
        (e.g. when the device is in a pre-logged in state)</li>
        <li>to send authorisation information to the operating system and to log 
        into the device using either local or network credentials</li>
        <li>to carry out additional actions such as password resets</li>
    </ul>
    <p>Login Agent creates and configures a Windows Service which is responsible for 
    starting a dedicated Login Agent Runtime Resource which is able to communicate 
    with the operating system to achieve a Windows log on. 
    </p>
    
    <p>The Login Agent Runtime Resource is shown using a dedicated icon within 
    Control Room.</p>
    
    <p>When appropriately configured, the Login Agent Runtime Resource is started 
    whenever the machine is in a pre-logged in state, and remains active until the 
    device has been logged on and a conventional Blue Prism Runtime Resource has 
    been started. The Login Agent Runtime Resource is automatically shut-down by 
    the start-up of a Blue Prism Runtime Resource. </p>
    <div class="Highlighted" style="background-color: lightgrey" ><p><font color="black">
    The Login Agent Runtime Resource operates with a limited-access account
    and it will not have full access to the local machine.
    Therefore it can only be used for achieving Log in actions.</font> 
</p></div>  
<h2>Installing Login Agent</h2>   
    <h3>Prerequisites</h3>
    <p>Windows Desktop OS: XP, Vista, 7, 8.1, 10 (32-bit and 64-bit) </p>
    <p>Windows Server OS: 2008, 2008 R2, 2012, 2012 R2 (32-bit and 64-bit)</p>
    <p>Administrator access is required to install Login Agent.  </p>
    <p> It is essential that the following security policies are applied to the 
    target device.</p> 
  
    <ul>
        <li>There must not be a requirement to press ctrl + alt + del prior to the username and password fields being presented</li>
        <li>There must not be a requirement to traverse an on-screen message such as a usage acceptance policy as part of the login process</li>
        <li>There must not be a requirement to traverse a lock screen (Windows 8.1 and Windows 10)</li>
    </ul>
    <p>
        The install of Login Agent will apply these to the local
        policies on the device however within corporate networks the changes may
        need applying centrally.
    </p>

    <h3>Installing Login Agent</h3>
    <div class="captioned-image overview-screenshot">
        <img src="Graphics/login-agent-installer-connection-name.png"
             alt="Selecting the Blue Prism connection name" />
    </div> <p>The installers for Login Agent can be found within the Blue Prism installation directory.
It is necessary to select the installation file that matches the CPU architecture of the target device.
</p>
    <p><code>  [Blue Prism Location]\Installers\LoginAgent_x86.msi</code> for 32-bit operating systems</p>
    <p><code>  [Blue Prism Location]\Installers\LoginAgent_x64.msi</code> for 64-bit operating systems</p>
 <p>As part of the installation procedure it is necessary to provide a Connection 
    Name which must be an exact match of the name of an existing Blue Prism 
    connection on the local device. </p>   
    <p>A list of the currently configured connections on the device can be found within the Blue Prism  client (pictured)</p>
    
<h3>Login Agent Sample Process and Business Object</h3>   
  <p>Once Login Agent has been deployed on the required devices, the Login Agent 
    Release Package (<code>Login Agent Release.bprelease</code> within the Login 
    Agent Install Directory) can be imported into the environment.  
    This is achieved using the File -> Import menu option on any single device. 
    The data is copied into the database so it only needs to be completed once 
    for each relevant Blue Prism environment.</p>   

<p>Two of the provided sample processes (Login and Change Password) require that a Credential record 
    is created for each device. These credential records need to be created using the default naming format <code>Windows Login: [MachineName].</code>
    E.g. if the Runtime Resource is configured on robot0001 on port 8190, 
    the default credential name should be <code>Windows Login: robot0001.</code></p>
    <p>This VBO provides a set of example actions that can be used to achieve common 
    authentication actions with the operating system such as Log In, Is Logged In, Log Out, Change Password.</p>
    <p>Information regarding the Login Agent VBO and its actions can be found in the API documentation under Help > API Documentation.</p>
    <div class="Highlighted" style="background-color:lightgrey">
        <p><font color="black">When overwriting existing versions of the Login Agent VBO, 
            it is necessary to re-verify any processes that use the provided functionality.</font>  </p></div>

    <h2>Advanced Topics</h2>
    <h3>Updating or customising the Login Agent configuration</h3>
    <p>The configuration of Blue Prism Login Agent service, which is responsible for initialising the Login Agent Runtime Resource, is stored within a local configuration file:</p>
    <p><code>C:\ProgramData\Blue Prism Limited\Automate V3\LoginAgentService.config</code></p>
    <p>The <code>workingdirectory</code> element points to the installation directory for the Blue Prism software. </p>
    <div class="captioned-image section-screenshot">
        <img src="Graphics/login-agent-config.png"
             alt="Configuring Login Agent" />
    </div><p>
        The <code>startuparguments</code> element gives the arguments that will be used when launching the Login Agent Runtime Resource.
        For example this section can be configured to update the port that the Runtime Resource will listen on,
        or the name of the connection that it will use to connect to the environment.
    </p>
        
    
        <h3>Resources configured with Certificate-based encryption</h3>
        <p>
            <div class="captioned-image section-screenshot  ">
                <img src="Graphics/login-agent-config-2.png"
                     alt="Configuring for Certificate-based encryption" />
            </div>

            <div class="captioned-image section-screenshot   ">
                <img src="Graphics/login-agent-config-3.png"
                     alt="Configuring for Certificate-based encryption" />
            </div>
            Where the conventional Runtime Resources are configured to force encryption of incoming
            connections using a specified certificate (e.g. where the Runtimes are started using
            the /sslcert switch), it is necessary to manually apply the appropriate configuration
            to the Login Agent Runtime Resource.
        </p>

        <p>
            The <code>startuparguments</code> element within the configuration file
            can be updated to include the appropriate information:
        </p>
       
    <h3>Silent Install</h3>
    <p>
        A silent install can be achieved through use of msiexec.
        It is important to ensure the correct installer is selected for the CPU architecture (i.e. x86 is for 32-bit operating systems; x64 is for 64-bit operating systems).
    </p>
    <p>It is necessary to provide the following parameters:    </p>
    <ul>
        <li><b>[Blue Prism Install Location]</b>, the location where Blue Prism has been installed. This is commonly where the Login Agent installation file is located</li>
        <li><b>[Connection Name]</b> which must be an exact match of the name of an existing Blue Prism connection on the local device. A list of the currently configured connections on the device can be found within the Blue Prism client.</li>
    </ul>
    <p>For example (32-bit installation):</p>
    <p><code>msiexec /i "[Blue Blue Install Location]\Installers\LoginAgent_x86.msi " /quiet BPCONN="[Connection Name]" </code></p>
    <p>For example (32-bit installation):</p>
    <p><code>msiexec /i "c:\Program Files\Blue Prism Limited\Blue Prism Automate\Installers\LoginAgent_x86.msi " /quiet BPCONN="Prod: Financial Services"</code></p>
    
    <p>For example (64-bit installation):</p>
    <p><code>msiexec /i "[Blue Blue Install Location]\Installers\LoginAgent_x86.msi " /quiet CONNECTIONNAME="[Connection Name]" </code></p>
    <p>For example (64-bit installation):</p>
    <p><code>msiexec /i "c:\Program Files\Blue Prism Limited\Blue Prism Automate\Installers\LoginAgent_x86.msi " /quiet CONNECTIONNAME="Prod: Financial Services"</code></p>

    <h3>Configuring Logging</h3>
   
    <p>Login Agent can be configured to generate diagnostic logs on a specific device by configuring the appropriate Registry key settings.</p>
    <p>For appropriate versions of Login Agent, the keys can be found within the Registry at the following location:</p>
    <p><code>HKEY_LOCAL_MACHINE\SOFTWARE\Blue Prism Limited\LoginAgent</code></p>
    <ul>
        <li><b>LogFileDir:</b> specifies the location where the log file will be generated. </li>
        <li><b>LogLevel:</b> specifies the granularity of logs. 0: Disabled (default); 1: Error messages; 2: Debug messages; 4: Trace messages. 
        For a combination of levels, the values can be added together.  E.g. a value of 7 will provide error messages, debug messages and trace messages.</li>
    </ul>
    <div class="Highlighted" style="background-color:lightgrey">
        <p><font color="Black">
    Logging is only recommend while troubleshooting.
    It is necessary to reboot the device to apply registry setting changes.
          </font>
        </p>
    </div>
</body>
</html>
