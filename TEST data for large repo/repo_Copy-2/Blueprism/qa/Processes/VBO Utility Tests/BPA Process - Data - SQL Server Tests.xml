<process name="Data - SQL Server Tests" version="1.0" narrative="Suite of tests for the &quot;Data - SQL Server&quot; VBO bundled with the product under bug 7551" preferredid="85fef5b6-d22a-4ae3-8b27-8634436169af">
  <view>
    <camerax>0</camerax>
    <cameray>0</cameray>
    <zoom>1</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="55c2318b-e85b-42cc-97e4-14b3f5abe664" type="Normal" published="False">
    <name>Configuration</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="f1198f8a-2261-46ca-9eef-4266d66e37fa" type="Normal" published="False">
    <name>Execute Batches</name>
    <view>
      <camerax>0</camerax>
      <cameray>25</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="73815adc-b856-4997-8888-d97217f2e4d9" type="Normal" published="False">
    <name>Create DB</name>
    <view>
      <camerax>0</camerax>
      <cameray>168</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="60880cfa-786f-43fb-a727-000ec2e3d5e6" type="Normal" published="False">
    <name>Create DB Data</name>
    <view>
      <camerax>0</camerax>
      <cameray>-5</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="eeaa3de9-941b-491a-b88a-3f52a4fe8271" type="Normal" published="False">
    <name>Run Tests</name>
    <view>
      <camerax>202</camerax>
      <cameray>249</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="2fc0d7af-4e4a-43ae-954c-ca302d8bc776" type="Normal" published="False">
    <name>Test Exception Handling</name>
    <view>
      <camerax>0</camerax>
      <cameray>537</cameray>
      <zoom>1</zoom>
    </view>
  </subsheet>
  <stage stageid="9ce1a114-1a14-4312-a1d6-e16c292fcad5" name="Start" type="Start">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>bd9a4d16-bbc6-4df1-85e9-c7e55398bd57</onsuccess>
  </stage>
  <stage stageid="260ae1c1-08dd-47cd-ae67-d073af80f4e3" name="End" type="End">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>285</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="24f05992-c42c-438c-8d6a-54a1e3556d1b" name="Stage1" type="ProcessInfo">
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>300</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="c94df1f2-48f6-40c0-a1ea-89874d554108" name="Success" type="Data">
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-30</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="0443daeb-c6e1-4186-bcbb-a3f390ad93d0" name="Message" type="Data">
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>30</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="a3f36632-8bab-4fd7-a252-7adf5478bfef" name="Create DB" type="SubSheetInfo">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="585f88e9-7eb8-4220-88ba-ba03be4cf9b3" name="Start" type="Start">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <preconditions>
      <condition narrative="Database connection is available to localhost\SQLExpress" />
    </preconditions>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>3272da7b-7e60-417b-9348-00f28398c691</onsuccess>
  </stage>
  <stage stageid="4ec1d550-4773-4a0b-a5dc-4972d1e4723a" name="End" type="End">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>180</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="3272da7b-7e60-417b-9348-00f28398c691" name="Set Connection : master" type="Action">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Server" expr="[Server]" />
      <input type="text" name="Database" expr="[Database (non-test)]" />
      <input type="text" name="User" expr="[Username]" />
      <input type="text" name="Password" expr="[Password]" />
    </inputs>
    <onsuccess>199e30da-a10a-4555-b7bd-e9a26891322b</onsuccess>
    <resource object="Data - SQL Server" action="Set Connection" />
  </stage>
  <stage stageid="7d859716-21e5-4264-bcc5-dfc8857e1158" name="Create DB" type="SubSheet">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>0</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>21e07e7c-48e6-4abd-a30f-b0e88443d564</onsuccess>
    <processid>73815adc-b856-4997-8888-d97217f2e4d9</processid>
  </stage>
  <stage stageid="199e30da-a10a-4555-b7bd-e9a26891322b" name="Success?" type="Decision">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>-60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>b9c28f8b-c5e2-468b-b778-d0d8e63b3beb</ontrue>
    <onfalse>d9e7bac5-5675-4918-8b17-7234be5c4d39</onfalse>
  </stage>
  <stage stageid="d9e7bac5-5675-4918-8b17-7234be5c4d39" name="FAIL" type="Exception">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>165</displayx>
    <displayy>-60</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;SetConnection:master - &quot; &amp; [Message]" />
  </stage>
  <stage stageid="987bbbcd-1432-4485-a272-efcda8ef3e8a" name="Create DB Data" type="SubSheetInfo">
    <subsheetid>60880cfa-786f-43fb-a727-000ec2e3d5e6</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="623c1497-a03e-4457-a01c-21f809eca3e4" name="Start" type="Start">
    <subsheetid>60880cfa-786f-43fb-a727-000ec2e3d5e6</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>a125af10-8175-46de-9bdc-22c15416448c</onsuccess>
  </stage>
  <stage stageid="e154cde6-7c3a-481c-96f8-c58c6a81a8f3" name="End" type="End">
    <subsheetid>60880cfa-786f-43fb-a727-000ec2e3d5e6</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="799b7d30-7f34-4c90-8749-c0f6b2ea78af" name="Execute Batches" type="SubSheetInfo">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="7201cc17-642f-4714-81b4-26292b9daa8e" name="Start" type="Start">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-120</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="Batches" narrative="The batches making up the transaction" stage="Batches" />
      <input type="flag" name="Transaction" narrative="Flag indicating if a transaction should be used; Default is TRUE" stage="Transaction" />
    </inputs>
    <onsuccess>15227536-7133-4cdb-8e2d-a103977ba156</onsuccess>
  </stage>
  <stage stageid="c9099bbd-e90f-49e1-819d-b0c70a766729" name="End" type="End">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>240</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="1f2fb006-c737-4699-93bc-973bc8c3e40d" name="Batches" type="Collection">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>-180</displayx>
    <displayy>15</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Batch" type="text" description="The batch of SQL commands to send to the database" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Batch" type="text" value="create table company (&#xD;&#xA;  id int not null identity primary key,&#xD;&#xA;  name varchar(255) not null&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;create table client (&#xD;&#xA;  id int not null identity primary key,&#xD;&#xA;  name varchar(255) not null,&#xD;&#xA;  dob datetime null,&#xD;&#xA;  company int not null&#xD;&#xA;    constraint fk_client_company&#xD;&#xA;      foreign key references company (id)&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;create table invoice (&#xD;&#xA;  id int not null identity primary key,&#xD;&#xA;  company int not null&#xD;&#xA;    constraint fk_invoice_company&#xD;&#xA;      foreign key references company (id),&#xD;&#xA;  client int null&#xD;&#xA;    constraint fk_invoice_client&#xD;&#xA;      foreign key references client (id),&#xD;&#xA;  date datetime not null,&#xD;&#xA;  state tinyint not null,&#xD;&#xA;  total int not null&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;create table invoiceentry (&#xD;&#xA;  id bigint not null identity primary key,&#xD;&#xA;  name varchar(255) not null,&#xD;&#xA;  invoice int not null&#xD;&#xA;    constraint fk_invoiceentry_invoice&#xD;&#xA;      foreign key references invoice (id),&#xD;&#xA;  price int not null&#xD;&#xA;)&#xD;&#xA;" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="6cd9669f-f317-4e28-930f-c54494e4f83c" name="Begin Transaction" type="Action">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>866457f4-ae0e-40c7-a181-79f39d46e137</onsuccess>
    <resource object="Data - SQL Server" action="Begin Transaction" />
  </stage>
  <stage stageid="0d28e23e-d93b-4395-860f-5656007f8f5b" name="Commit" type="Action">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>195</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>e53699b8-9eb1-4553-bf37-4b3560522869</onsuccess>
    <resource object="Data - SQL Server" action="Commit Transaction" />
  </stage>
  <stage stageid="a9206369-0edd-40d6-ad94-4c813a17a6ee" name="Execute" type="Action">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="[Batches.Batch]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>17bfaccf-fd0f-46fe-982c-5e6c3227a249</onsuccess>
    <resource object="Data - SQL Server" action="Execute" />
  </stage>
  <stage stageid="86a8a7e9-3b61-4ef6-89ac-053a4a48bde5" name="For Each Batch" type="LoopStart">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Bold" color="333399" />
    <onsuccess>a9206369-0edd-40d6-ad94-4c813a17a6ee</onsuccess>
    <groupid>45170d38-82b2-4b42-9b4a-8646cd055ce7</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Batches</loopdata>
  </stage>
  <stage stageid="57d8a338-2dd8-4a5b-8c87-c50285e8a5f0" name="Next Batch" type="LoopEnd">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>105</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Bold" color="333399" />
    <onsuccess>ad3f610d-deca-48e2-91f2-72a7c0511c36</onsuccess>
    <groupid>45170d38-82b2-4b42-9b4a-8646cd055ce7</groupid>
  </stage>
  <stage stageid="17bfaccf-fd0f-46fe-982c-5e6c3227a249" name="Success?" type="Decision">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>57d8a338-2dd8-4a5b-8c87-c50285e8a5f0</ontrue>
    <onfalse>ac19edaf-a00d-4ced-a490-8990e575ee97</onfalse>
  </stage>
  <stage stageid="ac19edaf-a00d-4ced-a490-8990e575ee97" name="FAIL" type="Exception">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>165</displayx>
    <displayy>60</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Failed executing batch: &quot; &amp; [Batches.Batch] &amp; NewLine() &amp; &quot;with message: &quot; &amp; [Message]" />
  </stage>
  <stage stageid="e53699b8-9eb1-4553-bf37-4b3560522869" name="Success?" type="Decision">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>195</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>c9099bbd-e90f-49e1-819d-b0c70a766729</ontrue>
    <onfalse>4f20a7a0-d85a-4eaf-b316-f86f6fb6d0ab</onfalse>
  </stage>
  <stage stageid="4f20a7a0-d85a-4eaf-b316-f86f6fb6d0ab" name="FAIL" type="Exception">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>165</displayx>
    <displayy>195</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Failed committing transaction: &quot; &amp; [Message]" />
  </stage>
  <stage stageid="39038222-11ce-489d-af9a-dbd97de77580" name="Success?" type="Decision">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>34839f52-fb1f-44bf-a545-25b4eca1ba41</ontrue>
    <onfalse>b6b30522-93ae-478f-ba38-39ea8dc49877</onfalse>
  </stage>
  <stage stageid="b6b30522-93ae-478f-ba38-39ea8dc49877" name="FAIL" type="Exception">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>165</displayx>
    <displayy>60</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;SetConnection:testsqlvbo - &quot; &amp; [Message]" />
  </stage>
  <stage stageid="866457f4-ae0e-40c7-a181-79f39d46e137" name="Success?" type="Decision">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>86a8a7e9-3b61-4ef6-89ac-053a4a48bde5</ontrue>
    <onfalse>32e0d147-ea75-48ca-ae7d-bada2fa16c01</onfalse>
  </stage>
  <stage stageid="32e0d147-ea75-48ca-ae7d-bada2fa16c01" name="FAIL" type="Exception">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>165</displayx>
    <displayy>-30</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Failed executing batch: &quot; &amp; [Batches.Batch] &amp; NewLine() &amp; &quot;with message: &quot; &amp; [Message]" />
  </stage>
  <stage stageid="7f449857-7192-4880-931e-3a912d2c0eea" name="Batches" type="Collection">
    <subsheetid>60880cfa-786f-43fb-a727-000ec2e3d5e6</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>0</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Batch" type="text" description="The batch of SQL commands to send to the database" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Batch" type="text" value="insert into company (name)&#xD;&#xA; select 'Acme, Inc.' union all&#xD;&#xA; select 'Bloggs Biscuits' union all&#xD;&#xA; select 'Carmichael and sons' union all&#xD;&#xA; select 'Delight'&#xD;&#xA;&#xD;&#xA;declare @acme int, @bloggs int, @carmichael int, @delight int;&#xD;&#xA;set @acme = (select id from company where name = 'Acme, Inc.')&#xD;&#xA;set @bloggs = (select id from company where name = 'Bloggs Biscuits')&#xD;&#xA;set @carmichael = (select id from company where name = 'Carmichael and sons')&#xD;&#xA;set @delight = (select id from company where name = 'Delight')&#xD;&#xA;&#xD;&#xA;select @acme, @bloggs, @carmichael, @delight&#xD;&#xA;&#xD;&#xA;-- Check for any nulls&#xD;&#xA;if (@acme + @bloggs + @carmichael + @delight) is null&#xD;&#xA;begin&#xD;&#xA;    raiserror('Invalid company found', 10, 1)&#xD;&#xA;    return&#xD;&#xA;end&#xD;&#xA;&#xD;&#xA;insert into client (name, dob, company)&#xD;&#xA;  select 'Andrew Atkinson', '19741214', @acme union all&#xD;&#xA;  select 'Bill Bloggs', '19590317', @bloggs union all&#xD;&#xA;  select 'Barry Bloggs', '19610828', @bloggs union all&#xD;&#xA;  select 'Carl Carmichael', null, @carmichael union all&#xD;&#xA;  select 'Chris Carmichael', '19820106', @carmichael union all&#xD;&#xA;  select 'Carrie Carmichael', '19830416', @carmichael union all&#xD;&#xA;  select 'Doris Deloitte', null, @delight&#xD;&#xA;&#xD;&#xA;-- Again, with the checking&#xD;&#xA;declare @andrew int, @bill int, @barry int, @carl int, @chris int, @carrie int, @doris int;&#xD;&#xA;set @andrew = (select id from client where name = 'Andrew Atkinson')&#xD;&#xA;set @bill = (select id from client where name = 'Bill Bloggs')&#xD;&#xA;set @barry = (select id from client where name = 'Barry Bloggs')&#xD;&#xA;set @carl = (select id from client where name = 'Carl Carmichael')&#xD;&#xA;set @chris = (select id from client where name = 'Chris Carmichael')&#xD;&#xA;set @carrie = (select id from client where name = 'Carrie Carmichael')&#xD;&#xA;set @doris = (select id from client where name = 'Doris Deloitte')&#xD;&#xA;&#xD;&#xA;if (@andrew + @bill + @barry + @carl + @chris + @carrie + @doris) is null&#xD;&#xA;begin&#xD;&#xA;    raiserror('Invalid client found', 10, 1)&#xD;&#xA;    return&#xD;&#xA;end&#xD;&#xA;&#xD;&#xA;declare @pending int, @dispatched int, @delivered int, @paid int&#xD;&#xA;set @pending = 1&#xD;&#xA;set @dispatched = 2&#xD;&#xA;set @delivered = 3&#xD;&#xA;set @paid = 4&#xD;&#xA;&#xD;&#xA;declare @invoiceid int&#xD;&#xA;&#xD;&#xA;-- Invoice 1 &amp; 2: A simple fisherman&#xD;&#xA;insert into invoice (company, client, date, state)&#xD;&#xA;  select @acme, @andrew, '20130612', @pending&#xD;&#xA;set @invoiceid = scope_identity()&#xD;&#xA;insert into invoiceentry (section, subsection, name, invoice, price) values ('Fishing', 'Rods', 'Budget-o-rod', @invoiceid, 1000)&#xD;&#xA;&#xD;&#xA;insert into invoice (company, client, date, state)&#xD;&#xA;  select @acme, @andrew, '20130613', @pending&#xD;&#xA;set @invoiceid = scope_identity()&#xD;&#xA;insert into invoiceentry (section, subsection, name, invoice, price) &#xD;&#xA;  select 'Fishing', 'Lures', 'Black Dancer (x12)', @invoiceid, 299 union all&#xD;&#xA;  select 'Fishing', 'Lures', 'Diawl Bach Olive Hares Ear (x12)', @invoiceid, 349 union all&#xD;&#xA;  select 'Fishing', 'Flies', 'Mixed Epoxy Buzzers Size 14 (x12)', @invoiceid, 200 union all&#xD;&#xA;  select 'Household', 'General', 'Scotch 3M masking tape', @invoiceid, 226 union all&#xD;&#xA;  select 'Household', 'Kitchen', 'Gerber Gator Fixed Blade Fillet Knife (Fine Edge)', @invoiceid, 1300&#xD;&#xA;&#xD;&#xA;-- Invoice 3 &amp; 4: Bloggs fun &amp; games&#xD;&#xA;insert into invoice (company, client, date, state)&#xD;&#xA;  select @bloggs, @bill, '20130812', @delivered&#xD;&#xA;set @invoiceid = scope_identity()&#xD;&#xA;insert into invoiceentry (section, subsection, name, invoice, price) &#xD;&#xA;  select 'Clothing', 'Alternative', 'Hot Pants Zentai Gimp Suit', @invoiceid, 4399 union all&#xD;&#xA;  select 'Clothing', 'Military', 'Soviet Russian Gas Mask Model Gp-4', @invoiceid, 1405 union all&#xD;&#xA;  select 'Clothing', 'Shoes', 'Mustang Laced Union Jack Boots', @invoiceid, 5500 union all&#xD;&#xA;  select 'Sports', 'Accessories', 'Castle Pretty Pink Riding Crop', @invoiceid, 325&#xD;&#xA;&#xD;&#xA;insert into invoice (company, client, date, state)&#xD;&#xA;  select @bloggs, @barry, '20130812', @dispatched&#xD;&#xA;set @invoiceid = scope_identity()&#xD;&#xA;insert into invoiceentry (section, subsection, name, invoice, price) &#xD;&#xA;  select 'Clothing', 'Military', 'Bulletproof Vest Body Armor Tactical Kevlar', @invoiceid, 20869 union all&#xD;&#xA;  select 'Media', 'Books', 'Jay McGraw''s Life Strategies for Dealing with Bullies', @invoiceid, 495&#xD;&#xA;&#xD;&#xA;-- Invoice 5, 6, 7, 8: The rise and fall of Carrie Carmichael&#xD;&#xA;insert into invoice (company, client, date, state)&#xD;&#xA;  select @carmichael, @carl, '20130812', @dispatched&#xD;&#xA;set @invoiceid = scope_identity()&#xD;&#xA;insert into invoiceentry (section, subsection, name, invoice, price) &#xD;&#xA;  select 'Media', 'DVD', 'Basic Instinct', @invoiceid, 450 union all&#xD;&#xA;  select 'Media', 'DVD', '9 1/2 Weeks', @invoiceid, 20869 union all&#xD;&#xA;  select 'Media', 'DVD', 'Striptease', @invoiceid, 203 union all&#xD;&#xA;  select 'Media', 'Books', '30 Shades of Grey', @invoiceid, 700 union all&#xD;&#xA;  select 'Household', 'General', 'Kleenex Mansize - Box of 100 Tissues', @invoiceid, 239&#xD;&#xA;&#xD;&#xA;insert into invoice (company, client, date, state)&#xD;&#xA;  select @carmichael, @carrie, '20130812', @paid&#xD;&#xA;set @invoiceid = scope_identity()&#xD;&#xA;insert into invoiceentry (section, subsection, name, invoice, price)&#xD;&#xA;  select 'Household', 'Produce', 'My Free Range Farm - Eggs (x6 Medium)', @invoiceid, 152 union all&#xD;&#xA;  select 'Household', 'Produce', 'Tate &amp; Lyle Sugars Fairtrade Caster Sugar 1kg', @invoiceid, 111 union all&#xD;&#xA;  select 'Household', 'Produce', 'Homepride Self-Raising Flour 1kg', @invoiceid, 200 union all&#xD;&#xA;  select 'Household', 'Produce', 'Rakusen''s Tomor Dairy Free Vegetarian Margarine 250g', @invoiceid, 90 union all&#xD;&#xA;  select 'Household', 'Produce', 'Cottage Delight Award Winning Strawberry Jam', @invoiceid, 360 union all&#xD;&#xA;  select 'Household', 'Pest Control', 'Rentokil PSR98 Biotrol Plus Rat Killer Bait 400g', @invoiceid, 900&#xD;&#xA;&#xD;&#xA;insert into invoice (company, client, date, state)&#xD;&#xA;  select @carmichael, @chris, '20130820', @paid&#xD;&#xA;set @invoiceid = scope_identity()&#xD;&#xA;insert into invoiceentry (section, subsection, name, invoice, price)&#xD;&#xA;  select 'Services', 'Funeral', 'Rosewood traditional coffin', @invoiceid, 65000 union all&#xD;&#xA;  select 'Services', 'Funeral', 'Lawn Headstone', @invoiceid, 9899 union all&#xD;&#xA;  select 'Services', 'Funeral', 'Hearse Rental - 2hrs', @invoiceid, 27499&#xD;&#xA;&#xD;&#xA;insert into invoice (company, client, date, state)&#xD;&#xA;  select @carmichael, @carrie, '20130830', @delivered&#xD;&#xA;set @invoiceid = scope_identity()&#xD;&#xA;insert into invoiceentry (section, subsection, name, invoice, price)&#xD;&#xA;  select 'Media', 'Books', 'Unlocking Criminal Law', @invoiceid, 2400 union all&#xD;&#xA;  select 'Media', 'Books', 'Permissible Killing: The Self-Defence Justification of Homicide', @invoiceid, 1399&#xD;&#xA;" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="a125af10-8175-46de-9bdc-22c15416448c" name="Execute Batches" type="SubSheet">
    <subsheetid>60880cfa-786f-43fb-a727-000ec2e3d5e6</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="Batches" narrative="The batches making up the transaction" expr="[Batches]" />
      <input type="flag" name="Transaction" narrative="Flag indicating if a transaction should be used; Default is TRUE" expr="True" />
    </inputs>
    <onsuccess>e154cde6-7c3a-481c-96f8-c58c6a81a8f3</onsuccess>
    <processid>f1198f8a-2261-46ca-9eef-4266d66e37fa</processid>
  </stage>
  <stage stageid="d9dfa1ce-aa53-4254-b161-4e1310a632ae" name="Create Script" type="Collection">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-15</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Batch" type="text" description="The batch of SQL commands to send to the database" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Batch" type="text" value="if (db_id('testsqlvbo') is not null)&#xD;&#xA;  drop database testsqlvbo" />
      </row>
      <row>
        <field name="Batch" type="text" value="create database testsqlvbo" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="b9c28f8b-c5e2-468b-b778-d0d8e63b3beb" name="Execute Create Script" type="SubSheet">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>Note that you can't drop or create a database inside a transaction</narrative>
    <displayx>15</displayx>
    <displayy>0</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="Batches" narrative="The batches making up the transaction" expr="[Create Script]" />
      <input type="flag" name="Transaction" narrative="Flag indicating if a transaction should be used; Default is TRUE" expr="False" />
    </inputs>
    <onsuccess>1ee4e894-143e-4cc8-a43f-c4c0757e7494</onsuccess>
    <processid>f1198f8a-2261-46ca-9eef-4266d66e37fa</processid>
  </stage>
  <stage stageid="429598b4-c1cb-4d9e-875f-2b480361fca3" name="Create Tables" type="Collection">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>60</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Batch" type="text" description="The batch of SQL commands to send to the database" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Batch" type="text" value="create table company (&#xD;&#xA;  id int not null identity primary key,&#xD;&#xA;  name varchar(255) not null&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;create table client (&#xD;&#xA;  id int not null identity primary key,&#xD;&#xA;  name varchar(255) not null,&#xD;&#xA;  dob datetime null,&#xD;&#xA;  company int not null&#xD;&#xA;    constraint fk_client_company&#xD;&#xA;      foreign key references company (id)&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;create table invoice (&#xD;&#xA;  id int not null identity primary key,&#xD;&#xA;  company int not null&#xD;&#xA;    constraint fk_invoice_company&#xD;&#xA;      foreign key references company (id),&#xD;&#xA;  client int null&#xD;&#xA;    constraint fk_invoice_client&#xD;&#xA;      foreign key references client (id),&#xD;&#xA;  date datetime not null,&#xD;&#xA;  state tinyint not null&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;create table invoiceentry (&#xD;&#xA;  id bigint not null identity primary key,&#xD;&#xA;  section varchar(255) not null,&#xD;&#xA;  subsection varchar(255) null,&#xD;&#xA;  name varchar(255) not null,&#xD;&#xA;  invoice int not null&#xD;&#xA;    constraint fk_invoiceentry_invoice&#xD;&#xA;      foreign key references invoice (id),&#xD;&#xA;  price int not null&#xD;&#xA;)&#xD;&#xA;" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="34839f52-fb1f-44bf-a545-25b4eca1ba41" name="Execute Create Tables" type="SubSheet">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>120</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="Batches" narrative="The batches making up the transaction" expr="[Create Tables]" />
      <input type="flag" name="Transaction" narrative="Flag indicating if a transaction should be used; Default is TRUE" expr="True" />
    </inputs>
    <onsuccess>4ec1d550-4773-4a0b-a5dc-4972d1e4723a</onsuccess>
    <processid>f1198f8a-2261-46ca-9eef-4266d66e37fa</processid>
  </stage>
  <stage stageid="13d1359a-3582-475b-9bfd-a693a7c511c4" name="Configuration" type="SubSheetInfo">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="8d4affea-1c39-4a53-9b63-e95e4f9d0b42" name="Start" type="Start">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>12277b01-e89a-4d45-8d09-cca87e3c91c0</onsuccess>
  </stage>
  <stage stageid="49f14446-f6ca-4680-879b-ead160eb533e" name="End" type="End">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d37a07ec-40cf-49f9-b580-4957942618a3" name="Server" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-30</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">localhost\SQLExpress</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="3a950c93-a549-435b-9663-14bd25ff4560" name="Database (non-test)" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>0</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">master</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="225e612b-eae1-4535-8b01-eb33ce20e61b" name="Database (test)" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>30</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">testsqlvbo</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="2945df16-404d-4a46-92b9-4587f1199b44" name="Username" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>60</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">sa</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="0b706f49-f196-4540-a564-ee6db1af7233" name="Password" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>90</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">sa</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="1ee4e894-143e-4cc8-a43f-c4c0757e7494" name="Set Connection : testsqlvbo" type="Action">
    <subsheetid>73815adc-b856-4997-8888-d97217f2e4d9</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Server" expr="[Server]" />
      <input type="text" name="Database" expr="[Database (test)]" />
      <input type="text" name="User" expr="[Username]" />
      <input type="text" name="Password" expr="[Password]" />
    </inputs>
    <onsuccess>39038222-11ce-489d-af9a-dbd97de77580</onsuccess>
    <resource object="Data - SQL Server" action="Set Connection" />
  </stage>
  <stage stageid="21e07e7c-48e6-4abd-a30f-b0e88443d564" name="Create DB Data" type="SubSheet">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>ed0c9a50-57fb-4263-9861-450ce0b1f6b6</onsuccess>
    <processid>60880cfa-786f-43fb-a727-000ec2e3d5e6</processid>
  </stage>
  <stage stageid="200c989d-8f54-4241-87a8-14d18303f5c6" name="Run Tests" type="SubSheetInfo">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="6d578600-fce8-4502-a69b-4efefc2bb66f" name="Start" type="Start">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>dc067ab7-f0ee-41e4-9a4f-3f42bbc416c3</onsuccess>
  </stage>
  <stage stageid="c8299fa6-3817-405c-8637-e72175a4d163" name="End" type="End">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>345</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="3fe1f2b6-2732-42f6-9ede-deb316485bb7" name="Number Result" type="Data">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>45</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ed0c9a50-57fb-4263-9861-450ce0b1f6b6" name="Run Tests" type="SubSheet">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>150</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>5c9cfd0b-8c16-4f07-9940-0525fca24e20</onsuccess>
    <processid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</processid>
  </stage>
  <stage stageid="eee55dde-82c2-41e4-afdd-7b6ec5e01558" name="Transaction" type="Data">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="15227536-7133-4cdb-8e2d-a103977ba156" name="Transaction?" type="Decision">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Transaction]" />
    <ontrue>6cd9669f-f317-4e28-930f-c54494e4f83c</ontrue>
    <onfalse>d03e8a86-0cb6-479d-8497-ca656b42fefc</onfalse>
  </stage>
  <stage stageid="d03e8a86-0cb6-479d-8497-ca656b42fefc" name="anchor1" type="Anchor">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>-60</displayx>
    <displayy>-75</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>6c4613f1-700b-4353-bb80-9dfe70dd3db2</onsuccess>
  </stage>
  <stage stageid="6c4613f1-700b-4353-bb80-9dfe70dd3db2" name="anchor2" type="Anchor">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>-60</displayx>
    <displayy>15</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>86a8a7e9-3b61-4ef6-89ac-053a4a48bde5</onsuccess>
  </stage>
  <stage stageid="ad3f610d-deca-48e2-91f2-72a7c0511c36" name="Transaction?" type="Decision">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>150</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Transaction]" />
    <ontrue>0d28e23e-d93b-4395-860f-5656007f8f5b</ontrue>
    <onfalse>5dafef6b-26a0-4958-abb2-eba627be17e6</onfalse>
  </stage>
  <stage stageid="5dafef6b-26a0-4958-abb2-eba627be17e6" name="anchor1" type="Anchor">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>-60</displayx>
    <displayy>150</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>9ec296d6-ab36-48f4-a56c-0050f48a4191</onsuccess>
  </stage>
  <stage stageid="9ec296d6-ab36-48f4-a56c-0050f48a4191" name="anchor2" type="Anchor">
    <subsheetid>f1198f8a-2261-46ca-9eef-4266d66e37fa</subsheetid>
    <narrative>
    </narrative>
    <displayx>-60</displayx>
    <displayy>240</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>c9099bbd-e90f-49e1-819d-b0c70a766729</onsuccess>
  </stage>
  <stage stageid="bd9a4d16-bbc6-4df1-85e9-c7e55398bd57" name="Configuration" type="SubSheet">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>7d859716-21e5-4264-bcc5-dfc8857e1158</onsuccess>
    <processid>55c2318b-e85b-42cc-97e4-14b3f5abe664</processid>
  </stage>
  <stage stageid="075bac77-1f78-419f-af60-06e62471dbad" name="Tests" type="Collection">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-15</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Query" type="text" description="The text of the query to produce a number" />
      <field name="Expected Number" type="number" description="The number expected to come out from the query or affected records" />
      <field name="Row Type" type="number" description="0=No Output; 1=Number; 2=Affected Records; 3=Collection; 4=CSV; 5=Text; 6=Error Expected" />
      <field name="Special Command" type="number" description="0=Not Special; 1=Begin Transaction; 2=Commit; 3=Rollback" />
      <field name="Expected Collection" type="collection" description="The collection expected to come out from the query">
        <field name="Company" type="text" description="The company name" />
        <field name="Invoices" type="number" description="The number of invoices" />
        <field name="Revenue" type="number" description="The amount of revenue gleaned from this company" />
      </field>
      <field name="Expected Text" type="text" description="The text or CSV content expected from a query" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Query" type="text" value="select sum(e.price) from invoiceentry e" />
        <field name="Expected Number" type="number" value="166838" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select cast(sum(e.price)/100.0 as decimal(10,2)) from invoiceentry e" />
        <field name="Expected Number" type="number" value="1668.38" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select count(*) from client" />
        <field name="Expected Number" type="number" value="7" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select 1" />
        <field name="Expected Number" type="number" value="1" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select max(a.cnt) from (select c.name as company, count(*) as cnt from invoice i join company c on i.company = c.id group by c.name) a" />
        <field name="Expected Number" type="number" value="4" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select sum(a.cnt) from (select c.name as company, count(*) as cnt from invoice i join company c on i.company = c.id group by c.name) a" />
        <field name="Expected Number" type="number" value="8" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select count(*) from invoice" />
        <field name="Expected Number" type="number" value="8" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select max(a.total) from (select c.name as company, sum(e.price) as total from invoice i join invoiceentry e on i.id = e.invoice join company c on i.company = c.id group by c.name) a" />
        <field name="Expected Number" type="number" value="130471" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select a.total from (select c.name as company, sum(e.price) as total from invoice i join invoiceentry e on i.id = e.invoice join company c on i.company = c.id group by c.name) a" />
        <field name="Expected Number" type="number" value="3374" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select top 1 a.total from (select c.name as company, sum(e.price) as total from invoice i join invoiceentry e on i.id = e.invoice join company c on i.company = c.id group by c.name) a" />
        <field name="Expected Number" type="number" value="3374" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="update invoiceentry set price=price*10 where invoice in (6,7,8,9,10,11,12,13,14)" />
        <field name="Expected Number" type="number" value="11" />
        <field name="Row Type" type="number" value="2" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="update invoiceentry set price=price/10 where invoice between 6 and 7" />
        <field name="Expected Number" type="number" value="9" />
        <field name="Row Type" type="number" value="2" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="update invoiceentry set price=price/10 where invoice=8" />
        <field name="Expected Number" type="number" value="2" />
        <field name="Row Type" type="number" value="2" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="&lt;&lt;&lt; BEGIN TRAN &gt;&gt;&gt;" />
        <field name="Expected Number" type="number" value="" />
        <field name="Row Type" type="number" value="" />
        <field name="Special Command" type="number" value="1" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="delete from invoiceentry where invoice=99" />
        <field name="Expected Number" type="number" value="0" />
        <field name="Row Type" type="number" value="2" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="delete from invoiceentry where invoice=1" />
        <field name="Expected Number" type="number" value="1" />
        <field name="Row Type" type="number" value="2" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="&lt;&lt;&lt; ROLLBACK &gt;&gt;&gt;" />
        <field name="Expected Number" type="number" value="" />
        <field name="Row Type" type="number" value="" />
        <field name="Special Command" type="number" value="3" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select count(*) from invoiceentry" />
        <field name="Expected Number" type="number" value="28" />
        <field name="Row Type" type="number" value="1" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select&#xD;&#xA;  co.name as Company,&#xD;&#xA;  count(i.id) as Invoices,&#xD;&#xA;  cast(isnull(sum(ie.price)/100.0, 0.0) as decimal(10,2)) as Revenue&#xD;&#xA;from company as co&#xD;&#xA;  left join invoice i -- nested join of invoice &amp; invoiceentry&#xD;&#xA;    join invoiceentry ie on ie.invoice = i.id&#xD;&#xA;  on i.company = co.id&#xD;&#xA;group by co.name&#xD;&#xA;" />
        <field name="Expected Number" type="number" value="" />
        <field name="Row Type" type="number" value="3" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection&gt;&lt;row&gt;&lt;field name=&quot;Company&quot; type=&quot;text&quot; value=&quot;Acme, Inc.&quot; /&gt;&lt;field name=&quot;Invoices&quot; type=&quot;number&quot; value=&quot;6&quot; /&gt;&lt;field name=&quot;Revenue&quot; type=&quot;number&quot; value=&quot;33.74&quot; /&gt;&lt;/row&gt;&lt;row&gt;&lt;field name=&quot;Company&quot; type=&quot;text&quot; value=&quot;Bloggs Biscuits&quot; /&gt;&lt;field name=&quot;Invoices&quot; type=&quot;number&quot; value=&quot;6&quot; /&gt;&lt;field name=&quot;Revenue&quot; type=&quot;number&quot; value=&quot;329.93&quot; /&gt;&lt;/row&gt;&lt;row&gt;&lt;field name=&quot;Company&quot; type=&quot;text&quot; value=&quot;Carmichael and sons&quot; /&gt;&lt;field name=&quot;Invoices&quot; type=&quot;number&quot; value=&quot;16&quot; /&gt;&lt;field name=&quot;Revenue&quot; type=&quot;number&quot; value=&quot;1304.71&quot; /&gt;&lt;/row&gt;&lt;row&gt;&lt;field name=&quot;Company&quot; type=&quot;text&quot; value=&quot;Delight&quot; /&gt;&lt;field name=&quot;Invoices&quot; type=&quot;number&quot; value=&quot;0&quot; /&gt;&lt;field name=&quot;Revenue&quot; type=&quot;number&quot; value=&quot;0.00&quot; /&gt;&lt;/row&gt;&lt;/collection&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
      <row>
        <field name="Query" type="text" value="select&#xD;&#xA;  co.name as Company,&#xD;&#xA;  count(i.id) as Invoices,&#xD;&#xA;  cast(isnull(sum(ie.price)/100.0, 0.0) as decimal(10,2)) as Revenue&#xD;&#xA;from company as co&#xD;&#xA;  left join invoice i -- nested join of invoice &amp; invoiceentry&#xD;&#xA;    join invoiceentry ie on ie.invoice = i.id&#xD;&#xA;  on i.company = co.id&#xD;&#xA;group by co.name&#xD;&#xA;" />
        <field name="Expected Number" type="number" value="" />
        <field name="Row Type" type="number" value="4" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="Company,Invoices,Revenue&#xD;&#xA;&quot;Acme, Inc.&quot;,6,33.74&#xD;&#xA;Bloggs Biscuits,6,329.93&#xD;&#xA;Carmichael and sons,16,1304.71&#xD;&#xA;Delight,0,0.00" />
      </row>
      <row>
        <field name="Query" type="text" value="select cli.name from client cli where cli.id not in (select distinct cli.id from invoice i join client cli on i.client = cli.id)" />
        <field name="Expected Number" type="number" value="" />
        <field name="Row Type" type="number" value="5" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="Doris Deloitte" />
      </row>
      <row>
        <field name="Query" type="text" value="select nothing from nowhere" />
        <field name="Expected Number" type="number" value="" />
        <field name="Row Type" type="number" value="6" />
        <field name="Special Command" type="number" value="0" />
        <field name="Expected Collection" type="collection" value="&lt;collection /&gt;" />
        <field name="Expected Text" type="text" value="" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="dc067ab7-f0ee-41e4-9a4f-3f42bbc416c3" name="For Each Test" type="LoopStart">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-90</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Bold" color="993300" />
    <onsuccess>65525970-6681-49b3-b54f-996b9394c67d</onsuccess>
    <groupid>30a5e002-f04f-4181-88a3-181629bed29d</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Tests</loopdata>
  </stage>
  <stage stageid="09baf3fd-1ac3-4c06-950d-e349f9224eaf" name="Next Test" type="LoopEnd">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>300</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Bold" color="993300" />
    <onsuccess>c8299fa6-3817-405c-8637-e72175a4d163</onsuccess>
    <groupid>30a5e002-f04f-4181-88a3-181629bed29d</groupid>
  </stage>
  <stage stageid="65525970-6681-49b3-b54f-996b9394c67d" name="Special Command?" type="ChoiceStart">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>b62e855c-689f-4828-95c2-f5b7601935ae</onsuccess>
    <groupid>0e014022-4dad-4a4f-a3de-854f1954e82f</groupid>
    <choices>
      <choice expression="[Tests.Special Command] = 1">
        <name>Begin Tran</name>
        <distance>60</distance>
        <ontrue>b62e855c-689f-4828-95c2-f5b7601935ae</ontrue>
      </choice>
      <choice expression="[Tests.Special Command] = 2">
        <name>Commit Tran</name>
        <distance>135</distance>
        <ontrue>28690888-6274-4742-a632-9defa4a2c763</ontrue>
      </choice>
      <choice expression="[Tests.Special Command] = 3">
        <name>Rollback Tran</name>
        <distance>210</distance>
        <ontrue>ebf01b0e-4f9c-4cd5-b77d-3818ee694109</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="3aad2268-6d2a-4d3e-8824-06876d782a03" name="Not Special" type="ChoiceEnd">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>390</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>469ae078-eaba-4153-b3b9-db89175469ab</onsuccess>
    <groupid>0e014022-4dad-4a4f-a3de-854f1954e82f</groupid>
  </stage>
  <stage stageid="b62e855c-689f-4828-95c2-f5b7601935ae" name="Begin Transaction" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>60</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>5fa5d405-f6c4-4298-8d27-8c939d5dde25</onsuccess>
    <resource object="Data - SQL Server" action="Begin Transaction" />
  </stage>
  <stage stageid="28690888-6274-4742-a632-9defa4a2c763" name="Commit" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>135</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>46f67c87-409a-4c96-93a8-f4cc1cbd10f8</onsuccess>
    <resource object="Data - SQL Server" action="Commit Transaction" />
  </stage>
  <stage stageid="ebf01b0e-4f9c-4cd5-b77d-3818ee694109" name="Rollback" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>16991f7b-fa99-48d0-8d71-75508ac5f31f</onsuccess>
    <resource object="Data - SQL Server" action="Rollback Transaction" />
  </stage>
  <stage stageid="5fa5d405-f6c4-4298-8d27-8c939d5dde25" name="anchor3" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>60</displayx>
    <displayy>30</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>46f67c87-409a-4c96-93a8-f4cc1cbd10f8</onsuccess>
  </stage>
  <stage stageid="46f67c87-409a-4c96-93a8-f4cc1cbd10f8" name="anchor4" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>135</displayx>
    <displayy>30</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>16991f7b-fa99-48d0-8d71-75508ac5f31f</onsuccess>
  </stage>
  <stage stageid="16991f7b-fa99-48d0-8d71-75508ac5f31f" name="anchor5" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>30</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>7f8ae9c5-a9e2-4f6b-841c-2b7abe74d22c</onsuccess>
  </stage>
  <stage stageid="469ae078-eaba-4153-b3b9-db89175469ab" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>390</displayx>
    <displayy>75</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>f8bb41e7-15f8-42c2-933d-63359a62e4a3</onsuccess>
  </stage>
  <stage stageid="f8bb41e7-15f8-42c2-933d-63359a62e4a3" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>75</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>8862c447-f46c-4a02-858a-921abc6b46c0</onsuccess>
  </stage>
  <stage stageid="8862c447-f46c-4a02-858a-921abc6b46c0" name="Test Type?" type="ChoiceStart">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>120</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <groupid>6ffe1bb9-bcb2-4c6f-b2d0-615c22e1bf4e</groupid>
    <choices>
      <choice expression="[Tests.Row Type] = 0">
        <name>No Output</name>
        <distance>75</distance>
        <ontrue>b2f4c540-118c-40e7-a82d-d0f03e1d3a79</ontrue>
      </choice>
      <choice expression="[Tests.Row Type] = 1">
        <name>Number</name>
        <distance>195</distance>
        <ontrue>1f94b63d-cc90-4f14-b4c4-71e57c782dae</ontrue>
      </choice>
      <choice expression="[Tests.Row Type] = 2">
        <name>Records Affected</name>
        <distance>315</distance>
        <ontrue>dcdbb827-703f-4c5e-8e0d-920522fb7013</ontrue>
      </choice>
      <choice expression="[Tests.Row Type] = 3">
        <name>Collection</name>
        <distance>435</distance>
        <ontrue>cb7f972a-ff5a-4ba0-aa6a-d4fbd1d86ec4</ontrue>
      </choice>
      <choice expression="[Tests.Row Type] = 4">
        <name>CSV</name>
        <distance>555</distance>
        <ontrue>cd327dad-eb01-4351-9c8a-9a7757c5a259</ontrue>
      </choice>
      <choice expression="[Tests.Row Type] = 5">
        <name>Text</name>
        <distance>675</distance>
        <ontrue>e9da89dd-e337-48b6-88a2-d2c380746ccd</ontrue>
      </choice>
      <choice expression="[Tests.Row Type] = 6">
        <name>Error</name>
        <distance>795</distance>
        <ontrue>b6799b5e-ed86-408a-981b-ee89b56af2ea</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="01c8b185-a8c3-4024-8367-a234e330179a" name="Uh-oh" type="ChoiceEnd">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>900</displayx>
    <displayy>120</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>03f44b07-8da0-428d-8a1a-530278f259b0</onsuccess>
    <groupid>6ffe1bb9-bcb2-4c6f-b2d0-615c22e1bf4e</groupid>
  </stage>
  <stage stageid="1f94b63d-cc90-4f14-b4c4-71e57c782dae" name="Get Number" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="number" name="Result" stage="Number Result" />
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>ccd223f8-1ee3-4644-a8cd-efcf6a09705e</onsuccess>
    <resource object="Data - SQL Server" action="Get Number" />
  </stage>
  <stage stageid="b2f4c540-118c-40e7-a82d-d0f03e1d3a79" name="Execute" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>75</displayx>
    <displayy>165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>de437723-a6ca-4863-8a9a-38fd5a985e7e</onsuccess>
    <resource object="Data - SQL Server" action="Execute" />
  </stage>
  <stage stageid="dcdbb827-703f-4c5e-8e0d-920522fb7013" name="Get Records Affected" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>315</displayx>
    <displayy>165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="number" name="Records Affected" stage="Number Result" />
    </outputs>
    <onsuccess>3d7aaf86-57e0-4d75-af92-374239294474</onsuccess>
    <resource object="Data - SQL Server" action="Get Records Affected" />
  </stage>
  <stage stageid="03f44b07-8da0-428d-8a1a-530278f259b0" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>975</displayx>
    <displayy>120</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Unrecognised test type: &quot; &amp; [Tests.Row Type]" />
  </stage>
  <stage stageid="de437723-a6ca-4863-8a9a-38fd5a985e7e" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>75</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>a2277029-f125-45b4-b10d-a6c1d290bc15</ontrue>
    <onfalse>e757ce4b-b4dd-4f02-9095-e7f4acb0ed74</onfalse>
  </stage>
  <stage stageid="e757ce4b-b4dd-4f02-9095-e7f4acb0ed74" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>135</displayx>
    <displayy>210</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while executing (No Output Test): &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="6102935e-a170-498d-b183-60d31ed570cf" name="Expected Number?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>255</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Number Result] = [Tests.Expected Number]" />
    <ontrue>a000409b-3147-4337-abec-88f65777ffad</ontrue>
    <onfalse>4156ef6f-fac5-4136-af92-a26d9af7802e</onfalse>
  </stage>
  <stage stageid="4156ef6f-fac5-4136-af92-a26d9af7802e" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>255</displayx>
    <displayy>255</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="Expected Result Exception" detail="&quot;Get Number test; Expected: &quot; &amp; [Tests.Expected Number] &amp; &quot;; but received: &quot; &amp; [Number Result] &amp; &quot; for query:&quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="a2277029-f125-45b4-b10d-a6c1d290bc15" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>75</displayx>
    <displayy>300</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>09baf3fd-1ac3-4c06-950d-e349f9224eaf</onsuccess>
  </stage>
  <stage stageid="7f8ae9c5-a9e2-4f6b-841c-2b7abe74d22c" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>95b85f6f-46c8-4a42-b0cf-63738c128c13</ontrue>
    <onfalse>55a845b0-a1e2-46da-9746-33bffffb2e9e</onfalse>
  </stage>
  <stage stageid="55a845b0-a1e2-46da-9746-33bffffb2e9e" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>345</displayx>
    <displayy>30</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while attempting a special command with ID: &quot; &amp; [Tests.Special Command] &amp; &quot;(1=BeginTran; 2=CommitTran; 3=RollbackTran)&quot;" />
  </stage>
  <stage stageid="95b85f6f-46c8-4a42-b0cf-63738c128c13" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>60</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>a0393e95-f461-4135-9008-6a9bfb9788df</onsuccess>
  </stage>
  <stage stageid="a0393e95-f461-4135-9008-6a9bfb9788df" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>-45</displayx>
    <displayy>60</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>72141b76-7d2a-4db9-8455-8fa4405b6172</onsuccess>
  </stage>
  <stage stageid="72141b76-7d2a-4db9-8455-8fa4405b6172" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>-45</displayx>
    <displayy>300</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>09baf3fd-1ac3-4c06-950d-e349f9224eaf</onsuccess>
  </stage>
  <stage stageid="ccd223f8-1ee3-4644-a8cd-efcf6a09705e" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>6102935e-a170-498d-b183-60d31ed570cf</ontrue>
    <onfalse>4781f218-2161-4921-b946-0f679624c9ff</onfalse>
  </stage>
  <stage stageid="4781f218-2161-4921-b946-0f679624c9ff" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>255</displayx>
    <displayy>210</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while executing (Number Test): &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="3d7aaf86-57e0-4d75-af92-374239294474" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>315</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>c81502e3-e918-45e0-afe6-3902e8d24e38</ontrue>
    <onfalse>d068cbc9-975b-4da9-b92b-525fa47ac41e</onfalse>
  </stage>
  <stage stageid="d068cbc9-975b-4da9-b92b-525fa47ac41e" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>375</displayx>
    <displayy>210</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while executing (Affected Test): &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="c81502e3-e918-45e0-afe6-3902e8d24e38" name="Expected Number?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>315</displayx>
    <displayy>255</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Number Result] = [Tests.Expected Number]" />
    <ontrue>9da51eb6-28ee-41dc-83a3-588ba6f1af10</ontrue>
    <onfalse>f697fe9e-f4cc-4c75-b5f5-b02c3e78a386</onfalse>
  </stage>
  <stage stageid="f697fe9e-f4cc-4c75-b5f5-b02c3e78a386" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>375</displayx>
    <displayy>255</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="Expected Result Exception" detail="&quot;Get Records Affected test; Expected: &quot; &amp; [Tests.Expected Number] &amp; &quot;; but received: &quot; &amp; [Number Result] &amp; &quot; for query:&quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="a000409b-3147-4337-abec-88f65777ffad" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>300</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>a2277029-f125-45b4-b10d-a6c1d290bc15</onsuccess>
  </stage>
  <stage stageid="9da51eb6-28ee-41dc-83a3-588ba6f1af10" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>315</displayx>
    <displayy>300</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>a000409b-3147-4337-abec-88f65777ffad</onsuccess>
  </stage>
  <stage stageid="cb7f972a-ff5a-4ba0-aa6a-d4fbd1d86ec4" name="Get Collection" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>435</displayx>
    <displayy>165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="SQL" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="collection" name="Results" stage="Collection Result" />
    </outputs>
    <onsuccess>d2c8f39b-86a0-4101-a9dd-8d9c19347e39</onsuccess>
    <resource object="Data - SQL Server" action="Get Collection" />
  </stage>
  <stage stageid="a55a871e-4e85-4528-a690-51c2872a8833" name="Collection Result" type="Collection">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>90</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d2c8f39b-86a0-4101-a9dd-8d9c19347e39" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>435</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>21d89967-853e-420e-a8e4-0003db550e71</ontrue>
    <onfalse>6fa566ad-be75-4047-8978-7396151158e4</onfalse>
  </stage>
  <stage stageid="6fa566ad-be75-4047-8978-7396151158e4" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>495</displayx>
    <displayy>210</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while executing (Collection Test): &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="21d89967-853e-420e-a8e4-0003db550e71" name="Expected Collection?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>435</displayx>
    <displayy>255</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Collection Result] = [Tests.Expected Collection]" />
    <ontrue>72a27cf7-4e80-48d0-9e55-44a0d9132f50</ontrue>
    <onfalse>46545de5-2fb9-40d1-ac69-605d12a3b16d</onfalse>
  </stage>
  <stage stageid="46545de5-2fb9-40d1-ac69-605d12a3b16d" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>495</displayx>
    <displayy>255</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="Expected Result Exception" detail="&quot;Get Collection test; Collections don't match for query:&quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="72a27cf7-4e80-48d0-9e55-44a0d9132f50" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>435</displayx>
    <displayy>300</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>9da51eb6-28ee-41dc-83a3-588ba6f1af10</onsuccess>
  </stage>
  <stage stageid="cd327dad-eb01-4351-9c8a-9a7757c5a259" name="Get CSV Text" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="SQL" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="text" name="CSV" stage="Text Result" />
    </outputs>
    <onsuccess>452d2100-2e0b-4d32-8dba-919215597fe2</onsuccess>
    <resource object="Data - SQL Server" action="Get CSV" />
  </stage>
  <stage stageid="28254e27-8153-4d27-af0f-133e826f7281" name="Text Result" type="Data">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>135</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="452d2100-2e0b-4d32-8dba-919215597fe2" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>09659783-1310-4416-b3f7-076779d22812</ontrue>
    <onfalse>d3147aba-7d5d-4fed-bb4e-eee67a56ed19</onfalse>
  </stage>
  <stage stageid="d3147aba-7d5d-4fed-bb4e-eee67a56ed19" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>615</displayx>
    <displayy>210</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while executing (CSV Test): &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="09659783-1310-4416-b3f7-076779d22812" name="Expected Text?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>255</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="Trim([Text Result]) = Trim([Tests.Expected Text])" />
    <ontrue>66574284-195f-4de7-96c6-ad13b1b3d539</ontrue>
    <onfalse>2dad4e4d-27f9-465f-846c-48929b0d3b02</onfalse>
  </stage>
  <stage stageid="2dad4e4d-27f9-465f-846c-48929b0d3b02" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>615</displayx>
    <displayy>255</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="Expected Result Exception" detail="&quot;Get CSV test; CSV Text doesn't match; Expected: &quot; &amp; [Tests.Expected Text] &amp; &quot;; But got: &quot; &amp; [Text Result] &amp;&quot; for query:&quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="d6c55038-590f-4813-b0f3-a629ffe03a7e" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>435</displayx>
    <displayy>510</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>72a27cf7-4e80-48d0-9e55-44a0d9132f50</onsuccess>
  </stage>
  <stage stageid="66574284-195f-4de7-96c6-ad13b1b3d539" name="Get CSV File" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>300</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="SQL" expr="[Tests.Query]" />
      <input type="text" name="File" expr="[CSV File]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>ac8c9ec8-2fc8-462d-af85-15f933f509f9</onsuccess>
    <resource object="Data - SQL Server" action="Get CSV File" />
  </stage>
  <stage stageid="ac8c9ec8-2fc8-462d-af85-15f933f509f9" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>345</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>478d92bf-362c-438e-8c01-7cec0f10bcbb</ontrue>
    <onfalse>78174cd3-b0a8-44e5-9605-2cf3328a5cea</onfalse>
  </stage>
  <stage stageid="78174cd3-b0a8-44e5-9605-2cf3328a5cea" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>615</displayx>
    <displayy>345</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while executing (CSV File Test): &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="bfd62848-a884-496b-8ac6-ccf51d319425" name="Expected Text?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>480</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="Trim([Text Result]) = Trim([Tests.Expected Text])" />
    <ontrue>ba737bb7-64cc-479e-826e-f8a906b7d3ec</ontrue>
    <onfalse>dca10041-7bbe-4b2b-a7c5-0793245cd4a1</onfalse>
  </stage>
  <stage stageid="cc2a0fbb-45b8-437f-8fab-6a971ffcdfd0" name="CSV File" type="Data">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>180</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\temp\testoutput.csv</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="478d92bf-362c-438e-8c01-7cec0f10bcbb" name="Read CSV File" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>390</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="File Name" narrative="The full path the file to read the text from" expr="[CSV File]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" narrative="True if successful" stage="Success" />
      <output type="text" name="Message" narrative="An error message if unsuccessful" stage="Message" />
      <output type="text" name="Text" narrative="The text of the file" stage="Text Result" />
    </outputs>
    <onsuccess>258ed61f-c3ec-456f-b777-697ffe6df20f</onsuccess>
    <resource object="Utility - File Management" action="Read All Text from File" />
  </stage>
  <stage stageid="258ed61f-c3ec-456f-b777-697ffe6df20f" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>435</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>bfd62848-a884-496b-8ac6-ccf51d319425</ontrue>
    <onfalse>54bd7402-cb7b-4e2f-b3c9-f36a8a00f12e</onfalse>
  </stage>
  <stage stageid="54bd7402-cb7b-4e2f-b3c9-f36a8a00f12e" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>615</displayx>
    <displayy>435</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while reading CSV file: &quot; &amp; [CSV File]" />
  </stage>
  <stage stageid="dca10041-7bbe-4b2b-a7c5-0793245cd4a1" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>615</displayx>
    <displayy>480</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="Expected Result Exception" detail="&quot;Get CSV test; CSV Text from file: &quot; &amp; [CSV File] &amp; &quot; doesn't match; Expected: &quot; &amp; [Tests.Expected Text] &amp; &quot;; But got: &quot; &amp; [Text Result] &amp;&quot; for query:&quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="e9da89dd-e337-48b6-88a2-d2c380746ccd" name="Get Text" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>675</displayx>
    <displayy>165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="text" name="Result" stage="Text Result" />
    </outputs>
    <onsuccess>28a70d12-37be-4b2e-86b4-49f2c5f3ed2d</onsuccess>
    <resource object="Data - SQL Server" action="Get Text" />
  </stage>
  <stage stageid="28a70d12-37be-4b2e-86b4-49f2c5f3ed2d" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>675</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>0f0393fe-c55e-4288-a4e7-9564cf85d0b2</ontrue>
    <onfalse>b0f73826-03d0-41d5-b820-35638fdd71fe</onfalse>
  </stage>
  <stage stageid="b0f73826-03d0-41d5-b820-35638fdd71fe" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>735</displayx>
    <displayy>210</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Error: &quot; &amp; [Message] &amp; &quot; while executing (Text Test): &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="0f0393fe-c55e-4288-a4e7-9564cf85d0b2" name="Expected Text?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>675</displayx>
    <displayy>255</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="Trim([Text Result]) = Trim([Tests.Expected Text])" />
    <ontrue>e31a4089-79da-4abe-9395-435eb13052d5</ontrue>
    <onfalse>7fc0644a-dfbd-4c62-8d57-47879fbe5f98</onfalse>
  </stage>
  <stage stageid="7fc0644a-dfbd-4c62-8d57-47879fbe5f98" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>735</displayx>
    <displayy>255</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="Expected Result Exception" detail="&quot;Get Text; Returned text doesn't match; Expected: &quot; &amp; [Tests.Expected Text] &amp; &quot;; But got: &quot; &amp; [Text Result] &amp;&quot; for query:&quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="e31a4089-79da-4abe-9395-435eb13052d5" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>675</displayx>
    <displayy>510</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>ba737bb7-64cc-479e-826e-f8a906b7d3ec</onsuccess>
  </stage>
  <stage stageid="ba737bb7-64cc-479e-826e-f8a906b7d3ec" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>555</displayx>
    <displayy>510</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>d6c55038-590f-4813-b0f3-a629ffe03a7e</onsuccess>
  </stage>
  <stage stageid="b6799b5e-ed86-408a-981b-ee89b56af2ea" name="Execute" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>3b60d772-8e44-418f-9228-403ebc0a5483</onsuccess>
    <resource object="Data - SQL Server" action="Execute" />
  </stage>
  <stage stageid="3b60d772-8e44-418f-9228-403ebc0a5483" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>53ef7b23-10c9-4d8a-9d01-4d76bd8940f3</ontrue>
    <onfalse>cf8f5145-d17a-4464-be94-71f5a267f37e</onfalse>
  </stage>
  <stage stageid="53ef7b23-10c9-4d8a-9d01-4d76bd8940f3" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>855</displayx>
    <displayy>210</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;No error reported when calling Execute() with: &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="cf8f5145-d17a-4464-be94-71f5a267f37e" name="Get Number" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>255</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="number" name="Result" stage="" />
    </outputs>
    <onsuccess>c68b40fc-c567-45e7-95a5-991e5d2ee980</onsuccess>
    <resource object="Data - SQL Server" action="Get Number" />
  </stage>
  <stage stageid="c68b40fc-c567-45e7-95a5-991e5d2ee980" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>300</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>3a57979b-d6e0-459e-a407-78e10db9b2f5</ontrue>
    <onfalse>302e4bf1-1715-4a3f-b68f-f950c0a63ac6</onfalse>
  </stage>
  <stage stageid="3a57979b-d6e0-459e-a407-78e10db9b2f5" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>855</displayx>
    <displayy>300</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;No error reported when calling Execute() with: &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="302e4bf1-1715-4a3f-b68f-f950c0a63ac6" name="Get Text" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>345</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="text" name="Result" stage="" />
    </outputs>
    <onsuccess>6ea88412-0c8f-4aa0-af91-6dc40e13273d</onsuccess>
    <resource object="Data - SQL Server" action="Get Text" />
  </stage>
  <stage stageid="6ea88412-0c8f-4aa0-af91-6dc40e13273d" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>390</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>cb939be7-1d0e-4129-99eb-74c5e34ca5ff</ontrue>
    <onfalse>11a4b06f-ad6c-4c50-bac1-0300e3a29e4b</onfalse>
  </stage>
  <stage stageid="cb939be7-1d0e-4129-99eb-74c5e34ca5ff" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>855</displayx>
    <displayy>390</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;No error reported when calling Execute() with: &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="fef8bf8d-83bd-4f7e-9f3e-52a4ff0b70c8" name="anchor6" type="Anchor">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>510</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>e31a4089-79da-4abe-9395-435eb13052d5</onsuccess>
  </stage>
  <stage stageid="11a4b06f-ad6c-4c50-bac1-0300e3a29e4b" name="Get CSV" type="Action">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>435</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="SQL" expr="[Tests.Query]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="text" name="CSV" stage="" />
    </outputs>
    <onsuccess>47cf40d5-1b0d-465b-9893-a677b91d0bc1</onsuccess>
    <resource object="Data - SQL Server" action="Get CSV" />
  </stage>
  <stage stageid="47cf40d5-1b0d-465b-9893-a677b91d0bc1" name="Success?" type="Decision">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>795</displayx>
    <displayy>480</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>69df7232-1cec-4c8f-8289-55486a6c6576</ontrue>
    <onfalse>fef8bf8d-83bd-4f7e-9f3e-52a4ff0b70c8</onfalse>
  </stage>
  <stage stageid="69df7232-1cec-4c8f-8289-55486a6c6576" name="FAIL" type="Exception">
    <subsheetid>eeaa3de9-941b-491a-b88a-3f52a4fe8271</subsheetid>
    <narrative>
    </narrative>
    <displayx>855</displayx>
    <displayy>480</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;No error reported when calling Execute() with: &quot; &amp; [Tests.Query]" />
  </stage>
  <stage stageid="a0f4bc92-338e-4f21-9266-9f6cf8764912" name="Test Exception Handling" type="SubSheetInfo">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="fa56dc71-7f21-4762-a6f2-31c1edd3fb67" name="Start" type="Start">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>c453f7bd-cebd-4fc1-8b4d-e5a09a07ad09</onsuccess>
  </stage>
  <stage stageid="c453f7bd-cebd-4fc1-8b4d-e5a09a07ad09" name="RaiseExceptions:=True" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-90</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="flag" name="Raise exception on any failure" narrative="Flag indicating if failure should cause an exception to be raised rather than a return of a success output value" expr="True" />
    </inputs>
    <onsuccess>68b99317-3d2a-4a35-b516-57486cdfedea</onsuccess>
    <resource object="Data - SQL Server" action="Configure" />
  </stage>
  <stage stageid="68b99317-3d2a-4a35-b516-57486cdfedea" name="Begin Transaction" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>59b891a5-c977-4456-b14a-2342933f8f4e</onsuccess>
    <resource object="Data - SQL Server" action="Begin Transaction" />
  </stage>
  <stage stageid="7573086a-b4d7-46e3-9b0e-56458bbfb5d4" name="." type="Block">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>-45</displayx>
    <displayy>-15</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>150</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="59b891a5-c977-4456-b14a-2342933f8f4e" name="Begin Transaction" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>b7c777ee-079f-4584-9b50-a65fbb7fa3c1</onsuccess>
    <resource object="Data - SQL Server" action="Begin Transaction" />
  </stage>
  <stage stageid="4890d490-479a-40b8-a282-9d1e41167a39" name="Transaction Already Open" type="Recover">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>02d933f3-4525-491c-89bc-36ca3293f25b</onsuccess>
  </stage>
  <stage stageid="b7c777ee-079f-4584-9b50-a65fbb7fa3c1" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>15</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;BEGIN TRAN within BEGIN TRAN should have raised an exception, but did not - Output Params: Success=&quot; &amp; [Success] &amp; &quot;; Message='&quot; &amp; [Message] &amp; &quot;'&quot;" />
  </stage>
  <stage stageid="459bdd39-5c11-41e6-9fa1-1e64e7ca7601" name="Which is as it should be" type="Resume">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>165</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>dc56abb9-2cbe-4f2c-9da8-ad2216978e34</onsuccess>
  </stage>
  <stage stageid="dc56abb9-2cbe-4f2c-9da8-ad2216978e34" name="Execute Nothing" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>105</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>e2b69e72-2490-4733-9a62-da26def34d61</onsuccess>
    <resource object="Data - SQL Server" action="Execute" />
  </stage>
  <stage stageid="de4c4276-c46f-4dc5-89c7-8e603b99e48d" name="." type="Block">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>135</displayx>
    <displayy>75</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>150</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e2b69e72-2490-4733-9a62-da26def34d61" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>105</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;Execute(Nothing) should have raised an exception, but did not - Output Params: Success=&quot; &amp; [Success] &amp; &quot;; Message='&quot; &amp; [Message] &amp; &quot;'&quot;" />
  </stage>
  <stage stageid="91a0acd5-1f78-4765-a585-10160aa7dcb0" name="No Query Given" type="Recover">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>150</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>e4184245-39be-49dc-ae1d-e79952d4d5ae</onsuccess>
  </stage>
  <stage stageid="b36962d8-a2f9-4c61-9519-62267b74bbf9" name="Which is as it should be" type="Resume">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>255</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>bfa85043-e194-4cb0-914b-41fc4a1fa5e5</onsuccess>
  </stage>
  <stage stageid="bfa85043-e194-4cb0-914b-41fc4a1fa5e5" name="Get Number Syntax Error" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>375</displayx>
    <displayy>195</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="&quot;select nothing from nowhere&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="number" name="Result" stage="Number Result" />
    </outputs>
    <onsuccess>5a574032-048f-4a05-9c5d-ab29bf4a8b35</onsuccess>
    <resource object="Data - SQL Server" action="Get Number" />
  </stage>
  <stage stageid="5a3d5294-70ec-4645-8720-ca5ea747bfee" name="." type="Block">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>315</displayx>
    <displayy>165</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>150</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5a574032-048f-4a05-9c5d-ab29bf4a8b35" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>465</displayx>
    <displayy>195</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;GetNumber(BadQuery) should have raised an exception, but did not - Output Params: Success=&quot; &amp; [Success] &amp; &quot;; Message='&quot; &amp; [Message] &amp; &quot;'; Number Result=&quot; &amp; [Number Result]" />
  </stage>
  <stage stageid="6c43b4a9-4c6d-4a97-a830-2da3c41b9f46" name="Syntax Error" type="Recover">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>375</displayx>
    <displayy>240</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>541cd4bc-2066-4034-9566-4cb714cca1aa</onsuccess>
  </stage>
  <stage stageid="08c7546b-2a09-4daf-b88c-c64d3de7636a" name="Which is as it should be" type="Resume">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>375</displayx>
    <displayy>345</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>98b80ce0-0c09-4337-b988-2c26e7589737</onsuccess>
  </stage>
  <stage stageid="e1af07e0-cfad-4e51-b6e2-dc2e7402c4b8" name="Number Result" type="Data">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-30</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="98b80ce0-0c09-4337-b988-2c26e7589737" name="Rollback" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>345</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>20570f9a-3ce3-4385-b29d-0632d318507e</onsuccess>
    <resource object="Data - SQL Server" action="Rollback Transaction" />
  </stage>
  <stage stageid="bf073e25-30a4-48ff-b664-912d056a581b" name="." type="Block">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>-45</displayx>
    <displayy>375</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>150</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="39c414f5-86bd-448e-9161-8961ebb41882" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>405</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;ROLLBACK followed by ROLLBACK should have raised an exception, but did not - Output Params: Success=&quot; &amp; [Success] &amp; &quot;; Message='&quot; &amp; [Message] &amp; &quot;'; Number Result=&quot; &amp; [Number Result]" />
  </stage>
  <stage stageid="20fdb056-e36d-4f80-a300-23dda071a094" name="No Transaction to rollback" type="Recover">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>450</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>92e82783-5561-461f-957e-f6f48cf3118b</onsuccess>
  </stage>
  <stage stageid="63826556-323f-4ed2-b54c-1a36f350fc66" name="Which is as it should be" type="Resume">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>555</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>73fb2002-21b9-42ed-8ec8-02c2830475c9</onsuccess>
  </stage>
  <stage stageid="20570f9a-3ce3-4385-b29d-0632d318507e" name="Rollback" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>405</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
    </outputs>
    <onsuccess>39c414f5-86bd-448e-9161-8961ebb41882</onsuccess>
    <resource object="Data - SQL Server" action="Rollback Transaction" />
  </stage>
  <stage stageid="73fb2002-21b9-42ed-8ec8-02c2830475c9" name="Set Connection To Garbage" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>495</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Server" expr="&quot;red\orange&quot;" />
      <input type="text" name="Database" expr="&quot;yellowgreen&quot;" />
      <input type="text" name="User" expr="&quot;blueindigo&quot;" />
      <input type="text" name="Password" expr="&quot;violet&quot;" />
    </inputs>
    <onsuccess>fa0a0d1c-5c7a-4260-97ea-404c90377e9e</onsuccess>
    <resource object="Data - SQL Server" action="Set Connection" />
  </stage>
  <stage stageid="fa0a0d1c-5c7a-4260-97ea-404c90377e9e" name="Get Text(valid)" type="Action">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>555</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Query" expr="&quot;select 'Hello'&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Message" stage="Message" />
      <output type="text" name="Result" stage="Text Result" />
    </outputs>
    <onsuccess>16c9f996-bd82-4559-b99a-6c3db0af03e7</onsuccess>
    <resource object="Data - SQL Server" action="Get Text" />
  </stage>
  <stage stageid="a044913a-8ea8-46b0-8516-3c61e215238a" name="." type="Block">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>135</displayx>
    <displayy>525</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>150</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="16c9f996-bd82-4559-b99a-6c3db0af03e7" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>555</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="SQL Server Exception" detail="&quot;GetText() on invalid connection should have raised an exception, but did not - Output Params: Success=&quot; &amp; [Success] &amp; &quot;; Message='&quot; &amp; [Message] &amp; &quot;'; Text Result=&quot; &amp; [Text Result]" />
  </stage>
  <stage stageid="85b0bf78-602f-47b1-accc-b7d61d54be25" name="Cannot connect to database" type="Recover">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>600</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>d6cd1841-dac6-4d84-8edf-9e7f3edceb12</onsuccess>
  </stage>
  <stage stageid="314329fc-87bd-493f-9516-0b7f07206ed1" name="Which is as it should be" type="Resume">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>705</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>3a638fee-0357-49ef-8a9f-06736364ed8d</onsuccess>
  </stage>
  <stage stageid="4df8a483-4b13-4fdd-8db6-3d60311b6c3b" name="Text Result" type="Data">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>15</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3a638fee-0357-49ef-8a9f-06736364ed8d" name="I think that'll do" type="End">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>750</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="5c9cfd0b-8c16-4f07-9940-0525fca24e20" name="Test Exception Handling" type="SubSheet">
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>225</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>60</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>260ae1c1-08dd-47cd-ae67-d073af80f4e3</onsuccess>
    <processid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</processid>
  </stage>
  <stage stageid="02d933f3-4525-491c-89bc-36ca3293f25b" name="Correct Exception?" type="Decision">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>105</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="InStr(ExceptionDetail(), &quot;A transaction is already open in this connection&quot;) &gt; 0" />
    <ontrue>459bdd39-5c11-41e6-9fa1-1e64e7ca7601</ontrue>
    <onfalse>90d37329-99a7-4776-ba5f-9e87a9390592</onfalse>
  </stage>
  <stage stageid="90d37329-99a7-4776-ba5f-9e87a9390592" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>105</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="e4184245-39be-49dc-ae1d-e79952d4d5ae" name="Correct Exception?" type="Decision">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>195</displayx>
    <displayy>195</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="InStr(ExceptionDetail(), &quot;CommandText property has not been initialized&quot;) &gt; 0" />
    <ontrue>b36962d8-a2f9-4c61-9519-62267b74bbf9</ontrue>
    <onfalse>db98356f-cfbe-4211-8bcf-0a0ff59ce158</onfalse>
  </stage>
  <stage stageid="db98356f-cfbe-4211-8bcf-0a0ff59ce158" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>195</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="541cd4bc-2066-4034-9566-4cb714cca1aa" name="Correct Exception?" type="Decision">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>375</displayx>
    <displayy>285</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="InStr(ExceptionDetail(), &quot;Invalid object name 'nowhere'&quot;) &gt; 0" />
    <ontrue>08c7546b-2a09-4daf-b88c-c64d3de7636a</ontrue>
    <onfalse>8e1f9305-17e6-4e77-b7ad-badcae073dc6</onfalse>
  </stage>
  <stage stageid="8e1f9305-17e6-4e77-b7ad-badcae073dc6" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>465</displayx>
    <displayy>285</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="92e82783-5561-461f-957e-f6f48cf3118b" name="Correct Exception?" type="Decision">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>495</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="InStr(ExceptionDetail(), &quot;There is no open transaction to rollback&quot;) &gt; 0" />
    <ontrue>63826556-323f-4ed2-b54c-1a36f350fc66</ontrue>
    <onfalse>b16539e4-fae5-4f2b-a860-ddda3b8bc3f4</onfalse>
  </stage>
  <stage stageid="b16539e4-fae5-4f2b-a860-ddda3b8bc3f4" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>495</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="d6cd1841-dac6-4d84-8edf-9e7f3edceb12" name="Correct Exception?" type="Decision">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>A bit ropey because we're testing error messages from a third party product - this may be better just not testing the specific error message... we'll see.</narrative>
    <displayx>195</displayx>
    <displayy>645</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="InStr(ExceptionDetail(), &quot;The server was not found or was not accessible&quot;) &gt; 0 OR InStr(ExceptionDetail(), &quot;An error has occurred while establishing a connection to the server&quot;) &gt; 0" />
    <ontrue>314329fc-87bd-493f-9516-0b7f07206ed1</ontrue>
    <onfalse>a1df1f13-e664-4487-a347-63351fa64ba7</onfalse>
  </stage>
  <stage stageid="a1df1f13-e664-4487-a347-63351fa64ba7" name="FAIL" type="Exception">
    <subsheetid>2fc0d7af-4e4a-43ae-954c-ca302d8bc776</subsheetid>
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>645</displayy>
    <displaywidth>30</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="ed95879f-cc5e-4129-a6bc-802903d428e4" name="DB Name" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>Not actually used, but registered as an env-var for completeness - it may come in handy in the future.</narrative>
    <displayx>210</displayx>
    <displayy>15</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8bec9313-ee20-4869-b166-5eca0e480337" name="DB Password" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>75</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1f4fd1db-47ea-4480-9137-eefcfd107b53" name="DB Server" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>-15</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">localhost\SQLExpress</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b754f3b0-cae2-4b73-9afa-26c151d3e179" name="DB User" type="Data">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>210</displayx>
    <displayy>45</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="12277b01-e89a-4d45-8d09-cca87e3c91c0" name="Set From Env Vars" type="MultipleCalculation">
    <subsheetid>55c2318b-e85b-42cc-97e4-14b3f5abe664</subsheetid>
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-90</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>30</displayheight>
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>49f14446-f6ca-4680-879b-ead160eb533e</onsuccess>
    <steps>
      <calculation expression="[DB Server]" stage="Server" />
      <calculation expression="[DB User]" stage="Username" />
      <calculation expression="[DB Password]" stage="Password" />
    </steps>
  </stage>
</process>