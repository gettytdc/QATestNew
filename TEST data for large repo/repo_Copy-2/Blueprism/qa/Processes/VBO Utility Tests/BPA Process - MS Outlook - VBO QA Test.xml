<process name="MS Outlook - VBO QA Test" version="1.0" bpversion="6.8.0.21588" narrative="" byrefcollection="true" preferredid="aa3e985d-baac-47e9-9e38-5a7f9c373eb9">
  <view>
    <camerax>116</camerax>
    <cameray>129</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="d8be370f-c0c7-4abc-9a63-b39c63e6f2cc" type="Normal" published="False">
    <name>Send Email</name>
    <view>
      <camerax>278</camerax>
      <cameray>-9</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0" type="Normal" published="False">
    <name>ForwardingEmail</name>
    <view>
      <camerax>6</camerax>
      <cameray>75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="cedfa4e3-9a80-4fef-a457-639c44c548a0" type="Normal" published="False">
    <name>Reply to Email</name>
    <view>
      <camerax>25</camerax>
      <cameray>54</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="c5f44d7f-11d6-493c-8124-0861e361120a" type="Normal" published="False">
    <name>Reply All to Email</name>
    <view>
      <camerax>7</camerax>
      <cameray>75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7ca1fd3b-9ee5-4754-85df-ab1bced27eba" type="Normal" published="False">
    <name>Delete Email</name>
    <view>
      <camerax>211</camerax>
      <cameray>75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="dcc2e6bf-8a1f-49ec-8242-e46328f354eb" type="Normal" published="False">
    <name>Mark Email as Read</name>
    <view>
      <camerax>7</camerax>
      <cameray>75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="51a7c6b5-f6b4-46da-b5df-c938d98aafeb" type="Normal" published="False">
    <name>Mark Email as Unread</name>
    <view>
      <camerax>7</camerax>
      <cameray>75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="1f0a3efe-125f-4107-8a88-a730edbed5bc" type="Normal" published="False">
    <name>Save Email As File</name>
    <view>
      <camerax>283</camerax>
      <cameray>75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="d1214ce1-9718-460a-8ffb-8e6becc03833" type="Normal" published="False">
    <name>Save Attachment (single file)</name>
    <view>
      <camerax>283</camerax>
      <cameray>75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="8f6e2f66-243b-482e-9fe5-15085f92b303" type="Normal" published="False">
    <name>Save Attachment (multiple files)</name>
    <view>
      <camerax>283</camerax>
      <cameray>75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ba40bcbc-a71e-4af2-b9fa-95541487559a" type="Normal" published="False">
    <name>Move Email into Subfolder</name>
    <view>
      <camerax>22</camerax>
      <cameray>108</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="4270da95-4b3a-4378-af8d-77c3b08692b8" type="Normal" published="False">
    <name>Get Received Items (Basic)</name>
    <view>
      <camerax>53</camerax>
      <cameray>206</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="77187256-2f3d-4550-af78-386374256168" type="Normal" published="False">
    <name>Get Received Items (Advanced)</name>
    <view>
      <camerax>283</camerax>
      <cameray>225</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="a03db2f8-5e88-43d8-8514-b775b9e85fc4" type="Normal" published="False">
    <name>Get Received Items (Expert)</name>
    <view>
      <camerax>76</camerax>
      <cameray>225</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="78c10bdb-81bd-40d0-9248-9e29b04ab431" type="Normal" published="False">
    <name>Get Sent Items (Basic)</name>
    <view>
      <camerax>-39</camerax>
      <cameray>121</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="0a1d9670-85c2-42a0-9256-edfa4d088212" type="Normal" published="False">
    <name>Get Sent Items (Advanced)</name>
    <view>
      <camerax>-39</camerax>
      <cameray>28</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7fdcf009-c0a1-464e-8e4d-73976d18cd26" type="Normal" published="False">
    <name>Get Sent Items (Expert)</name>
    <view>
      <camerax>-39</camerax>
      <cameray>43</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="1a893da7-2352-4ae4-8b08-abe553bd7b18" name="Start" type="Start">
    <display x="15" y="-135" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>74e92993-7146-4529-9a5f-e9b88fddd6d6</onsuccess>
  </stage>
  <stage stageid="444186dd-c5c4-4102-a4b8-64a576c3c547" name="End" type="End">
    <display x="165" y="330" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
  </stage>
  <stage stageid="c03256ce-ff0e-4408-a532-c50101524494" name="Stage1" type="ProcessInfo">
    <display x="-165" y="-90" w="150" h="120" />
  </stage>
  <stage stageid="e560444c-f716-4430-9939-244c5eb1546f" name="Send Email" type="SubSheetInfo">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <narrative>Function: Sending Emails using "Subject/Email Message/Attachments" as input parameters. Single or Multi attachments can be added. 

Out of Scope: Anything unrelated to sending an email.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="1f4b60e3-0d41-4a97-88e7-fa75b976cbc0" name="Start" type="Start">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="15" y="-135" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>88845596-4b35-42f4-b783-4931e51184cb</onsuccess>
  </stage>
  <stage stageid="c72252bf-1ee1-4e1d-a15f-8de9374bb124" name="End" type="End">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="795" y="300" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
  </stage>
  <stage stageid="88845596-4b35-42f4-b783-4931e51184cb" name="Send Email" type="Action">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="15" y="-60" />
    <inputs>
      <input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" expr="[To (Email Address).Email Address]" />
      <input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[CC]" />
      <input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[BCC]" />
      <input type="text" name="Subject" narrative="Optional. Any alphanumeric value allowed." expr="[Subject]" />
      <input type="text" name="Message" narrative="Optional, HTML or plain text" expr="[Message]" />
      <input type="text" name="Attachments" narrative="Optional, Comma-separated file paths. Default blank." expr="[Attachemts.Path]" />
    </inputs>
    <onsuccess>6a546ddf-3c42-4946-92cc-6f3d2f26dca0</onsuccess>
    <resource object="MS Outlook Email VBO" action="Send Email" />
  </stage>
  <stage stageid="fd2a8664-33d3-4db6-a339-eb31296ef9b0" name="Send Email" type="Action">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="15" y="90" />
    <inputs>
      <input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" expr="[To (Email Address).Email Address]" />
      <input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[CC]" />
      <input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[BCC]" />
      <input type="text" name="Subject" narrative="Optional. Any alphanumeric value allowed." expr="[Subject Email.Subject]" />
      <input type="text" name="Message" narrative="Optional, HTML or plain text" expr="[Message]" />
      <input type="text" name="Attachments" narrative="Optional, Comma-separated file paths. Default blank." expr="[Attachemts.Path]" />
    </inputs>
    <onsuccess>ef28d2f9-0eca-4108-ac65-d930f2f7df73</onsuccess>
    <resource object="MS Outlook Email VBO" action="Send Email" />
  </stage>
  <stage stageid="f28f1c2a-7f11-418a-af3c-b44b8c7b5f7b" name="Happy Path" type="Block">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="-90" y="-90" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="a4318413-a344-45dc-b63f-e0de1a800439" name="Exception Scenario (Subject)" type="Block">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="-90" y="60" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="d3b3a95d-8731-4a4f-bb43-b50fdc81c7ec" name="Recover" type="Recover">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="105" y="90" />
    <onsuccess>eb26be88-5e5d-4cd2-a4a4-b103a08c00c3</onsuccess>
  </stage>
  <stage stageid="65684416-26be-4787-b896-e39f16026f52" name="System Exception" type="Exception">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="210" y="270" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="eb26be88-5e5d-4cd2-a4a4-b103a08c00c3" name="capture exception message" type="Calculation">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="210" y="90" />
    <onsuccess>cb482fcf-28f5-4ccb-8450-7a276116c4d3</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="cb482fcf-28f5-4ccb-8450-7a276116c4d3" name="Resume" type="Resume">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="210" y="150" />
    <onsuccess>905db4e7-39bb-4167-ab55-d2964ffc8f61</onsuccess>
  </stage>
  <stage stageid="905db4e7-39bb-4167-ab55-d2964ffc8f61" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="210" y="210" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: There must be at least one name or contact group in the To, Cc, or Bcc box.&quot;" />
    <ontrue>ef28d2f9-0eca-4108-ac65-d930f2f7df73</ontrue>
    <onfalse>65684416-26be-4787-b896-e39f16026f52</onfalse>
  </stage>
  <stage stageid="74e92993-7146-4529-9a5f-e9b88fddd6d6" name="Send Email" type="SubSheet">
    <display x="15" y="-75" />
    <onsuccess>4f2bf448-2233-4cc3-b19a-3d6997d27269</onsuccess>
    <processid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</processid>
  </stage>
  <stage stageid="db8c5705-3bb5-4460-b137-26d380065df8" name="Get Received Items (Basic)" type="SubSheetInfo">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <narrative>Get Emails using specific "Filter Expressions" as input parameters. Items can also be retrieved from Sub Folders within the Inbox folder.

Out of Scope: Anything unrelated functions for getting emails from Outlook.</narrative>
    <display x="-195" y="-105" w="150" h="120" />
  </stage>
  <stage stageid="09152e0b-91ac-42d6-8c58-65cc9e79332a" name="Start" type="Start">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="15" y="-150" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>ac953edc-e478-4878-b6c8-733c1be9f819</onsuccess>
  </stage>
  <stage stageid="081be00c-c82f-4659-a1f9-e1209e4d46d9" name="End" type="End">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="465" y="360" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
  </stage>
  <stage stageid="ac953edc-e478-4878-b6c8-733c1be9f819" name="Get Received Items (Basic)" type="Action">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <narrative>Important: Please create a subfolder and update collection to allow the action to work.</narrative>
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Sender Name" narrative="Optional. The From display name, which might be a name (eg John Smith) or email address (eg admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the From field." expr="[Sender Name]" />
      <input type="text" name="Sender Email" narrative="Optional. The sender email address." expr="[Sender Email]" />
      <input type="datetime" name="Received Earliest" narrative="Optional. The earliest date to search from." expr="[Received Earliest]" />
      <input type="datetime" name="Received Latest" narrative="Optional. The latest date to search to." expr="[Received Latest]" />
      <input type="text" name="Subject" narrative="Optional. Asterisk wildcard permitted, eg *Project Update for 'Project Update', 'RE: Project Update' etc." expr="&quot;Testing different attachments&quot;" />
      <input type="text" name="Message" narrative="Optional. Asterisk wildcard permitted, eg *Blue Prism*" expr="[Message]" />
      <input type="flag" name="Include Read" narrative="Optional, default True" expr="[Include Read]" />
      <input type="flag" name="Include Unread" narrative="Optional, default True" expr="[Include Unread]" />
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Subfolder]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>3509cd68-788b-4aad-9a75-0aeecbf328e3</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Basic)" />
  </stage>
  <stage stageid="fb0d87d6-bbd0-4f4c-935e-d577b5611d82" name="Recover" type="Recover">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="105" y="120" />
    <onsuccess>b41d59b9-a086-4bfd-a743-8915925cf84d</onsuccess>
  </stage>
  <stage stageid="2e4bc8f5-763a-46a7-b2c4-b0e14410da38" name="System Exception" type="Exception">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="300" y="240" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="b41d59b9-a086-4bfd-a743-8915925cf84d" name="capture exception message" type="Calculation">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="195" y="120" />
    <onsuccess>21535923-b54e-4482-af31-04530206b41a</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="e67db80b-163e-414f-93da-af256d2e07ff" name="exception" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="465" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="21535923-b54e-4482-af31-04530206b41a" name="Resume" type="Resume">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="195" y="180" />
    <onsuccess>e41f2e71-8597-4724-8df4-21bd707a508e</onsuccess>
  </stage>
  <stage stageid="e41f2e71-8597-4724-8df4-21bd707a508e" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="195" y="240" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: The attempted operation failed.  An object could not be found.&quot; OR [exception]=&quot;Could not execute code stage because exception thrown by code stage: Condition is not valid.&quot;" />
    <ontrue>c25bba21-ab6d-4621-9a06-b14e953bd9ad</ontrue>
    <onfalse>2e4bc8f5-763a-46a7-b2c4-b0e14410da38</onfalse>
  </stage>
  <stage stageid="89d80871-43d6-44d2-96be-3e7dafb1d1d9" name="Get Received Items (Basic)" type="Action">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <narrative>Define Criteria to Filter for within Subfolder.</narrative>
    <display x="15" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Sender Name" narrative="Optional. The From display name, which might be a name (eg John Smith) or email address (eg admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the From field." expr="[Sender Name]" />
      <input type="text" name="Sender Email" narrative="Optional. The sender email address." expr="[Sender Email]" />
      <input type="datetime" name="Received Earliest" narrative="Optional. The earliest date to search from." expr="[Received Earliest]" />
      <input type="datetime" name="Received Latest" narrative="Optional. The latest date to search to." expr="[Received Latest]" />
      <input type="text" name="Subject" narrative="Optional. Asterisk wildcard permitted, eg *Project Update for 'Project Update', 'RE: Project Update' etc." expr="[Subject]" />
      <input type="text" name="Message" narrative="Optional. Asterisk wildcard permitted, eg *Blue Prism*" expr="[Message]" />
      <input type="flag" name="Include Read" narrative="Optional, default True" expr="[Include Read]" />
      <input type="flag" name="Include Unread" narrative="Optional, default True" expr="[Include Unread]" />
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Sub Folder.Folder]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>c25bba21-ab6d-4621-9a06-b14e953bd9ad</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Basic)" />
  </stage>
  <stage stageid="e2591ec4-5b7f-4b1e-a2f0-45d7f515a8bb" name="Item Count" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="405" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cd529f66-3caa-4d11-93b4-e8b49ad0a86a" name="Get Received Items (Basic)" type="SubSheet">
    <display x="450" y="-60" w="90" h="60" />
    <onsuccess>ea955154-730a-4794-b3a8-b11fc3ab26d7</onsuccess>
    <processid>4270da95-4b3a-4378-af8d-77c3b08692b8</processid>
  </stage>
  <stage stageid="ba7f8ddd-8d29-41e9-875b-9e0d4407adf3" name="Reply All to Email" type="SubSheetInfo">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <narrative>Reply to a specific Email (specifed by using the Entry ID = Unique Item ID of Email item in Outlook) using the "Reply All" functionaly within Outlook, which sends an email to all included recipients (From, CC, BCC)

Out of Scope: Anything other than replying to emails.</narrative>
    <display x="-195" y="-75" w="150" h="150" />
  </stage>
  <stage stageid="fbefc869-4da8-45b4-855c-c18303935696" name="Start" type="Start">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="15" y="-135" />
    <onsuccess>2e12f174-13b4-400b-842c-50f2ec56669d</onsuccess>
  </stage>
  <stage stageid="d1e55d7e-8f96-4693-9822-cdf735d9b8f6" name="End" type="End">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="2e12f174-13b4-400b-842c-50f2ec56669d" name="Reply All to Email" type="Action">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." expr="[Message]" />
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
    </inputs>
    <onsuccess>6e4f11a0-a9d4-414d-b8db-600b34861aca</onsuccess>
    <resource object="MS Outlook Email VBO" action="Reply All to Email" />
  </stage>
  <stage stageid="8016d222-a45d-441b-9565-88cea025d568" name="Recover" type="Recover">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="90" y="75" />
    <onsuccess>2d45969b-63f8-4feb-84b0-b766d945ffa2</onsuccess>
  </stage>
  <stage stageid="06058f3a-784e-4921-94b0-87ae69894461" name="System Exception" type="Exception">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="300" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="2d45969b-63f8-4feb-84b0-b766d945ffa2" name="capture exception message" type="Calculation">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="195" y="75" />
    <onsuccess>b1b9f4f7-9b89-4e5c-946e-0a2cf97d8863</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="87e172dc-afc4-4a2c-819e-a6638ae8d210" name="exception" type="Data">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="300" y="75" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b1b9f4f7-9b89-4e5c-946e-0a2cf97d8863" name="Resume" type="Resume">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="195" y="135" />
    <onsuccess>7439ffe2-f67e-40db-890e-6be2019fd6b3</onsuccess>
  </stage>
  <stage stageid="7439ffe2-f67e-40db-890e-6be2019fd6b3" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Could not open the item. Try again.&quot;" />
    <ontrue>d1e55d7e-8f96-4693-9822-cdf735d9b8f6</ontrue>
    <onfalse>06058f3a-784e-4921-94b0-87ae69894461</onfalse>
  </stage>
  <stage stageid="51465369-73f8-45e3-a5cb-a4224253ab2b" name="Message" type="Data">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Replied to all recipients of that Email.</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6e4f11a0-a9d4-414d-b8db-600b34861aca" name="Reply All to Email" type="Action">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <narrative>No Entry ID provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." expr="[Message]" />
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="&quot;&quot;" />
    </inputs>
    <onsuccess>d1e55d7e-8f96-4693-9822-cdf735d9b8f6</onsuccess>
    <resource object="MS Outlook Email VBO" action="Reply All to Email" />
  </stage>
  <stage stageid="5512c8b3-f50d-4254-868c-15026e18f3d7" name="Reply All to Email" type="SubSheet">
    <display x="165" y="0" />
    <onsuccess>b03caf70-aeb0-4418-98d0-16a59c75aa5b</onsuccess>
    <processid>c5f44d7f-11d6-493c-8124-0861e361120a</processid>
  </stage>
  <stage stageid="199ae1da-b76a-4400-87b3-0c4498be887c" name="Reply All to Email" type="SubSheetInfo">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <narrative>Reply to a specific Email (specifed by using the Entry ID = Unique Item ID of Email item in Outlook) using the "Reply" functionaly within Outlook, which sends an email to all only the sender/recipient (From).

Out of Scope: Reply to will not included (CC/BCC) or anything other than replying to emails.</narrative>
    <display x="-195" y="-75" w="150" h="150" />
  </stage>
  <stage stageid="4d1c0777-a4d5-4de7-942c-d64daaa0ad19" name="Start" type="Start">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="15" y="-135" />
    <onsuccess>25671f1e-ca7b-41cb-8212-2a5ba12b7e5f</onsuccess>
  </stage>
  <stage stageid="d2d6b4c2-e74b-4c39-8037-87ded3e7fc16" name="End" type="End">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="25671f1e-ca7b-41cb-8212-2a5ba12b7e5f" name="Reply to Email" type="Action">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." expr="[Message]" />
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
    </inputs>
    <onsuccess>b9dfc09e-cb13-407a-abef-daa86d3a535a</onsuccess>
    <resource object="MS Outlook Email VBO" action="Reply to Email" />
  </stage>
  <stage stageid="4706b8d8-67ce-49bb-b8b3-1a2f1f8f1079" name="Recover" type="Recover">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="90" y="75" />
    <onsuccess>ed2e3ba0-6c8b-49ec-8d5b-981b1a4a9eef</onsuccess>
  </stage>
  <stage stageid="e00101d0-43b3-4db9-ae57-a064d0e03a1c" name="System Exception" type="Exception">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="300" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="ed2e3ba0-6c8b-49ec-8d5b-981b1a4a9eef" name="capture exception message" type="Calculation">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="195" y="75" />
    <onsuccess>e5a21872-7770-488d-a842-87cdcce41fac</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="5cfc3bdc-6caf-464c-85a4-b289f12a9899" name="exception" type="Data">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="300" y="75" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e5a21872-7770-488d-a842-87cdcce41fac" name="Resume" type="Resume">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="195" y="135" />
    <onsuccess>ce12b484-e909-4110-b2e2-6e0e5a635d0f</onsuccess>
  </stage>
  <stage stageid="ce12b484-e909-4110-b2e2-6e0e5a635d0f" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Could not open the item. Try again.&quot;" />
    <ontrue>d2d6b4c2-e74b-4c39-8037-87ded3e7fc16</ontrue>
    <onfalse>e00101d0-43b3-4db9-ae57-a064d0e03a1c</onfalse>
  </stage>
  <stage stageid="16f05758-bf27-4707-a163-67715ffd7ef7" name="Message" type="Data">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Replied to Email Sender.</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b9dfc09e-cb13-407a-abef-daa86d3a535a" name="Reply to Email" type="Action">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <narrative>No Entry ID provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." expr="[Message]" />
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="&quot;&quot;" />
    </inputs>
    <onsuccess>d2d6b4c2-e74b-4c39-8037-87ded3e7fc16</onsuccess>
    <resource object="MS Outlook Email VBO" action="Reply to Email" />
  </stage>
  <stage stageid="6d0c139e-b082-40be-a9d0-1fa99449c779" name="Reply to Email" type="SubSheet">
    <display x="315" y="0" />
    <onsuccess>5512c8b3-f50d-4254-868c-15026e18f3d7</onsuccess>
    <processid>cedfa4e3-9a80-4fef-a457-639c44c548a0</processid>
  </stage>
  <stage stageid="85ba0ae4-ed64-4bcd-8ee5-10221f709f0b" name="ForwardingEmail" type="SubSheetInfo">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <narrative>Forwarding Emails using "To/CC/BCC/Message" as the input parameter.

Out of Scope: Anything unrelated to forwarding an email.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="017ab268-8d8b-42af-956d-b95e03c57eda" name="Start" type="Start">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>9c439ca2-c8c6-457e-b06f-ee64b5b55ac6</onsuccess>
  </stage>
  <stage stageid="2b73f68c-2463-43e4-9fe3-154af2287905" name="End" type="End">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="9c439ca2-c8c6-457e-b06f-ee64b5b55ac6" name="Forwarding Email" type="Action">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" expr="[To]" />
      <input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[CC]" />
      <input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[BCC]" />
      <input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." expr="[Message]" />
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
    </inputs>
    <onsuccess>ad77f6fb-363a-40d5-beb6-f8803a4984bd</onsuccess>
    <resource object="MS Outlook Email VBO" action="Forward Email" />
  </stage>
  <stage stageid="ad77f6fb-363a-40d5-beb6-f8803a4984bd" name="Forwarding Email" type="Action">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <narrative>No TO provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" expr="&quot;&quot;" />
      <input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[CC]" />
      <input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[BCC]" />
      <input type="text" name="Message" narrative="Mandatory, Any alphanumeric value allowed. HTML or plain text." expr="[Message]" />
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="flag" name="IsHTML" friendlyname="IsHTML" narrative="Optional. True or False, default to True" expr="" />
      <input type="number" name="Sensitivity" friendlyname="Sensitivity" narrative="Optional. An integer between 0 to 3, default to 0." expr="" />
      <input type="number" name="Importance" friendlyname="Importance" narrative="Optional. An integer between 0 to 2, default to 1." expr="" />
      <input type="text" name="Subject" friendlyname="Subject" narrative="Optional. Any text entered will override the default forwarding subject." expr="" />
    </inputs>
    <onsuccess>2b73f68c-2463-43e4-9fe3-154af2287905</onsuccess>
    <resource object="MS Outlook Email VBO" action="Forward Email" />
  </stage>
  <stage stageid="7ad8714f-3db3-4e7f-88cb-b867e0a79d96" name="Recover" type="Recover">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="90" y="75" />
    <onsuccess>8243487d-c5ee-4c1b-9a65-c0493779d7aa</onsuccess>
  </stage>
  <stage stageid="9de8e80b-10a7-4c66-8db1-bc9fa063a7de" name="System Exception" type="Exception">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="300" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="8243487d-c5ee-4c1b-9a65-c0493779d7aa" name="capture exception message" type="Calculation">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="195" y="75" />
    <onsuccess>4958a462-a7f7-452c-b8c6-d75691e49f87</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="97a2107b-3580-4aea-a1db-422a5779244f" name="exception" type="Data">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="300" y="75" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4958a462-a7f7-452c-b8c6-d75691e49f87" name="Resume" type="Resume">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="195" y="135" />
    <onsuccess>7115062b-540a-45e3-aecc-15b90aca1b76</onsuccess>
  </stage>
  <stage stageid="7115062b-540a-45e3-aecc-15b90aca1b76" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: We need to know who to send this to. Make sure you enter at least one name.&quot;" />
    <ontrue>2b73f68c-2463-43e4-9fe3-154af2287905</ontrue>
    <onfalse>9de8e80b-10a7-4c66-8db1-bc9fa063a7de</onfalse>
  </stage>
  <stage stageid="7d5e0fd8-1612-4b15-8392-3a05e28c6888" name="Subject" type="Data">
    <loginhibit />
    <display x="-165" y="15" w="150" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Hello World</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="c3fdd7c9-63b0-4e27-8a09-5c4ed70996c3" name="To" type="Data">
    <loginhibit />
    <display x="-165" y="45" w="150" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">placeholder.email@blueprism.com</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="f1e8d0a6-f367-43bb-88e7-a7bb870403b1" name="CC" type="Data">
    <display x="-165" y="75" w="150" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="d3bc1d84-2e3c-4e67-85e1-13c92a57db24" name="BCC" type="Data">
    <display x="-165" y="105" w="150" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">placeholder.email@blueprism.com</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="dcd99fcf-5e0b-40e2-83e5-16c667bde7c0" name="Message" type="Data">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <loginhibit />
    <display x="-195" y="-15" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Hello World</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4a4703d2-523d-4b1e-9a83-1cf1196fd2bd" name="Message" type="Data">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="-195" y="-15" w="150" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Email Forwarded</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b03caf70-aeb0-4418-98d0-16a59c75aa5b" name="Forward Email" type="SubSheet">
    <display x="15" y="0" />
    <onsuccess>b2c2e208-a4a8-4220-9702-e296c244d1c9</onsuccess>
    <processid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</processid>
  </stage>
  <stage stageid="1686a6df-9413-4d6b-998e-fd6baeb01fa1" name="Send Email" type="SubSheetInfo">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <narrative>Saves Email as an .MSG file on the local machine.

Out of Scope: Anything unrelated to saving emails as a file.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="19b2f08c-2f10-4edd-b802-3a010f26d731" name="Start" type="Start">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>eb2de7a9-9334-490e-a888-d77a165bd025</onsuccess>
  </stage>
  <stage stageid="eb2de7a9-9334-490e-a888-d77a165bd025" name="Save Email as File" type="Action">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="text" name="File Path" narrative="Mandatory. The destination file path. Default blank." expr="[File Path]" />
      <input type="text" name="File Name" narrative="Mandatory. The File Name for the stored Email." expr="[File Name]" />
    </inputs>
    <onsuccess>8e944285-bf78-4816-9a46-f1860cb78b10</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Email As File" />
  </stage>
  <stage stageid="8e944285-bf78-4816-9a46-f1860cb78b10" name="Save Email as File" type="Action">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <narrative>No Entry ID provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="&quot;&quot;" />
      <input type="text" name="File Path" narrative="Mandatory. The destination file path. Default blank." expr="[File Path]" />
      <input type="text" name="File Name" narrative="Mandatory. The File Name for the stored Email." expr="[File Name]" />
    </inputs>
    <onsuccess>b7fc1753-0689-4193-aac1-19303419e427</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Email As File" />
  </stage>
  <stage stageid="5ea676da-b609-419e-9f6a-03be2f3d2c06" name="Recover" type="Recover">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="90" y="75" />
    <onsuccess>4654d9ee-dacf-40f7-9773-ebc3f269bd2b</onsuccess>
  </stage>
  <stage stageid="25921c07-c39a-452d-9c63-e6b1f31e3e2f" name="System Exception" type="Exception">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="105" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="4654d9ee-dacf-40f7-9773-ebc3f269bd2b" name="capture exception message" type="Calculation">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="195" y="75" />
    <onsuccess>ef577315-25f9-44d2-b9c2-4f8ecbb4e661</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="a1df7e19-5c20-4d1c-9024-15bf00a3e842" name="exception" type="Data">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="-195" y="75" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ef577315-25f9-44d2-b9c2-4f8ecbb4e661" name="Resume" type="Resume">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="195" y="135" />
    <onsuccess>d33e2bc5-6e62-4bf3-bd9c-517dd809c2d6</onsuccess>
  </stage>
  <stage stageid="d33e2bc5-6e62-4bf3-bd9c-517dd809c2d6" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Could not open the item. Try again.&quot;" />
    <ontrue>10dad20b-69d0-41f5-a411-5b2c75e3998d</ontrue>
    <onfalse>25921c07-c39a-452d-9c63-e6b1f31e3e2f</onfalse>
  </stage>
  <stage stageid="2849e50d-1ebe-4575-8d41-2373179808e6" name="File Path" type="Data">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <narrative>Provide valid file path to store an email.</narrative>
    <display x="-195" y="-15" w="150" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\Users\User Name\Desktop\Outlook VBO\Test Data</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b2c2e208-a4a8-4220-9702-e296c244d1c9" name="Save Email As File" type="SubSheet">
    <display x="15" y="60" />
    <onsuccess>594255e5-a14b-4aac-956f-3edf248857a7</onsuccess>
    <processid>1f0a3efe-125f-4107-8a88-a730edbed5bc</processid>
  </stage>
  <stage stageid="e5e0edae-76a1-4ed3-a801-55b6b1f6c304" name="File Name" type="Data">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Saved Email</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="55f6fef9-d9d6-484e-9863-a014f3b156b4" name="Delete Email" type="SubSheetInfo">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <narrative>Function: Deleting Emails using "Entry ID" as input parameter. 

Out of Scope: Anything unrelated to deleting an email.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="4a369baa-e9f9-4335-8074-d93545eb9f70" name="Start" type="Start">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>a7d72355-3443-4222-a190-e678a8e2d285</onsuccess>
  </stage>
  <stage stageid="6c96d3c3-ed0f-4034-a0e9-8f2cc89b25d8" name="End" type="End">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="a7d72355-3443-4222-a190-e678a8e2d285" name="Delete Email" type="Action">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
    </inputs>
    <onsuccess>33edeb08-93ae-4edf-8db0-d293ea210f6f</onsuccess>
    <resource object="MS Outlook Email VBO" action="Delete Email" />
  </stage>
  <stage stageid="33edeb08-93ae-4edf-8db0-d293ea210f6f" name="Delete Email" type="Action">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <narrative>No Entry ID provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="&quot;&quot;" />
    </inputs>
    <onsuccess>6c96d3c3-ed0f-4034-a0e9-8f2cc89b25d8</onsuccess>
    <resource object="MS Outlook Email VBO" action="Delete Email" />
  </stage>
  <stage stageid="23a1f7a4-c67f-45ef-af63-2639552ffc4d" name="Recover" type="Recover">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="90" y="75" />
    <onsuccess>28a634f2-97c9-40e4-8e25-3784b5610bac</onsuccess>
  </stage>
  <stage stageid="45ceaaac-0f1e-4058-906f-5b958bcdc946" name="System Exception" type="Exception">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="300" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="28a634f2-97c9-40e4-8e25-3784b5610bac" name="capture exception message" type="Calculation">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="195" y="75" />
    <onsuccess>5efa4a7b-099c-4995-ac24-f5950ec3b8d4</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="3f958730-6d73-4302-8c0e-eb17378ca9e9" name="exception" type="Data">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="300" y="75" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5efa4a7b-099c-4995-ac24-f5950ec3b8d4" name="Resume" type="Resume">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="195" y="135" />
    <onsuccess>1a325de3-4c69-4649-9300-7965b2693b77</onsuccess>
  </stage>
  <stage stageid="1a325de3-4c69-4649-9300-7965b2693b77" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Could not open the item. Try again.&quot;" />
    <ontrue>6c96d3c3-ed0f-4034-a0e9-8f2cc89b25d8</ontrue>
    <onfalse>45ceaaac-0f1e-4058-906f-5b958bcdc946</onfalse>
  </stage>
  <stage stageid="4f2a6071-257e-4ffc-94f2-8874f0f876dd" name="Delete Email" type="SubSheet">
    <display x="315" y="330" />
    <onsuccess>444186dd-c5c4-4102-a4b8-64a576c3c547</onsuccess>
    <processid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</processid>
  </stage>
  <stage stageid="1f1f5909-38a3-45ee-8b17-528244dc535e" name="Move Email into Subfolder" type="SubSheetInfo">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <narrative>Function: Moving Emails using the "Entry ID" into specified Subfolders. (Subfolder within Subfolder is now support).

Out of Scope: Anything unrelated to moving an email into a subfolder.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="2d76adb9-3a22-4417-94cc-9bef293e3fe5" name="Start" type="Start">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>01a325b6-f937-465e-ae26-9f9b85090613</onsuccess>
  </stage>
  <stage stageid="2af02578-f80b-44d8-b7cf-821a33763d42" name="End" type="End">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="15" y="390" />
  </stage>
  <stage stageid="01a325b6-f937-465e-ae26-9f9b85090613" name="Move Email to Subfolder" type="Action">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="text" name="Destination Folder" narrative="Mandatory. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Destination Folder.Folder]" />
    </inputs>
    <outputs>
      <output type="text" name="New Entry ID" narrative="Returns the new Entry ID from the Moved Email Object" stage="" />
    </outputs>
    <onsuccess>894f3126-4a18-49d5-bcfd-e18dc9a3be74</onsuccess>
    <resource object="MS Outlook Email VBO" action="Move Email to Inbox Sub Folder" />
  </stage>
  <stage stageid="846a6026-b6a0-4992-81e0-f19c4f1aa5c0" name="Recover" type="Recover">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="90" y="135" />
    <onsuccess>114d55f4-cf7d-474b-8d91-0a86b608cc25</onsuccess>
  </stage>
  <stage stageid="2998cc03-e5b5-4e96-bf57-e6a23c855758" name="System Exception" type="Exception">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="300" y="255" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="114d55f4-cf7d-474b-8d91-0a86b608cc25" name="capture exception message" type="Calculation">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="195" y="135" />
    <onsuccess>85610573-6f3b-4e90-b6ad-441159af27cf</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="3b5a60ee-3235-4ecf-9453-03c0dbbd7c64" name="exception" type="Data">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="300" y="135" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="85610573-6f3b-4e90-b6ad-441159af27cf" name="Resume" type="Resume">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="195" y="195" />
    <onsuccess>7facee26-5935-4d97-9ecf-35c004e73d7b</onsuccess>
  </stage>
  <stage stageid="7facee26-5935-4d97-9ecf-35c004e73d7b" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="195" y="255" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: The message you specified cannot be found.&quot; OR [exception]=&quot;Could not execute code stage because exception thrown by code stage: The attempted operation failed.  An object could not be found.&quot; OR [exception]&lt;&gt;&quot;Could not execute code stage because exception thrown by code stage: The items were copied instead of moved because the original items cannot be deleted. The item cannot be deleted. It was either moved or already deleted, or access was denied.&quot; OR [exception]=&quot;Could not execute code stage because exception thrown by code stage: The items were copied instead of moved because the original items cannot be deleted. The item cannot be deleted. It was either moved or already deleted, or access was denied.&quot;" />
    <ontrue>490fb1a6-c44c-422e-80ce-9a97afefb876</ontrue>
    <onfalse>2998cc03-e5b5-4e96-bf57-e6a23c855758</onfalse>
  </stage>
  <stage stageid="a270258d-706f-4f67-bd7e-673754470836" name="Move Email to Subfolder" type="Action">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="15" y="135" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="text" name="Destination Folder" narrative="Mandatory. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Destination Folder.Folder]" />
    </inputs>
    <outputs>
      <output type="text" name="New Entry ID" narrative="Returns the new Entry ID from the Moved Email Object" stage="" />
    </outputs>
    <onsuccess>490fb1a6-c44c-422e-80ce-9a97afefb876</onsuccess>
    <resource object="MS Outlook Email VBO" action="Move Email to Inbox Sub Folder" />
  </stage>
  <stage stageid="594255e5-a14b-4aac-956f-3edf248857a7" name="Move Email to Inbox Sub Folder" type="SubSheet">
    <display x="315" y="60" />
    <onsuccess>74aa8745-e985-4fc7-aada-8b166668bd76</onsuccess>
    <processid>ba40bcbc-a71e-4af2-b9fa-95541487559a</processid>
  </stage>
  <stage stageid="4f2bf448-2233-4cc3-b19a-3d6997d27269" name="15seconds" type="Note">
    <narrative>Wait for Email to arrive...</narrative>
    <display x="165" y="-75" w="90" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="FF0000" />
    <onsuccess>5ea3f1ee-7b18-40b1-ad4f-c55671d3e061</onsuccess>
  </stage>
  <stage stageid="495bcbf6-831d-4ef9-8581-fa4feccba639" name="Input" type="Block">
    <display x="-240" y="-15" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="11c295ad-40a0-40a4-839c-34938ea3f7a5" name="Attachemts" type="Collection">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <narrative>List of attachments to test (XLSX, DOCX, TXT, BMP)</narrative>
    <display x="-195" y="90" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Path" type="text" description="File path to attachment" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Path" type="text" value="C:\Users\User Name\Desktop\Outlook VBO\Attachments\test.txt" />
      </row>
      <row>
        <field name="Path" type="text" value="C:\Users\User Name\Desktop\Outlook VBO\Attachments\test.docx" />
      </row>
      <row>
        <field name="Path" type="text" value="C:\Users\User Name\Desktop\Outlook VBO\Attachments\Test.bmp" />
      </row>
      <row>
        <field name="Path" type="text" value="C:\Users\User Name\Desktop\Outlook VBO\Attachments\test.xlsx" />
      </row>
      <row>
        <field name="Path" type="text" value="C:\Users\User Name\Desktop\Outlook VBO\Attachments\abc.txt" />
      </row>
      <row>
        <field name="Path" type="text" value="C:\Users\User Name\Desktop\Outlook VBO\Attachments\Testing of attachments with long path\ABCDEFGHIJKLMNOPQRSTUVWXYZ\1234567890 1234567890 1234567890\Test1.bmp" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="58853873-935f-4c5e-b3c7-31e50480d309" name="Loop Attachments" type="LoopStart">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="405" y="15" />
    <onsuccess>5b517559-e7af-4fb9-904c-846bcd81405a</onsuccess>
    <groupid>d87d9eb7-113c-4e2d-8b23-43559a9acda7</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Attachemts</loopdata>
  </stage>
  <stage stageid="12a4f93a-ea26-4f20-bb85-7d5cd0ba9275" name="Loop Attachments" type="LoopEnd">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="405" y="210" />
    <onsuccess>723869cb-12af-4d73-86c9-49541424ee4f</onsuccess>
    <groupid>d87d9eb7-113c-4e2d-8b23-43559a9acda7</groupid>
  </stage>
  <stage stageid="53123e16-b610-4af5-ab96-f6e3a9370161" name="Input" type="Block">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="-270" y="-45" w="150" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="74cac0dc-ee87-45c4-8a43-c72687c787c1" name="Subject Email" type="Collection">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="-195" y="15" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Subject" type="text" description="Subject of Email" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Subject" type="text" value="Hello World" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="6a546ddf-3c42-4946-92cc-6f3d2f26dca0" name="Loop Subject" type="LoopStart">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="15" y="15" />
    <onsuccess>fd2a8664-33d3-4db6-a339-eb31296ef9b0</onsuccess>
    <groupid>f73caa62-297d-4c92-b8a7-237482e022b5</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Subject Email</loopdata>
  </stage>
  <stage stageid="ef28d2f9-0eca-4108-ac65-d930f2f7df73" name="Loop Subject" type="LoopEnd">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="15" y="210" />
    <onsuccess>4dac792e-3920-407c-b34e-6a899c1b0ecd</onsuccess>
    <groupid>f73caa62-297d-4c92-b8a7-237482e022b5</groupid>
  </stage>
  <stage stageid="5f9ddb49-b31f-4e54-9268-e7473c3d97d5" name="To (Email Address)" type="Collection">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="-195" y="45" w="150" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Email Address" type="text" description="Email Address" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Email Address" type="text" value="placeholder.email@blueprism.com" />
      </row>
      <row>
        <field name="Email Address" type="text" value="placeholder.email2@blueprism.com" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="e6e294ab-c058-40e3-95b3-c547e47b09d1" name="Send Email" type="Action">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="795" y="90" />
    <inputs>
      <input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" expr="[To (Email Address).Email Address]" />
      <input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[CC]" />
      <input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[BCC]" />
      <input type="text" name="Subject" narrative="Optional. Any alphanumeric value allowed." expr="&quot;Testing different Email address&quot;" />
      <input type="text" name="Message" narrative="Optional, HTML or plain text" expr="[Message]" />
      <input type="text" name="Attachments" narrative="Optional, Comma-separated file paths. Default blank." expr="&quot;&quot;" />
    </inputs>
    <onsuccess>ade2f2ad-0448-4d15-89d1-1302cac2dcd5</onsuccess>
    <resource object="MS Outlook Email VBO" action="Send Email" />
  </stage>
  <stage stageid="130d916a-6d15-4f67-b069-0c645200d848" name="Exception Scenario (To Email Address)" type="Block">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="690" y="60" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="a6d3151b-f1f7-41d0-ae22-72f19b9ce814" name="Recover" type="Recover">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="885" y="90" />
    <onsuccess>5762aac7-72c3-48d0-b9d5-dda5ac08c603</onsuccess>
  </stage>
  <stage stageid="d5acf5ef-727d-4d22-9de6-fca5b7ecf71a" name="System Exception" type="Exception">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="990" y="270" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="5762aac7-72c3-48d0-b9d5-dda5ac08c603" name="capture exception message" type="Calculation">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="990" y="90" />
    <onsuccess>465a1087-d419-4443-ae1f-13846f9ec25d</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="6048747d-db09-4e02-9db4-615f13aef28e" name="exception" type="Data">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="-195" y="165" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="465a1087-d419-4443-ae1f-13846f9ec25d" name="Resume" type="Resume">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="990" y="150" />
    <onsuccess>38d6597c-d785-4e20-8385-2405fd4cb72a</onsuccess>
  </stage>
  <stage stageid="38d6597c-d785-4e20-8385-2405fd4cb72a" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="990" y="210" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Outlook does not recognize one or more names. &quot;" />
    <ontrue>ade2f2ad-0448-4d15-89d1-1302cac2dcd5</ontrue>
    <onfalse>d5acf5ef-727d-4d22-9de6-fca5b7ecf71a</onfalse>
  </stage>
  <stage stageid="205b69f6-f9c0-49d6-9756-0c9aa85477bd" name="Note1" type="Note">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <narrative>Using "junk" email adrtesses such as "j&amp;(@blurb" </narrative>
    <display x="885" y="15" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="5b517559-e7af-4fb9-904c-846bcd81405a" name="Send Email" type="Action">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="405" y="90" />
    <inputs>
      <input type="text" name="To" narrative="Mandatory. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;" expr="[To (Email Address).Email Address]" />
      <input type="text" name="CC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[CC]" />
      <input type="text" name="BCC" narrative="Optional. Any alphanumeric value allowed. Single Recipient = &quot;Name1@emaill.com&quot;; Multi Recipient = &quot;Name1@emaill.com; Name2@email.com&quot;. Default blank" expr="[BCC]" />
      <input type="text" name="Subject" narrative="Optional. Any alphanumeric value allowed." expr="&quot;Testing different attachments&quot;" />
      <input type="text" name="Message" narrative="Optional, HTML or plain text" expr="[Message]" />
      <input type="text" name="Attachments" narrative="Optional, Comma-separated file paths. Default blank." expr="[Attachemts.Path]" />
    </inputs>
    <onsuccess>12a4f93a-ea26-4f20-bb85-7d5cd0ba9275</onsuccess>
    <resource object="MS Outlook Email VBO" action="Send Email" />
  </stage>
  <stage stageid="58a3e63c-c879-45de-ae26-e446e676df41" name="Exception Scenario (Attachments)" type="Block">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="300" y="60" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="32983fbd-4957-4746-98d5-ce5dc82f4919" name="Recover" type="Recover">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="495" y="90" />
    <onsuccess>153a8a91-5b8d-4626-bd7c-f9b2c6a38ca8</onsuccess>
  </stage>
  <stage stageid="5a4da3f6-4835-4b58-9b5d-3f122e3daa76" name="System Exception" type="Exception">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="600" y="270" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="153a8a91-5b8d-4626-bd7c-f9b2c6a38ca8" name="capture exception message" type="Calculation">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="600" y="90" />
    <onsuccess>20faf644-f076-4f15-846c-7badc3b2f8f6</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="20faf644-f076-4f15-846c-7badc3b2f8f6" name="Resume" type="Resume">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="600" y="150" />
    <onsuccess>c4cea25d-1ef6-46fa-8517-5af285623898</onsuccess>
  </stage>
  <stage stageid="c4cea25d-1ef6-46fa-8517-5af285623898" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="600" y="210" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Cannot find this file. Verify the path and file name are correct.&quot;" />
    <ontrue>12a4f93a-ea26-4f20-bb85-7d5cd0ba9275</ontrue>
    <onfalse>5a4da3f6-4835-4b58-9b5d-3f122e3daa76</onfalse>
  </stage>
  <stage stageid="34756678-d95b-4ff3-9e95-b99caeef5262" name="Note1" type="Note">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <narrative>Extra large attachments added (Valid Exception Mesage)</narrative>
    <display x="105" y="15" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="2755b6f0-4c01-4ff7-b0f2-da69bda1aeb0" name="Loop To Email Address" type="LoopStart">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="795" y="15" />
    <onsuccess>e6e294ab-c058-40e3-95b3-c547e47b09d1</onsuccess>
    <groupid>a4187093-ece2-427e-a24c-9be7bc7c81f5</groupid>
    <looptype>ForEach</looptype>
    <loopdata>To (Email Address)</loopdata>
  </stage>
  <stage stageid="ade2f2ad-0448-4d15-89d1-1302cac2dcd5" name="Loop To Email Address" type="LoopEnd">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="795" y="210" />
    <onsuccess>c72252bf-1ee1-4e1d-a15f-8de9374bb124</onsuccess>
    <groupid>a4187093-ece2-427e-a24c-9be7bc7c81f5</groupid>
  </stage>
  <stage stageid="4dac792e-3920-407c-b34e-6a899c1b0ecd" name="Anchor1" type="Anchor">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="15" y="315" w="10" h="10" />
    <onsuccess>4a62f091-e37a-4c5f-a15a-d8ce6b9bd3be</onsuccess>
  </stage>
  <stage stageid="4a62f091-e37a-4c5f-a15a-d8ce6b9bd3be" name="Anchor2" type="Anchor">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="270" y="315" w="10" h="10" />
    <onsuccess>86c85d97-4749-4510-8ec5-8311db7854eb</onsuccess>
  </stage>
  <stage stageid="86c85d97-4749-4510-8ec5-8311db7854eb" name="Anchor3" type="Anchor">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="270" y="15" w="10" h="10" />
    <onsuccess>58853873-935f-4c5e-b3c7-31e50480d309</onsuccess>
  </stage>
  <stage stageid="723869cb-12af-4d73-86c9-49541424ee4f" name="Anchor1" type="Anchor">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="405" y="315" w="10" h="10" />
    <onsuccess>afd1d6f9-3b56-44db-b732-3896e8928638</onsuccess>
  </stage>
  <stage stageid="afd1d6f9-3b56-44db-b732-3896e8928638" name="Anchor2" type="Anchor">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="660" y="315" w="10" h="10" />
    <onsuccess>0dbdad8c-b423-4573-a472-61bffbc77f01</onsuccess>
  </stage>
  <stage stageid="0dbdad8c-b423-4573-a472-61bffbc77f01" name="Anchor3" type="Anchor">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <display x="660" y="15" w="10" h="10" />
    <onsuccess>2755b6f0-4c01-4ff7-b0f2-da69bda1aeb0</onsuccess>
  </stage>
  <stage stageid="fa8b66ae-3805-4239-97d4-74ab38c0a0ac" name="Note1" type="Note">
    <subsheetid>d8be370f-c0c7-4abc-9a63-b39c63e6f2cc</subsheetid>
    <narrative>No subject is supplied.</narrative>
    <display x="495" y="15" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="37e84d7f-11dc-4eaa-a59f-e6fa71cc6c43" name="Input" type="Block">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-270" y="-30" w="150" h="315" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="d31316a3-5bd8-4891-88d6-7c03544dee78" name="Output" type="Block">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-270" y="315" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="7a5b57c1-b07b-4240-8c0f-fd28fe96a0af" name="Happy Path" type="Block">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-90" y="-105" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="3dc315e1-e8b0-48fa-925d-054266d22f83" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-90" y="90" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="96313ad6-1f36-4ea7-9f06-aac21b01a361" name="Sub Folder" type="Collection">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="0" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Folder" type="text" description="Sub Folder Name" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Folder" type="text" value="Subfolder A" />
      </row>
      <row>
        <field name="Folder" type="text" value="Subfolder B" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="eb800e7b-ecc2-4c14-a451-44c094c70c3c" name="Loop Sub Folder" type="LoopStart">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="15" y="60" />
    <onsuccess>89d80871-43d6-44d2-96be-3e7dafb1d1d9</onsuccess>
    <groupid>8c31d442-a08a-40b3-9365-c6c44891b04d</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Sub Folder</loopdata>
  </stage>
  <stage stageid="c1b63746-24cf-4b7f-b8fc-5b134563339a" name="Loop Sub Folder" type="LoopEnd">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="15" y="300" />
    <onsuccess>5953d113-fb25-4d64-acc9-ed8007163bee</onsuccess>
    <groupid>8c31d442-a08a-40b3-9365-c6c44891b04d</groupid>
  </stage>
  <stage stageid="f6e97ce8-57f3-47cf-8de6-25c346dc7c9a" name="Note1" type="Note">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <narrative>Nested Folder &amp; Empty target folder added.</narrative>
    <display x="105" y="45" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="bbefee88-212c-4a67-ad99-0ecbed0d3388" name="Recover" type="Recover">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="555" y="120" />
    <onsuccess>161b5063-06cd-4420-8aa4-2fab9b0f1c46</onsuccess>
  </stage>
  <stage stageid="41325ec8-3100-43ca-9599-f555577ba661" name="System Exception" type="Exception">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="750" y="240" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="161b5063-06cd-4420-8aa4-2fab9b0f1c46" name="capture exception message" type="Calculation">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="645" y="120" />
    <onsuccess>2f44b0f6-5a4b-43b8-9ede-d5257d1e3d9d</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="2f44b0f6-5a4b-43b8-9ede-d5257d1e3d9d" name="Resume" type="Resume">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="645" y="180" />
    <onsuccess>dad32e19-9e84-4717-ad1b-6fd6ad527e50</onsuccess>
  </stage>
  <stage stageid="dad32e19-9e84-4717-ad1b-6fd6ad527e50" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="645" y="240" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: The attempted operation failed.  An object could not be found.&quot; OR [exception]=&quot;Could not execute code stage because exception thrown by code stage: Condition is not valid.&quot;" />
    <ontrue>8c04bcb1-b411-4f02-9493-836f3630cecf</ontrue>
    <onfalse>41325ec8-3100-43ca-9599-f555577ba661</onfalse>
  </stage>
  <stage stageid="cf259335-3527-4d64-96c9-147fbf88df37" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="360" y="90" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="a464a5c4-391b-49c4-96f5-a799dbdaf071" name="Loop Filter Expression" type="LoopStart">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="465" y="60" />
    <onsuccess>47a896e6-7792-4234-afcd-9874519a05c5</onsuccess>
    <groupid>68d5a695-f3ab-4595-889d-49152c77c893</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Addtional Filter Expression</loopdata>
  </stage>
  <stage stageid="efa434e3-8dcb-4630-afd9-4d9f8199308d" name="Loop Filter Expression" type="LoopEnd">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="465" y="300" />
    <onsuccess>081be00c-c82f-4659-a1f9-e1209e4d46d9</onsuccess>
    <groupid>68d5a695-f3ab-4595-889d-49152c77c893</groupid>
  </stage>
  <stage stageid="eda02ea8-9b06-426d-be00-469a917c0f03" name="Note1" type="Note">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <narrative>Target Folder Empty</narrative>
    <display x="555" y="45" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="5953d113-fb25-4d64-acc9-ed8007163bee" name="Anchor4" type="Anchor">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="345" y="300" w="10" h="10" />
    <onsuccess>974f7c0b-9b66-425f-859d-88b391fb912f</onsuccess>
  </stage>
  <stage stageid="974f7c0b-9b66-425f-859d-88b391fb912f" name="Anchor5" type="Anchor">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="345" y="60" w="10" h="10" />
    <onsuccess>a464a5c4-391b-49c4-96f5-a799dbdaf071</onsuccess>
  </stage>
  <stage stageid="8b01ce67-c027-46ed-982c-32a104e219c3" name="Addtional Filter Expression" type="Collection">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Filter Expression" type="text" description="Provide Filter Expression" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Filter Expression" type="text" value="Hello World" />
      </row>
      <row>
        <field name="Filter Expression" type="text" value="Test (not existing)" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="2dfc1e60-4a24-4822-903d-bb7084ce3faa" name="Happy Path" type="Block">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="bf5008fd-b4c1-4559-b62f-0e8e8260f9d0" name="Happy Path" type="Block">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="d717b5eb-771c-4dbb-8392-8f0c375d118e" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>cedfa4e3-9a80-4fef-a457-639c44c548a0</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="cb5bf0f4-cc77-45c0-a8bb-912380e16051" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>c5f44d7f-11d6-493c-8124-0861e361120a</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="d3183f25-a06e-427f-8c77-4e3f48c63469" name="Happy Path" type="Block">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="57c792ad-3699-4795-a82d-d89fccc7db8b" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>d5d67463-cf8a-49d4-9f8e-0e9713e3d1e0</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="7d703c9b-927e-498c-b6ed-2b2a2a0f309f" name="Happy Path" type="Block">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="7a0cfd0c-662b-409a-8681-75f80799858f" name="Exception Scenario (Entry ID = &quot;&quot;)" type="Block">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="733e6e88-801b-4a4f-92c3-82f65006250b" name="Happy Path" type="Block">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="199b3879-3942-4d07-9c1a-1e3bedd5d4f4" name="Exception Scenario (Entry ID Missing)" type="Block">
    <subsheetid>7ca1fd3b-9ee5-4754-85df-ab1bced27eba</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="aec369a4-dba4-4eba-b926-69744edf9db6" name="Happy Path" type="Block">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="5e69af01-c41d-43ea-8159-27fcc43ff957" name="Exception Scenario (Entry ID Missing)" type="Block">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="-90" y="105" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="56462184-ef2d-4711-b308-6301445cabdd" name="Destination Folder" type="Collection">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="-195" y="-15" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Folder" type="text" description="Sub Folder Name" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Folder" type="text" value="Subfolder A" />
      </row>
      <row>
        <field name="Folder" type="text" value="Subfolder B (not existing)" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="894f3126-4a18-49d5-bcfd-e18dc9a3be74" name="Loop Destination Folder" type="LoopStart">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="15" y="75" />
    <onsuccess>a270258d-706f-4f67-bd7e-673754470836</onsuccess>
    <groupid>bd7571fc-5e20-4268-9c64-4bfb0c1a16a3</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Destination Folder</loopdata>
  </stage>
  <stage stageid="490fb1a6-c44c-422e-80ce-9a97afefb876" name="Loop Destination Folder" type="LoopEnd">
    <subsheetid>ba40bcbc-a71e-4af2-b9fa-95541487559a</subsheetid>
    <display x="15" y="255" />
    <onsuccess>2af02578-f80b-44d8-b7cf-821a33763d42</onsuccess>
    <groupid>bd7571fc-5e20-4268-9c64-4bfb0c1a16a3</groupid>
  </stage>
  <stage stageid="7aa798d1-d628-4115-878b-b8eb4a4567ab" name="Sender Name" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="60" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c963b0ca-5abd-4e90-ac12-58ce8817fdee" name="Sender Email" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="90" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ededd01c-78a3-4b40-aaef-89a5e7c78d3f" name="Message" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="120" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="54fced6b-7eb3-4724-91b7-c6cc5bd17228" name="Subfolder" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="150" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3fe05013-13f1-494e-9ef7-e4c8b2e3547f" name="Received Earliest" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="180" w="150" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d1867f3b-c1b4-425f-a99f-c11b04730494" name="Received Latest" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="210" w="150" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3ef83f4b-4cee-486f-ae0a-e83728859f02" name="Get Received Items (Basic)" type="SubSheetInfo">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <narrative>Get Emails using specific "Filter Expressions" as input parameters. Items can also be retrieved from Sub Folders within the Inbox folder.

Out of Scope: Anything unrelated functions for getting emails from Outlook.</narrative>
    <display x="-195" y="-105" w="150" h="120" />
  </stage>
  <stage stageid="7b855d57-c3f6-4124-a8b4-71ae6bb61040" name="Start" type="Start">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="15" y="-150" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>805a38bf-89ef-42e6-ad4c-84a1a344ea9a</onsuccess>
  </stage>
  <stage stageid="b4aaaf48-e979-4db4-9716-e396174f0ec8" name="End" type="End">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="465" y="345" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
  </stage>
  <stage stageid="4a947b71-6691-4557-abf6-1e41f31c3c64" name="Get Received Items (Advanced)" type="Action">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <narrative>Important: Please create a subfolder and update collection to allow the action to work.</narrative>
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Subfolder]" />
      <input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>2df2ef9c-bfe9-4dbb-b4bd-1a4921683cdc</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Advanced)" />
  </stage>
  <stage stageid="e6354dda-fb19-47f7-a91f-47da7bd40037" name="Recover" type="Recover">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="90" y="105" />
    <onsuccess>4478fc2a-622b-4e6e-b127-b9b7d727872d</onsuccess>
  </stage>
  <stage stageid="bc2208cf-fe93-4fde-9bf4-0f63248c07c9" name="System Exception" type="Exception">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="300" y="225" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="4478fc2a-622b-4e6e-b127-b9b7d727872d" name="capture exception message" type="Calculation">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="195" y="105" />
    <onsuccess>e21fd9d0-6aa7-4a6d-a2f2-5b1213da4aa2</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="38f417e8-d5fb-4329-a3bc-fefbc470459a" name="exception" type="Data">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-195" y="300" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e21fd9d0-6aa7-4a6d-a2f2-5b1213da4aa2" name="Resume" type="Resume">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="195" y="165" />
    <onsuccess>3aaf8767-9321-431f-b512-e99be009946c</onsuccess>
  </stage>
  <stage stageid="3aaf8767-9321-431f-b512-e99be009946c" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="195" y="225" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: The attempted operation failed.  An object could not be found.&quot; OR [exception]=&quot;Could not execute code stage because exception thrown by code stage: Condition is not valid.&quot;" />
    <ontrue>ba108edb-4f3a-48cb-bbe1-7c4737b2312a</ontrue>
    <onfalse>bc2208cf-fe93-4fde-9bf4-0f63248c07c9</onfalse>
  </stage>
  <stage stageid="97652d97-0b72-4daa-84b9-949d540b28e4" name="Get Received Items (Advanced)" type="Action">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <narrative>Define Criteria to Filter for within Subfolder.</narrative>
    <display x="15" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Sub Folder.Folder]" />
      <input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Filter Expression]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>ba108edb-4f3a-48cb-bbe1-7c4737b2312a</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Advanced)" />
  </stage>
  <stage stageid="7386390f-9622-4ba7-8feb-c78389d7c849" name="Item Count" type="Data">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-195" y="240" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a0a63737-faa1-4c7c-a802-d3beaa4e4ed0" name="Input" type="Block">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-270" y="-30" w="150" h="165" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="06a80df3-b596-45a6-8455-d2e04233622c" name="Output" type="Block">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-270" y="150" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="d8d829f6-3722-41f2-bf84-062d91af8330" name="Happy Path" type="Block">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-90" y="-105" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="c47a9c12-6a55-4041-8034-c5cc666f8471" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-90" y="75" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="16028cc9-ce51-4b5e-8b61-1f167e5fe58a" name="Sub Folder" type="Collection">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-195" y="0" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Folder" type="text" description="Sub Folder Name" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Folder" type="text" value="Subfolder A" />
      </row>
      <row>
        <field name="Folder" type="text" value="Subfolder B" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="1dfadbd8-96e0-444a-94d5-c15193b5eeba" name="Loop Sub Folder" type="LoopStart">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="15" y="45" />
    <onsuccess>97652d97-0b72-4daa-84b9-949d540b28e4</onsuccess>
    <groupid>c24f7ebb-12ab-47f7-abaf-af2bfbc66f62</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Sub Folder</loopdata>
  </stage>
  <stage stageid="be0a1f5c-1cd9-4a23-a933-d63e032d0e7c" name="Loop Sub Folder" type="LoopEnd">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="15" y="285" />
    <onsuccess>f8e93a93-1427-49a0-9c5d-2e85b30bfce8</onsuccess>
    <groupid>c24f7ebb-12ab-47f7-abaf-af2bfbc66f62</groupid>
  </stage>
  <stage stageid="58929fb0-e921-465d-91f4-f76342a3ebf6" name="Note1" type="Note">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <narrative>Nested Folder &amp; Empty target folder added.</narrative>
    <display x="105" y="30" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="d63d876b-f122-4b6b-85ef-50007a30481f" name="Recover" type="Recover">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="540" y="105" />
    <onsuccess>47bb5914-6bc5-4c2c-8bdb-890581069fac</onsuccess>
  </stage>
  <stage stageid="63c4c443-6dc0-4ec5-9663-68f1b7159b92" name="System Exception" type="Exception">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="750" y="225" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="47bb5914-6bc5-4c2c-8bdb-890581069fac" name="capture exception message" type="Calculation">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="645" y="105" />
    <onsuccess>50caf5f0-dcbc-4d41-aa12-7e6411971143</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="50caf5f0-dcbc-4d41-aa12-7e6411971143" name="Resume" type="Resume">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="645" y="165" />
    <onsuccess>c6343a4a-4e21-409c-b052-5b680841a131</onsuccess>
  </stage>
  <stage stageid="c6343a4a-4e21-409c-b052-5b680841a131" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="645" y="225" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: The attempted operation failed.  An object could not be found.&quot; OR [exception]=&quot;Could not execute code stage because exception thrown by code stage: Condition is not valid.&quot;" />
    <ontrue>e4beff76-1b54-474a-9ad3-30840367583a</ontrue>
    <onfalse>63c4c443-6dc0-4ec5-9663-68f1b7159b92</onfalse>
  </stage>
  <stage stageid="72967896-9903-4f92-b026-4d50df3ef283" name="Get Received Items (Advanced)" type="Action">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <narrative>Action will look in Inbox for specifed Filter Expression</narrative>
    <display x="465" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Subfolder]" />
      <input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[Addtional Filter Expression.Filter Expression]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>e4beff76-1b54-474a-9ad3-30840367583a</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Advanced)" />
  </stage>
  <stage stageid="ab3d3b8a-ac13-4bde-bd4b-564a7dfdba5d" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="360" y="75" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="eb06a40f-90b7-4b8d-9cff-a0010ad56a16" name="Loop Filter Expression" type="LoopStart">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="465" y="45" />
    <onsuccess>72967896-9903-4f92-b026-4d50df3ef283</onsuccess>
    <groupid>f7d589f1-2cf1-403e-8d63-29105dcff0bd</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Addtional Filter Expression</loopdata>
  </stage>
  <stage stageid="8878b1f7-5e3f-4ac5-ab48-e78bd9ff1072" name="Loop Filter Expression" type="LoopEnd">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="465" y="285" />
    <onsuccess>b4aaaf48-e979-4db4-9716-e396174f0ec8</onsuccess>
    <groupid>f7d589f1-2cf1-403e-8d63-29105dcff0bd</groupid>
  </stage>
  <stage stageid="03d0132c-179f-449e-8cce-9962a25e869b" name="Note1" type="Note">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <narrative>Target Folder Empty</narrative>
    <display x="555" y="30" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="f8e93a93-1427-49a0-9c5d-2e85b30bfce8" name="Anchor4" type="Anchor">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="345" y="285" w="10" h="10" />
    <onsuccess>6266dbbb-4e0c-4477-ae2d-3b01b5ab41c8</onsuccess>
  </stage>
  <stage stageid="6266dbbb-4e0c-4477-ae2d-3b01b5ab41c8" name="Anchor5" type="Anchor">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="345" y="45" w="10" h="10" />
    <onsuccess>eb06a40f-90b7-4b8d-9cff-a0010ad56a16</onsuccess>
  </stage>
  <stage stageid="92b9c0a8-9c1e-41df-a94f-a8478e5a959b" name="Addtional Filter Expression" type="Collection">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Filter Expression" type="text" description="Provide Filter Expression" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Filter Expression" type="text" value="[From]='User Name' AND [unread]=False" />
      </row>
      <row>
        <field name="Filter Expression" type="text" value="Test (Not Working Condition)" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="4cb53629-227d-4e4a-b406-b0ffe08501be" name="Subfolder" type="Data">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-195" y="75" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="437abb5c-7cf9-4c9d-b84f-4bb2dc04947e" name="Filter Expression" type="Data">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-195" y="105" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">[From]='User Name' AND [unread]=False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bbb154e6-2006-4e5c-9f44-f60c8db670f9" name="Entry ID" type="Data">
    <narrative>The Entry ID is the internal Outlook Email ID obtained from one of the 'Get Item' actions in this object.</narrative>
    <display x="-165" y="180" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="b383d83d-1b6f-4663-905d-0e19d13122c1" name="Output" type="Block">
    <display x="-240" y="150" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="62d8d0b4-2c47-4b28-89dc-9b8f46d82524" name="Include Read" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="240" w="150" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="305f8dd9-61d6-46fb-832e-de0dfe83253c" name="Include Unread" type="Data">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="270" w="150" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="47a896e6-7792-4234-afcd-9874519a05c5" name="Get Received Items (Advanced)" type="Action">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <narrative>Define Criteria to Filter for within Subfolder.</narrative>
    <display x="465" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Sender Name" narrative="Optional. The From display name, which might be a name (eg John Smith) or email address (eg admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the From field." expr="[Sender Name]" />
      <input type="text" name="Sender Email" narrative="Optional. The sender email address." expr="[Sender Email]" />
      <input type="datetime" name="Received Earliest" narrative="Optional. The earliest date to search from." expr="[Received Earliest]" />
      <input type="datetime" name="Received Latest" narrative="Optional. The latest date to search to." expr="[Received Latest]" />
      <input type="text" name="Subject" narrative="Optional. Asterisk wildcard permitted, eg *Project Update for 'Project Update', 'RE: Project Update' etc." expr="[Addtional Filter Expression.Filter Expression]" />
      <input type="text" name="Message" narrative="Optional. Asterisk wildcard permitted, eg *Blue Prism*" expr="[Message]" />
      <input type="flag" name="Include Read" narrative="Optional, default True" expr="[Include Read]" />
      <input type="flag" name="Include Unread" narrative="Optional, default True" expr="[Include Unread]" />
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>8c04bcb1-b411-4f02-9493-836f3630cecf</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Basic)" />
  </stage>
  <stage stageid="ea955154-730a-4794-b3a8-b11fc3ab26d7" name="Get Received Items (Advanced)" type="SubSheet">
    <display x="450" y="15" w="90" h="60" />
    <onsuccess>6eb42baa-e14a-4db7-ad00-db98daacb70e</onsuccess>
    <processid>77187256-2f3d-4550-af78-386374256168</processid>
  </stage>
  <stage stageid="9f3bae38-2a53-4655-896e-face95c2e1da" name="Get Received Items (Basic)" type="SubSheetInfo">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <narrative>Get Emails using specific "Filter Expressions" as input parameters. Items can also be retrieved from Sub Folders within the Inbox folder.

Out of Scope: Anything unrelated functions for getting emails from Outlook.</narrative>
    <display x="-195" y="-105" w="150" h="120" />
  </stage>
  <stage stageid="2bda7616-8a91-4f3b-ba24-0a4165ce720a" name="Start" type="Start">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="15" y="-150" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>71828ba4-9360-44bb-8c30-4105a5987eb1</onsuccess>
  </stage>
  <stage stageid="cfb0484f-1b07-4622-9261-6de7eb7c6b0a" name="End" type="End">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="465" y="345" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
  </stage>
  <stage stageid="1f833069-f55f-4ac6-84ca-018e5ec8c59f" name="Get Received Items (Expert)" type="Action">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <narrative>Important: Please create a subfolder and update collection to allow the action to work.</narrative>
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Subfolder]" />
      <input type="text" name="DASL Query" narrative="Mandatory. A filter using a DASL query, eg @SQL=urn:schemas:httpmail:fromname='Mike Colleague' AND (urn:schemas:httpmail:subject LIKE '%Important%' OR urn:schemas:httpmail:subject LIKE '%Urgent%')" expr="[DASL Query]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>fbd1abfd-aa49-4ee5-aedf-d744a71e615d</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Expert)" />
  </stage>
  <stage stageid="598f6e3f-c411-4092-a234-a4c08a6f5978" name="Recover" type="Recover">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="105" y="105" />
    <onsuccess>54871fc4-b7bc-4c72-a368-4e6db11765e0</onsuccess>
  </stage>
  <stage stageid="18672c7d-31ee-4e74-bb56-eb0e041cac4e" name="System Exception" type="Exception">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="300" y="225" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="54871fc4-b7bc-4c72-a368-4e6db11765e0" name="capture exception message" type="Calculation">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="195" y="105" />
    <onsuccess>f04af544-13e4-4be9-ad4e-db8ce2aaa614</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="7b0328e8-3946-4b50-aada-c925d5916866" name="exception" type="Data">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-195" y="300" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f04af544-13e4-4be9-ad4e-db8ce2aaa614" name="Resume" type="Resume">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="195" y="165" />
    <onsuccess>c97a2686-983e-42af-bd77-accbb19a0aa4</onsuccess>
  </stage>
  <stage stageid="c97a2686-983e-42af-bd77-accbb19a0aa4" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="195" y="225" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: The attempted operation failed.  An object could not be found.&quot; OR [exception]=&quot;Could not execute code stage because exception thrown by code stage: Condition is not valid.&quot;" />
    <ontrue>8037977e-027e-496b-a1e4-eb627f4605c2</ontrue>
    <onfalse>18672c7d-31ee-4e74-bb56-eb0e041cac4e</onfalse>
  </stage>
  <stage stageid="85bb40d4-f41b-47a7-81bb-0dd7ea1d5a76" name="Get Received Items (Expert)" type="Action">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <narrative>Define Criteria to Filter for within Subfolder.</narrative>
    <display x="15" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Sub Folder.Folder]" />
      <input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[DASL Query]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>8037977e-027e-496b-a1e4-eb627f4605c2</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Advanced)" />
  </stage>
  <stage stageid="676134c6-c803-4589-ad10-03a095ebddbc" name="Item Count" type="Data">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-195" y="240" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="842abaf9-007f-4b63-83cc-680dd3b15022" name="Input" type="Block">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-270" y="-30" w="150" h="165" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="796acfc2-0b44-4982-8a24-61f518243d58" name="Output" type="Block">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-270" y="150" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="97d09ef2-1f5f-463c-9bb7-fef272cc0f9a" name="Happy Path" type="Block">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-90" y="-105" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="f70077d5-5773-4661-9e77-864341a5dac0" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-90" y="75" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="621a17dd-5280-416f-8d24-25494bc0bd9e" name="Sub Folder" type="Collection">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-195" y="0" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Folder" type="text" description="Sub Folder Name" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Folder" type="text" value="Subfolder A" />
      </row>
      <row>
        <field name="Folder" type="text" value="Subfolder B" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="0e68becc-c3d9-4def-8ad1-0f144ceafdd9" name="Loop Sub Folder" type="LoopStart">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="15" y="45" />
    <onsuccess>85bb40d4-f41b-47a7-81bb-0dd7ea1d5a76</onsuccess>
    <groupid>3e5f8af3-b6dd-4408-819c-c0ba811d575a</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Sub Folder</loopdata>
  </stage>
  <stage stageid="e8634f8f-d290-44c1-adaf-7a7911c40bf6" name="Loop Sub Folder" type="LoopEnd">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="15" y="285" />
    <onsuccess>affb44f4-f68d-4eee-82cd-fdd58ef9dce6</onsuccess>
    <groupid>3e5f8af3-b6dd-4408-819c-c0ba811d575a</groupid>
  </stage>
  <stage stageid="15150012-4d0c-4e1f-851e-9460948f8aeb" name="Note1" type="Note">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <narrative>Nested Folder &amp; Empty target folder added.</narrative>
    <display x="105" y="30" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="1c77b229-6862-4b28-b305-d72203a7245f" name="Recover" type="Recover">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="555" y="105" />
    <onsuccess>f75a79e6-5233-4a75-8b13-aeb6db98beeb</onsuccess>
  </stage>
  <stage stageid="24437f50-62de-447e-af92-6d77a44c87ab" name="System Exception" type="Exception">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="750" y="225" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="f75a79e6-5233-4a75-8b13-aeb6db98beeb" name="capture exception message" type="Calculation">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="645" y="105" />
    <onsuccess>92a6286b-249e-43fa-9963-4faf59098782</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="92a6286b-249e-43fa-9963-4faf59098782" name="Resume" type="Resume">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="645" y="165" />
    <onsuccess>ee93f080-16f3-4853-9013-5cfe3957b138</onsuccess>
  </stage>
  <stage stageid="ee93f080-16f3-4853-9013-5cfe3957b138" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="645" y="225" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: The attempted operation failed.  An object could not be found.&quot; OR [exception]=&quot;Could not execute code stage because exception thrown by code stage: Condition is not valid.&quot;" />
    <ontrue>6e132db0-9360-4d2b-884f-b87aabfde30f</ontrue>
    <onfalse>24437f50-62de-447e-af92-6d77a44c87ab</onfalse>
  </stage>
  <stage stageid="ec15158b-5fc0-428b-9f03-dd4ae6c09342" name="Get Received Items (Advanced)" type="Action">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <narrative>Action will look in Inbox for specifed Filter Expression</narrative>
    <display x="465" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Sub Folder" narrative="Optional. Any alphanumeric value valid. The Subfolder in the Inbox, eg. Subfolder A needs to be declared as &quot;Subfolder A&quot;. A Nested Subfolder eg. Subfolder B in Subfolder A, needs to be declared as &quot;Subfolder A\Subfolder B&quot;." expr="[Subfolder]" />
      <input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [From]='Mike Colleague' AND [unread] = True" expr="[DASL Query (Collection).Filter Expression]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>6e132db0-9360-4d2b-884f-b87aabfde30f</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Received Items (Advanced)" />
  </stage>
  <stage stageid="3ac20409-1e3a-4f57-8f35-72296165495f" name="Exception Scenario (Subfolder)" type="Block">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="360" y="75" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="02b5cdd6-5bad-4ee8-8a99-87a84c198fd3" name="Loop Filter Expression" type="LoopStart">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="465" y="45" />
    <onsuccess>ec15158b-5fc0-428b-9f03-dd4ae6c09342</onsuccess>
    <groupid>9ccbbaab-f5f6-4a20-8888-beb6b07c33ab</groupid>
    <looptype>ForEach</looptype>
    <loopdata>DASL Query (Collection)</loopdata>
  </stage>
  <stage stageid="953dff52-340a-418a-9829-b1351e2d2e7f" name="Loop Filter Expression" type="LoopEnd">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="465" y="285" />
    <onsuccess>cfb0484f-1b07-4622-9261-6de7eb7c6b0a</onsuccess>
    <groupid>9ccbbaab-f5f6-4a20-8888-beb6b07c33ab</groupid>
  </stage>
  <stage stageid="a85cd963-61b1-43dc-b636-76a45ec0a13f" name="Note1" type="Note">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <narrative>Target Folder Empty</narrative>
    <display x="555" y="30" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="affb44f4-f68d-4eee-82cd-fdd58ef9dce6" name="Anchor4" type="Anchor">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="345" y="285" w="10" h="10" />
    <onsuccess>ed4eec7f-34c3-4fa5-9540-e4d2adeed55e</onsuccess>
  </stage>
  <stage stageid="ed4eec7f-34c3-4fa5-9540-e4d2adeed55e" name="Anchor5" type="Anchor">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="345" y="45" w="10" h="10" />
    <onsuccess>02b5cdd6-5bad-4ee8-8a99-87a84c198fd3</onsuccess>
  </stage>
  <stage stageid="627fa608-4f5d-44e9-b3d9-bd6583ad96cd" name="DASL Query (Collection)" type="Collection">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Filter Expression" type="text" description="Provide Filter Expression" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Filter Expression" type="text" value="@SQL=urn:schemas:httpmail:fromname='User Name'" />
      </row>
      <row>
        <field name="Filter Expression" type="text" value="@SQL=urn:schemas:httpmail:fromname='User Name' AND urn:schemas:httpmail:subject LIKE '%Hello World%'" />
      </row>
      <row>
        <field name="Filter Expression" type="text" value="Test (Not working Condition)" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="10e22fda-4691-4c81-bc6f-32425a1805c0" name="Subfolder" type="Data">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-195" y="75" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="547b86bb-9e6b-49cc-96cb-6fd278eda729" name="DASL Query" type="Data">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-195" y="105" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">@SQL=urn:schemas:httpmail:fromname='User Name'</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c85daecf-6dda-48b8-8076-537f15aea7a4" name="Get Received Items Options" type="Block">
    <narrative>This pages can be used for testing the additional filter expression actions of the VBO (Advanced/Export Mode).</narrative>
    <display x="390" y="-120" w="120" h="255" />
    <font family="Segoe UI" size="10" style="Regular" color="FFFF99" />
  </stage>
  <stage stageid="6eb42baa-e14a-4db7-ad00-db98daacb70e" name="Get Received Items (Expert)" type="SubSheet">
    <display x="450" y="90" w="90" h="60" />
    <onsuccess>6d0c139e-b082-40be-a9d0-1fa99449c779</onsuccess>
    <processid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</processid>
  </stage>
  <stage stageid="ebac8aa9-c254-44fc-ab9c-1befb1be6939" name="Note2" type="Note">
    <narrative>Just connect as you like</narrative>
    <display x="450" y="-135" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="FF0000" />
  </stage>
  <stage stageid="25244a21-a40e-4d5b-8759-34bdd3dee5b6" name="Mark Email as Read" type="SubSheetInfo">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <narrative>Specific email to be marked "Read".

Out of scope: Mark emails as unread.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="119c10f4-5eeb-47df-b57b-9abd232fb857" name="Start" type="Start">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>87f2e98c-2949-4614-8ded-b38d642d657f</onsuccess>
  </stage>
  <stage stageid="18f03756-2c53-4047-a6db-3890a7bc9877" name="End" type="End">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="87f2e98c-2949-4614-8ded-b38d642d657f" name="Mark as Read" type="Action">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
    </inputs>
    <onsuccess>1579053a-fa3e-4eb1-b46f-79deb9691549</onsuccess>
    <resource object="MS Outlook Email VBO" action="Mark Email As Read" />
  </stage>
  <stage stageid="1579053a-fa3e-4eb1-b46f-79deb9691549" name="Mark as Read" type="Action">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <narrative>No Entry ID provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="&quot;&quot;" />
    </inputs>
    <onsuccess>18f03756-2c53-4047-a6db-3890a7bc9877</onsuccess>
    <resource object="MS Outlook Email VBO" action="Mark Email As Read" />
  </stage>
  <stage stageid="310d51f5-1f79-4ddb-ad81-a88098e70424" name="Recover" type="Recover">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="90" y="75" />
    <onsuccess>2db786a7-6c1d-4e1b-80a0-6c5380e70de1</onsuccess>
  </stage>
  <stage stageid="b75cb814-6c4f-4fa4-bc5d-9c213255e0ce" name="System Exception" type="Exception">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="300" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="2db786a7-6c1d-4e1b-80a0-6c5380e70de1" name="capture exception message" type="Calculation">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="195" y="75" />
    <onsuccess>e22efbbb-17d7-4e59-890f-accf397269db</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="702f1387-018e-47aa-ac42-9d1ccb9c6f8d" name="exception" type="Data">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="300" y="75" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e22efbbb-17d7-4e59-890f-accf397269db" name="Resume" type="Resume">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="195" y="135" />
    <onsuccess>faceaee3-fff0-41fe-9614-71a50aeed77e</onsuccess>
  </stage>
  <stage stageid="faceaee3-fff0-41fe-9614-71a50aeed77e" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Could not open the item. Try again.&quot;" />
    <ontrue>18f03756-2c53-4047-a6db-3890a7bc9877</ontrue>
    <onfalse>b75cb814-6c4f-4fa4-bc5d-9c213255e0ce</onfalse>
  </stage>
  <stage stageid="0b8ae6d9-05d7-4184-92cb-48a773ff8789" name="Happy Path" type="Block">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="9a57725f-b078-4c81-a122-908ee87a0a5f" name="Exception Scenario (Entry ID Missing)" type="Block">
    <subsheetid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="ee08ea97-da64-4a45-8cca-ab4ebb436d15" name="MarkEmail as Read" type="SubSheetInfo">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <narrative>Specific email to be marked "Unread".

Out of scope: Mark emails as read.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="4a74e6c0-60b5-486c-9d27-de9aa9af9f14" name="Start" type="Start">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>4c2f9e2f-20b0-49d0-ad29-8eb41b274206</onsuccess>
  </stage>
  <stage stageid="eff56bff-103d-4671-b0c7-9d0894a80939" name="End" type="End">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="4c2f9e2f-20b0-49d0-ad29-8eb41b274206" name="Mark as Unread" type="Action">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
    </inputs>
    <onsuccess>93f8254f-7a55-40a2-8871-596a68f6d477</onsuccess>
    <resource object="MS Outlook Email VBO" action="Mark Email As Unread" />
  </stage>
  <stage stageid="93f8254f-7a55-40a2-8871-596a68f6d477" name="Mark as Unread" type="Action">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <narrative>No Entry ID provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="&quot;&quot;" />
    </inputs>
    <onsuccess>eff56bff-103d-4671-b0c7-9d0894a80939</onsuccess>
    <resource object="MS Outlook Email VBO" action="Mark Email As Unread" />
  </stage>
  <stage stageid="81683019-21de-41a1-8ecf-ae9aa674c5f5" name="Recover" type="Recover">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="90" y="75" />
    <onsuccess>edda50f6-0d8b-4d18-bab6-3686d4deebff</onsuccess>
  </stage>
  <stage stageid="c6645822-a804-4a23-96c1-9c6122b52259" name="System Exception" type="Exception">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="300" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="edda50f6-0d8b-4d18-bab6-3686d4deebff" name="capture exception message" type="Calculation">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="195" y="75" />
    <onsuccess>22a7a589-7fef-465a-954f-0ff4c004de08</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="44115f9e-a465-4c14-9102-c3ac7e653fad" name="exception" type="Data">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="300" y="75" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="22a7a589-7fef-465a-954f-0ff4c004de08" name="Resume" type="Resume">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="195" y="135" />
    <onsuccess>eba15c97-5945-492b-b65e-96f6219fdd8d</onsuccess>
  </stage>
  <stage stageid="eba15c97-5945-492b-b65e-96f6219fdd8d" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Could not open the item. Try again.&quot;" />
    <ontrue>eff56bff-103d-4671-b0c7-9d0894a80939</ontrue>
    <onfalse>c6645822-a804-4a23-96c1-9c6122b52259</onfalse>
  </stage>
  <stage stageid="8fc26f8b-e485-4703-b21c-9c49de2b5763" name="Happy Path" type="Block">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="b4651449-2751-4c99-a71a-b44797b45583" name="Exception Scenario (Entry ID Missing)" type="Block">
    <subsheetid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="95be102c-b8ed-4775-9bf2-74dc1ad43f3a" name="Mark Email as Read" type="SubSheet">
    <display x="165" y="150" />
    <onsuccess>f5b5559b-ed2b-46d2-9c6a-d0104d1dd5e0</onsuccess>
    <processid>dcc2e6bf-8a1f-49ec-8242-e46328f354eb</processid>
  </stage>
  <stage stageid="f5b5559b-ed2b-46d2-9c6a-d0104d1dd5e0" name="Mark Email as Unread" type="SubSheet">
    <display x="15" y="150" />
    <onsuccess>9a793594-8a76-436c-960d-8768bccfcc7f</onsuccess>
    <processid>51a7c6b5-f6b4-46da-b5df-c938d98aafeb</processid>
  </stage>
  <stage stageid="43446c18-5e69-4ca8-a5ce-11888cc87900" name="Get Received Items (Basic)" type="SubSheetInfo">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <narrative>Get Emails using specific "Filter Expressions" as input parameters. Items can also be retrieved from Sub Folders within the Inbox folder.

Out of Scope: Anything unrelated functions for getting emails from Outlook.</narrative>
    <display x="-195" y="-105" w="150" h="120" />
  </stage>
  <stage stageid="6bf6887c-c0a2-4e6d-a914-0616307c9ec2" name="Start" type="Start">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="15" y="-150" />
    <onsuccess>1567b5a1-75d5-4fc4-b608-c5ebf57f2782</onsuccess>
  </stage>
  <stage stageid="1567b5a1-75d5-4fc4-b608-c5ebf57f2782" name="Get Sent Items (Basic)" type="Action">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Subject" narrative="Optional. Asterisk wildcard permitted, eg *Project Update for 'Project Update', 'RE: Project Update' etc." expr="[Subject]" />
      <input type="text" name="Message" narrative="Optional. Asterisk wildcard permitted, eg *Blue Prism*" expr="[Message]" />
      <input type="text" name="Sent To" narrative="Optional. The To display name, which might be a name (eg John Smith), an email address (eg admin@client.com), or a list (eg John Smith; Ann Jones; admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the To field." expr="[Sent To]" />
      <input type="text" name="Copied To" narrative="Optional. The CC display name, which might be a name (eg John Smith), an email address (eg admin@client.com), or a semi-colon separated list (eg John Smith; Ann Jones; admin@client.com). Asterisk wildcard permitted, eg *John Smith* for any mail where the text 'John Smith' appears in the To field." expr="[Copied To]" />
      <input type="datetime" name="Sent Earliest" narrative="Optional. The earliest date to search from." expr="[Sent Earliest]" />
      <input type="datetime" name="Sent Latest" narrative="Optional. The latest date to search to." expr="[Sent Latest]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>71eea843-f379-407a-b470-b0d621440325</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Sent Items (Basic)" />
  </stage>
  <stage stageid="b7d05e33-d27d-4038-8035-03023d6a0937" name="Item Count" type="Data">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-195" y="255" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ea1d57d3-da6f-41db-b2d4-0a6767a24b4d" name="Input" type="Block">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-270" y="-30" w="150" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="033df05f-1b0c-4c06-83d3-7e8dd57c36f5" name="Output" type="Block">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-270" y="165" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="0fea4d62-6b5b-4320-8904-5d5539fd8743" name="Happy Path" type="Block">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-90" y="-105" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="e2458d4c-88b7-4f3b-802e-779742ea067c" name="Sent To" type="Data">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-195" y="0" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="da432ac4-5773-4af1-b6e1-45362f83b7c6" name="Copied To" type="Data">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="10c483c5-fa76-43fb-af1c-c6dabf952603" name="Sent Earliest" type="Data">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-195" y="60" w="150" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9f7e8998-06b6-4341-afe4-5800be21e0bd" name="Sent Latest" type="Data">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-195" y="90" w="150" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bc238470-31ff-4d2f-b7b0-690ad9b2815f" name="End1" type="End">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="e42df2b2-7738-4e92-aad4-117e52812537" name="Message" type="Data">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-195" y="120" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="47519401-151d-4d73-b32f-3b3f9ccbf2a4" name="Get Sent Items (Basic)" type="SubSheet">
    <display x="450" y="255" w="90" h="60" />
    <onsuccess>5c1e9b04-3563-4978-b49a-c62d98cb845d</onsuccess>
    <processid>78c10bdb-81bd-40d0-9248-9e29b04ab431</processid>
  </stage>
  <stage stageid="fcdc2bb7-61da-42ca-a54e-971e833c3043" name="Get Sent Items Options" type="Block">
    <narrative>This pages can be used for testing the additional filter expression actions of the VBO (Advanced/Export Mode).</narrative>
    <display x="390" y="195" w="120" h="255" />
    <font family="Segoe UI" size="10" style="Regular" color="CC99FF" />
  </stage>
  <stage stageid="7a8cef4f-f1f8-462b-991c-09c305c391ab" name="Note2" type="Note">
    <narrative>Just connect as you like</narrative>
    <display x="450" y="180" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="FF0000" />
  </stage>
  <stage stageid="71eea843-f379-407a-b470-b0d621440325" name="Note3" type="Note">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <narrative>Action filters through the "Sent Email" Folder, hence no Subfolder applies.

No Exception (negative testing) can be applied due to limitation of functions of the action itself by MS Outlook.</narrative>
    <display x="15" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
    <onsuccess>bc238470-31ff-4d2f-b7b0-690ad9b2815f</onsuccess>
  </stage>
  <stage stageid="58bc2435-2c11-4b29-a463-b0fbd26c50d1" name="Get Received Items (Basic)" type="SubSheetInfo">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <narrative>Get Emails using specific "Filter Expressions" as input parameters. Items can also be retrieved from Sub Folders within the Inbox folder.

Out of Scope: Anything unrelated functions for getting emails from Outlook.</narrative>
    <display x="-195" y="-105" w="150" h="120" />
  </stage>
  <stage stageid="0b7cf3bf-2f12-4eb9-ba90-bee6d66a7f4d" name="Start" type="Start">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="15" y="-150" />
    <onsuccess>a0ebdebc-eaeb-4a3e-bd00-b81e31affa35</onsuccess>
  </stage>
  <stage stageid="b81ac810-eb49-4e32-9b22-9f516fd2bf59" name="Get Sent Items (Advanced)" type="Action">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Filter Expression" narrative="Mandatory. A MAPI filter, eg [To]='Mike Colleague' AND [SentOn]&gt;='15 January 2018 09:00' AND [SentOn]&lt;='19 January 2018 17:00'" expr="[Filter Expression]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>85a7b532-c2be-457a-949c-d5c1013a396a</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Sent Items (Advanced)" />
  </stage>
  <stage stageid="de38f678-c4b3-42af-9f22-178846bc4d3d" name="exception" type="Data">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="-195" y="195" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d3de4feb-4ea9-4327-819c-21b17b6f8fae" name="Item Count" type="Data">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="-195" y="135" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8bd88334-23f4-4112-bf0e-76ac491c3372" name="Input" type="Block">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="-270" y="-30" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="dd099f5c-40fc-4f43-9a70-a3407a74515b" name="Output" type="Block">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="-270" y="45" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="f0ce85dd-edc6-413a-887c-609af787450b" name="Happy Path" type="Block">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="-90" y="-105" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="dcd07a63-041b-4bcf-a074-d565dbe737a9" name="End1" type="End">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="85a7b532-c2be-457a-949c-d5c1013a396a" name="Note3" type="Note">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <narrative>Action filters through the "Sent Email" Folder, hence no Subfolder applies.

No Exception (negative testing) can be applied due to limitation of functions of the action itself by MS Outlook.</narrative>
    <display x="15" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
    <onsuccess>dcd07a63-041b-4bcf-a074-d565dbe737a9</onsuccess>
  </stage>
  <stage stageid="1fbb6077-0787-4333-aaa3-940ded898345" name="Get Received Items (Basic)" type="SubSheetInfo">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <narrative>Get Emails using specific "Filter Expressions" as input parameters. Items can also be retrieved from Sub Folders within the Inbox folder.

Out of Scope: Anything unrelated functions for getting emails from Outlook.</narrative>
    <display x="-195" y="-105" w="150" h="120" />
  </stage>
  <stage stageid="e3733355-237d-48bc-8436-e19ec962369c" name="Start" type="Start">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="15" y="-150" />
    <onsuccess>ca9f6d18-1df9-4c58-8a95-07859d4fadd7</onsuccess>
  </stage>
  <stage stageid="03274add-6bbf-42b0-9ad3-84cd08262ff1" name="Get Sent Items (Expert)" type="Action">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="DASL Query" narrative="Mandatory. A filter using a DASL query, eg @SQL=urn:schemas:httpmail:displayto='Mike Colleague' AND (urn:schemas:httpmail:subject LIKE '%Important%' OR urn:schemas:httpmail:subject LIKE '%Urgent%')" expr="[DASL Query]" />
    </inputs>
    <outputs>
      <output type="collection" name="Items" narrative="Details of items matching the filter" stage="Items" />
      <output type="number" name="Item Count" narrative="Number of items matching the filter" stage="Item Count" />
    </outputs>
    <onsuccess>fd4013ff-4604-4964-9ce3-944d97164425</onsuccess>
    <resource object="MS Outlook Email VBO" action="Get Sent Items (Expert)" />
  </stage>
  <stage stageid="6d86d721-b076-4920-a0bd-9f6674f23edb" name="exception" type="Data">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="-195" y="195" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="85e77aad-4243-45c2-b91b-7a0361433c32" name="Item Count" type="Data">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="-195" y="135" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="765ca3f8-fd5f-4262-bf9d-a3a30b7e4602" name="Input" type="Block">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="-270" y="-30" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="13abce31-536c-4210-a075-43b15de83720" name="Output" type="Block">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="-270" y="45" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="9e2e41f6-8570-4e1b-8c40-d421078cee66" name="Happy Path" type="Block">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="-90" y="-105" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="f6a7232c-7aae-4dd9-b4e3-53fa370b1073" name="End1" type="End">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="7311bf2c-43c3-406d-8fa1-002c2d9f852d" name="Predefined Test Scenarios" type="Block">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <narrative>You can use these scenarios to test the action by connection the collection with the Action.</narrative>
    <display x="195" y="-180" w="120" h="75" />
    <font family="Segoe UI" size="10" style="Regular" color="C0C0C0" />
  </stage>
  <stage stageid="fd4013ff-4604-4964-9ce3-944d97164425" name="Note3" type="Note">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <narrative>Action filters through the "Sent Email" Folder, hence no Subfolder applies.

No Exception (negative testing) can be applied due to limitation of functions of the action itself by MS Outlook.</narrative>
    <display x="15" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
    <onsuccess>f6a7232c-7aae-4dd9-b4e3-53fa370b1073</onsuccess>
  </stage>
  <stage stageid="a0ebdebc-eaeb-4a3e-bd00-b81e31affa35" name="Test1" type="MultipleCalculation">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <loginhibit />
    <display x="240" y="-135" />
    <font family="Segoe UI" size="10" style="Regular" color="FF00FF" />
    <onsuccess>b81ac810-eb49-4e32-9b22-9f516fd2bf59</onsuccess>
    <steps>
      <calculation expression="&quot;[Subject]='Hello World'&quot;" stage="Filter Expression" />
    </steps>
  </stage>
  <stage stageid="d4ad93e5-5084-4a1e-bc0e-4835a4ceb902" name="Predefined Test Scenarios" type="Block">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <narrative>You can use these scenarios to test the action by connection the collection with the Action.</narrative>
    <display x="180" y="-180" w="120" h="75" />
    <font family="Segoe UI" size="10" style="Regular" color="C0C0C0" />
  </stage>
  <stage stageid="6bb75d06-0156-47bc-8ebd-d629d12c17a9" name="Filter Expression" type="Data">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="-195" y="0" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">[To]='User Name' AND [Subject]='Hello World'</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ca9f6d18-1df9-4c58-8a95-07859d4fadd7" name="Test1" type="MultipleCalculation">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <loginhibit />
    <display x="255" y="-135" />
    <font family="Segoe UI" size="10" style="Regular" color="FF00FF" />
    <onsuccess>03274add-6bbf-42b0-9ad3-84cd08262ff1</onsuccess>
    <steps>
      <calculation expression="&quot;@SQL=urn:schemas:httpmail:subject LIKE '%Hello World%'&quot;" stage="DASL Query" />
    </steps>
  </stage>
  <stage stageid="e181ee24-c243-4d1f-978c-884c040d25c7" name="DASL Query" type="Data">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="-195" y="0" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">@SQL=urn:schemas:httpmail:subject LIKE '%Hello World%'</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5c1e9b04-3563-4978-b49a-c62d98cb845d" name="Get Sent Items (Advanced)" type="SubSheet">
    <display x="450" y="330" w="90" h="60" />
    <onsuccess>e793a602-2500-4619-b3d1-711fbfb52b92</onsuccess>
    <processid>0a1d9670-85c2-42a0-9256-edfa4d088212</processid>
  </stage>
  <stage stageid="e793a602-2500-4619-b3d1-711fbfb52b92" name="Get Sent Items (Expert)" type="SubSheet">
    <display x="450" y="405" w="90" h="60" />
    <onsuccess>4f2a6071-257e-4ffc-94f2-8874f0f876dd</onsuccess>
    <processid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</processid>
  </stage>
  <stage stageid="63b117e7-f3b6-4103-8a0b-12412f24db79" name="Note4" type="Note">
    <narrative>QA Process designed to test the following.

Send Email - using the MS Outlook API
Forwarding Email - Forwaring one specific Email (Entry ID)
Reply to Email - reply to one specific Email (Entry ID)
Reply All to Email - replying to all Email recipients of one specifc Email (Entry ID)
Delete Email - Deleting an email
Mark Email as Read - Mark an email as read
Mark Email as Unread - Mark an email as unread
Save Email as File - Saving an email as a *.msg file
Move Email to Inbox Sub Folder - Move an email into a subfolder of the Inbox Folder

Get Received Items (Basic) - on Inbox Folder/Subfolder using "Pre-defined filter criterias"
Get Received Items (Advanced) - on Inbox Folder/Subfolder using "Specifc filter expression"
Get Received Items (Expert) - on Inbox Folder/Subfolder using "DASL filter string"

Get Sent Items (Basic) - on Sent Folder using "Pre-defined filter criterias"
Get Sent Items (Advanced) - on Sent Folder using "Specifc filter expression"
Get Sent Items (Expert) - on Sent Folder using "DASL filter expression"</narrative>
    <display x="-450" y="-30" w="360" h="240" />
  </stage>
  <stage stageid="c25bba21-ab6d-4621-9a06-b14e953bd9ad" name="Anchor6" type="Anchor">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="15" y="240" w="10" h="10" />
    <onsuccess>c1b63746-24cf-4b7f-b8fc-5b134563339a</onsuccess>
  </stage>
  <stage stageid="8c04bcb1-b411-4f02-9493-836f3630cecf" name="Anchor7" type="Anchor">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="465" y="240" w="10" h="10" />
    <onsuccess>efa434e3-8dcb-4630-afd9-4d9f8199308d</onsuccess>
  </stage>
  <stage stageid="3509cd68-788b-4aad-9a75-0aeecbf328e3" name="Add Entry ID" type="Calculation">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="15" y="0" />
    <onsuccess>eb800e7b-ecc2-4c14-a451-44c094c70c3c</onsuccess>
    <calculation expression="[Items.EntryID]" stage="Entry ID" />
  </stage>
  <stage stageid="ba108edb-4f3a-48cb-bbe1-7c4737b2312a" name="Anchor8" type="Anchor">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="15" y="225" w="10" h="10" />
    <onsuccess>be0a1f5c-1cd9-4a23-a933-d63e032d0e7c</onsuccess>
  </stage>
  <stage stageid="e4beff76-1b54-474a-9ad3-30840367583a" name="Anchor9" type="Anchor">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="465" y="225" w="10" h="10" />
    <onsuccess>8878b1f7-5e3f-4ac5-ab48-e78bd9ff1072</onsuccess>
  </stage>
  <stage stageid="2df2ef9c-bfe9-4dbb-b4bd-1a4921683cdc" name="Add Entry ID" type="Calculation">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="15" y="-15" />
    <onsuccess>1dfadbd8-96e0-444a-94d5-c15193b5eeba</onsuccess>
    <calculation expression="[Items.EntryID]" stage="Entry ID" />
  </stage>
  <stage stageid="8037977e-027e-496b-a1e4-eb627f4605c2" name="Anchor10" type="Anchor">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="15" y="225" w="10" h="10" />
    <onsuccess>e8634f8f-d290-44c1-adaf-7a7911c40bf6</onsuccess>
  </stage>
  <stage stageid="6e132db0-9360-4d2b-884f-b87aabfde30f" name="Anchor11" type="Anchor">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="465" y="225" w="10" h="10" />
    <onsuccess>953dff52-340a-418a-9829-b1351e2d2e7f</onsuccess>
  </stage>
  <stage stageid="fbd1abfd-aa49-4ee5-aedf-d744a71e615d" name="Add Entry ID" type="Calculation">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="15" y="-15" />
    <onsuccess>0e68becc-c3d9-4def-8ad1-0f144ceafdd9</onsuccess>
    <calculation expression="[Items.EntryID]" stage="Entry ID" />
  </stage>
  <stage stageid="805a38bf-89ef-42e6-ad4c-84a1a344ea9a" name="Test1" type="MultipleCalculation">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <loginhibit />
    <display x="240" y="-135" />
    <font family="Segoe UI" size="10" style="Regular" color="FF00FF" />
    <onsuccess>4a947b71-6691-4557-abf6-1e41f31c3c64</onsuccess>
    <steps>
      <calculation expression="&quot;[From]='Enrico Emme' AND [unread]=False&quot;" stage="Filter Expression" />
    </steps>
  </stage>
  <stage stageid="d353093f-8947-4bb1-9b9a-dc5eefcdd56d" name="Predefined Test Scenarios" type="Block">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <narrative>You can use these scenarios to test the action by connection the collection with the Action.</narrative>
    <display x="195" y="-165" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="C0C0C0" />
  </stage>
  <stage stageid="71828ba4-9360-44bb-8c30-4105a5987eb1" name="Test1" type="MultipleCalculation">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <loginhibit />
    <display x="225" y="-135" />
    <font family="Segoe UI" size="10" style="Regular" color="FF00FF" />
    <onsuccess>1f833069-f55f-4ac6-84ca-018e5ec8c59f</onsuccess>
    <steps>
      <calculation expression="&quot;@SQL=urn:schemas:httpmail:subject LIKE '%Hello World%'&quot;" stage="DASL Query" />
    </steps>
  </stage>
  <stage stageid="65482151-73c2-45f4-9615-cb4e6c5bf495" name="Predefined Test Scenarios" type="Block">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <narrative>You can use these scenarios to test the action by connection the collection with the Action.</narrative>
    <display x="180" y="-165" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="C0C0C0" />
  </stage>
  <stage stageid="cdc5725c-0ae0-49ba-b073-5b9ebc6a0195" name="End" type="End">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="480" y="195" />
  </stage>
  <stage stageid="7f609562-bf3e-4198-9e3c-3cd90dcf6126" name="Save Email as File" type="Action">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <narrative>Wrong File path provided.</narrative>
    <display x="480" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="text" name="File Path" narrative="Mandatory. The destination file path. Default blank." expr="&quot;C:\temp\not exsting path\&quot;" />
      <input type="text" name="File Name" narrative="Mandatory. The File Name for the stored Email." expr="[File Name]" />
    </inputs>
    <onsuccess>cdc5725c-0ae0-49ba-b073-5b9ebc6a0195</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Email As File" />
  </stage>
  <stage stageid="b6d310b7-2612-43da-84c0-464bf4a547d2" name="Recover" type="Recover">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="555" y="75" />
    <onsuccess>27bb5c65-8ef3-4e33-9fad-642ea906f41c</onsuccess>
  </stage>
  <stage stageid="9507fd5e-93b4-4b28-81d8-30870a95c831" name="System Exception" type="Exception">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="765" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="27bb5c65-8ef3-4e33-9fad-642ea906f41c" name="capture exception message" type="Calculation">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="660" y="75" />
    <onsuccess>179e2fb7-9615-443a-a323-e392a6c7b1f6</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="179e2fb7-9615-443a-a323-e392a6c7b1f6" name="Resume" type="Resume">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="660" y="135" />
    <onsuccess>cef8df80-a3d3-4280-a06b-86267865eb94</onsuccess>
  </stage>
  <stage stageid="cef8df80-a3d3-4280-a06b-86267865eb94" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="660" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: The operation failed.&quot;" />
    <ontrue>cdc5725c-0ae0-49ba-b073-5b9ebc6a0195</ontrue>
    <onfalse>9507fd5e-93b4-4b28-81d8-30870a95c831</onfalse>
  </stage>
  <stage stageid="a323619e-75fb-4e17-8010-92675ffd62de" name="Exception Scenario (Wrong File Path)" type="Block">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="375" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="10dad20b-69d0-41f5-a411-5b2c75e3998d" name="Anchor12" type="Anchor">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="345" y="240" w="10" h="10" />
    <onsuccess>76d8ab52-071f-486f-b5bb-9f96cf72e538</onsuccess>
  </stage>
  <stage stageid="76d8ab52-071f-486f-b5bb-9f96cf72e538" name="Anchor13" type="Anchor">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="345" y="75" w="10" h="10" />
    <onsuccess>7f609562-bf3e-4198-9e3c-3cd90dcf6126</onsuccess>
  </stage>
  <stage stageid="74aa8745-e985-4fc7-aada-8b166668bd76" name="Get Received Items (Basic)" type="SubSheet">
    <display x="315" y="150" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>95be102c-b8ed-4775-9bf2-74dc1ad43f3a</onsuccess>
    <processid>4270da95-4b3a-4378-af8d-77c3b08692b8</processid>
  </stage>
  <stage stageid="47978501-4897-4497-833b-c9a8eb1868be" name="Get New Email ID for Marking" type="Block">
    <display x="255" y="120" w="120" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="C0C0C0" />
  </stage>
  <stage stageid="b7fc1753-0689-4193-aac1-19303419e427" name="Anchor14" type="Anchor">
    <subsheetid>1f0a3efe-125f-4107-8a88-a730edbed5bc</subsheetid>
    <display x="15" y="240" w="10" h="10" />
    <onsuccess>10dad20b-69d0-41f5-a411-5b2c75e3998d</onsuccess>
  </stage>
  <stage stageid="c7beedc1-a756-4c30-9637-4ff354c0c17a" name="Save Attachment (single file)" type="SubSheetInfo">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <narrative>Saves a specific attachment of an email.

Out of Scope: Anything unrelated to saving specific attachements.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="d606bd51-242c-4d5e-839a-fcd650607676" name="Start" type="Start">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>9cd53b46-2e75-423c-aa05-1b81afbf3564</onsuccess>
  </stage>
  <stage stageid="9cd53b46-2e75-423c-aa05-1b81afbf3564" name="Save Attachment" type="Action">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="text" name="File Name" narrative="Optional, Default value is *.* but common cases inlcude &quot;.docx&quot; , &quot;.pdf&quot; , &quot;.xlsx&quot; etc." expr="[File Name]" />
      <input type="text" name="Folder Path" narrative="Mandatory. The destination folder path for the attachments to be stored. Example &quot;C:\Temp&quot;." expr="[File Path]" />
    </inputs>
    <onsuccess>f1a4a775-f9a8-4bf7-8aa5-12f38a1975aa</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Attachment" />
  </stage>
  <stage stageid="f1a4a775-f9a8-4bf7-8aa5-12f38a1975aa" name="Save Attachement" type="Action">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <narrative>No Entry ID provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="&quot;&quot;" />
      <input type="text" name="File Name" narrative="Optional, Default value is *.* but common cases inlcude &quot;.docx&quot; , &quot;.pdf&quot; , &quot;.xlsx&quot; etc." expr="[File Name]" />
      <input type="text" name="Folder Path" narrative="Mandatory. The destination folder path for the attachments to be stored. Example &quot;C:\Temp&quot;." expr="[File Path]" />
    </inputs>
    <onsuccess>ee6e252a-8065-424f-adad-688a94c954d9</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Attachment" />
  </stage>
  <stage stageid="7f6975b1-08f1-4767-a059-b9eaf01b286a" name="Recover" type="Recover">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="90" y="75" />
    <onsuccess>d517f831-786a-42ee-a765-b7d75d2d9274</onsuccess>
  </stage>
  <stage stageid="6b0b66d7-e06c-4a86-a1ce-b94e8f07f5ed" name="System Exception" type="Exception">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="105" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="d517f831-786a-42ee-a765-b7d75d2d9274" name="capture exception message" type="Calculation">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="195" y="75" />
    <onsuccess>cf4217fc-2a42-42f6-9e2a-736de65d7e68</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="922624b1-0ca2-4e2b-b578-9d3440a49e6f" name="exception" type="Data">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="-195" y="75" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cf4217fc-2a42-42f6-9e2a-736de65d7e68" name="Resume" type="Resume">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="195" y="135" />
    <onsuccess>a41592cd-3743-4d57-8e23-89f8e8ce15eb</onsuccess>
  </stage>
  <stage stageid="a41592cd-3743-4d57-8e23-89f8e8ce15eb" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Could not open the item. Try again.&quot;" />
    <ontrue>38df2181-3d83-41af-8fa5-1d8a8d934128</ontrue>
    <onfalse>6b0b66d7-e06c-4a86-a1ce-b94e8f07f5ed</onfalse>
  </stage>
  <stage stageid="8002396e-79ec-44bf-9861-ce6a517a3dfb" name="File Path" type="Data">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <narrative>Provide valid file path to store an email.</narrative>
    <display x="-195" y="-15" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\Users\User Name\Desktop\Outlook VBO\Test Data</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ecf519fc-8484-459d-a96a-93af31177332" name="File Name" type="Data">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <narrative>Optional, Default value is *.* but common cases inlcude "*.docx" or "*.pdf" or "*.xlsx" or "*.txt" etc</narrative>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">"*.txt"</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5fd3119c-e3b7-4cfb-a692-cec0ff08dfa3" name="Happy Path" type="Block">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="a1c03525-7247-49e2-99cd-1fa4860b2b48" name="Exception Scenario (Entry ID = &quot;&quot;)" type="Block">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="c2a649f9-c41e-4d46-b61e-22498e2d912f" name="End" type="End">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="480" y="195" />
  </stage>
  <stage stageid="c830e263-ebbd-40b6-b7c8-13c5d2f4e079" name="Save Attachement" type="Action">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <narrative>Wrong File path provided.</narrative>
    <display x="480" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="text" name="File Name" narrative="Optional, Default value is *.* but common cases inlcude &quot;.docx&quot; , &quot;.pdf&quot; , &quot;.xlsx&quot; etc." expr="[File Name]" />
      <input type="text" name="Folder Path" narrative="Mandatory. The destination folder path for the attachments to be stored. Example &quot;C:\Temp&quot;." expr="&quot;C:\temp\notexistingfolder&quot;" />
    </inputs>
    <onsuccess>c2a649f9-c41e-4d46-b61e-22498e2d912f</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Attachment" />
  </stage>
  <stage stageid="5f369316-0bf7-4831-b061-8529b4425950" name="Recover" type="Recover">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="555" y="75" />
    <onsuccess>21349a23-9ed9-4424-9044-2f9e9a7832e0</onsuccess>
  </stage>
  <stage stageid="85e89b04-a6c9-48a7-a611-18ffc9a2c1cb" name="System Exception" type="Exception">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="765" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="21349a23-9ed9-4424-9044-2f9e9a7832e0" name="capture exception message" type="Calculation">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="660" y="75" />
    <onsuccess>be2e3876-47a9-4cae-9fc6-adb7d11b4757</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="be2e3876-47a9-4cae-9fc6-adb7d11b4757" name="Resume" type="Resume">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="660" y="135" />
    <onsuccess>eadd41ff-34b3-4682-881b-579b32d90946</onsuccess>
  </stage>
  <stage stageid="eadd41ff-34b3-4682-881b-579b32d90946" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="660" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Cannot save the attachment. Path does not exist. Verify the path is correct.&quot;" />
    <ontrue>c2a649f9-c41e-4d46-b61e-22498e2d912f</ontrue>
    <onfalse>85e89b04-a6c9-48a7-a611-18ffc9a2c1cb</onfalse>
  </stage>
  <stage stageid="806e04f3-1ba6-4a0e-8c69-543ad8a029e2" name="Exception Scenario (Wrong File Path)" type="Block">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="375" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="894016bb-eaa2-44b1-b37b-fed66d24a4d5" name="Anchor12" type="Anchor">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="345" y="240" w="10" h="10" />
    <onsuccess>38df2181-3d83-41af-8fa5-1d8a8d934128</onsuccess>
  </stage>
  <stage stageid="38df2181-3d83-41af-8fa5-1d8a8d934128" name="Anchor13" type="Anchor">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="345" y="75" w="10" h="10" />
    <onsuccess>c830e263-ebbd-40b6-b7c8-13c5d2f4e079</onsuccess>
  </stage>
  <stage stageid="ee6e252a-8065-424f-adad-688a94c954d9" name="Anchor14" type="Anchor">
    <subsheetid>d1214ce1-9718-460a-8ffb-8e6becc03833</subsheetid>
    <display x="15" y="240" w="10" h="10" />
    <onsuccess>894016bb-eaa2-44b1-b37b-fed66d24a4d5</onsuccess>
  </stage>
  <stage stageid="d1005a38-6c51-4037-a81a-bfbbd0c420a0" name="Save Attachment (multiple files)" type="SubSheetInfo">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <narrative>Saves all attachments of an email.

Out of Scope: Anything unrelated to saving attachements.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="23c9a38f-6da3-45dc-91e9-eb6f1581a6da" name="Start" type="Start">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>09f70cb0-6645-4c09-b593-e08ef943831c</onsuccess>
  </stage>
  <stage stageid="09f70cb0-6645-4c09-b593-e08ef943831c" name="Save Attachments" type="Action">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="15" y="-15" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="text" name="Folder Path" narrative="Mandatory. The destination folder path for the attachments to be stored. Example &quot;C:\Temp&quot;." expr="[File Path]" />
    </inputs>
    <onsuccess>63fff794-89b6-4a9b-b85b-c5cf916b4134</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Attachments" />
  </stage>
  <stage stageid="63fff794-89b6-4a9b-b85b-c5cf916b4134" name="Save Attachements" type="Action">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <narrative>No Entry ID provided, exception expected!</narrative>
    <display x="15" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="&quot;&quot;" />
      <input type="text" name="Folder Path" narrative="Mandatory. The destination folder path for the attachments to be stored. Example &quot;C:\Temp&quot;." expr="[File Path]" />
    </inputs>
    <onsuccess>f28f0934-e147-49a4-bd53-80a2001ccebc</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Attachments" />
  </stage>
  <stage stageid="f10053cf-4733-43e8-82dc-992420d4f2b2" name="Recover" type="Recover">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="90" y="75" />
    <onsuccess>ab2e71c6-772d-4bff-a524-0fc641b0df84</onsuccess>
  </stage>
  <stage stageid="b3c74093-f1ad-487e-9646-8a7b4069141f" name="System Exception" type="Exception">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="105" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="ab2e71c6-772d-4bff-a524-0fc641b0df84" name="capture exception message" type="Calculation">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="195" y="75" />
    <onsuccess>06fac11b-83a2-4fd7-9beb-4792e002f5e1</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="7b6e8ea4-c1e7-424f-8308-f371cf4730e6" name="exception" type="Data">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="-195" y="30" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="06fac11b-83a2-4fd7-9beb-4792e002f5e1" name="Resume" type="Resume">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="195" y="135" />
    <onsuccess>e9f2ef4d-ad93-444d-b95d-c9ec9c1893fa</onsuccess>
  </stage>
  <stage stageid="e9f2ef4d-ad93-444d-b95d-c9ec9c1893fa" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="195" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Could not open the item. Try again.&quot;" />
    <ontrue>15747857-acc5-4fe0-b8ee-21d0a1729419</ontrue>
    <onfalse>b3c74093-f1ad-487e-9646-8a7b4069141f</onfalse>
  </stage>
  <stage stageid="812a5c0b-8d5d-426b-bcd8-2c606e058f22" name="File Path" type="Data">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <narrative>Provide valid file path to store an email.</narrative>
    <display x="-195" y="-15" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\Users\User Name\Desktop\Outlook VBO\Test Data</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c2a37f5e-732e-473c-add0-c38fbce4e931" name="Happy Path" type="Block">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="-90" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="CCFFCC" />
  </stage>
  <stage stageid="7e3872f3-d272-4013-82c5-6b3de5f05939" name="Exception Scenario (Entry ID = &quot;&quot;)" type="Block">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="-90" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="fcf613db-970d-4cf9-809a-68b0ca17d1ba" name="End" type="End">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="480" y="195" />
  </stage>
  <stage stageid="40af1f57-4ee8-45ad-ba88-273cecaee5f6" name="Save Attachement" type="Action">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <narrative>Wrong File path provided.</narrative>
    <display x="480" y="75" />
    <inputs>
      <input type="text" name="Entry ID" narrative="Mandatory. An ID obtained from one of the Get Item actions in this object. NB not the same as a Mapiex ID." expr="[Entry ID]" />
      <input type="text" name="Folder Path" narrative="Mandatory. The destination folder path for the attachments to be stored. Example &quot;C:\Temp&quot;." expr="&quot;C:\temp\notexistingfolder&quot;" />
    </inputs>
    <onsuccess>fcf613db-970d-4cf9-809a-68b0ca17d1ba</onsuccess>
    <resource object="MS Outlook Email VBO" action="Save Attachments" />
  </stage>
  <stage stageid="1d984964-920b-41c8-b6da-4c31ab508c61" name="Recover" type="Recover">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="555" y="75" />
    <onsuccess>053975f5-5c72-48d4-8253-87c8acb4687c</onsuccess>
  </stage>
  <stage stageid="0411efe8-00af-405f-85d8-04de8ca9258e" name="System Exception" type="Exception">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="765" y="195" />
    <exception type="System Exception" detail="[exception]" />
  </stage>
  <stage stageid="053975f5-5c72-48d4-8253-87c8acb4687c" name="capture exception message" type="Calculation">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="660" y="75" />
    <onsuccess>857b7218-1c04-4172-a1f7-19441aa79bfc</onsuccess>
    <calculation expression="ExceptionDetail()" stage="exception" />
  </stage>
  <stage stageid="857b7218-1c04-4172-a1f7-19441aa79bfc" name="Resume" type="Resume">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="660" y="135" />
    <onsuccess>e245a349-acad-4bfb-9dc7-d6a34eaebfb4</onsuccess>
  </stage>
  <stage stageid="e245a349-acad-4bfb-9dc7-d6a34eaebfb4" name="Exception matches expected Exception?" type="Decision">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="660" y="195" w="90" h="30" />
    <decision expression="[exception]=&quot;Could not execute code stage because exception thrown by code stage: Cannot save the attachment. Path does not exist. Verify the path is correct.&quot;" />
    <ontrue>fcf613db-970d-4cf9-809a-68b0ca17d1ba</ontrue>
    <onfalse>0411efe8-00af-405f-85d8-04de8ca9258e</onfalse>
  </stage>
  <stage stageid="c0e1040c-d6d8-4e46-909e-a974333586d7" name="Exception Scenario (Wrong File Path)" type="Block">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="375" y="45" w="240" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FFCC99" />
  </stage>
  <stage stageid="e965f03d-1464-4dbd-baef-85774b17becb" name="Anchor12" type="Anchor">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="345" y="240" w="10" h="10" />
    <onsuccess>15747857-acc5-4fe0-b8ee-21d0a1729419</onsuccess>
  </stage>
  <stage stageid="15747857-acc5-4fe0-b8ee-21d0a1729419" name="Anchor13" type="Anchor">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="345" y="75" w="10" h="10" />
    <onsuccess>40af1f57-4ee8-45ad-ba88-273cecaee5f6</onsuccess>
  </stage>
  <stage stageid="f28f0934-e147-49a4-bd53-80a2001ccebc" name="Anchor14" type="Anchor">
    <subsheetid>8f6e2f66-243b-482e-9fe5-15085f92b303</subsheetid>
    <display x="15" y="240" w="10" h="10" />
    <onsuccess>e965f03d-1464-4dbd-baef-85774b17becb</onsuccess>
  </stage>
  <stage stageid="2476e9e1-a383-4430-9f3f-171911605276" name="Save Attachment (single file)" type="SubSheet">
    <display x="315" y="255" />
    <onsuccess>47519401-151d-4d73-b32f-3b3f9ccbf2a4</onsuccess>
    <processid>d1214ce1-9718-460a-8ffb-8e6becc03833</processid>
  </stage>
  <stage stageid="951b851a-4adb-4670-8745-f93b60e0c3ab" name="Save Attachments (multiple files)" type="SubSheet">
    <display x="165" y="255" />
    <onsuccess>2476e9e1-a383-4430-9f3f-171911605276</onsuccess>
    <processid>8f6e2f66-243b-482e-9fe5-15085f92b303</processid>
  </stage>
  <stage stageid="9a793594-8a76-436c-960d-8768bccfcc7f" name="Get Received Items (Basic)" type="SubSheet">
    <display x="15" y="255" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <onsuccess>951b851a-4adb-4670-8745-f93b60e0c3ab</onsuccess>
    <processid>4270da95-4b3a-4378-af8d-77c3b08692b8</processid>
  </stage>
  <stage stageid="af06eddd-d8d1-44c9-a5e8-c7fcfb1a2500" name="Get Email ID with Attachment" type="Block">
    <display x="-45" y="225" w="120" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="C0C0C0" />
  </stage>
  <stage stageid="5ea3f1ee-7b18-40b1-ad4f-c55671d3e061" name="Wait 30 Seconds" type="Action">
    <display x="315" y="-75" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="30" />
    </inputs>
    <onsuccess>cd529f66-3caa-4d11-93b4-e8b49ad0a86a</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="c28bbb20-e3c3-41e6-bf23-e5b399af1a0b" name="Items" type="Collection">
    <subsheetid>4270da95-4b3a-4378-af8d-77c3b08692b8</subsheetid>
    <display x="-195" y="360" w="150" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="EntryID" type="text" description="The mail ID. NB this is different from the Mapiex ID." />
      <field name="To" type="text" description="The display name of the recipient(s)" />
      <field name="CC" type="text" description="The display name of the copied recipient(s)" />
      <field name="Subject" type="text" description="The mail subject line" />
      <field name="Body" type="text" description="The mail message" />
      <field name="Attachments" type="text" description="The names of the attachements as a CSV string" />
      <field name="ReceivedOn" type="datetime" description="The date an incoming mail was received" />
      <field name="SentOn" type="datetime" description="The date an outgoing mail was sent" />
      <field name="SenderName" type="text" description="The display name of the sender" />
      <field name="SenderEmailAddress" type="text" description="The email of the sender" />
      <field name="Unread" type="flag" description="True if an incoming mail has not been read, otherwise False" />
      <field name="Sensitivity" type="number" description="Sensitivity of an email" />
      <field name="Importance" type="number" description="Importance of an email" />
      <field name="Flag" type="text" description="Flag status of an email" />
      <field name="IsHTML" type="flag" description="True if an email is in HTML" />
    </collectioninfo>
  </stage>
  <stage stageid="9c392ba8-1fe5-4835-9cec-b409d393f840" name="Items" type="Collection">
    <subsheetid>77187256-2f3d-4550-af78-386374256168</subsheetid>
    <display x="-195" y="195" w="150" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="EntryID" type="text" description="The mail ID. NB this is different from the Mapiex ID." />
      <field name="To" type="text" description="The display name of the recipient(s)" />
      <field name="CC" type="text" description="The display name of the copied recipient(s)" />
      <field name="Subject" type="text" description="The mail subject line" />
      <field name="Body" type="text" description="The mail message" />
      <field name="Attachments" type="text" description="The names of the attachements as a CSV string" />
      <field name="ReceivedOn" type="datetime" description="The date an incoming mail was received" />
      <field name="SentOn" type="datetime" description="The date an outgoing mail was sent" />
      <field name="SenderName" type="text" description="The display name of the sender" />
      <field name="SenderEmailAddress" type="text" description="The email of the sender" />
      <field name="Unread" type="flag" description="True if an incoming mail has not been read, otherwise False" />
      <field name="Sensitivity" type="number" description="Sensitivity of an email" />
      <field name="Importance" type="number" description="Importance of an email" />
      <field name="Flag" type="text" description="Flag status of an email" />
      <field name="IsHTML" type="flag" description="True if an email is in HTML" />
    </collectioninfo>
  </stage>
  <stage stageid="130fe79a-9441-4a5b-9f4f-b492ff7392c5" name="Items" type="Collection">
    <subsheetid>a03db2f8-5e88-43d8-8514-b775b9e85fc4</subsheetid>
    <display x="-195" y="195" w="150" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="EntryID" type="text" description="The mail ID. NB this is different from the Mapiex ID." />
      <field name="To" type="text" description="The display name of the recipient(s)" />
      <field name="CC" type="text" description="The display name of the copied recipient(s)" />
      <field name="Subject" type="text" description="The mail subject line" />
      <field name="Body" type="text" description="The mail message" />
      <field name="Attachments" type="text" description="The names of the attachements as a CSV string" />
      <field name="ReceivedOn" type="datetime" description="The date an incoming mail was received" />
      <field name="SentOn" type="datetime" description="The date an outgoing mail was sent" />
      <field name="SenderName" type="text" description="The display name of the sender" />
      <field name="SenderEmailAddress" type="text" description="The email of the sender" />
      <field name="Unread" type="flag" description="True if an incoming mail has not been read, otherwise False" />
      <field name="Sensitivity" type="number" description="Sensitivity of an email" />
      <field name="Importance" type="number" description="Importance of an email" />
      <field name="Flag" type="text" description="Flag status of an email" />
      <field name="IsHTML" type="flag" description="True if an email is in HTML" />
    </collectioninfo>
  </stage>
  <stage stageid="2ac1f183-e24d-46d9-839c-cf295b91857f" name="Items" type="Collection">
    <subsheetid>78c10bdb-81bd-40d0-9248-9e29b04ab431</subsheetid>
    <display x="-195" y="210" w="150" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="EntryID" type="text" description="The mail ID. NB this is different from the Mapiex ID." />
      <field name="To" type="text" description="The display name of the recipient(s)" />
      <field name="CC" type="text" description="The display name of the copied recipient(s)" />
      <field name="Subject" type="text" description="The mail subject line" />
      <field name="Body" type="text" description="The mail message" />
      <field name="Attachments" type="text" description="The names of the attachements as a CSV string" />
      <field name="ReceivedOn" type="datetime" description="The date an incoming mail was received" />
      <field name="SentOn" type="datetime" description="The date an outgoing mail was sent" />
      <field name="SenderName" type="text" description="The display name of the sender" />
      <field name="SenderEmailAddress" type="text" description="The email of the sender" />
      <field name="Unread" type="flag" description="True if an incoming mail has not been read, otherwise False" />
      <field name="Sensitivity" type="number" description="Sensitivity of an email" />
      <field name="Importance" type="number" description="Importance of an email" />
      <field name="Flag" type="text" description="Flag status of an email" />
      <field name="IsHTML" type="flag" description="True if an email is in HTML" />
    </collectioninfo>
  </stage>
  <stage stageid="ff235bcb-14e0-4676-b706-584a12d1a8b8" name="Items" type="Collection">
    <subsheetid>0a1d9670-85c2-42a0-9256-edfa4d088212</subsheetid>
    <display x="-195" y="90" w="150" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="EntryID" type="text" description="The mail ID. NB this is different from the Mapiex ID." />
      <field name="To" type="text" description="The display name of the recipient(s)" />
      <field name="CC" type="text" description="The display name of the copied recipient(s)" />
      <field name="Subject" type="text" description="The mail subject line" />
      <field name="Body" type="text" description="The mail message" />
      <field name="Attachments" type="text" description="The names of the attachements as a CSV string" />
      <field name="ReceivedOn" type="datetime" description="The date an incoming mail was received" />
      <field name="SentOn" type="datetime" description="The date an outgoing mail was sent" />
      <field name="SenderName" type="text" description="The display name of the sender" />
      <field name="SenderEmailAddress" type="text" description="The email of the sender" />
      <field name="Unread" type="flag" description="True if an incoming mail has not been read, otherwise False" />
      <field name="Sensitivity" type="number" description="Sensitivity of an email" />
      <field name="Importance" type="number" description="Importance of an email" />
      <field name="Flag" type="text" description="Flag status of an email" />
      <field name="IsHTML" type="flag" description="True if an email is in HTML" />
    </collectioninfo>
  </stage>
  <stage stageid="16e02635-1115-4089-ac1e-f4bcfad9ce91" name="Items" type="Collection">
    <subsheetid>7fdcf009-c0a1-464e-8e4d-73976d18cd26</subsheetid>
    <display x="-195" y="90" w="150" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="EntryID" type="text" description="The mail ID. NB this is different from the Mapiex ID." />
      <field name="To" type="text" description="The display name of the recipient(s)" />
      <field name="CC" type="text" description="The display name of the copied recipient(s)" />
      <field name="Subject" type="text" description="The mail subject line" />
      <field name="Body" type="text" description="The mail message" />
      <field name="Attachments" type="text" description="The names of the attachements as a CSV string" />
      <field name="ReceivedOn" type="datetime" description="The date an incoming mail was received" />
      <field name="SentOn" type="datetime" description="The date an outgoing mail was sent" />
      <field name="SenderName" type="text" description="The display name of the sender" />
      <field name="SenderEmailAddress" type="text" description="The email of the sender" />
      <field name="Unread" type="flag" description="True if an incoming mail has not been read, otherwise False" />
      <field name="Sensitivity" type="number" description="Sensitivity of an email" />
      <field name="Importance" type="number" description="Importance of an email" />
      <field name="Flag" type="text" description="Flag status of an email" />
      <field name="IsHTML" type="flag" description="True if an email is in HTML" />
    </collectioninfo>
  </stage>
</process>