<process name="Queue Utils" version="1.0" bpversion="6.7.0.16957" narrative="Utility functions for the queue test" byrefcollection="true" type="object" runmode="Background" preferredid="55f09077-6a05-4120-9579-a96f513c083a">
  <appdef>
    <element name="Application Root">
      <id>4e5d151a-4c34-4bbf-9185-a64d649feebc</id>
      <type>Application</type>
      <basetype>Application</basetype>
      <datatype>unknown</datatype>
      <diagnose>False</diagnose>
    </element>
  </appdef>
  <view>
    <camerax>53</camerax>
    <cameray>0</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="3be3e386-6afc-4884-82f9-0e9b0ceae5ef" type="CleanUp" published="True">
    <name>Clean Up</name>
    <view>
      <camerax>0</camerax>
      <cameray>-84</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="46eed926-0456-4d83-89b0-efbe3dc9a453" type="Normal" published="True">
    <name>Wait 100ms</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="887127fd-e756-4079-847f-81e92084426b" type="Normal" published="True">
    <name>Wait 5 Seconds</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb" type="Normal" published="True">
    <name>Wait n seconds</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="68339725-266c-4c2e-a54e-e11aa473119a" type="Normal" published="True">
    <name>Wait Rand(m,n) Seconds</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="a913d1b2-037f-49ec-b3bd-fa0a3d0c112b" type="Normal" published="True">
    <name>Create Queue</name>
    <view>
      <camerax>-4</camerax>
      <cameray>42</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="67e059a8-19ee-4cb7-aa36-1fefd0731377" type="Normal" published="True">
    <name>Create (If Not Exists) Queue</name>
    <view>
      <camerax>28</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23" type="Normal" published="True">
    <name>Export Queue</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ef914f05-dbd9-4984-b27d-acdbc410b332" type="Normal" published="True">
    <name>Clear Queue</name>
    <view>
      <camerax>4</camerax>
      <cameray>96</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="1f9a203f-b19f-4201-b62e-f9f2fc31e12a" type="Normal" published="True">
    <name>Delete Queue</name>
    <view>
      <camerax>-160</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7bccced6-d989-4b42-b7a0-0dce2604d4db" type="Normal" published="True">
    <name>Destroy Queue</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ef99d5b8-ccf1-4256-aaf8-1db843dd0d26" type="Normal" published="True">
    <name>Count Pending Items</name>
    <view>
      <camerax>218</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d" type="Normal" published="True">
    <name>Get Random Number</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="a8d462fe-7356-475e-82ed-57bf73d9fd30" type="Normal" published="True">
    <name>Build Large Collection</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="479dd99f-2be5-4a3f-8b12-9309bf917494" name="Start" type="Start">
    <loginhibit />
    <display x="15" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>a4548d76-a21e-437f-b6a9-198469c7677e</onsuccess>
  </stage>
  <stage stageid="a4548d76-a21e-437f-b6a9-198469c7677e" name="End" type="End">
    <loginhibit />
    <display x="15" y="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="fea68f52-e716-4a63-9631-22b8fc83b2d9" name="Stage1" type="ProcessInfo">
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <references>
      <reference>System.Data.dll</reference>
      <reference>System.Xml.dll</reference>
      <reference>System.Drawing.dll</reference>
      <reference>Microsoft.VisualBasic.dll</reference>
      <reference>System.Windows.Forms.dll</reference>
    </references>
    <imports>
      <import>System</import>
      <import>System.Drawing</import>
      <import>System.Data</import>
    </imports>
    <language>visualbasic</language>
    <globalcode><![CDATA[


]]></globalcode>
    <code><![CDATA[Private rand as New Random()

Private Function GetExePath as String

	' Get the executing directory name - works for console apps as well
	' as the BP client app.
	Dim dirPath As String = System.IO.Path.GetDirectoryName( _
	 System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName)

	Return System.IO.Path.Combine(dirPath, "AutomateC.exe")

End Function]]></code>
  </stage>
  <stage stageid="0507c1c8-ae04-4d35-bf80-d245f07be0fc" name="Clean Up" type="SubSheetInfo">
    <subsheetid>3be3e386-6afc-4884-82f9-0e9b0ceae5ef</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="8340a66b-3d99-496f-9ac4-192295658c4f" name="Start" type="Start">
    <subsheetid>3be3e386-6afc-4884-82f9-0e9b0ceae5ef</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>6e9859d4-32ca-427a-a23f-d28ad6efc334</onsuccess>
  </stage>
  <stage stageid="6e9859d4-32ca-427a-a23f-d28ad6efc334" name="End" type="End">
    <subsheetid>3be3e386-6afc-4884-82f9-0e9b0ceae5ef</subsheetid>
    <loginhibit />
    <display x="15" y="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="38c953a5-9324-4d70-b178-ce82aa0e2f7a" name="Wait 5 Seconds" type="SubSheetInfo">
    <subsheetid>887127fd-e756-4079-847f-81e92084426b</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="5469a479-1057-42a8-b735-e7bfb6f8bd72" name="Start" type="Start">
    <subsheetid>887127fd-e756-4079-847f-81e92084426b</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>52c54625-bb33-46d5-8765-e082ea15de4c</onsuccess>
  </stage>
  <stage stageid="3d82e2ab-45b2-4474-a3e3-a901efc1f27b" name="End" type="End">
    <subsheetid>887127fd-e756-4079-847f-81e92084426b</subsheetid>
    <loginhibit />
    <display x="15" y="15" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="6dec0360-fa4f-493b-9bf5-10e257f305ed" name="new" type="Note">
    <subsheetid>3be3e386-6afc-4884-82f9-0e9b0ceae5ef</subsheetid>
    <narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative>
    <display x="-180" y="60" w="180" h="230" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="65eaf7b1-bad8-4b47-a2f1-674c91d72cf2" name="new" type="Note">
    <narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative>
    <display x="-180" y="60" w="180" h="230" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="2e244acb-7f02-4615-a14f-b95275633fae" name="Create Queue" type="SubSheetInfo">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <display x="-195" y="-105" w="180" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="4dbc96b1-e0c2-4346-8f53-af208b311fd5" name="Start" type="Start">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <loginhibit />
    <display x="15" y="-120" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue to be created" stage="Queue Name" />
      <input type="text" name="Key Field" narrative="The key column to use in the collection which makes up a queue item" stage="Key Field" />
      <input type="number" name="Max Attempts" narrative="The maximum number of retry attempts for the queue. Default: 5" stage="Max Attempts" />
    </inputs>
    <onsuccess>25e4947e-4927-4a06-978a-fa3a63ff1f93</onsuccess>
  </stage>
  <stage stageid="e05f4f91-f85a-4112-b7de-dc193f5b7432" name="End" type="End">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <loginhibit />
    <display x="15" y="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="0b6f8022-2382-476f-8e79-54e5ed64c434" name="Queue Name" type="Data">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <display x="-270" y="-30" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Test Queue</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="25e4947e-4927-4a06-978a-fa3a63ff1f93" name="Create Queue" type="Code">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <loginhibit />
    <display x="15" y="-60" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" expr="[Queue Name]" />
      <input type="text" name="Key Field" expr="[Key Field]" />
      <input type="number" name="Max Attempts" expr="[Max Attempts]" />
      <input type="text" name="exe" expr="[AutomateC EXE]" />
      <input type="text" name="loginargs" expr="[Login Args]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Output" stage="Output" />
    </outputs>
    <onsuccess>7ff0a605-0e95-4900-956d-a424c6b5c965</onsuccess>
    <code><![CDATA[' It's /createqueue <key> <running> <maxattempts> /queuename <name> /<login-info>
Dim args as String = String.Format( _
 " /createqueue ""{0}"" {1} {2}" & _
 " /queuename ""{3}""" & _
 " /{4}", _
 Key_Field,"True",Max_Attempts,Queue_Name,loginargs)

Dim proc as new Diagnostics.Process()
proc.EnableRaisingEvents = False
With proc.StartInfo
  .FileName=exe
  .Arguments = args
  .UseShellExecute = False
  .CreateNoWindow = True
  .RedirectStandardOutput = True
End With

proc.Start()
proc.WaitForExit()

Success = (proc.ExitCode = 0)
Output = proc.StandardOutput.ReadToEnd()]]></code>
  </stage>
  <stage stageid="1c14f9dd-085a-44d7-9ecc-d188e85c3341" name="Success" type="Data">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <display x="-135" y="15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6574b63b-a37e-4aef-ad46-10fc3b0df6dd" name="Output" type="Data">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <display x="-135" y="-30" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7ef984ac-8e1f-4152-98fc-7deac6aad708" name="Export Queue" type="SubSheetInfo">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="b47c99a8-6cb8-453d-b75f-f0fa9aef9c68" name="End" type="End">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <loginhibit />
    <display x="15" y="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="text" name="Report File" stage="Report File" />
      <output type="flag" name="Success" narrative="True if the queue was successfully exported; False otherwise" stage="Success" />
      <output type="text" name="Subprocess Output" narrative="The output from the forked subprocess which exported the queue to the CSV file" stage="Output" />
    </outputs>
  </stage>
  <stage stageid="b321252e-9493-460b-8bc7-e9230095902f" name="Start" type="Start">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <loginhibit />
    <display x="15" y="-120" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" stage="Queue Name" />
    </inputs>
    <onsuccess>505b37df-85a7-413c-abf7-3da71a12dd10</onsuccess>
  </stage>
  <stage stageid="0b7a7830-7665-4806-bd7d-6e7bcc895e87" name="Queue Name" type="Data">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <display x="90" y="-120" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Test Queue</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="505b37df-85a7-413c-abf7-3da71a12dd10" name="Export Queue" type="Code">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <loginhibit />
    <display x="15" y="-30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="exe" expr="[AutomateC EXE]" />
      <input type="text" name="loginargs" expr="[Login Args]" />
      <input type="text" name="Queue Name" expr="[Queue Name]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" stage="Success" />
      <output type="text" name="Output" stage="Output" />
      <output type="text" name="Report File" stage="Report File" />
    </outputs>
    <onsuccess>f583d9c2-b047-402e-9004-3f97eee4d8c8</onsuccess>
    <code><![CDATA[
Report_File = Environment.GetFolderPath( _
 Environment.SpecialFolder.Desktop) & "\Report.csv"

Dim proc As New System.Diagnostics.Process()
proc.EnableRaisingEvents = False
With proc.StartInfo
  .UseShellExecute = False
  .CreateNoWindow = True
  .RedirectStandardOutput = True
  .FileName = exe
  .Arguments = String.Format( _
   " /exportqueue ""{0}""" & _
   " /queuename ""{1}""" & _
   " /{2}", _
   report_file, Queue_Name, loginargs)
End With
proc.Start()
proc.WaitForExit()
Output = proc.StandardOutput.ReadToEnd

Success = (proc.ExitCode = 0)
]]></code>
  </stage>
  <stage stageid="686a3db3-aa86-435e-9c25-b6f61eb84714" name="Success" type="Data">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <display x="90" y="-30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="24c17a91-ac68-4083-977f-11653b061d09" name="Output" type="Data">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <display x="-60" y="-30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5d543773-31ea-402c-8d40-d6fb1f573130" name="Report File" type="Data">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <display x="90" y="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f583d9c2-b047-402e-9004-3f97eee4d8c8" name="Set Success" type="Calculation">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <loginhibit />
    <display x="15" y="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>b47c99a8-6cb8-453d-b75f-f0fa9aef9c68</onsuccess>
    <calculation expression="[Success] and InStr([Output], &quot;Report written&quot;) &gt; 0" stage="Success" />
  </stage>
  <stage stageid="1a496096-82e1-4355-91a7-df8761097a67" name="Get Random Number" type="SubSheetInfo">
    <subsheetid>b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d</subsheetid>
    <narrative>Gets a random integer within a specified number range.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="35948ee2-8a14-4dcf-8a59-f3f667f72c77" name="Start" type="Start">
    <subsheetid>b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d</subsheetid>
    <loginhibit />
    <display x="-45" y="-135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Min Value" narrative="The inclusive lower bound of the random number returned" stage="Min Value" />
      <input type="number" name="Max Value" narrative="The exclusive upper bound of the random number returned. Max Value must be greater than or equal to Min Value." stage="Max Value" />
    </inputs>
    <onsuccess>64ee23ae-8f1a-42ed-94e9-abba24c8ec57</onsuccess>
  </stage>
  <stage stageid="aaa6b843-981a-4592-8ce0-d932ebc45a35" name="End" type="End">
    <subsheetid>b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d</subsheetid>
    <loginhibit />
    <display x="-45" y="0" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="number" name="Output" stage="Output" />
    </outputs>
  </stage>
  <stage stageid="0be6a904-7cf0-4af5-8e82-fccbb87f0850" name="Max Value" type="Data">
    <subsheetid>b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d</subsheetid>
    <display x="30" y="-135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="72924064-4b02-4f59-b40e-3c24f6555c16" name="Min Value" type="Data">
    <subsheetid>b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d</subsheetid>
    <display x="90" y="-135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="64ee23ae-8f1a-42ed-94e9-abba24c8ec57" name="Get Random" type="Code">
    <subsheetid>b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d</subsheetid>
    <loginhibit />
    <display x="-45" y="-75" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Min" expr="[Min Value]" />
      <input type="number" name="Max" expr="[Max Value]" />
    </inputs>
    <outputs>
      <output type="number" name="Output" stage="Output" />
    </outputs>
    <onsuccess>aaa6b843-981a-4592-8ce0-d932ebc45a35</onsuccess>
    <code><![CDATA[
output = rand.Next(min, max)]]></code>
  </stage>
  <stage stageid="337a6b7c-aaae-480e-bc51-43cf7f2d39f4" name="Output" type="Data">
    <subsheetid>b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d</subsheetid>
    <display x="60" y="-75" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a6672060-83f2-4658-8c70-f1359ad920ed" name="Key Field" type="Data">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <display x="-270" y="15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5b840d8c-d2a3-4dc3-9a68-3a9cce5a6afc" name="Wait 100ms" type="SubSheetInfo">
    <subsheetid>46eed926-0456-4d83-89b0-efbe3dc9a453</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="5eda05d2-69e4-4930-b04d-70bb1e96995c" name="Build Large Collection" type="SubSheetInfo">
    <subsheetid>a8d462fe-7356-475e-82ed-57bf73d9fd30</subsheetid>
    <narrative>Builds a large collection with a "Key" text field and a "Value" numeric field.
The "Key" field has the value: "No. &lt;index&gt;"
The "Value" field contains the index.</narrative>
    <display x="-225" y="-120" w="300" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="8b394534-4b78-4503-a38c-e0083bb888aa" name="Start" type="Start">
    <subsheetid>a8d462fe-7356-475e-82ed-57bf73d9fd30</subsheetid>
    <loginhibit />
    <display x="15" y="-150" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Start Index" narrative="The index that the collection should be built from" stage="Start Index" />
      <input type="number" name="End Index" narrative="The last index that should be added to the collection" stage="End Index" />
    </inputs>
    <onsuccess>69ae7703-adf4-418d-b60f-e2973c60e5e7</onsuccess>
  </stage>
  <stage stageid="88fad80f-b174-4810-bb62-56e4b89852d9" name="End" type="End">
    <subsheetid>a8d462fe-7356-475e-82ed-57bf73d9fd30</subsheetid>
    <loginhibit />
    <display x="15" y="-30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="Output" narrative="The collection which has been built" stage="Output" />
    </outputs>
  </stage>
  <stage stageid="7c58a8a0-2693-45a7-89a3-89188433e7b1" name="Start Index" type="Data">
    <subsheetid>a8d462fe-7356-475e-82ed-57bf73d9fd30</subsheetid>
    <display x="-330" y="-45" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d8b7d8fb-bec9-483d-a4e4-15369a241ab1" name="End Index" type="Data">
    <subsheetid>a8d462fe-7356-475e-82ed-57bf73d9fd30</subsheetid>
    <display x="-120" y="-15" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="69ae7703-adf4-418d-b60f-e2973c60e5e7" name="Build Collection" type="Code">
    <subsheetid>a8d462fe-7356-475e-82ed-57bf73d9fd30</subsheetid>
    <loginhibit />
    <display x="15" y="-90" w="150" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Start" expr="[Start Index]" />
      <input type="number" name="End" expr="[End Index]" />
    </inputs>
    <outputs>
      <output type="collection" name="Output" stage="Output" />
    </outputs>
    <onsuccess>88fad80f-b174-4810-bb62-56e4b89852d9</onsuccess>
    <code><![CDATA[

' Set up the collection
Output = New DataTable("BigCollection")

Dim colKey As New DataColumn("Key")
colKey.DataType = Type.GetType("System.String")
Output.Columns.Add(colKey)

Dim colVal As New DataColumn("Value")
colVal.DataType = Type.GetType("System.Decimal")
Output.Columns.Add(colVal)

For i as Integer = Start To [End]

	Dim row As DataRow = Output.NewRow()
	row("Key") = "No. " & i
	row("Value") = i
	Output.Rows.Add(row)

Next i]]></code>
  </stage>
  <stage stageid="aaf07768-ecdf-409c-8e68-8536910fbf3f" name="Output" type="Collection">
    <subsheetid>a8d462fe-7356-475e-82ed-57bf73d9fd30</subsheetid>
    <display x="-225" y="-30" w="150" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ef7cac51-be07-4e79-89e8-a7a27a79c01c" name="Max Attempts" type="Data">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <display x="-270" y="60" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>5</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ce737e5e-63e5-4774-b942-18991a9540c4" name="Clear Queue" type="SubSheetInfo">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <narrative>Clears any pending items in the queue by marking them with an exception (and not retrying) and optionally deleting them</narrative>
    <display x="-210" y="-120" w="180" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="c1ce749b-419d-4e11-a4ac-c3a2b8fd4ab5" name="Start" type="Start">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="-180" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue whose items should all be cleared" stage="Queue Name" />
      <input type="text" name="Exception Message" narrative="The message which should be used as the exception for the unworked items" stage="Exception Message" />
      <input type="flag" name="Delete Items" narrative="True to delete the items after they have been marked with an exception" stage="Delete Items" />
    </inputs>
    <onsuccess>d5163764-2979-4fcd-8277-54525ffd94d0</onsuccess>
  </stage>
  <stage stageid="1e3013e1-3e4e-4b22-bad2-3deb15112553" name="End" type="End">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="450" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="27669443-3163-426e-aa81-2e376f5f7ea0" name="Get Next" type="Action">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative>
    <display x="195" y="135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" />
      <input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" />
      <output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>b8584224-f405-42b6-b6e2-2ff2ee4aa57d</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" />
  </stage>
  <stage stageid="299fc428-c584-4155-9e7b-ce0546dadf33" name="Queue Name" type="Data">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <display x="-270" y="-45" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6a38bad8-d01a-4897-a9cf-52e2f38256a1" name="Exception Message" type="Data">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <display x="-285" y="0" w="210" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Marked as a result of clearing the queue</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="dad288fe-70d6-46a5-9c99-abc2552d6cf4" name="Item ID" type="Data">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <display x="300" y="135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b8584224-f405-42b6-b6e2-2ff2ee4aa57d" name="Has Next?" type="Decision">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="195" y="180" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Item ID] &lt;&gt; &quot;&quot;" />
    <ontrue>94d79b83-b3e1-4cba-87dd-0db45d0ff90e</ontrue>
    <onfalse>3fa895c0-9c1f-425b-af6c-1c66105c8120</onfalse>
  </stage>
  <stage stageid="94d79b83-b3e1-4cba-87dd-0db45d0ff90e" name="EXCEPTIONATE EXCEPTIONATE" type="Action">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="195" y="225" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" />
      <input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Message]" />
      <input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="False" />
      <input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="False" />
    </inputs>
    <outputs>
      <output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="" />
    </outputs>
    <onsuccess>31b5d556-19bb-4d89-92a6-005de40694c0</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" />
  </stage>
  <stage stageid="31b5d556-19bb-4d89-92a6-005de40694c0" name="anchor1" type="Anchor">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="120" y="225" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>c793c113-a440-4fcb-94d8-4ae788a5bb2b</onsuccess>
  </stage>
  <stage stageid="c793c113-a440-4fcb-94d8-4ae788a5bb2b" name="anchor2" type="Anchor">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="120" y="135" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>27669443-3163-426e-aa81-2e376f5f7ea0</onsuccess>
  </stage>
  <stage stageid="c0255747-2605-4f50-8442-005852435f0a" name="Delete Queue" type="SubSheetInfo">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <narrative>Deletes the named queue using automatec</narrative>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="30faed33-3a46-43c7-951a-deb58f0d1071" name="Start" type="Start">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="15" y="-135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue to delete" stage="Queue Name" />
    </inputs>
    <onsuccess>c8fc8bda-286b-4185-9390-7b9de68f20b7</onsuccess>
  </stage>
  <stage stageid="4f441641-6336-4652-9b29-0addb8984f83" name="End" type="End">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="15" y="0" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d5163764-2979-4fcd-8277-54525ffd94d0" name="Get Locked Items" type="Action">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <narrative>Retrieves the IDs and locked times for all currently locked work queue items in the specified queue, matching the given tags</narrative>
    <display x="15" y="-135" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue for which the locked items are required" expr="[Queue Name]" />
      <input type="text" name="Tags" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Locked Items" narrative="The currently locked items in the queue. Columns are 'Item ID' : text, and 'Locked' : datetime. The elements in the collection will be in locked date/time order" stage="Locked Items" />
    </outputs>
    <onsuccess>3093262f-5f47-4ebd-bae7-7febfc53e08e</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Locked Items" />
  </stage>
  <stage stageid="c5aef69d-8ac1-4adf-a22e-de9ea3ce76c9" name="Locked Items" type="Collection">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <display x="-270" y="60" w="150" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" />
      <field name="Locked" type="datetime" />
    </collectioninfo>
  </stage>
  <stage stageid="3093262f-5f47-4ebd-bae7-7febfc53e08e" name="For Each Locked Item" type="LoopStart">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="-90" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>8b535f3a-4e3a-4c24-9c59-e87e223f27bd</onsuccess>
    <groupid>f4318c87-5d82-4d7d-bd1d-ad551e38bcee</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Locked Items</loopdata>
  </stage>
  <stage stageid="f4cf5fbb-dcd1-46d4-84f3-0f4c9657b7d5" name="Next Locked Item" type="LoopEnd">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="90" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>0d06c5f0-6636-4da7-88eb-ad1bfb832b4d</onsuccess>
    <groupid>f4318c87-5d82-4d7d-bd1d-ad551e38bcee</groupid>
  </stage>
  <stage stageid="8b535f3a-4e3a-4c24-9c59-e87e223f27bd" name="Unlock it" type="Action">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <narrative>Unlocks a currently locked work queue item</narrative>
    <display x="15" y="-45" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Item ID" narrative="The ID of the work queue item which should be unlocked" expr="[Locked Items.Item ID]" />
    </inputs>
    <outputs>
      <output type="flag" name="Unlocked" narrative="Whether the item was unlocked as a result of this action or not. If the item had finished being worked elsewhere before this action had run, this will be 'False'" stage="" />
    </outputs>
    <onsuccess>4580369e-8210-4f84-809c-2721e83a368f</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Unlock Item" />
  </stage>
  <stage stageid="7f5edc94-330f-4537-82e6-adfc871fb2da" name="Queue Name" type="Data">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <display x="-270" y="-15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Test Queue</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c8fc8bda-286b-4185-9390-7b9de68f20b7" name="Delete Queue" type="Code">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="15" y="-90" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="exe" expr="[AutomateC EXE]" />
      <input type="text" name="loginargs" expr="[Login Args]" />
      <input type="text" name="name" expr="[Queue Name]" />
    </inputs>
    <outputs>
      <output type="flag" name="success" stage="Success" />
      <output type="text" name="output" stage="Output" />
    </outputs>
    <onsuccess>4997b1a2-752b-4022-b76c-a621970db9cb</onsuccess>
    <code><![CDATA[
Dim args as String = _
 " /deletequeue " & _
 " /queuename """ & name & """ " & _
 "/" & loginargs

Dim proc as new System.Diagnostics.Process()
proc.EnableRaisingEvents = False
With proc.StartInfo
  .FileName=exe
  .Arguments = args
  .UseShellExecute = False
  .CreateNoWindow = True
  .RedirectStandardOutput = True
End With
proc.Start()
proc.WaitForExit()

Success = (proc.ExitCode = 0)
Output = proc.StandardOutput.ReadToEnd]]></code>
  </stage>
  <stage stageid="fb54e702-7a3b-4124-8fc8-4f617c0f79e6" name="Success" type="Data">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <display x="-135" y="30" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="700e23f4-7f84-4015-a93e-ab4e29e0277f" name="Output" type="Data">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <display x="-135" y="-15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a4ccc796-31e2-4fc8-860e-76ebad4af610" name="Login Args" type="Data">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="-270" y="30" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">user admin admin</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="29fdc98a-79b6-4753-bf47-ffd05087e608" name="AutomateC EXE" type="Data">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="-270" y="75" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">c:\BluePrism\automate\BluePrism.Automate\bin\AutomateC.exe</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d3a1ed67-1d15-4699-9c2f-c9afb6d1c7f9" name="Login Args" type="Data">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <loginhibit />
    <display x="-210" y="120" w="270" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">user admin admin</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="af1cded7-be96-471c-9bad-1b5c26be5f45" name="AutomateC EXE" type="Data">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <loginhibit />
    <display x="-210" y="150" w="270" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">c:\BluePrism\automate\BluePrism.Automate\bin\AutomateC.exe</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4997b1a2-752b-4022-b76c-a621970db9cb" name="Success?" type="Decision">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="15" y="-45" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>4f441641-6336-4652-9b29-0addb8984f83</ontrue>
    <onfalse>5a7b8e1d-5041-413d-97b7-237180310e37</onfalse>
  </stage>
  <stage stageid="0cefc141-b902-4811-bb5d-88bd50ce2746" name="FAIL" type="Exception">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <display x="120" y="0" w="30" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="AutomateC Error" detail="[Output]" />
  </stage>
  <stage stageid="7ff0a605-0e95-4900-956d-a424c6b5c965" name="Success?" type="Decision">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <loginhibit />
    <display x="15" y="-15" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Success]" />
    <ontrue>e05f4f91-f85a-4112-b7de-dc193f5b7432</ontrue>
    <onfalse>550e8587-b029-4c32-959a-59acaa8bcc8a</onfalse>
  </stage>
  <stage stageid="550e8587-b029-4c32-959a-59acaa8bcc8a" name="FAIL" type="Exception">
    <subsheetid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</subsheetid>
    <display x="135" y="-15" w="30" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="AutomateC Error" detail="&quot;Error: &quot; &amp; [Output]" />
  </stage>
  <stage stageid="f3281a99-638b-4db5-b786-361151f28256" name="Wait n seconds" type="SubSheetInfo">
    <subsheetid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</subsheetid>
    <display x="-165" y="-75" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="2e80ff66-c695-4c01-853c-1e9d7d33af60" name="Start" type="Start">
    <subsheetid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" narrative="The number of seconds to wait (can be fractional)" stage="Seconds" />
    </inputs>
    <onsuccess>42f6c562-3d9b-405f-912f-06db43a66557</onsuccess>
  </stage>
  <stage stageid="18fa51cc-2cc6-4a4e-a519-b802fe166adf" name="End" type="End">
    <subsheetid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</subsheetid>
    <loginhibit />
    <display x="15" y="15" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="7fae0e6a-7917-4998-881f-5295eb767ac9" name="Seconds" type="Data">
    <subsheetid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</subsheetid>
    <display x="-165" y="0" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9de2b8eb-fd10-49ad-bfb5-5546e255552d" name="o" type="WaitEnd">
    <subsheetid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</subsheetid>
    <loginhibit />
    <display x="60" y="-45" w="30" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>18fa51cc-2cc6-4a4e-a519-b802fe166adf</onsuccess>
    <groupid>d9753fdb-e674-4596-bbda-b17f18187753</groupid>
  </stage>
  <stage stageid="42f6c562-3d9b-405f-912f-06db43a66557" name="Wait n seconds" type="WaitStart">
    <subsheetid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</subsheetid>
    <loginhibit />
    <display x="-30" y="-45" w="60" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <groupid>d9753fdb-e674-4596-bbda-b17f18187753</groupid>
    <choices />
    <timeout>[Seconds]</timeout>
  </stage>
  <stage stageid="52c54625-bb33-46d5-8765-e082ea15de4c" name="Wait n seconds (5)" type="SubSheet">
    <subsheetid>887127fd-e756-4079-847f-81e92084426b</subsheetid>
    <loginhibit />
    <display x="15" y="-45" w="90" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" narrative="The number of seconds to wait (can be fractional)" expr="5" />
    </inputs>
    <onsuccess>3d82e2ab-45b2-4474-a3e3-a901efc1f27b</onsuccess>
    <processid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</processid>
  </stage>
  <stage stageid="8c8e4b9f-54b8-4686-8279-fc3b991bb732" name="Start" type="Start">
    <subsheetid>46eed926-0456-4d83-89b0-efbe3dc9a453</subsheetid>
    <loginhibit />
    <display x="-45" y="-135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>73676521-f482-491b-8aad-6b98a9be5065</onsuccess>
  </stage>
  <stage stageid="66a0c685-e727-4467-bcbc-667a70bb0296" name="End" type="End">
    <subsheetid>46eed926-0456-4d83-89b0-efbe3dc9a453</subsheetid>
    <loginhibit />
    <display x="-45" y="-15" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="73676521-f482-491b-8aad-6b98a9be5065" name="Wait n seconds (0.1)" type="SubSheet">
    <subsheetid>46eed926-0456-4d83-89b0-efbe3dc9a453</subsheetid>
    <loginhibit />
    <display x="-45" y="-75" w="90" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" narrative="The number of seconds to wait (can be fractional)" expr="0.1" />
    </inputs>
    <onsuccess>66a0c685-e727-4467-bcbc-667a70bb0296</onsuccess>
    <processid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</processid>
  </stage>
  <stage stageid="47e0755e-a2cf-4475-8c2e-cf21888fd5e6" name="Wait Rand(m,n) Seconds" type="SubSheetInfo">
    <subsheetid>68339725-266c-4c2e-a54e-e11aa473119a</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d5882506-0ce5-4428-af76-529a9459495c" name="End" type="End">
    <subsheetid>68339725-266c-4c2e-a54e-e11aa473119a</subsheetid>
    <loginhibit />
    <display x="45" y="75" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="72de040d-df8e-4b47-a47f-333361c08958" name="Get Random Number" type="SubSheet">
    <subsheetid>68339725-266c-4c2e-a54e-e11aa473119a</subsheetid>
    <loginhibit />
    <display x="45" y="-75" w="90" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Min Value" expr="[min]" />
      <input type="number" name="Max Value" expr="[max]" />
    </inputs>
    <outputs>
      <output type="number" name="Output" stage="period" />
    </outputs>
    <onsuccess>88070215-2d4e-4be9-a098-7abf50d0c05d</onsuccess>
    <processid>b385d3d1-3c2c-4c1d-8d28-4b1fb4ebd69d</processid>
  </stage>
  <stage stageid="94710634-9c4f-44a7-90c0-acc0a7c92759" name="period" type="Data">
    <subsheetid>68339725-266c-4c2e-a54e-e11aa473119a</subsheetid>
    <display x="-210" y="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f465a62c-dc6a-4cd6-b66e-899ba93fd552" name="Start" type="Start">
    <subsheetid>68339725-266c-4c2e-a54e-e11aa473119a</subsheetid>
    <display x="45" y="-135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Min Seconds" narrative="The minimum number of seconds to wait" stage="min" />
      <input type="number" name="Max Seconds" narrative="The maximum number of seconds to wait" stage="max" />
    </inputs>
    <onsuccess>72de040d-df8e-4b47-a47f-333361c08958</onsuccess>
  </stage>
  <stage stageid="bc853ad5-d630-4164-a67f-72b8fbe5778f" name="min" type="Data">
    <subsheetid>68339725-266c-4c2e-a54e-e11aa473119a</subsheetid>
    <display x="-180" y="-30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4df289fd-5fda-4cc6-9601-3ab9fb42349d" name="max" type="Data">
    <subsheetid>68339725-266c-4c2e-a54e-e11aa473119a</subsheetid>
    <display x="-195" y="0" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="88070215-2d4e-4be9-a098-7abf50d0c05d" name="Wait n seconds (period)" type="SubSheet">
    <subsheetid>68339725-266c-4c2e-a54e-e11aa473119a</subsheetid>
    <loginhibit />
    <display x="45" y="0" w="90" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" narrative="The number of seconds to wait (can be fractional)" expr="[period]" />
    </inputs>
    <onsuccess>d5882506-0ce5-4428-af76-529a9459495c</onsuccess>
    <processid>f3b7ce0a-1833-42ab-96f9-cdb8a82c67cb</processid>
  </stage>
  <stage stageid="a3c64ac5-823b-42f8-9b52-59a8682dfc09" name="Delete Items" type="Data">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <display x="-150" y="-45" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e472e983-4ec9-4bb3-adcf-49e9a6717715" name="Delete Items?" type="Decision">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="360" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Delete Items]" />
    <ontrue>ea523601-71ae-4e9e-9238-7866d434a71f</ontrue>
    <onfalse>97bdef6e-2804-4cd5-9e0c-6cde1f6e0440</onfalse>
  </stage>
  <stage stageid="ea523601-71ae-4e9e-9238-7866d434a71f" name="Delete Worked Items" type="Action">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="405" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue to delete items from" expr="[Queue Name]" />
      <input type="datetime" name="Date Threshold" narrative="The threshold date. Items completed or marked with an exception before this date will be deleted from the queue - if not given, all processed items in the specified queue will be deleted." expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Deletion Count" narrative="Indicates the number of items which were deleted (which may legitimately be zero)." stage="" />
    </outputs>
    <onsuccess>1e3013e1-3e4e-4b22-bad2-3deb15112553</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Delete Processed Items" />
  </stage>
  <stage stageid="2b51c950-fe70-4ff9-ade0-9ee8909ee9cc" name="anchor1" type="Anchor">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="-75" y="450" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>1e3013e1-3e4e-4b22-bad2-3deb15112553</onsuccess>
  </stage>
  <stage stageid="97bdef6e-2804-4cd5-9e0c-6cde1f6e0440" name="anchor1" type="Anchor">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="-75" y="360" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>2b51c950-fe70-4ff9-ade0-9ee8909ee9cc</onsuccess>
  </stage>
  <stage stageid="95cf714b-2dbb-4fea-a37f-57e818586c34" name="Destroy Queue" type="SubSheetInfo">
    <subsheetid>7bccced6-d989-4b42-b7a0-0dce2604d4db</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="1550141e-d083-4a76-a450-17204d545a6d" name="End" type="End">
    <subsheetid>7bccced6-d989-4b42-b7a0-0dce2604d4db</subsheetid>
    <loginhibit />
    <display x="-15" y="0" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="96f09dc0-183d-4111-827e-f860e309aae0" name="Start" type="Start">
    <subsheetid>7bccced6-d989-4b42-b7a0-0dce2604d4db</subsheetid>
    <loginhibit />
    <display x="-15" y="-135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue to delete" stage="Queue Name" />
    </inputs>
    <onsuccess>16ca392b-f2ba-40f7-a6be-14328eb98d30</onsuccess>
  </stage>
  <stage stageid="16ca392b-f2ba-40f7-a6be-14328eb98d30" name="Clear Queue" type="SubSheet">
    <subsheetid>7bccced6-d989-4b42-b7a0-0dce2604d4db</subsheetid>
    <loginhibit />
    <display x="-15" y="-90" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue whose items should all be cleared" expr="[Queue Name]" />
      <input type="text" name="Exception Message" narrative="The message which should be used as the exception for the unworked items" expr="" />
      <input type="flag" name="Delete Items" narrative="True to delete the items after they have been marked with an exception" expr="True" />
    </inputs>
    <onsuccess>92ea1b2e-e36e-4f14-8046-bfb4f4bcfb7d</onsuccess>
    <processid>ef914f05-dbd9-4984-b27d-acdbc410b332</processid>
  </stage>
  <stage stageid="acedd19e-0082-41b6-8676-78ce24fae9a4" name="Queue Name" type="Data">
    <subsheetid>7bccced6-d989-4b42-b7a0-0dce2604d4db</subsheetid>
    <display x="-195" y="-30" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="92ea1b2e-e36e-4f14-8046-bfb4f4bcfb7d" name="Delete Queue" type="SubSheet">
    <subsheetid>7bccced6-d989-4b42-b7a0-0dce2604d4db</subsheetid>
    <loginhibit />
    <display x="-15" y="-45" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue to delete" expr="[Queue Name]" />
    </inputs>
    <onsuccess>1550141e-d083-4a76-a450-17204d545a6d</onsuccess>
    <processid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</processid>
  </stage>
  <stage stageid="5f43380e-1e09-4cd4-908e-2e0276034116" name="Login Args" type="Data">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <loginhibit />
    <display x="-210" y="-15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">user admin admin</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f6e89c7d-4fef-40fe-95be-9477ba18dcf8" name="AutomateC EXE" type="Data">
    <subsheetid>e5e8f1d0-d6f9-4ab9-ab66-ba4f05ea2c23</subsheetid>
    <loginhibit />
    <display x="-210" y="30" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">c:\BluePrism\automate\BluePrism.Automate\bin\AutomateC.exe</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3a6a526b-d392-4b74-8422-ded7a760d3f9" name="Delete it" type="Action">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <narrative>Delete the given item from a queue. Note that there is no locking involved in this, i.e. you should only delete an item if you are sure it is safe to do so. On the other hand, attempting to delete an item that is locked (e.g. being worked by another process) will result in an error</narrative>
    <display x="15" y="45" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Item ID" narrative="The ID of the item to delete. An error will be raised if this item does not exist, or is locked." expr="[Locked Items.Item ID]" />
    </inputs>
    <onsuccess>f4cf5fbb-dcd1-46d4-84f3-0f4c9657b7d5</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Delete Item" />
  </stage>
  <stage stageid="4563f76a-b0af-4b0d-b711-7dc5dad82b26" name="Get Pending Items" type="Action">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <narrative>Retrieves the IDs for all currently pending work queue items in the specified queue, matching the given tags</narrative>
    <display x="15" y="180" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue for which the pending items are required" expr="[Queue Name]" />
      <input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
      <input type="number" name="Maximum" narrative="Optionally, the maximum number of items to return. Default is to return all items" expr="" />
      <input type="number" name="Skip" narrative="Optionally, the number of items to skip before returning. Default is zero, ie. return all items from the head of the queue" expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Pending Items" narrative="The currently pending items in the queue, referenced by ID. The single column is 'Item ID' : text. The elements in the collection will be in the order in which they will be loaded by the 'Get Next Item' action." stage="Pending Items" />
    </outputs>
    <onsuccess>2d509e01-230d-4999-8555-4fd79935d148</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Pending Items" />
  </stage>
  <stage stageid="384ea67c-c7d4-4b7a-97cb-bc0bded63868" name="Pending Items" type="Collection">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <display x="-270" y="90" w="150" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" />
    </collectioninfo>
  </stage>
  <stage stageid="2d509e01-230d-4999-8555-4fd79935d148" name="For Each Pending Item" type="LoopStart">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="225" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>50857d91-7ca4-4de3-8415-443fd49f0366</onsuccess>
    <groupid>b9b46f64-563a-4460-be38-65d21207f3c8</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Pending Items</loopdata>
  </stage>
  <stage stageid="8378417a-d6eb-402b-b8d2-3cb3456d8665" name="Next Pending Item" type="LoopEnd">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="315" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>e472e983-4ec9-4bb3-adcf-49e9a6717715</onsuccess>
    <groupid>b9b46f64-563a-4460-be38-65d21207f3c8</groupid>
  </stage>
  <stage stageid="50857d91-7ca4-4de3-8415-443fd49f0366" name="Delete it" type="Action">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <narrative>Delete the given item from a queue. Note that there is no locking involved in this, i.e. you should only delete an item if you are sure it is safe to do so. On the other hand, attempting to delete an item that is locked (e.g. being worked by another process) will result in an error</narrative>
    <display x="15" y="270" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Item ID" narrative="The ID of the item to delete. An error will be raised if this item does not exist, or is locked." expr="[Pending Items.Item ID]" />
    </inputs>
    <onsuccess>8378417a-d6eb-402b-b8d2-3cb3456d8665</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Delete Item" />
  </stage>
  <stage stageid="4580369e-8210-4f84-809c-2721e83a368f" name="Delete Items?" type="Decision">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="0" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Delete Items]" />
    <ontrue>3a6a526b-d392-4b74-8422-ded7a760d3f9</ontrue>
    <onfalse>d1985be9-db2d-450c-8753-e169bdcc47fe</onfalse>
  </stage>
  <stage stageid="d1985be9-db2d-450c-8753-e169bdcc47fe" name="anchor5" type="Anchor">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="-75" y="0" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>14b0f81b-93c7-439b-96d3-9116717fc5d3</onsuccess>
  </stage>
  <stage stageid="14b0f81b-93c7-439b-96d3-9116717fc5d3" name="anchor5" type="Anchor">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="-75" y="90" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>f4cf5fbb-dcd1-46d4-84f3-0f4c9657b7d5</onsuccess>
  </stage>
  <stage stageid="0d06c5f0-6636-4da7-88eb-ad1bfb832b4d" name="Delete Items?" type="Decision">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="15" y="135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Delete Items]" />
    <ontrue>4563f76a-b0af-4b0d-b711-7dc5dad82b26</ontrue>
    <onfalse>c793c113-a440-4fcb-94d8-4ae788a5bb2b</onfalse>
  </stage>
  <stage stageid="3fa895c0-9c1f-425b-af6c-1c66105c8120" name="anchor1" type="Anchor">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="270" y="180" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>47d5cab7-3e7c-43ca-94b6-3cdae8c972ea</onsuccess>
  </stage>
  <stage stageid="47d5cab7-3e7c-43ca-94b6-3cdae8c972ea" name="anchor1" type="Anchor">
    <subsheetid>ef914f05-dbd9-4984-b27d-acdbc410b332</subsheetid>
    <loginhibit />
    <display x="270" y="360" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>e472e983-4ec9-4bb3-adcf-49e9a6717715</onsuccess>
  </stage>
  <stage stageid="6525b7c7-bced-436c-bd61-9baaa581c4f4" name="Clear Queue" type="SubSheet">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="210" y="-90" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue whose items should all be cleared" expr="[Queue Name]" />
      <input type="text" name="Exception Message" narrative="The message which should be used as the exception for the unworked items" expr="" />
      <input type="flag" name="Delete Items" narrative="True to delete the items after they have been marked with an exception" expr="True" />
    </inputs>
    <onsuccess>c8fc8bda-286b-4185-9390-7b9de68f20b7</onsuccess>
    <processid>ef914f05-dbd9-4984-b27d-acdbc410b332</processid>
  </stage>
  <stage stageid="12eaaafd-3026-4154-9d3e-70459d6ec94f" name="Retried" type="Data">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="-135" y="75" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5a7b8e1d-5041-413d-97b7-237180310e37" name="Retried?" type="Decision">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="120" y="-45" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Retried]" />
    <ontrue>0cefc141-b902-4811-bb5d-88bd50ce2746</ontrue>
    <onfalse>d8b8b617-1863-4336-81dc-5b9fe7b63784</onfalse>
  </stage>
  <stage stageid="d8b8b617-1863-4336-81dc-5b9fe7b63784" name="Retried:=True" type="Calculation">
    <subsheetid>1f9a203f-b19f-4201-b62e-f9f2fc31e12a</subsheetid>
    <loginhibit />
    <display x="210" y="-45" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>6525b7c7-bced-436c-bd61-9baaa581c4f4</onsuccess>
    <calculation expression="True" stage="Retried" />
  </stage>
  <stage stageid="f8cee152-c89b-417c-a4de-e675cdc33ceb" name="Count Pending Items" type="SubSheetInfo">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="-180" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="c81ad051-40e6-40b0-9a27-901321121a40" name="Start" type="Start">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="15" y="-135" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue whose items should be counted" stage="Queue Name" />
      <input type="text" name="Tag Filter" narrative="Count only those items which pass a particular tag filter" stage="Tag Filter" />
      <input type="text" name="Key Filter" narrative="Count only those items with a particular key" stage="Key Filter" />
      <input type="number" name="Expected" narrative="The expected number of queue items currently unlocked and pending - a value of &quot;-1&quot; or leaving blank disables checking" stage="Expected" />
    </inputs>
    <onsuccess>f8de8e28-0330-4c4c-b326-81b932e7f132</onsuccess>
  </stage>
  <stage stageid="06decfb7-b138-4e2d-b39f-ebe3e5443114" name="Expected" type="Data">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="-240" y="60" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>-1</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="565de23a-1c45-4612-87d2-5d560e39555a" name="Item ID" type="Data">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="-135" y="60" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f3c128d9-51ae-4f47-a223-52e47fb72257" name="Count" type="Data">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="-135" y="-30" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bf70801e-d916-4889-b4af-bcfd1fdd8358" name="Queue Name" type="Data">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="-240" y="-30" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f8de8e28-0330-4c4c-b326-81b932e7f132" name="Get Pending Items" type="Action">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <loginhibit />
    <narrative>Retrieves the IDs for all currently pending work queue items in the specified queue, matching the given tags</narrative>
    <display x="15" y="-90" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue for which the pending items are required" expr="[Queue Name]" />
      <input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
      <input type="number" name="Maximum" narrative="Optionally, the maximum number of items to return. Default is to return all items" expr="" />
      <input type="number" name="Skip" narrative="Optionally, the number of items to skip before returning. Default is zero, ie. return all items from the head of the queue" expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Pending Items" narrative="The currently pending items in the queue, referenced by ID. The single column is 'Item ID' : text. The elements in the collection will be in the order in which they will be loaded by the 'Get Next Item' action." stage="Pending Items" />
    </outputs>
    <onsuccess>7c53d6f5-868f-4cca-a251-1c4e2c966b07</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Pending Items" />
  </stage>
  <stage stageid="3dbf9449-3141-43b9-ae20-16e0acb42195" name="Pending Items" type="Collection">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="-180" y="105" w="150" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" />
    </collectioninfo>
  </stage>
  <stage stageid="7c53d6f5-868f-4cca-a251-1c4e2c966b07" name="Count Pending Items" type="Action">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <loginhibit />
    <display x="15" y="-45" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Pending Items&quot;" />
    </inputs>
    <outputs>
      <output type="number" name="Count" narrative="The number of rows counted in the collection" stage="Count" />
    </outputs>
    <onsuccess>c31dbc14-35b7-4670-b056-85bce5c4ace1</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" />
  </stage>
  <stage stageid="520d1029-3ad5-4ca3-a123-1ffbb4795d0d" name="End" type="End">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="15" y="120" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="number" name="Count" narrative="The count of pending items in the work queue" stage="Count" />
    </outputs>
  </stage>
  <stage stageid="d9e9a504-5008-4e1c-b00a-35547e2aa88a" name="Is that a bingo?" type="Decision">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <loginhibit />
    <display x="15" y="45" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Count] = [Expected]" />
    <ontrue>520d1029-3ad5-4ca3-a123-1ffbb4795d0d</ontrue>
    <onfalse>9a5fd731-e3fc-4d33-8d29-9c2cc9d5f100</onfalse>
  </stage>
  <stage stageid="9a5fd731-e3fc-4d33-8d29-9c2cc9d5f100" name="Basterd" type="Exception">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="120" y="45" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception type="Queue Test Failed" detail="&quot;Expected &quot; &amp; [Expected] &amp; &quot; items in the bongiovi queue - found &quot; &amp; [Count]" />
  </stage>
  <stage stageid="c31dbc14-35b7-4670-b056-85bce5c4ace1" name="Are we checking?" type="Decision">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <loginhibit />
    <display x="15" y="0" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Expected] &gt; -1" />
    <ontrue>d9e9a504-5008-4e1c-b00a-35547e2aa88a</ontrue>
    <onfalse>81009729-c61d-4493-b8a9-e0d9c122c712</onfalse>
  </stage>
  <stage stageid="81009729-c61d-4493-b8a9-e0d9c122c712" name="anchor3" type="Anchor">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <loginhibit />
    <display x="-60" y="0" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>b9e24cdc-5529-4c2d-82c2-17e506a51453</onsuccess>
  </stage>
  <stage stageid="b9e24cdc-5529-4c2d-82c2-17e506a51453" name="anchor3" type="Anchor">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <loginhibit />
    <display x="-60" y="120" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>520d1029-3ad5-4ca3-a123-1ffbb4795d0d</onsuccess>
  </stage>
  <stage stageid="dc743696-158b-408c-b2d1-dc1dd3a73b32" name="Tag Filter" type="Data">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="-240" y="15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4c15d233-62a6-4c96-87be-bf65eaf01083" name="Key Filter" type="Data">
    <subsheetid>ef99d5b8-ccf1-4256-aaf8-1db843dd0d26</subsheetid>
    <display x="-135" y="15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2ca19c66-e19f-478f-9866-2c8933c42c60" name="Create (If Not Exists) Queue" type="SubSheetInfo">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <narrative>Creates a named queue, skipping the creation if it already exists</narrative>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="9759bae9-4bce-488e-a53c-1b86272c6d50" name="End" type="End">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <loginhibit />
    <display x="15" y="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="flag" name="Created" narrative="Flag indicating if the queue was created by this action (True) or if it already exists (False)" stage="Created" />
    </outputs>
  </stage>
  <stage stageid="e534c3ee-c93c-42a4-b67b-796af422775a" name="Recover" type="Recover">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="120" y="-60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>67e6dcf8-2487-4e4f-83b0-45d00d3dea35</onsuccess>
  </stage>
  <stage stageid="67e6dcf8-2487-4e4f-83b0-45d00d3dea35" name="Duplicate Key?" type="Decision">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="195" y="-60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="InStr(ExceptionDetail(), &quot;Cannot insert duplicate key in object 'dbo.BPAWorkQueue'&quot;) &gt; 0" />
    <ontrue>2390a60c-69ae-4c5f-9e25-d986a48e3bcb</ontrue>
    <onfalse>13123d35-259a-4f4f-86ac-74562880fc39</onfalse>
  </stage>
  <stage stageid="2390a60c-69ae-4c5f-9e25-d986a48e3bcb" name="Resume" type="Resume">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="195" y="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>60d96891-337a-4e9c-8d7f-7242ecf6a314</onsuccess>
  </stage>
  <stage stageid="13123d35-259a-4f4f-86ac-74562880fc39" name="REFAIL" type="Exception">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="285" y="-60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <exception localized="yes" type="Error" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="60d96891-337a-4e9c-8d7f-7242ecf6a314" name="anchor4" type="Anchor">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="15" y="30" w="10" h="10" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>9759bae9-4bce-488e-a53c-1b86272c6d50</onsuccess>
  </stage>
  <stage stageid="42aaca38-ec7c-4ccc-a463-1d9412ac7f29" name="Try..Catch" type="Block">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="-60" y="-90" w="300" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="08ef15e6-1002-4228-a0dd-ed708d3aa226" name="Start" type="Start">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <loginhibit />
    <display x="15" y="-120" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue to be created" stage="Queue Name" />
      <input type="text" name="Key Field" narrative="The key column to use in the collection which makes up a queue item" stage="Key Field" />
      <input type="number" name="Max Attempts" narrative="The maximum number of retry attempts for the queue. Default: 5" stage="Max Attempts" />
    </inputs>
    <onsuccess>8d960dbd-4c11-4d4e-b775-b0d64ebe296e</onsuccess>
  </stage>
  <stage stageid="e6b47f11-05ce-4176-8065-3677aa45cb20" name="Queue Name" type="Data">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b46a54af-2107-4cb1-a33b-d7dbee6fca12" name="Key Field" type="Data">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="-195" y="15" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e917d954-8721-4fca-9d9c-c40f19de6431" name="Max Attempts" type="Data">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="-195" y="45" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8d960dbd-4c11-4d4e-b775-b0d64ebe296e" name="Create Queue" type="SubSheet">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <loginhibit />
    <display x="15" y="-60" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue to be created" expr="[Queue Name]" />
      <input type="text" name="Key Field" narrative="The key column to use in the collection which makes up a queue item" expr="[Key Field]" />
      <input type="number" name="Max Attempts" narrative="The maximum number of retry attempts for the queue. Default: 5" expr="[Max Attempts]" />
    </inputs>
    <onsuccess>61d25fc9-65d2-42c8-ae37-c920cf3ca715</onsuccess>
    <processid>a913d1b2-037f-49ec-b3bd-fa0a3d0c112b</processid>
  </stage>
  <stage stageid="06a35a80-e4fe-4723-952d-b3d77ed21c12" name="Created" type="Data">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <display x="-195" y="120" w="120" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="61d25fc9-65d2-42c8-ae37-c920cf3ca715" name="Created:=True" type="Calculation">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <loginhibit />
    <display x="15" y="0" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>60d96891-337a-4e9c-8d7f-7242ecf6a314</onsuccess>
    <calculation expression="True" stage="Created" />
  </stage>
  <stage stageid="907d82b8-de74-4d68-a1a0-61e6ed845b13" name="Inputs" type="Block">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <loginhibit />
    <display x="-270" y="-45" w="150" h="120" />
    <font family="Tahoma" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="1048e02b-1e90-4b84-adc4-66b7c18ee7ef" name="Outputs" type="Block">
    <subsheetid>67e059a8-19ee-4cb7-aa36-1fefd0731377</subsheetid>
    <loginhibit />
    <display x="-270" y="90" w="150" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="008000" />
  </stage>
</process>