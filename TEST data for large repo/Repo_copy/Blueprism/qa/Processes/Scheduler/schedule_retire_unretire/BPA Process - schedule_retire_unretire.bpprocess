<process name="schedule_retire_unretire" version="1.0" bpversion="6.11.0.34639" narrative="" byrefcollection="true" preferredid="fdc4e03b-a00d-4786-a46b-d548903ea12b" published="true">
  <view>
    <camerax>70</camerax>
    <cameray>-402</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="b206be12-0083-4219-98c6-391facede2b8" type="Normal" published="False">
    <name>Setup</name>
    <view>
      <camerax>136</camerax>
      <cameray>141</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="519d16f4-104f-4fe1-a442-17ed468a3f38" type="Normal" published="False">
    <name>Retire Schedule</name>
    <view>
      <camerax>0</camerax>
      <cameray>208</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="a7fb0091-52c4-447a-af51-ec93f8be0e6f" type="Normal" published="False">
    <name>Unretire Schedule</name>
    <view>
      <camerax>0</camerax>
      <cameray>198</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b09b0a30-91e6-4b8f-a6e9-7ffb21a34375" type="Normal" published="False">
    <name>Check Audit</name>
    <view>
      <camerax>0</camerax>
      <cameray>180</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="5677aa87-3fee-498e-ae34-23c406fe0ab5" type="Normal" published="False">
    <name>CleanUp</name>
    <view>
      <camerax>45</camerax>
      <cameray>42</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="0514bda8-d583-4bb0-a422-fd7c9466de9d" name="End" type="End">
    <display x="150" y="-150" />
  </stage>
  <stage stageid="a4d8d77b-a4d1-4fe0-a811-969cce9c5fa2" name="Stage1" type="ProcessInfo">
    <display x="-135" y="-555" w="150" h="90" />
  </stage>
  <stage stageid="972f809a-fb3b-4cca-b1a5-f04828133061" name="CleanUp" type="SubSheetInfo">
    <subsheetid>5677aa87-3fee-498e-ae34-23c406fe0ab5</subsheetid>
    <display x="-90" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="51875169-1114-46e6-9678-cbb42bf53231" name="Start" type="Start">
    <subsheetid>5677aa87-3fee-498e-ae34-23c406fe0ab5</subsheetid>
    <display x="45" y="-105" />
    <onsuccess>aa5592d8-8793-47cc-98c9-98b06ea3b1c7</onsuccess>
  </stage>
  <stage stageid="5a1dcf04-58b8-4ac5-8ee1-c5cee4ca980d" name="End" type="End">
    <subsheetid>5677aa87-3fee-498e-ae34-23c406fe0ab5</subsheetid>
    <display x="45" y="120" />
  </stage>
  <stage stageid="5921caac-ceea-4f68-9c99-692702df27f3" name="Exit App" type="Action">
    <subsheetid>5677aa87-3fee-498e-ae34-23c406fe0ab5</subsheetid>
    <display x="45" y="75" w="90" h="30" />
    <onsuccess>5a1dcf04-58b8-4ac5-8ee1-c5cee4ca980d</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="bc0f368d-c0e1-473a-8548-5e99b9e8fc76" name="Local Variables" type="Block">
    <display x="-210" y="-360" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ef05b229-b12e-4589-b403-3cf6e57ac260" name="Failed?" type="Data">
    <display x="-135" y="-330" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="e38008e4-cdcb-485e-b74c-83a821fb159a" name="CleanUp" type="SubSheet">
    <display x="150" y="-240" w="90" h="30" />
    <onsuccess>0846dcdb-ab20-41df-946b-a4815a86c141</onsuccess>
    <processid>5677aa87-3fee-498e-ae34-23c406fe0ab5</processid>
  </stage>
  <stage stageid="ef1c11a6-d184-470e-a868-37911c5aaf01" name="Exception" type="Data">
    <display x="-135" y="-300" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="4fea7dcc-6d2d-4c07-848a-8a4984333a37" name="Delete Schedule" type="Action">
    <subsheetid>5677aa87-3fee-498e-ae34-23c406fe0ab5</subsheetid>
    <display x="45" y="30" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" narrative="The name of the schedule which will be run" expr="[Schedule Name]" />
    </inputs>
    <onsuccess>5921caac-ceea-4f68-9c99-692702df27f3</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Delete Schedule" />
  </stage>
  <stage stageid="0846dcdb-ab20-41df-946b-a4815a86c141" name="Failed?" type="Decision">
    <display x="150" y="-195" w="90" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>ef7ad72b-c4cc-40cc-8390-4accfdc5e2d1</ontrue>
    <onfalse>0514bda8-d583-4bb0-a422-fd7c9466de9d</onfalse>
  </stage>
  <stage stageid="ef7ad72b-c4cc-40cc-8390-4accfdc5e2d1" name="RETHROW" type="Exception">
    <display x="240" y="-195" />
    <exception type="RETHROW" detail="[Exception]" />
  </stage>
  <stage stageid="c3ff0145-b82f-4230-8e6f-e9d4e4e79964" name="Anchor17" type="Anchor">
    <display x="375" y="-240" w="10" h="10" />
    <onsuccess>e38008e4-cdcb-485e-b74c-83a821fb159a</onsuccess>
  </stage>
  <stage stageid="1ef5b7e5-4608-4a6f-bfbc-0e52d0169086" name="Open Control Tab" type="Action">
    <subsheetid>5677aa87-3fee-498e-ae34-23c406fe0ab5</subsheetid>
    <display x="45" y="-15" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>4fea7dcc-6d2d-4c07-848a-8a4984333a37</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="aa5592d8-8793-47cc-98c9-98b06ea3b1c7" name="Go Home Tab" type="Action">
    <subsheetid>5677aa87-3fee-498e-ae34-23c406fe0ab5</subsheetid>
    <display x="45" y="-60" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Home&quot;" />
    </inputs>
    <onsuccess>1ef5b7e5-4608-4a6f-bfbc-0e52d0169086</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="76bf9f83-b563-46b8-8f92-019e437a6a25" name="pid" type="Data">
    <display x="-135" y="-465" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="1111aad0-dd01-439e-a9a3-5f37c774da77" name="Start" type="Start">
    <display x="150" y="-585" />
    <onsuccess>86250b0b-31b2-4f3b-b6f1-aec8a1056cb6</onsuccess>
  </stage>
  <stage stageid="3c04cc23-c34f-4560-a782-96d107a07fff" name="Setup" type="SubSheetInfo">
    <subsheetid>b206be12-0083-4219-98c6-391facede2b8</subsheetid>
    <display x="0" y="15" w="150" h="90" />
  </stage>
  <stage stageid="dc2314a0-c968-4e53-8cd2-33d93b90564c" name="Start" type="Start">
    <subsheetid>b206be12-0083-4219-98c6-391facede2b8</subsheetid>
    <display x="135" y="-15" />
    <onsuccess>e7ca457c-143e-4aed-b99a-4bffbcc26a64</onsuccess>
  </stage>
  <stage stageid="1a29547f-46ac-435f-8d9c-1800266668f8" name="End" type="End">
    <subsheetid>b206be12-0083-4219-98c6-391facede2b8</subsheetid>
    <display x="135" y="255" />
  </stage>
  <stage stageid="49d097d9-327c-4cb4-8f5a-cebc64391f5d" name="Sign In" type="Action">
    <subsheetid>b206be12-0083-4219-98c6-391facede2b8</subsheetid>
    <display x="135" y="210" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" expr="" />
      <input type="password" name="Password" expr="" />
      <input type="password" name="New Password" narrative="If this is your first login it will prompt you to change the password." expr="" />
    </inputs>
    <onsuccess>1a29547f-46ac-435f-8d9c-1800266668f8</onsuccess>
    <resource object="Blue Prism" action="Sign In" />
  </stage>
  <stage stageid="2bb133c6-0be3-4b87-9643-2047f428c631" name="Launch Blue Prism" type="Action">
    <subsheetid>b206be12-0083-4219-98c6-391facede2b8</subsheetid>
    <display x="135" y="75" w="90" h="30" />
    <outputs>
      <output type="number" name="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>8ddd382c-5924-4faa-99fb-c5a748cdf689</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="8ddd382c-5924-4faa-99fb-c5a748cdf689" name="Attach Control" type="Action">
    <subsheetid>b206be12-0083-4219-98c6-391facede2b8</subsheetid>
    <display x="135" y="120" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>6b4ac672-687d-4739-ae49-79b9a71bda8e</onsuccess>
    <resource object="Blue Prism - Control Room (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="6b4ac672-687d-4739-ae49-79b9a71bda8e" name="Attach System" type="Action">
    <subsheetid>b206be12-0083-4219-98c6-391facede2b8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="135" y="165" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>49d097d9-327c-4cb4-8f5a-cebc64391f5d</onsuccess>
    <resource object="Blue Prism - System (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="f74cdfe6-24ea-4e99-8ed4-d83ce29cead2" name="Global Variables" type="Block">
    <display x="-210" y="-495" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="3c9d7ae3-3747-4a54-9dac-ba4dc9217d22" name="Setup" type="SubSheet">
    <display x="150" y="-480" w="360" h="30" />
    <onsuccess>d4fd88d7-1795-4172-b2ec-e65d62ac712e</onsuccess>
    <processid>b206be12-0083-4219-98c6-391facede2b8</processid>
  </stage>
  <stage stageid="cf75e266-71bf-4fba-bb57-9868321ddd51" name="Retire Schedule" type="SubSheetInfo">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="-120" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="49d4eb00-d3a3-4728-9fac-ca45acb7a95b" name="Start" type="Start">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>147d07c4-1f98-43e1-a745-147783d6caec</onsuccess>
  </stage>
  <stage stageid="8b502118-fa2c-453b-a512-e01a9cb1a489" name="Retire Schedule" type="SubSheet">
    <display x="150" y="-390" w="360" h="30" />
    <onsuccess>10d8ef05-c491-4e19-a373-1f309fbe9707</onsuccess>
    <processid>519d16f4-104f-4fe1-a442-17ed468a3f38</processid>
  </stage>
  <stage stageid="147d07c4-1f98-43e1-a745-147783d6caec" name="Go to Control" type="Action">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>c5deb4ad-8846-499f-a305-7631c7e44b9d</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="225c9e60-5984-49a2-a2d2-c508252158a5" name="Unretire Schedule" type="SubSheetInfo">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="-135" y="-120" w="150" h="90" />
  </stage>
  <stage stageid="2386d4c9-9ee5-4b5c-8b15-db2504ea6c95" name="Unretire Schedule" type="SubSheet">
    <display x="150" y="-300" w="360" h="30" />
    <onsuccess>e38008e4-cdcb-485e-b74c-83a821fb159a</onsuccess>
    <processid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</processid>
  </stage>
  <stage stageid="7b30f950-3bee-416a-b961-a559465625bc" name="Cleanup Block" type="Block">
    <display x="-45" y="-555" w="465" h="285" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="025f768e-a0d6-4f7b-8611-8a6b97421762" name="Resume" type="Resume">
    <display x="375" y="-315" />
    <onsuccess>c3ff0145-b82f-4230-8e6f-e9d4e4e79964</onsuccess>
  </stage>
  <stage stageid="5a23faa0-a873-4271-9367-a9ec34d412fe" name="Exception Calc" type="MultipleCalculation">
    <display x="375" y="-360" />
    <onsuccess>025f768e-a0d6-4f7b-8611-8a6b97421762</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="86250b0b-31b2-4f3b-b6f1-aec8a1056cb6" name="Note2" type="Note">
    <narrative>Given I am a BP user and I have a schedule setup</narrative>
    <display x="150" y="-525" w="360" h="30" />
    <onsuccess>3c9d7ae3-3747-4a54-9dac-ba4dc9217d22</onsuccess>
  </stage>
  <stage stageid="d4fd88d7-1795-4172-b2ec-e65d62ac712e" name="Note2" type="Note">
    <narrative>WHEN I retire the schedule
THEN the schedule is moved into the Retired Schedules folder and an audit log is registered</narrative>
    <display x="150" y="-435" w="360" h="30" />
    <onsuccess>8b502118-fa2c-453b-a512-e01a9cb1a489</onsuccess>
  </stage>
  <stage stageid="10d8ef05-c491-4e19-a373-1f309fbe9707" name="Note2" type="Note">
    <narrative>WHEN I un-retire the schedule
THEN the schedule is moved into the Schedules folder and an audit log is registered</narrative>
    <display x="150" y="-345" w="360" h="30" />
    <onsuccess>2386d4c9-9ee5-4b5c-8b15-db2504ea6c95</onsuccess>
  </stage>
  <stage stageid="3f775b7a-ca65-41cc-9fdf-fcf2ce5bc23b" name="Schedule Name" type="Data">
    <display x="-135" y="-435" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Schedule TFM-361</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="98ac2971-3e66-4583-afb5-81f359257270" name="Recover" type="Recover">
    <display x="375" y="-405" />
    <onsuccess>5a23faa0-a873-4271-9367-a9ec34d412fe</onsuccess>
  </stage>
  <stage stageid="34fcc648-103c-46db-aeb1-1108c258fd51" name="Time" type="Data">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="-120" y="15" w="120" h="30" />
    <datatype>time</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="95fb1db2-b518-49ec-a104-7595a654eba6" name="Local variables" type="Block">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="84dc659b-516a-4ae7-93e8-8cdece4ed459" name="Time" type="Data">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="-135" y="-30" w="120" h="30" />
    <datatype>time</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="689c6e6b-1b2f-4ef9-9688-3adb7de7d1e0" name="Local variables" type="Block">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-60" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c5deb4ad-8846-499f-a305-7631c7e44b9d" name="Get Time" type="Calculation">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <onsuccess>cb8d4438-4e8e-4f2f-b89e-24eac005b7f8</onsuccess>
    <calculation expression="UTCTime()" stage="Time" />
  </stage>
  <stage stageid="026b09e3-20e8-41aa-8d69-22048be9d36f" name="Check Audit Log" type="SubSheet">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="15" y="300" w="90" h="30" />
    <inputs>
      <input type="text" name="Narrative" friendlyname="Narrative" expr="&quot;The user '&quot; &amp; [Current Username] &amp; &quot;' retired the schedule '&quot; &amp; [Schedule Name] &amp; &quot;'&quot;" />
      <input type="text" name="Comments" friendlyname="Comments" expr="&quot;&quot;" />
      <input type="time" name="Time" friendlyname="Time" expr="[Time]" />
      <input type="text" name="Test" friendlyname="Test" expr="&quot;Schedule Retire&quot;" />
    </inputs>
    <onsuccess>6b13f02c-daa0-4ea0-b186-387617df7fa5</onsuccess>
    <processid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</processid>
  </stage>
  <stage stageid="3df03e94-36c2-4d45-97be-b065144cd539" name="Check Audit" type="SubSheetInfo">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="f41229a4-d343-48ab-bcd8-5cb0b662c10d" name="Start" type="Start">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="-135" />
    <inputs>
      <input type="text" name="Narrative" stage="Narrative" />
      <input type="text" name="Comments" stage="Comments" />
      <input type="time" name="Time" stage="Time" />
      <input type="text" name="Test" stage="Test" />
    </inputs>
    <onsuccess>2b81c589-6b34-482d-9e95-ae3164b7d687</onsuccess>
  </stage>
  <stage stageid="c05d4a49-078f-43e3-a3f9-72247b8e8fc2" name="Get Audit Log" type="Action">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="45" w="90" h="30" />
    <inputs>
      <input type="date" name="Audit Date" friendlyname="Audit Date" narrative="Date for the Audit to View" expr="Today()" />
    </inputs>
    <outputs>
      <output type="collection" name="Audit Log Table" friendlyname="Audit Log Table" narrative="Contents of the Audit Log Viewer" stage="Audit Log Table" />
    </outputs>
    <onsuccess>97157296-a8ce-48a0-b7a8-e58dd881f4d4</onsuccess>
    <resource object="Blue Prism - System - Audit" action="Get View Log Content for Audit Log" />
  </stage>
  <stage stageid="97157296-a8ce-48a0-b7a8-e58dd881f4d4" name="Audit Log Loop" type="LoopStart">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="90" w="90" h="30" />
    <onsuccess>44892ca6-e2ed-44d2-957e-bf5ddbf7e48a</onsuccess>
    <groupid>681fa8d3-61bc-402e-9afe-797586603995</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Audit Log Table</loopdata>
  </stage>
  <stage stageid="00430552-dce3-42cc-a7a6-7667bc01f9b6" name="Audit Log Loop" type="LoopEnd">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="225" w="90" h="30" />
    <onsuccess>4d8ac0b1-07fe-465c-a7a6-41cf022c0689</onsuccess>
    <groupid>681fa8d3-61bc-402e-9afe-797586603995</groupid>
  </stage>
  <stage stageid="abdbef85-a521-4a59-b64a-67823e1fc01a" name="Audit Entry Present?" type="Decision">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="180" w="90" h="30" />
    <decision expression="[Audit Log Table.Narrative]=[Narrative]&#xA;AND&#xA;[Audit Log Table.Comments]=[Comments]&#xA;AND&#xA;[Audit Time]&gt;=[Time]" />
    <ontrue>59385803-acee-4836-970a-f9a337a1e4e9</ontrue>
    <onfalse>00430552-dce3-42cc-a7a6-7667bc01f9b6</onfalse>
  </stage>
  <stage stageid="83151729-4cf2-40a9-870b-7ec1219479af" name="End1" type="End">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="360" />
  </stage>
  <stage stageid="78d997b8-94b9-4ee1-92f1-b31a2ac947bc" name="Browse to Audit Log" type="Action">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" friendlyname="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Audit&quot;" />
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Audit Logs&quot;" />
      <input type="text" name="Sub Item Name" friendlyname="Sub Item Name" narrative="Name of the sub item to be clicked on." expr="" />
      <input type="flag" name="Select Item Method?" friendlyname="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" friendlyname="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" friendlyname="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>c05d4a49-078f-43e3-a3f9-72247b8e8fc2</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="44892ca6-e2ed-44d2-957e-bf5ddbf7e48a" name="Cast Time" type="Calculation">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="135" w="90" h="30" />
    <onsuccess>abdbef85-a521-4a59-b64a-67823e1fc01a</onsuccess>
    <calculation expression="[Audit Log Table.Time (Local)]" stage="Audit Time" />
  </stage>
  <stage stageid="4d8ac0b1-07fe-465c-a7a6-41cf022c0689" name="Set Fail" type="MultipleCalculation">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="270" w="90" h="30" />
    <onsuccess>eb880f9d-9cf3-4739-921b-03864e7d96ea</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot; &quot;&amp;[Test]&amp;&quot; test has failed.&quot;" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="59385803-acee-4836-970a-f9a337a1e4e9" name="Anchor1" type="Anchor">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="15" y="180" w="10" h="10" />
    <onsuccess>fa85b007-c753-494a-b70b-1872bcd92f69</onsuccess>
  </stage>
  <stage stageid="fa85b007-c753-494a-b70b-1872bcd92f69" name="Anchor2" type="Anchor">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="15" y="315" w="10" h="10" />
    <onsuccess>eb880f9d-9cf3-4739-921b-03864e7d96ea</onsuccess>
  </stage>
  <stage stageid="2b81c589-6b34-482d-9e95-ae3164b7d687" name="Browse to Home" type="Action">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;Home&quot;" />
    </inputs>
    <onsuccess>a0bde460-8d96-465f-834e-b4f2fe168961</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="a0bde460-8d96-465f-834e-b4f2fe168961" name="Browse to System" type="Action">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="-45" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>78d997b8-94b9-4ee1-92f1-b31a2ac947bc</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="eb880f9d-9cf3-4739-921b-03864e7d96ea" name="Browse to Home" type="Action">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-45" y="315" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;Home&quot;" />
    </inputs>
    <onsuccess>83151729-4cf2-40a9-870b-7ec1219479af</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="880f6c99-a81a-4261-b226-8011b43d2a52" name="Audit Log Table" type="Collection">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-195" y="150" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8b132881-b2a9-44ad-a633-d8ecd3f99a6d" name="Narrative" type="Data">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="fde3c123-e9e2-4c40-a086-fa3cc8f2ff36" name="Input Variable" type="Block">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-270" y="-45" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="75020da4-b8b8-4acf-b778-77be0553c8f1" name="Local Variable" type="Block">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-270" y="120" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="68efd47e-e891-489a-8db0-4661ecbb8ab2" name="Comments" type="Data">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-195" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="29b2dfcc-a6d4-4818-995d-8e17ffeb7900" name="Time" type="Data">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-195" y="45" w="120" h="30" />
    <datatype>time</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="fd87586a-db83-46e2-bac0-9c30f20e5f03" name="Audit Time" type="Data">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-195" y="180" w="120" h="30" />
    <datatype>time</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0d2e718e-7fce-47f6-a5d1-803eaebe2016" name="Test" type="Data">
    <subsheetid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</subsheetid>
    <display x="-195" y="75" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b7a41360-97e2-4250-83da-892c0e26cdb8" name="Retire Schedule" type="Action">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" expr="[Schedule Name]" />
      <input type="text" name="Context Menu Item to Select" friendlyname="Context Menu Item to Select" expr="&quot;Retire&quot;" />
    </inputs>
    <onsuccess>c8970f4a-4cb8-46d1-bb58-93a2ee239a53</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Select an item on a Schedule context menu (Dynamic)" />
  </stage>
  <stage stageid="cb8d4438-4e8e-4f2f-b89e-24eac005b7f8" name="Expand Schedules" type="Action">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" narrative="The name of the schedule you want to exapnd." expr="&quot;Schedules&quot;" />
      <input type="flag" name="State" friendlyname="State" narrative="The state you want to set, True or False." expr="&quot;True&quot;" />
    </inputs>
    <onsuccess>b7a41360-97e2-4250-83da-892c0e26cdb8</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Expand Schedule" />
  </stage>
  <stage stageid="c8970f4a-4cb8-46d1-bb58-93a2ee239a53" name="Get Retired Schedules" type="Action">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Group Name" friendlyname="Group Name" expr="&quot;Retired Schedules&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Tree Items" friendlyname="Tree Items" stage="Tree Items" />
    </outputs>
    <onsuccess>2db1cbb2-f484-4303-8e09-12e4ecd65123</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Read Child Tree Items" />
  </stage>
  <stage stageid="62d687fe-2b38-42c6-ad23-9d7bbbfc96bd" name="Tree Items" type="Collection">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="-120" y="90" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ff9b8708-9630-4aa1-a7c8-6cb56b259cff" name="Output" type="Block">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="60" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="2db1cbb2-f484-4303-8e09-12e4ecd65123" name="Retired Schedules" type="LoopStart">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="165" w="90" h="30" />
    <onsuccess>bd36190e-3ed3-4adf-ab2b-5839edcc327f</onsuccess>
    <groupid>e92da472-b579-404e-8da5-b5083dff3356</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Tree Items</loopdata>
  </stage>
  <stage stageid="9d70161b-df93-4c27-b2de-cde541f61f00" name="Retired Schedules" type="LoopEnd">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="255" w="90" h="30" />
    <onsuccess>41183a83-8377-4c10-8be5-e67d3e883cf8</onsuccess>
    <groupid>e92da472-b579-404e-8da5-b5083dff3356</groupid>
  </stage>
  <stage stageid="bd36190e-3ed3-4adf-ab2b-5839edcc327f" name="Schedule Retired?" type="Decision">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="15" y="210" w="90" h="30" />
    <decision expression="[Tree Items.Node Text]=[Schedule Name]" />
    <ontrue>f22e7d0e-3828-464a-ad3b-fe5444034d6d</ontrue>
    <onfalse>9d70161b-df93-4c27-b2de-cde541f61f00</onfalse>
  </stage>
  <stage stageid="41183a83-8377-4c10-8be5-e67d3e883cf8" name="Failed " type="Exception">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <display x="105" y="255" />
    <exception localized="yes" type="Failed Test" detail="&quot;The schedule is not retired&quot;" />
  </stage>
  <stage stageid="f22e7d0e-3828-464a-ad3b-fe5444034d6d" name="Anchor5" type="Anchor">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="210" w="10" h="10" />
    <onsuccess>9a60ecc2-cf5b-4585-a79a-a28ca3682f9a</onsuccess>
  </stage>
  <stage stageid="9a60ecc2-cf5b-4585-a79a-a28ca3682f9a" name="Anchor6" type="Anchor">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="300" w="10" h="10" />
    <onsuccess>026b09e3-20e8-41aa-8d69-22048be9d36f</onsuccess>
  </stage>
  <stage stageid="6b13f02c-daa0-4ea0-b186-387617df7fa5" name="End2" type="End">
    <subsheetid>519d16f4-104f-4fe1-a442-17ed468a3f38</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="345" />
  </stage>
  <stage stageid="8356cc8c-903e-4ee8-be96-3e4c40a431e0" name="Start" type="Start">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="15" y="-150" />
    <onsuccess>4644d327-4698-41e1-aef2-1c22ac5bc1a5</onsuccess>
  </stage>
  <stage stageid="4644d327-4698-41e1-aef2-1c22ac5bc1a5" name="Go to Control" type="Action">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="15" y="-105" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>e193ef67-3b50-4ab7-bcf2-256cacb29a24</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="e193ef67-3b50-4ab7-bcf2-256cacb29a24" name="Get Time" type="Calculation">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <onsuccess>0dd94256-7dda-491b-a752-d6fb480fcb72</onsuccess>
    <calculation expression="UTCTime()" stage="Time" />
  </stage>
  <stage stageid="e0a56a68-d81f-473f-b900-561831fcec18" name="Check Audit Log" type="SubSheet">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="15" y="255" w="90" h="30" />
    <inputs>
      <input type="text" name="Narrative" friendlyname="Narrative" expr="&quot;The user '&quot; &amp; [Current Username] &amp; &quot;' unretired the schedule '&quot; &amp; [Schedule Name] &amp; &quot;'&quot;" />
      <input type="text" name="Comments" friendlyname="Comments" expr="&quot;&quot;" />
      <input type="time" name="Time" friendlyname="Time" expr="[Time]" />
      <input type="text" name="Test" friendlyname="Test" expr="&quot;Schedule Un-Retire&quot;" />
    </inputs>
    <onsuccess>047eec2f-0002-4d02-a89c-0afea677afbb</onsuccess>
    <processid>b09b0a30-91e6-4b8f-a6e9-7ffb21a34375</processid>
  </stage>
  <stage stageid="9b217fe0-ca85-4a77-a118-6f86303dad67" name="Un-Retire Schedule" type="Action">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" expr="[Schedule Name]" />
      <input type="text" name="Context Menu Item to Select" friendlyname="Context Menu Item to Select" expr="&quot;Unretire&quot;" />
    </inputs>
    <onsuccess>31dc39c4-ae9a-41bb-827b-f636130045b7</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Select an item on a Schedule context menu (Dynamic)" />
  </stage>
  <stage stageid="0dd94256-7dda-491b-a752-d6fb480fcb72" name="Expand Retired Schedules" type="Action">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" narrative="The name of the schedule you want to exapnd." expr="&quot;Retired Schedules&quot;" />
      <input type="flag" name="State" friendlyname="State" narrative="The state you want to set, True or False." expr="&quot;True&quot;" />
    </inputs>
    <onsuccess>9b217fe0-ca85-4a77-a118-6f86303dad67</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Expand Schedule" />
  </stage>
  <stage stageid="31dc39c4-ae9a-41bb-827b-f636130045b7" name="Get Schedules" type="Action">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="text" name="Group Name" friendlyname="Group Name" expr="&quot;Schedules&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Tree Items" friendlyname="Tree Items" stage="Tree Items" />
    </outputs>
    <onsuccess>74267d78-a00f-4e81-b804-dd4599200466</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Read Child Tree Items" />
  </stage>
  <stage stageid="74267d78-a00f-4e81-b804-dd4599200466" name="Schedules" type="LoopStart">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="90" h="30" />
    <onsuccess>aad9de95-6d63-4922-b04f-3719416406b2</onsuccess>
    <groupid>651c323b-d9f3-43f8-9b15-47578be3cc66</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Tree Items</loopdata>
  </stage>
  <stage stageid="8efc4e15-c77c-42c3-9320-aa0caaa92f5d" name="Schedules" type="LoopEnd">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="210" w="90" h="30" />
    <onsuccess>ed3cdbb9-7966-4f0e-818b-a6e9152d1388</onsuccess>
    <groupid>651c323b-d9f3-43f8-9b15-47578be3cc66</groupid>
  </stage>
  <stage stageid="aad9de95-6d63-4922-b04f-3719416406b2" name="Schedule Un-retired?" type="Decision">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="15" y="165" w="90" h="30" />
    <decision expression="[Tree Items.Node Text]=[Schedule Name]" />
    <ontrue>e6a847e6-2401-495f-89b9-4afecee10492</ontrue>
    <onfalse>8efc4e15-c77c-42c3-9320-aa0caaa92f5d</onfalse>
  </stage>
  <stage stageid="ed3cdbb9-7966-4f0e-818b-a6e9152d1388" name="Failed " type="Exception">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="105" y="210" />
    <exception localized="yes" type="Failed Test" detail="&quot;The schedule is still retired when expected to be un-retired&quot;" />
  </stage>
  <stage stageid="e6a847e6-2401-495f-89b9-4afecee10492" name="Anchor5" type="Anchor">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="165" w="10" h="10" />
    <onsuccess>cfa28bbd-45d0-4aa5-8359-4c74d303f2f5</onsuccess>
  </stage>
  <stage stageid="cfa28bbd-45d0-4aa5-8359-4c74d303f2f5" name="Anchor6" type="Anchor">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="255" w="10" h="10" />
    <onsuccess>e0a56a68-d81f-473f-b900-561831fcec18</onsuccess>
  </stage>
  <stage stageid="047eec2f-0002-4d02-a89c-0afea677afbb" name="End2" type="End">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="300" />
  </stage>
  <stage stageid="ed7f1226-c280-46d6-a228-341af10c73fb" name="Tree Items" type="Collection">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <display x="-135" y="45" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="016f3b29-360b-4000-9725-835ec5253644" name="Output" type="Block">
    <subsheetid>a7fb0091-52c4-447a-af51-ec93f8be0e6f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e7ca457c-143e-4aed-b99a-4bffbcc26a64" name="Get Username" type="Calculation">
    <subsheetid>b206be12-0083-4219-98c6-391facede2b8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="135" y="30" w="90" h="30" />
    <onsuccess>2bb133c6-0be3-4b87-9643-2047f428c631</onsuccess>
    <calculation expression="GetUserName()" stage="Current Username" />
  </stage>
  <stage stageid="2b7e03ca-8044-4cd8-86fe-24e97318b433" name="Current Username" type="Data">
    <display x="-135" y="-405" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
</process>