<process name="Test Server Service Configuration" version="1.0" bpversion="6.7.0.18757" narrative="" byrefcollection="true" preferredid="2fa5aea7-bbe3-4cb9-a24a-55b78576859a">
  <view>
    <camerax>7</camerax>
    <cameray>169</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79" type="Normal" published="False">
    <name>Create DB Configuration</name>
    <view>
      <camerax>0</camerax>
      <cameray>59</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ce42f503-3277-462e-9bac-5ed70af902d7" type="Normal" published="False">
    <name>Create Server Configuration</name>
    <view>
      <camerax>0</camerax>
      <cameray>456</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="a0be92cd-70f4-4058-984f-2b1f7477b492" type="Normal" published="False">
    <name>Start Server Service</name>
    <view>
      <camerax>0</camerax>
      <cameray>21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="4342b2b3-abf0-448e-9326-6086e9c592a6" type="Normal" published="False">
    <name>Establish Connection</name>
    <view>
      <camerax>0</camerax>
      <cameray>-147</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="c98744d9-d18e-44e4-8445-7b6dcdb71e27" type="Normal" published="False">
    <name>Add to Cleanup</name>
    <view>
      <camerax>0</camerax>
      <cameray>-3</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="afeadc7e-5b31-4dd7-8ae1-0425070bbf14" type="Normal" published="False">
    <name>Remove from Cleanup</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="3d6aacbd-42a5-408c-8f63-319168e7a981" type="Normal" published="False">
    <name>Cleanup</name>
    <view>
      <camerax>109</camerax>
      <cameray>126</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="019596aa-b6fe-4976-a091-6f93489fca28" name="Start" type="Start">
    <display x="15" y="-120" />
    <onsuccess>ad985012-352f-4b7a-b980-abb82cad1499</onsuccess>
  </stage>
  <stage stageid="c874815a-6ec3-4820-b325-66814be9e116" name="Stage1" type="ProcessInfo">
    <display x="-210" y="-90" w="150" h="90" />
  </stage>
  <stage stageid="5ff04149-94d7-4a69-9009-d15922336ad9" name="Create DB Configuration" type="SubSheetInfo">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="-150" y="-120" w="150" h="90" />
  </stage>
  <stage stageid="220e6123-eb1d-4ac3-9b0b-dbbdec06fdac" name="Start" type="Start">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="15" y="-150" />
    <onsuccess>eee7fd53-fb02-4b92-ab55-d5dc571c045d</onsuccess>
  </stage>
  <stage stageid="530f3ef8-16d4-40bd-a370-78ce4c1ea3db" name="End" type="End">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="15" y="255" />
  </stage>
  <stage stageid="819caacd-22b4-4b8d-b882-62d2fc52dda8" name="Create Server Configuration" type="SubSheetInfo">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="-150" y="-255" w="150" h="90" />
  </stage>
  <stage stageid="f9a2fc24-4406-4f09-9cfc-b89243ff8fd0" name="Start" type="Start">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="-285" />
    <onsuccess>c4b93106-a57e-4bc6-a121-b1265bce3077</onsuccess>
  </stage>
  <stage stageid="9d7f72f3-620b-4b0d-b1f6-c0fd04d6524e" name="End" type="End">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="750" />
  </stage>
  <stage stageid="1b4aba33-87c5-42a4-9f1b-91253db452bf" name="Establish Connection" type="SubSheetInfo">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="-150" y="-345" w="150" h="90" />
  </stage>
  <stage stageid="9bda8972-e056-4f41-965b-0619b1b020b3" name="End" type="End">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="120" />
  </stage>
  <stage stageid="ad985012-352f-4b7a-b980-abb82cad1499" name="Note1" type="Note">
    <narrative>GIVEN I have created a valid server configuration
AND server service configuration</narrative>
    <display x="15" y="-45" w="240" h="60" />
    <font family="Segoe UI" size="11" style="Bold" color="3DB87A" />
    <onsuccess>0fd5f130-1855-4e23-ae1c-21688e07f2d7</onsuccess>
  </stage>
  <stage stageid="4afd449f-b0bb-41c7-9546-6d714529a05a" name="Note1" type="Note">
    <narrative>WHEN I start the service</narrative>
    <display x="15" y="105" w="240" h="30" />
    <font family="Segoe UI" size="11" style="Bold" color="3DB87A" />
    <onsuccess>41ecfc98-6ae7-449e-b0b6-b0ef9235c96a</onsuccess>
  </stage>
  <stage stageid="0fd5f130-1855-4e23-ae1c-21688e07f2d7" name="Create DB Configuration" type="SubSheet">
    <display x="15" y="15" w="240" h="30" />
    <onsuccess>d1d48588-b303-4701-a6f2-edcf2f7cac53</onsuccess>
    <processid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</processid>
  </stage>
  <stage stageid="d1d48588-b303-4701-a6f2-edcf2f7cac53" name="Create Server Configuration" type="SubSheet">
    <display x="15" y="60" w="240" h="30" />
    <onsuccess>4afd449f-b0bb-41c7-9546-6d714529a05a</onsuccess>
    <processid>ce42f503-3277-462e-9bac-5ed70af902d7</processid>
  </stage>
  <stage stageid="142e381d-7141-4650-9c8d-e459140a107a" name="Establish Connection" type="SubSheet">
    <display x="15" y="240" w="240" h="30" />
    <onsuccess>01023ead-6f12-4c54-93b5-d4d4cc01bf09</onsuccess>
    <processid>4342b2b3-abf0-448e-9326-6086e9c592a6</processid>
  </stage>
  <stage stageid="184125d6-d840-46cc-ac36-13e62d0d547a" name="pid" type="Data">
    <display x="-210" y="195" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="1e0c14fb-4bab-47c3-b9dc-dbdb6de91828" name="Global Variables" type="Block">
    <display x="-285" y="165" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="01023ead-6f12-4c54-93b5-d4d4cc01bf09" name="End" type="End">
    <display x="15" y="390" />
  </stage>
  <stage stageid="9d296fd5-164e-4e7e-b519-cf42042056a9" name="Cleanup" type="SubSheet">
    <display x="195" y="300" w="150" h="30" />
    <onsuccess>e20953af-1fda-42a6-9534-c5ce173e78b1</onsuccess>
    <processid>3d6aacbd-42a5-408c-8f63-319168e7a981</processid>
  </stage>
  <stage stageid="e20953af-1fda-42a6-9534-c5ce173e78b1" name="Failed?" type="Decision">
    <display x="195" y="345" w="150" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>5947b700-fdf0-4996-a167-bb48dafb78bb</ontrue>
    <onfalse>01023ead-6f12-4c54-93b5-d4d4cc01bf09</onfalse>
  </stage>
  <stage stageid="cece9d1b-9128-41f5-9514-64fc5d713c7c" name="Failed?" type="Data">
    <display x="-210" y="330" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="fff98c39-5446-40c8-87b3-50aad9362706" name="Exception" type="Data">
    <display x="-210" y="360" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0f908a08-8e53-41a5-bc93-4632c69b20ca" name="Local Variables" type="Block">
    <display x="-285" y="300" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5947b700-fdf0-4996-a167-bb48dafb78bb" name="RETHROW" type="Exception">
    <display x="315" y="345" />
    <exception type="RETHROW" detail="[Exception]" />
  </stage>
  <stage stageid="489a5e89-e99b-4f84-87a2-59e7de003777" name="Anchor1" type="Anchor">
    <display x="195" y="300" w="10" h="10" />
    <onsuccess>9d296fd5-164e-4e7e-b519-cf42042056a9</onsuccess>
  </stage>
  <stage stageid="dc77ee9c-2180-4287-86da-d3609b652f72" name="Recover" type="Recover">
    <display x="480" y="-60" w="90" h="30" />
    <onsuccess>5638f3bf-4c12-4db6-87dc-32a782054c04</onsuccess>
  </stage>
  <stage stageid="e1aed675-9fb9-4a45-b9e6-fbe7f3be0dc5" name="Resume" type="Resume">
    <display x="195" y="30" w="90" h="30" />
    <onsuccess>489a5e89-e99b-4f84-87a2-59e7de003777</onsuccess>
  </stage>
  <stage stageid="5638f3bf-4c12-4db6-87dc-32a782054c04" name="Get Exception" type="MultipleCalculation">
    <display x="195" y="-15" w="90" h="30" />
    <onsuccess>e1aed675-9fb9-4a45-b9e6-fbe7f3be0dc5</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="4dd39931-9f11-4912-831a-3ead445f1997" name="Cleanup Block" type="Block">
    <display x="-120" y="-90" w="375" h="360" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="2e8e3335-9a12-4f82-ada1-7b62ab0860c3" name="Add to Cleanup" type="SubSheetInfo">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="-150" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="c18eb0ed-58f2-4463-8382-1d613456e666" name="Start" type="Start">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="Item Name" narrative="The name of the item you want to clean up." stage="Item Name" />
    </inputs>
    <onsuccess>81021763-f338-4953-8b4d-109de0d57f08</onsuccess>
  </stage>
  <stage stageid="f6979f25-39b1-40a5-8a29-51fa932995e4" name="End" type="End">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="15" y="30" />
  </stage>
  <stage stageid="c80590f7-964d-471a-a52a-908559026391" name="Item Name" type="Data">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="-150" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="39a09a9a-9b8e-4c0e-9ccc-6c0e39ae5847" name="Input Variables" type="Block">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="-225" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="81021763-f338-4953-8b4d-109de0d57f08" name="Add Row" type="Action">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="15" y="-60" w="150" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;CleanUp Collection&quot;" />
    </inputs>
    <onsuccess>c7202d12-8842-44dc-b032-22d779666fe9</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="944c1159-f539-42b7-a671-77f7678e4141" name="CleanUp Collection" type="Collection">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="-150" y="90" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Item Name" type="text" description="The name of the item that needs cleaning up." />
    </collectioninfo>
    <noalwaysinit />
  </stage>
  <stage stageid="db8f2f05-e5d5-4351-b8a9-f2d8b5339c4c" name="Local Variables" type="Block">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="-225" y="60" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c7202d12-8842-44dc-b032-22d779666fe9" name="Add To Row" type="Calculation">
    <subsheetid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</subsheetid>
    <display x="15" y="-15" w="150" h="30" />
    <onsuccess>f6979f25-39b1-40a5-8a29-51fa932995e4</onsuccess>
    <calculation expression="[Item Name]" stage="CleanUp Collection.Item Name" />
  </stage>
  <stage stageid="6b7a85bc-473a-42ce-886a-6636d75a8b99" name="Cleanup" type="SubSheetInfo">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="-150" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="8a5e4ac7-3413-4b81-9b2e-9db4c674be91" name="Start" type="Start">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>1fd33785-fcba-48d4-a228-042c460a976c</onsuccess>
  </stage>
  <stage stageid="0bf368f1-7780-4aaa-9df2-a19a441c3f1b" name="To Clean" type="LoopStart">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="15" y="-15" w="150" h="30" />
    <onsuccess>28c5f38b-be97-4c41-8930-adf0ee46ec13</onsuccess>
    <groupid>1a536139-d9fd-49f2-a25f-42c78d75ef64</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Reversed CleanUp</loopdata>
  </stage>
  <stage stageid="6a5995a5-a98f-4341-8571-6abfd3d7a8b3" name="To Clean" type="LoopEnd">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="15" y="315" w="150" h="30" />
    <onsuccess>393bcb9d-5fc9-4ab0-8ea2-bf60da2bd636</onsuccess>
    <groupid>1a536139-d9fd-49f2-a25f-42c78d75ef64</groupid>
  </stage>
  <stage stageid="28c5f38b-be97-4c41-8930-adf0ee46ec13" name="Which Clean Up" type="ChoiceStart">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="15" y="30" w="150" h="30" />
    <groupid>b089e54a-2816-4358-9a53-e2c82ac022c5</groupid>
    <choices>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Blue Prism&quot;">
        <name>Blue Prism</name>
        <distance>30</distance>
        <ontrue>d5e869d4-145a-41b1-bb53-57401feb3606</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Stop Service&quot;">
        <name>Stop Service</name>
        <distance>60</distance>
        <ontrue>f0a8e9fb-f06f-4f97-838c-1c57fc059986</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;DB Con&quot;">
        <name>DB Connection</name>
        <distance>90</distance>
        <ontrue>b4fadfea-ef60-4a8a-baf9-39a6d9785984</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Server Con&quot;">
        <name>Server Connection</name>
        <distance>120</distance>
        <ontrue>845cc349-473e-4c2b-9b12-e74bc7c866fe</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Sign Out&quot;">
        <name>Sign Out</name>
        <distance>150</distance>
        <ontrue>f09770b1-a799-43da-a954-14626dad8396</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Server&quot;">
        <name>Server</name>
        <distance>180</distance>
        <ontrue>8fd2a24b-85c8-4604-a648-dd4eeb2d170a</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Server Conf&quot;">
        <name>Server Configuration</name>
        <distance>210</distance>
        <ontrue>8807ae32-fda6-472e-b329-429d1aaa4411</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="c50512a1-694b-415a-9f52-2530d12b73ab" name="Otherwise" type="ChoiceEnd">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="15" y="270" w="150" h="30" />
    <onsuccess>b53564dd-23f6-4107-9374-c3de61fdb9d5</onsuccess>
    <groupid>b089e54a-2816-4358-9a53-e2c82ac022c5</groupid>
  </stage>
  <stage stageid="b53564dd-23f6-4107-9374-c3de61fdb9d5" name="FAIL" type="Exception">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="120" y="270" w="30" h="30" />
    <exception type="" detail="&quot;You have entered a clean up item the choice doesn't recognise.&quot;" />
  </stage>
  <stage stageid="1fd33785-fcba-48d4-a228-042c460a976c" name="Reverse Collection" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="15" y="-60" w="150" h="30" />
    <inputs>
      <input type="collection" name="Collection" narrative="The collection to be reversed." expr="[CleanUp Collection]" />
    </inputs>
    <outputs>
      <output type="collection" name="Reversed Collection" narrative="The reversed collection." stage="Reversed CleanUp" />
    </outputs>
    <onsuccess>0bf368f1-7780-4aaa-9df2-a19a441c3f1b</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Reverse Collection" />
  </stage>
  <stage stageid="16411678-5152-4369-a2d2-782ec8ff672a" name="Reversed CleanUp" type="Collection">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="-150" y="15" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6ccf1a0c-caf2-4559-8737-ab04c5609152" name="Local Variables" type="Block">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="-225" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="3437576d-16b0-4a30-b8a1-4fade6eedf74" name="Anchor4" type="Anchor">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="495" y="180" w="10" h="10" />
    <onsuccess>663e3887-e719-4620-af3b-2027e3cb45b8</onsuccess>
  </stage>
  <stage stageid="ce6ef14d-8ec0-4f8e-8faf-f2d1b0e4a146" name="Anchor5" type="Anchor">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="495" y="315" w="10" h="10" />
    <onsuccess>6a5995a5-a98f-4341-8571-6abfd3d7a8b3</onsuccess>
  </stage>
  <stage stageid="b5a94fc4-b66d-4c02-b099-c387699761cb" name="Anchor4" type="Anchor">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="495" y="90" w="10" h="10" />
    <onsuccess>7b10a626-e358-42f6-9e2a-e7851da3ddc9</onsuccess>
  </stage>
  <stage stageid="7b10a626-e358-42f6-9e2a-e7851da3ddc9" name="Anchor4" type="Anchor">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="495" y="120" w="10" h="10" />
    <onsuccess>fc66a187-6366-41b7-bae2-6406909709ee</onsuccess>
  </stage>
  <stage stageid="fc66a187-6366-41b7-bae2-6406909709ee" name="Anchor4" type="Anchor">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="495" y="150" w="10" h="10" />
    <onsuccess>3437576d-16b0-4a30-b8a1-4fade6eedf74</onsuccess>
  </stage>
  <stage stageid="663e3887-e719-4620-af3b-2027e3cb45b8" name="Anchor6" type="Anchor">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="495" y="210" w="10" h="10" />
    <onsuccess>96424d3e-573e-4767-b9a1-dfb2e2d076ad</onsuccess>
  </stage>
  <stage stageid="96424d3e-573e-4767-b9a1-dfb2e2d076ad" name="Anchor7" type="Anchor">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="495" y="240" w="10" h="10" />
    <onsuccess>ce6ef14d-8ec0-4f8e-8faf-f2d1b0e4a146</onsuccess>
  </stage>
  <stage stageid="c176cacb-81c7-4e97-891d-dfb9ffcd4fc5" name="Terminate" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="405" y="60" w="150" h="30" />
    <onsuccess>0ef2c50f-7328-4122-a7c3-b45a63a6d582</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="d5e869d4-145a-41b1-bb53-57401feb3606" name="Close all child windows" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="225" y="60" w="180" h="30" />
    <onsuccess>c176cacb-81c7-4e97-891d-dfb9ffcd4fc5</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Close All Child Windows" />
  </stage>
  <stage stageid="0ef2c50f-7328-4122-a7c3-b45a63a6d582" name="Anchor9" type="Anchor">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="495" y="60" w="10" h="10" />
    <onsuccess>b5a94fc4-b66d-4c02-b099-c387699761cb</onsuccess>
  </stage>
  <stage stageid="393bcb9d-5fc9-4ab0-8ea2-bf60da2bd636" name="End1" type="End">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="15" y="360" />
  </stage>
  <stage stageid="eee7fd53-fb02-4b92-ab55-d5dc571c045d" name="Launch" type="Action">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="15" y="-105" w="150" h="30" />
    <outputs>
      <output type="number" name="pid" friendlyname="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>d9544298-783d-44e2-89dc-efafc90fd4f3</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="de872cdc-4710-4178-9b2f-8adfc93ed448" name="Create DB Connection" type="Action">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="15" y="75" w="150" h="30" />
    <inputs>
      <input type="text" name="Connection Name" friendlyname="Connection Name" narrative="The name you want to call your connection." expr="[DB Connection Name]" />
      <input type="text" name="Connection Type" friendlyname="Connection Type" narrative="A combobox in which you select a conection type (SQL / Windows Auth)" expr="&quot;SQL Server (SQL Authentication)&quot;" />
      <input type="text" name="Database Server" friendlyname="Database Server" narrative="Where you will store the database. This is usually &quot;localhost\SQLExpress&quot;" expr="[DB Server]" />
      <input type="text" name="Database Name" friendlyname="Database Name" narrative="The actual name of the database." expr="[DB Name]" />
      <input type="text" name="User ID" friendlyname="User ID" narrative="If you select SQL Auth this is the user ID of SQL." expr="[DB User]" />
      <input type="text" name="Password" friendlyname="Password" narrative="If you select SQL Auth this is the password for the user." expr="[DB Password]" />
      <input type="text" name="Blue Prism Server" friendlyname="Blue Prism Server" narrative="If you select a server connection this is where the server i located." expr="" />
      <input type="text" name="Connection Mode" friendlyname="Connection Mode" narrative="If you selected a server connection this is the connection mode the server is using." expr="" />
      <input type="text" name="Server Port" friendlyname="Server Port" narrative="If you selected a server connection this is the server port its using. " expr="" />
    </inputs>
    <onsuccess>0c624fe9-b65e-475a-93a1-6b5b69e8901d</onsuccess>
    <resource object="Blue Prism - General - Configuration" action="Create Connection" />
  </stage>
  <stage stageid="3c7b6a88-379f-4196-b682-100f99e1c0e2" name="Attach General" type="Action">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="15" y="-15" w="150" h="30" />
    <inputs>
      <input type="number" name="pid" friendlyname="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>6fb60b99-15bb-4c1d-ad22-9d71e6f1eb9d</onsuccess>
    <resource object="Blue Prism - General (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="2d9456f2-86cf-4191-bdc9-40e31a64c883" name="DB Server" type="Data">
    <display x="-210" y="0" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="a82d756d-61c2-4e19-9801-ccff65c8681c" name="DB Name" type="Data">
    <display x="-210" y="30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="7a0d6f51-6507-4078-93af-a6523535d8ef" name="DB User" type="Data">
    <display x="-210" y="60" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="edff9d55-5916-4b37-a65e-1d04e097932d" name="DB Password" type="Data">
    <display x="-210" y="90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="d2157c20-3f58-4954-bd2b-81a428cb3804" name="Environment Variables" type="Block">
    <display x="-285" y="-30" w="150" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c4b93106-a57e-4bc6-a121-b1265bce3077" name="Launch Server" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="-240" w="150" h="30" />
    <onsuccess>5ee4141e-684e-4bee-b65a-16f69a570a93</onsuccess>
    <resource object="Blue Prism Server (Parent)" action="Launch" />
  </stage>
  <stage stageid="b9a8f69e-9c8c-42ed-93a6-f9cf386b9f8d" name="Press New" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="-150" w="150" h="30" />
    <onsuccess>39a9a906-841e-489c-8433-44099db995d9</onsuccess>
    <resource object="Blue Prism Server" action="Press New" />
  </stage>
  <stage stageid="39a9a906-841e-489c-8433-44099db995d9" name="Set Configuration Details" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="-105" w="150" h="30" />
    <inputs>
      <input type="text" name="Configuration Name" friendlyname="Configuration Name" narrative="The name you want to set for the configuration." expr="[Server Configuration Name]" />
      <input type="text" name="Database Connection" friendlyname="Database Connection" narrative="The database connection you want to use." expr="[DB Connection Name]" />
      <input type="text" name="Connection Mode" friendlyname="Connection Mode" narrative="The connetion mode you want to use." expr="&quot;WCF: Insecure&quot;" />
    </inputs>
    <onsuccess>7775eee2-4748-4e14-b664-0507bf2777fc</onsuccess>
    <resource object="Blue Prism Server - Details" action="Set Configuration Details" />
  </stage>
  <stage stageid="222430e4-ad27-48c4-837e-9859f2f3174e" name="DB Connection Name" type="Data">
    <display x="-210" y="225" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">DB Connection (US-1709)</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="7775eee2-4748-4e14-b664-0507bf2777fc" name="Read Configuration Details" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="-60" w="150" h="30" />
    <outputs>
      <output type="text" name="Name" friendlyname="Name" narrative="The name of the connection." stage="Name" />
      <output type="text" name="Database Connection" friendlyname="Database Connection" narrative="The currently connection database connection" stage="Database Connection" />
      <output type="text" name="Connection Mode" friendlyname="Connection Mode" narrative="The currently selected connection mode." stage="Connection Mode" />
    </outputs>
    <onsuccess>241fc49b-79be-4243-925f-5023b42b86a9</onsuccess>
    <resource object="Blue Prism Server - Details" action="Read Configuration Details" />
  </stage>
  <stage stageid="460d915e-14b2-482e-9613-84befcd2f716" name="Name" type="Data">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="-150" y="-165" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5e22063f-8b93-4cc9-97dd-bd478bfb1b4d" name="Database Connection" type="Data">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="-150" y="-135" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="aef79a18-948f-4cfa-86df-425bb6640238" name="Connection Mode" type="Data">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="-150" y="-105" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="241fc49b-79be-4243-925f-5023b42b86a9" name="Server Details Correct?" type="Decision">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="-15" w="150" h="30" />
    <decision expression="[Name]=[Server Configuration Name]&#xA;AND&#xA;[Database Connection]=[DB Connection Name]&#xA;AND&#xA;[Connection Mode]=&quot;WCF: Insecure&quot;" />
    <ontrue>62988f68-4267-488a-93c0-7c3cdcef75b6</ontrue>
    <onfalse>317a761b-7eaa-41e3-90ad-47c73f483d75</onfalse>
  </stage>
  <stage stageid="317a761b-7eaa-41e3-90ad-47c73f483d75" name="FAIL" type="Exception">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="120" y="-15" w="30" h="30" />
    <exception localized="yes" type="&quot;SystemException&quot;" detail="&quot;The server configuration details were not set correctly.&quot;" />
  </stage>
  <stage stageid="9a1d30a8-4c36-4176-bf49-cb903e1697a0" name="Select Tab (Server Services)" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="165" w="150" h="30" />
    <inputs>
      <input type="text" name="Tab" friendlyname="Tab" narrative="The name of the tab you want to select." expr="&quot;Server Services&quot;" />
    </inputs>
    <onsuccess>d7525a62-f585-499c-a5d1-fe147ef3a495</onsuccess>
    <resource object="Blue Prism Server - Basic Actions" action="Select Tab" />
  </stage>
  <stage stageid="d7525a62-f585-499c-a5d1-fe147ef3a495" name="Click Create Service" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="210" w="150" h="30" />
    <onsuccess>04b7b868-fa7d-4395-b00b-46cb79f8b4be</onsuccess>
    <resource object="Blue Prism Server - Server Services" action="Press Create Service" />
  </stage>
  <stage stageid="04b7b868-fa7d-4395-b00b-46cb79f8b4be" name="Read Service List" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="255" w="150" h="30" />
    <inputs>
      <input type="unknown" name="Name" friendlyname="Name" expr="" />
      <input type="unknown" name="Service Path" friendlyname="Service Path" expr="" />
      <input type="unknown" name="Log" friendlyname="Log" expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Services" friendlyname="Services" narrative="A collection containing all of the services for this server configuration." stage="Services" />
    </outputs>
    <onsuccess>b5c12c75-7325-4370-9c8d-7e6e74828f4b</onsuccess>
    <resource object="Blue Prism Server - Server Services" action="Read Services" />
  </stage>
  <stage stageid="d34ddec7-a87d-4313-85aa-59ad15fd7949" name="Services" type="Collection">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="-150" y="-45" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Name" type="text" />
      <field name="Service Path" type="text" />
      <field name="Log On As" type="text" />
      <field name="Startup Type" type="text" />
      <field name="Status" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="07ab0c20-7c94-4dba-8e19-841887105ec5" name="Service Exist?" type="Decision">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="345" w="150" h="30" />
    <decision expression="[Services.Name]=&quot;Blue Prism Server:&quot;&amp;[Server Configuration Name]&#xA;AND&#xA;[Services.Service Path]=[BPServerService EXE]&amp;&quot; &quot;&quot;&quot;&amp;[Server Configuration Name]&amp;&quot;&quot;&quot;&quot;&#xA;AND&#xA;[Services.Log On As]=&quot;LocalSystem&quot;&#xA;AND&#xA;[Services.Startup Type]=&quot;Manual&quot;&#xA;AND&#xA;[Services.Status]=&quot;Stopped&quot;" />
    <ontrue>7ff2713f-fb25-4831-84d3-aee7c1219571</ontrue>
    <onfalse>d15c39b7-d709-4afd-82a0-b1bb7e2b7676</onfalse>
  </stage>
  <stage stageid="b5c12c75-7325-4370-9c8d-7e6e74828f4b" name="Loop Services" type="LoopStart">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="300" w="150" h="30" />
    <onsuccess>07ab0c20-7c94-4dba-8e19-841887105ec5</onsuccess>
    <groupid>6cf0d9d1-28b0-48cd-a1f8-de35c0c614c8</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Services</loopdata>
  </stage>
  <stage stageid="d15c39b7-d709-4afd-82a0-b1bb7e2b7676" name="Loop Services" type="LoopEnd">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="390" w="150" h="30" />
    <onsuccess>2b2c01b3-e4b2-469e-abc1-92e0768dcda1</onsuccess>
    <groupid>6cf0d9d1-28b0-48cd-a1f8-de35c0c614c8</groupid>
  </stage>
  <stage stageid="7ff2713f-fb25-4831-84d3-aee7c1219571" name="Anchor2" type="Anchor">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="150" y="345" w="10" h="10" />
    <onsuccess>f9ba79ba-b1d2-4fae-8409-1a3d67404ec6</onsuccess>
  </stage>
  <stage stageid="2b2c01b3-e4b2-469e-abc1-92e0768dcda1" name="FAIL" type="Exception">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="120" y="390" w="30" h="30" />
    <exception localized="yes" type="SystemExecption" detail="&quot;The server service wasn't found, was it created?&quot;" />
  </stage>
  <stage stageid="f9ba79ba-b1d2-4fae-8409-1a3d67404ec6" name="Anchor3" type="Anchor">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="150" y="435" w="10" h="10" />
    <onsuccess>5709105a-633c-4d41-afd5-44bfc6727977</onsuccess>
  </stage>
  <stage stageid="8880d836-42bf-44a6-9780-0122636a2b33" name="Press Save" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="615" w="150" h="30" />
    <onsuccess>ad78be88-9204-40fb-a271-a6e69d1b17b1</onsuccess>
    <resource object="Blue Prism Server - Basic Actions" action="Press Save" />
  </stage>
  <stage stageid="8edddf06-9cfb-4f4d-a6b2-53849e6e275b" name="Local Variables" type="Block">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="-225" y="-195" w="150" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="d1431132-0663-42bd-8f24-170fac9b46c5" name="BPServerService EXE" type="Data">
    <display x="-210" y="120" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="c2af66f7-ac01-4bfc-b594-019937ce671c" name="Server Configuration Name" type="Data">
    <display x="-210" y="255" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Server (US-1709)</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="2f35adde-edaf-4efa-9490-20fc905bdc19" name="Create Server Connection on client" type="Action">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="-150" w="150" h="30" />
    <inputs>
      <input type="text" name="Connection Name" friendlyname="Connection Name" narrative="The name you want to call your connection." expr="[Server Configuration Name]" />
      <input type="text" name="Connection Type" friendlyname="Connection Type" narrative="A combobox in which you select a conection type (SQL / Windows Auth)" expr="&quot;Blue Prism Server&quot;" />
      <input type="text" name="Database Server" friendlyname="Database Server" narrative="Where you will store the database. This is usually &quot;localhost\SQLExpress&quot;" expr="" />
      <input type="text" name="Database Name" friendlyname="Database Name" narrative="The actual name of the database." expr="" />
      <input type="text" name="User ID" friendlyname="User ID" narrative="If you select SQL Auth this is the user ID of SQL." expr="" />
      <input type="text" name="Password" friendlyname="Password" narrative="If you select SQL Auth this is the password for the user." expr="" />
      <input type="text" name="Blue Prism Server" friendlyname="Blue Prism Server" narrative="If you select a server connection this is where the server i located." expr="&quot;localhost&quot;" />
      <input type="text" name="Connection Mode" friendlyname="Connection Mode" narrative="If you selected a server connection this is the connection mode the server is using." expr="&quot;WCF: Insecure&quot;" />
      <input type="text" name="Server Port" friendlyname="Server Port" narrative="If you selected a server connection this is the server port its using. " expr="&quot;1709&quot;" />
    </inputs>
    <onsuccess>71729f27-c5a4-4d72-b45a-2f33eee79b35</onsuccess>
    <resource object="Blue Prism - General - Configuration" action="Create Connection" />
  </stage>
  <stage stageid="62988f68-4267-488a-93c0-7c3cdcef75b6" name="Set Server Port" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="30" w="150" h="30" />
    <inputs>
      <input type="text" name="Host Name / IP Address" friendlyname="Host Name / IP Address" narrative="The host name or IP address you want to set for the binding." expr="" />
      <input type="number" name="Port" friendlyname="Port" narrative="The port you want to set for the binding." expr="&quot;1709&quot;" />
    </inputs>
    <onsuccess>718a4678-bf31-46da-9c50-a8d966a9ef39</onsuccess>
    <resource object="Blue Prism Server - Details" action="Set Binding" />
  </stage>
  <stage stageid="718a4678-bf31-46da-9c50-a8d966a9ef39" name="Read Server Port" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="75" w="150" h="30" />
    <outputs>
      <output type="text" name="Host Name / IP Address" friendlyname="Host Name / IP Address" narrative="The current hostname or ip address set for binding." stage="" />
      <output type="number" name="Port" friendlyname="Port" narrative="The current port set for binding." stage="Port" />
    </outputs>
    <onsuccess>ab1fb1e2-9cda-4e81-8db9-0495a066fd32</onsuccess>
    <resource object="Blue Prism Server - Details" action="Read Binding" />
  </stage>
  <stage stageid="ab1fb1e2-9cda-4e81-8db9-0495a066fd32" name="Server Port Correct?" type="Decision">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="120" w="150" h="30" />
    <decision expression="[Port]=1709" />
    <ontrue>9a1d30a8-4c36-4176-bf49-cb903e1697a0</ontrue>
    <onfalse>4fb0ed37-f076-4c43-a662-90575d685a56</onfalse>
  </stage>
  <stage stageid="4fb0ed37-f076-4c43-a662-90575d685a56" name="FAIL" type="Exception">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="120" y="120" w="30" h="30" />
    <exception localized="yes" type="SystemException" detail="&quot;The server port wasn't set correctly.&quot;" />
  </stage>
  <stage stageid="dc700b14-a2bd-41de-9303-a6c53293ffa8" name="Port" type="Data">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="-150" y="-75" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5272a89e-2743-4fd3-8aca-d3554b91674b" name="Sign In" type="Action">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="-15" w="150" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" expr="" />
      <input type="password" name="Password" friendlyname="Password" expr="" />
      <input type="password" name="New Password" friendlyname="New Password" narrative="If this is your first login it will prompt you to change the password." expr="" />
      <input type="flag" name="Expect Password Reset" friendlyname="Expect Password Reset" expr="" />
      <input type="flag" name="Expected License Wizard" friendlyname="Expected License Wizard" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Locale" friendlyname="Locale" narrative="Blue Prism Locale setting" stage="" />
    </outputs>
    <onsuccess>8c3fe14b-8008-461b-817b-b9584fad1cc3</onsuccess>
    <resource object="Blue Prism" action="Sign In" />
  </stage>
  <stage stageid="f0a8e9fb-f06f-4f97-838c-1c57fc059986" name="Stop Server Service" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="405" y="90" w="150" h="30" />
    <inputs>
      <input type="text" name="Arguments" friendlyname="Arguments" expr="&quot;stop &quot;&quot;Blue Prism Server:&quot; &amp; [Server Configuration Name] &amp; &quot;&quot;&quot;&quot;" />
      <input type="flag" name="CreateWindow" friendlyname="CreateWindow" expr="True" />
      <input type="text" name="Filename" friendlyname="Filename" expr="&quot;C:\Windows\System32\net.exe&quot;" />
      <input type="flag" name="WaitForExit" friendlyname="WaitForExit" expr="True" />
    </inputs>
    <onsuccess>b5a94fc4-b66d-4c02-b099-c387699761cb</onsuccess>
    <resource object="Blue Prism Server - Server Services" action="Start Service" />
  </stage>
  <stage stageid="d9544298-783d-44e2-89dc-efafc90fd4f3" name="Add to Cleanup (Blue Prism)" type="SubSheet">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="15" y="-60" w="150" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Blue Prism&quot;" />
    </inputs>
    <onsuccess>3c7b6a88-379f-4196-b682-100f99e1c0e2</onsuccess>
    <processid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</processid>
  </stage>
  <stage stageid="9e9ed56e-67f0-4642-8215-1e28f278264c" name="Add to Cleanup (DB Con)" type="SubSheet">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="15" y="165" w="150" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;DB Con&quot;" />
    </inputs>
    <onsuccess>e9e67477-25ea-42f0-a249-4f9717d8af54</onsuccess>
    <processid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</processid>
  </stage>
  <stage stageid="71729f27-c5a4-4d72-b45a-2f33eee79b35" name="Add to Cleanup (Server Con)" type="SubSheet">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="-105" w="150" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Server Con&quot;" />
    </inputs>
    <onsuccess>e1b7baa6-f469-4caf-b98d-8515f8242f51</onsuccess>
    <processid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</processid>
  </stage>
  <stage stageid="b4fadfea-ef60-4a8a-baf9-39a6d9785984" name="Delete Connection (DB Connection)" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="405" y="120" w="150" h="30" />
    <inputs>
      <input type="text" name="Connection Name" friendlyname="Connection Name" narrative="The name of the connection you wan to delete. " expr="[DB Connection Name]" />
    </inputs>
    <onsuccess>7b10a626-e358-42f6-9e2a-e7851da3ddc9</onsuccess>
    <resource object="Blue Prism - General - Configuration" action="Delete Connection" />
  </stage>
  <stage stageid="845cc349-473e-4c2b-9b12-e74bc7c866fe" name="Delete Connection (Server Connection)" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="405" y="150" w="150" h="30" />
    <inputs>
      <input type="text" name="Connection Name" friendlyname="Connection Name" narrative="The name of the connection you wan to delete. " expr="[Server Configuration Name]" />
    </inputs>
    <onsuccess>fc66a187-6366-41b7-bae2-6406909709ee</onsuccess>
    <resource object="Blue Prism - General - Configuration" action="Delete Connection" />
  </stage>
  <stage stageid="8c3fe14b-8008-461b-817b-b9584fad1cc3" name="Add to Cleanup (Sign Out)" type="SubSheet">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="30" w="150" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Sign Out&quot;" />
    </inputs>
    <onsuccess>7da26edb-f7ba-46a3-a6c4-3b8b8f77cac0</onsuccess>
    <processid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</processid>
  </stage>
  <stage stageid="f09770b1-a799-43da-a954-14626dad8396" name="Sign Out" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="405" y="180" w="150" h="30" />
    <onsuccess>3437576d-16b0-4a30-b8a1-4fade6eedf74</onsuccess>
    <resource object="Blue Prism" action="Sign Out" />
  </stage>
  <stage stageid="5ee4141e-684e-4bee-b65a-16f69a570a93" name="Add to Cleanup (Server)" type="SubSheet">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="-195" w="150" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Server&quot;" />
    </inputs>
    <onsuccess>b9a8f69e-9c8c-42ed-93a6-f9cf386b9f8d</onsuccess>
    <processid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</processid>
  </stage>
  <stage stageid="ad78be88-9204-40fb-a271-a6e69d1b17b1" name="Add to Cleanup (Server Conf)" type="SubSheet">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="660" w="150" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Server Conf&quot;" />
    </inputs>
    <onsuccess>6a26dd6f-00e4-46a3-b837-5cfc11d286ce</onsuccess>
    <processid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</processid>
  </stage>
  <stage stageid="8fd2a24b-85c8-4604-a648-dd4eeb2d170a" name="Terminate Server" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="405" y="210" w="150" h="30" />
    <onsuccess>663e3887-e719-4620-af3b-2027e3cb45b8</onsuccess>
    <resource object="Blue Prism Server (Parent)" action="Terminate" />
  </stage>
  <stage stageid="8807ae32-fda6-472e-b329-429d1aaa4411" name="Select Server Configuration" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="225" y="240" w="180" h="30" />
    <inputs>
      <input type="text" name="Configuration Name" friendlyname="Configuration Name" narrative="The name of the configuration you want to select." expr="[Server Configuration Name]" />
    </inputs>
    <onsuccess>74a5eb0c-4874-40ea-b1da-276bb37e2031</onsuccess>
    <resource object="Blue Prism Server" action="Select Configuration" />
  </stage>
  <stage stageid="74a5eb0c-4874-40ea-b1da-276bb37e2031" name="Delete Server Configuration" type="Action">
    <subsheetid>3d6aacbd-42a5-408c-8f63-319168e7a981</subsheetid>
    <display x="405" y="240" w="150" h="30" />
    <onsuccess>96424d3e-573e-4767-b9a1-dfb2e2d076ad</onsuccess>
    <resource object="Blue Prism Server" action="Press Delete" />
  </stage>
  <stage stageid="29f62269-9314-4c06-91fe-14cd382cfcc1" name="Note1" type="Note">
    <narrative>THEN I should be able to connect via Blue Prism</narrative>
    <display x="15" y="195" w="240" h="30" />
    <font family="Segoe UI" size="11" style="Bold" color="3DB87A" />
    <onsuccess>142e381d-7141-4650-9c8d-e459140a107a</onsuccess>
  </stage>
  <stage stageid="10dd351b-3070-4057-98a7-e348f33c7d89" name="Block1" type="Block">
    <display x="420" y="-90" w="120" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5709105a-633c-4d41-afd5-44bfc6727977" name="Select Tab (Key Store)" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="435" w="150" h="30" />
    <inputs>
      <input type="text" name="Tab" friendlyname="Tab" narrative="The name of the tab you want to select." expr="&quot;Key Store&quot;" />
    </inputs>
    <onsuccess>a4e66707-5f93-4b76-833c-2f12f995798b</onsuccess>
    <resource object="Blue Prism Server - Basic Actions" action="Select Tab" />
  </stage>
  <stage stageid="a4e66707-5f93-4b76-833c-2f12f995798b" name="Press New Encryption Scheme" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="480" w="150" h="30" />
    <onsuccess>51b224d1-8b79-48de-bd12-1261ae6d6039</onsuccess>
    <resource object="Blue Prism Server - Key Store" action="Press New" />
  </stage>
  <stage stageid="51b224d1-8b79-48de-bd12-1261ae6d6039" name="Set Encryption Scheme" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="525" w="150" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name you want to give your encryption scheme." expr="&quot;Default Encryption Scheme&quot;" />
      <input type="text" name="Method" friendlyname="Method" narrative="TThe method you want to give your encryption scheme." expr="&quot;AES-256 AesCryptoService (256 bit)&quot;" />
    </inputs>
    <onsuccess>39a5d355-f76f-4f30-9bac-c078cc0d16cb</onsuccess>
    <resource object="Blue Prism Server - Key Store" action="Set Encryption Scheme" />
  </stage>
  <stage stageid="39a5d355-f76f-4f30-9bac-c078cc0d16cb" name="Press OK" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="570" w="150" h="30" />
    <onsuccess>8880d836-42bf-44a6-9780-0122636a2b33</onsuccess>
    <resource object="Blue Prism Server - Key Store" action="Press OK" />
  </stage>
  <stage stageid="7ac94daa-8891-45ad-a390-96cf100db811" name="Start Server Service" type="SubSheetInfo">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="-195" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="1ad21b47-ce4f-425e-9e35-50721b2347cd" name="Start" type="Start">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>2eb5d5a5-65ec-4e9e-aac3-e4e7ecba85da</onsuccess>
  </stage>
  <stage stageid="f5ec729b-d778-4923-aa97-b65e1cfeb44e" name="End" type="End">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="15" y="75" />
  </stage>
  <stage stageid="41ecfc98-6ae7-449e-b0b6-b0ef9235c96a" name="Start Server Service" type="SubSheet">
    <display x="15" y="150" w="240" h="30" />
    <onsuccess>29f62269-9314-4c06-91fe-14cd382cfcc1</onsuccess>
    <processid>a0be92cd-70f4-4058-984f-2b1f7477b492</processid>
  </stage>
  <stage stageid="2eb5d5a5-65ec-4e9e-aac3-e4e7ecba85da" name="Start Server Service" type="Action">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="15" y="-60" w="150" h="30" />
    <inputs>
      <input type="text" name="Arguments" friendlyname="Arguments" expr="&quot;start &quot;&quot;Blue Prism Server:&quot; &amp; [Server Configuration Name] &amp; &quot;&quot;&quot;&quot;" />
      <input type="flag" name="CreateWindow" friendlyname="CreateWindow" expr="True" />
      <input type="text" name="Filename" friendlyname="Filename" expr="&quot;C:\Windows\System32\net.exe&quot;" />
      <input type="flag" name="WaitForExit" friendlyname="WaitForExit" expr="True" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Output" friendlyname="Output" stage="Output" />
    </outputs>
    <onsuccess>e132ccee-b0b6-487e-91e0-de61bbed07f2</onsuccess>
    <resource object="Blue Prism Server - Server Services" action="Start Service" />
  </stage>
  <stage stageid="d49e053c-1744-44ed-b1b7-76cfe4faa6b3" name="Add to Cleanup (Stop Service)" type="SubSheet">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="15" y="30" w="150" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Stop Service&quot;" />
    </inputs>
    <onsuccess>f5ec729b-d778-4923-aa97-b65e1cfeb44e</onsuccess>
    <processid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</processid>
  </stage>
  <stage stageid="e978b4b4-1e31-4202-8cea-c554a62c3c94" name="Success" type="Data">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="-195" y="15" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="28686007-8c75-439b-8136-08320610a846" name="Output" type="Data">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="-195" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0c1fdbfb-6cd6-46a5-a8dc-a3f0139b6d2e" name="Local Variables" type="Block">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="-270" y="-15" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e132ccee-b0b6-487e-91e0-de61bbed07f2" name="Service Started?" type="Decision">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="15" y="-15" w="150" h="30" />
    <decision expression="[Success]" />
    <ontrue>d49e053c-1744-44ed-b1b7-76cfe4faa6b3</ontrue>
    <onfalse>822ffcbf-2625-4f17-8d9c-751b2bb4e75c</onfalse>
  </stage>
  <stage stageid="822ffcbf-2625-4f17-8d9c-751b2bb4e75c" name="Service didn't start Exception" type="Exception">
    <subsheetid>a0be92cd-70f4-4058-984f-2b1f7477b492</subsheetid>
    <display x="135" y="-15" />
    <exception localized="yes" type="" detail="&quot;The service didn't start: &quot;&amp;[Output]" />
  </stage>
  <stage stageid="472ca360-b827-407d-bd54-88822862d299" name="Remove from Cleanup" type="SubSheetInfo">
    <subsheetid>afeadc7e-5b31-4dd7-8ae1-0425070bbf14</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="0463b1ba-f055-4ad7-b2b6-f8d389499e70" name="Start" type="Start">
    <subsheetid>afeadc7e-5b31-4dd7-8ae1-0425070bbf14</subsheetid>
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="Item to remove" stage="Item to remove" />
    </inputs>
  </stage>
  <stage stageid="2408610d-5f6a-4af9-9370-b247e75ac2e6" name="End" type="End">
    <subsheetid>afeadc7e-5b31-4dd7-8ae1-0425070bbf14</subsheetid>
    <display x="15" y="90" />
  </stage>
  <stage stageid="e9e67477-25ea-42f0-a249-4f9717d8af54" name="Terminate" type="Action">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <display x="15" y="210" w="150" h="30" />
    <onsuccess>530f3ef8-16d4-40bd-a370-78ce4c1ea3db</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="df934f59-9ceb-4f46-9b86-f2a89eff4c45" name="Item to remove" type="Data">
    <subsheetid>afeadc7e-5b31-4dd7-8ae1-0425070bbf14</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="911012bd-79be-49e5-96a9-3bbfa16857a3" name="Input Variable" type="Block">
    <subsheetid>afeadc7e-5b31-4dd7-8ae1-0425070bbf14</subsheetid>
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="cf278e0c-f1ea-482a-92dc-b66c2695dc70" name="Start" type="Start">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="-375" />
    <onsuccess>0de2369b-4159-4c96-86d3-91c751461dad</onsuccess>
  </stage>
  <stage stageid="0de2369b-4159-4c96-86d3-91c751461dad" name="Launch" type="Action">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="-330" w="150" h="30" />
    <outputs>
      <output type="number" name="pid" friendlyname="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>23dc2082-794d-4992-a58b-18366d2b0290</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="6f32067e-af02-4738-a0fc-e792753c3a0d" name="Attach General" type="Action">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="-240" w="150" h="30" />
    <inputs>
      <input type="number" name="pid" friendlyname="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>fdc79d31-2f85-4b91-a087-31c250c45ce7</onsuccess>
    <resource object="Blue Prism - General (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="23dc2082-794d-4992-a58b-18366d2b0290" name="Add to Cleanup (Blue Prism)" type="SubSheet">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="-285" w="150" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Blue Prism&quot;" />
    </inputs>
    <onsuccess>6f32067e-af02-4738-a0fc-e792753c3a0d</onsuccess>
    <processid>c98744d9-d18e-44e4-8445-7b6dcdb71e27</processid>
  </stage>
  <stage stageid="7da26edb-f7ba-46a3-a6c4-3b8b8f77cac0" name="Terminate" type="Action">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <display x="15" y="75" w="150" h="30" />
    <onsuccess>9bda8972-e056-4f41-965b-0619b1b020b3</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="6a26dd6f-00e4-46a3-b837-5cfc11d286ce" name="Terminate Server" type="Action">
    <subsheetid>ce42f503-3277-462e-9bac-5ed70af902d7</subsheetid>
    <display x="15" y="705" w="150" h="30" />
    <onsuccess>9d7f72f3-620b-4b0d-b1f6-c0fd04d6524e</onsuccess>
    <resource object="Blue Prism Server (Parent)" action="Terminate" />
  </stage>
  <stage stageid="6fb60b99-15bb-4c1d-ad22-9d71e6f1eb9d" name="Wait for Establish Connection to finish" type="Action">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="150" h="30" />
    <onsuccess>de872cdc-4710-4178-9b2f-8adfc93ed448</onsuccess>
    <resource object="Blue Prism - General - Configuration" action="Wait for Establish Connection to Finish" />
  </stage>
  <stage stageid="0c624fe9-b65e-475a-93a1-6b5b69e8901d" name="Wait for Establish Connection to finish" type="Action">
    <subsheetid>4fe81f0f-88ea-4cf0-9b62-bfe4efcbcd79</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="150" h="30" />
    <onsuccess>9e9ed56e-67f0-4642-8215-1e28f278264c</onsuccess>
    <resource object="Blue Prism - General - Configuration" action="Wait for Establish Connection to Finish" />
  </stage>
  <stage stageid="fdc79d31-2f85-4b91-a087-31c250c45ce7" name="Wait for Establish Connection to finish" type="Action">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-195" w="150" h="30" />
    <onsuccess>2f35adde-edaf-4efa-9490-20fc905bdc19</onsuccess>
    <resource object="Blue Prism - General - Configuration" action="Wait for Establish Connection to Finish" />
  </stage>
  <stage stageid="e1b7baa6-f469-4caf-b98d-8515f8242f51" name="Wait for Establish Connection to finish" type="Action">
    <subsheetid>4342b2b3-abf0-448e-9326-6086e9c592a6</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="150" h="30" />
    <onsuccess>5272a89e-2743-4fd3-8aca-d3554b91674b</onsuccess>
    <resource object="Blue Prism - General - Configuration" action="Wait for Establish Connection to Finish" />
  </stage>
</process>