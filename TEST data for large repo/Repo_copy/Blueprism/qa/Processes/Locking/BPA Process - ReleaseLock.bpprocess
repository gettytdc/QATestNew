<process name="ReleaseLock" version="1.0" bpversion="6.9.0.25401" narrative="Test for BG-6673 environmental lock unhandled exception." byrefcollection="true" preferredid="6a3ea4d0-2483-46c4-ba85-7734a647ff24" published="true">
  <view>
    <camerax>0</camerax>
    <cameray>0</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <stage stageid="89e2fa0d-da59-49ed-9673-1df89ae41b79" name="Start" type="Start">
    <display x="15" y="-105" />
    <onsuccess>e537b68f-20aa-4707-8a40-fe6ce9b537f6</onsuccess>
  </stage>
  <stage stageid="c9ed2861-7a43-4dc3-b346-433758bdb668" name="End" type="End">
    <display x="15" y="75" />
  </stage>
  <stage stageid="26199c9f-d462-4b9d-b8dc-dd835373e497" name="Stage1" type="ProcessInfo">
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="e537b68f-20aa-4707-8a40-fe6ce9b537f6" name="Acquire Lock" type="Action">
    <narrative>Acquires the lock associated with the given name. If this session already holds the required lock, it will be re-acquired with a new token</narrative>
    <display x="15" y="-60" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name of the required lock. Mandatory parameter." expr="&quot;TestLock&quot;" />
      <input type="timespan" name="Timeout" friendlyname="Timeout" narrative="The maximum amount of time to await the lock. Default is to wait forever" expr="" />
      <input type="text" name="Preferred Token" friendlyname="Preferred Token" narrative="The preferred token to use for the lock. Default behaviour is to generate a new unique token." expr="" />
      <input type="text" name="Comment" friendlyname="Comment" narrative="The comments to set on the lock" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Token" friendlyname="Token" narrative="The token registered against the lock. This will be empty if the lock could not be acquired" stage="Token" />
    </outputs>
    <onsuccess>765140fe-fa66-4347-89a0-76d1791ae875</onsuccess>
    <resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Acquire Lock" />
  </stage>
  <stage stageid="0edc4ae4-d062-490c-80fd-358a4b115922" name="Token" type="Data">
    <display x="105" y="-105" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="765140fe-fa66-4347-89a0-76d1791ae875" name="Wait 1" type="Action">
    <narrative>Wait for 1 second</narrative>
    <display x="15" y="-15" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" friendlyname="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="120" />
    </inputs>
    <onsuccess>690ce49b-d52e-47ef-8663-0e0b96a1558c</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="690ce49b-d52e-47ef-8663-0e0b96a1558c" name="Release Lock" type="Action">
    <narrative>Releases the lock(s) associated with the given name and token</narrative>
    <display x="15" y="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name of the specific lock to be released. Default behaviour is to release all locks with the given token." expr="&quot;TestLock&quot;" />
      <input type="text" name="Comment" friendlyname="Comment" narrative="The comments to set on the lock(s)" expr="&quot;Done&quot;" />
      <input type="text" name="Token" friendlyname="Token" narrative="The token associated with the lock(s) to be released. Mandatory parameter." expr="[Token]" />
      <input type="flag" name="All Sessions" friendlyname="All Sessions" narrative="True to release locks matching the specified constraints across all sessions; False to only release locks acquired in the current session. Default is False" expr="False" />
    </inputs>
    <onsuccess>c9ed2861-7a43-4dc3-b346-433758bdb668</onsuccess>
    <resource object="BluePrism.AutomateAppCore.clsEnvironmentLockingBusinessObject" action="Release Lock" />
  </stage>
</process>