<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>MSIntellignetServicesWebAPIs</bpr:name>
    <bpr:release-notes />
    <bpr:created>2020-10-14 15:30:26Z</bpr:created>
    <bpr:package-id>-1</bpr:package-id>
    <bpr:package-name>&lt;Adhoc Package&gt;</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="3">
        <webapiservice id="fb458157-d512-4bf3-b63a-1b2319f422a5" name="Microsoft: Computer Vision" enabled="true" xmlns="http://www.blueprism.co.uk/product/webapiservice">
            <configuration baseurl="https://[API Region].api.cognitive.microsoft.com/" xmlns="">
                <actions>
                    <action id="1" name="Analyse and Describe Image" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="vision/v1.0/analyze?visualFeatures=Categories,Tags,Description">
                            <headers />
                            <bodycontent type="2" fileinputparametername="Image to Analyse" />
                        </request>
                        <parameters />
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Analysed Image" path="$" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="2" name="Detect Landmarks" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="vision/v1.0/analyze?details=Landmarks">
                            <headers />
                            <bodycontent type="2" fileinputparametername="Image to Analyse" />
                        </request>
                        <parameters />
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Detected Landmarks" path="$.categories" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="3" name="Detect Celebrities" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="vision/v1.0/analyze?details=Celebrities">
                            <headers />
                            <bodycontent type="2" fileinputparametername="Image to Analyse" />
                        </request>
                        <parameters />
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Detected Celebrities" path="$.categories" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="4" name="Optical Character Recognition" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="vision/v1.0/ocr/?language=unk&amp;detectOrientation=[Not Oriented Correctly]">
                            <headers />
                            <bodycontent type="2" fileinputparametername="Image to Analyse" />
                        </request>
                        <parameters>
                            <actionparameter name="Not Oriented Correctly" expose="true" datatype="8">
                                <initialvalue><![CDATA[False]]></initialvalue>
                                <description><![CDATA[An input parameter which states if the image is not oriented correctly]]></description>
                            </actionparameter>
                        </parameters>
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="OCR Response" path="$.regions" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="5" name="Send Recognise Handwriting Request" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="vision/v1.0/recognizeText?handwriting=true">
                            <headers />
                            <bodycontent type="2" fileinputparametername="Image to Analyse" />
                        </request>
                        <parameters />
                        <outputparameters>
                            <parameters />
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="6" name="Get Recognise Handwriting Response" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="GET" urlpath="vision/v1.0/textOperations/[OpertationalID]">
                            <headers />
                            <bodycontent type="0"></bodycontent>
                        </request>
                        <parameters>
                            <actionparameter name="OpertationalID" expose="true" datatype="64">
                                <initialvalue><![CDATA[]]></initialvalue>
                                <description><![CDATA[]]></description>
                            </actionparameter>
                        </parameters>
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Handwriting Response" path="$.recognitionResult.lines" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="7" name="Get Recognise Handwriting Status" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="GET" urlpath="vision/v1.0/textOperations/[OpertationalID]">
                            <headers />
                            <bodycontent type="0"></bodycontent>
                        </request>
                        <parameters>
                            <actionparameter name="OpertationalID" expose="true" datatype="64">
                                <initialvalue><![CDATA[]]></initialvalue>
                                <description><![CDATA[]]></description>
                            </actionparameter>
                        </parameters>
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Handwriting Status" path="$.status" datatype="text"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                </actions>
                <commonparameters>
                    <actionparameter name="API Region" expose="true" datatype="64">
                        <initialvalue><![CDATA[northeurope]]></initialvalue>
                        <description><![CDATA[]]></description>
                    </actionparameter>
                </commonparameters>
                <commonheaders>
                    <httpheader name="Ocp-Apim-Subscription-Key" value="[Credential.Password]" />
                </commonheaders>
                <commonauthentications>
                    <authentication type="6">
                        <credential credentialname="Microsoft Computer Vision" exposetoprocess="true" inputparametername="Microsoft Computer Vision Credential Name" />
                    </authentication>
                </commonauthentications>
                <commoncode>
                    <codeproperties code="" language="csharp">
                        <namespaces>
                            <namespace>System</namespace>
                            <namespace>System.Drawing</namespace>
                            <namespace>System.Data</namespace>
                            <namespace>System.Collections.Generic</namespace>
                            <namespace>System.Text.RegularExpressions</namespace>
                            <namespace>System.Linq</namespace>
                            <namespace>Newtonsoft.Json</namespace>
                            <namespace>Newtonsoft.Json.Linq</namespace>
                            <namespace>System.Text</namespace>
                            <namespace>System.IO</namespace>
                        </namespaces>
                        <references>
                            <reference>System.dll</reference>
                            <reference>System.Data.dll</reference>
                            <reference>System.Xml.dll</reference>
                            <reference>System.Drawing.dll</reference>
                            <reference>Newtonsoft.Json.dll</reference>
                            <reference>System.Core.dll</reference>
                        </references>
                    </codeproperties>
                </commoncode>
                <configurationsettings>
                    <configurationsettings requesttimeout="10" authserverrequesttimeout="10" />
                </configurationsettings>
            </configuration>
        </webapiservice>
        <webapiservice id="597add01-4983-40ff-a313-7cbcc71287d0" name="Microsoft: Text Analytics" enabled="true" xmlns="http://www.blueprism.co.uk/product/webapiservice">
            <configuration baseurl="https://[API Region].api.cognitive.microsoft.com/" xmlns="">
                <actions>
                    <action id="8" name="Detect Languages" enabled="true" enableRequestOutputParameter="true" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="text/analytics/v2.0/languages">
                            <headers>
                                <httpheader name="content-type" value="application/json" />
                            </headers>
                            <bodycontent type="4">
                                <code><![CDATA[List<JObject> sentences = new List<JObject>();

int id = 0;
foreach (DataRow row in Collection_of_Documents.Rows)
{
	sentences.Add(new JObject(
		new JProperty("id", id.ToString()),
		new JProperty("text", row["Text"].ToString())));
	id += 1;
}

Request_Content = JsonConvert.SerializeObject(            
                    new JObject(
                        new JProperty("documents",
                            new JArray(
                                from sentence in sentences
                                select new JObject(
                                    new JProperty("id", sentence["id"].ToObject<string>()),
                                    new JProperty("text", sentence["text"].ToObject<string>()))))));
]]></code>
                            </bodycontent>
                        </request>
                        <parameters>
                            <actionparameter name="Collection of Documents" expose="true" datatype="1">
                                <initialvalue><![CDATA[<collection />]]></initialvalue>
                                <description><![CDATA[]]></description>
                            </actionparameter>
                        </parameters>
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Detected Languages" path="$.documents" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="9" name="Recognise Entities" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="text/analytics/v2.0/entities">
                            <headers>
                                <httpheader name="content-type" value="application/json" />
                            </headers>
                            <bodycontent type="4">
                                <code><![CDATA[List<JObject> sentences = new List<JObject>();

int id = 0;
foreach (DataRow row in Collection_of_Documents.Rows)
{
	sentences.Add(new JObject(
		new JProperty("id", id.ToString()),
		new JProperty("language", row["Language"].ToString()),
		new JProperty("text", row["Text"].ToString())));
	id += 1;
}

Request_Content = JsonConvert.SerializeObject(            
                    new JObject(
                        new JProperty("documents",
                            new JArray(
                                from sentence in sentences
                                select new JObject(
                                    new JProperty("id", sentence["id"].ToObject<string>()),
                                    new JProperty("language", sentence["language"].ToObject<string>()),
                                    new JProperty("text", sentence["text"].ToObject<string>()))))));
]]></code>
                            </bodycontent>
                        </request>
                        <parameters>
                            <actionparameter name="Collection of Documents" expose="true" datatype="1">
                                <initialvalue><![CDATA[<collection />]]></initialvalue>
                                <description><![CDATA[]]></description>
                            </actionparameter>
                        </parameters>
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Detected Entities" path="$.documents" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="10" name="Recognise Key Phrases" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="text/analytics/v2.0/keyPhrases">
                            <headers>
                                <httpheader name="content-type" value="application/json" />
                            </headers>
                            <bodycontent type="4">
                                <code><![CDATA[List<JObject> sentences = new List<JObject>();

int id = 0;
foreach (DataRow row in Collection_of_Documents.Rows)
{
	sentences.Add(new JObject(
		new JProperty("id", id.ToString()),
		new JProperty("language", row["Language"].ToString()),
		new JProperty("text", row["Text"].ToString())));
	id += 1;
}

Request_Content = JsonConvert.SerializeObject(            
                    new JObject(
                        new JProperty("documents",
                            new JArray(
                                from sentence in sentences
                                select new JObject(
                                    new JProperty("id", sentence["id"].ToObject<string>()),
                                    new JProperty("language", sentence["language"].ToObject<string>()),
                                    new JProperty("text", sentence["text"].ToObject<string>()))))));
]]></code>
                            </bodycontent>
                        </request>
                        <parameters>
                            <actionparameter name="Collection of Documents" expose="true" datatype="1">
                                <initialvalue><![CDATA[<collection />]]></initialvalue>
                                <description><![CDATA[]]></description>
                            </actionparameter>
                        </parameters>
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Recognised Key Phrases" path="$.documents" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                    <action id="11" name="Recognise Sentiment" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="text/analytics/v2.0/sentiment">
                            <headers>
                                <httpheader name="content-type" value="application/json" />
                            </headers>
                            <bodycontent type="4">
                                <code><![CDATA[List<JObject> sentences = new List<JObject>();

int id = 0;
foreach (DataRow row in Collection_of_Documents.Rows)
{
	sentences.Add(new JObject(
		new JProperty("id", id.ToString()),
		new JProperty("language", row["Language"].ToString()),
		new JProperty("text", row["Text"].ToString())));
	id += 1;
}

Request_Content = JsonConvert.SerializeObject(            
                    new JObject(
                        new JProperty("documents",
                            new JArray(
                                from sentence in sentences
                                select new JObject(
                                    new JProperty("id", sentence["id"].ToObject<string>()),
                                    new JProperty("language", sentence["language"].ToObject<string>()),
                                    new JProperty("text", sentence["text"].ToObject<string>()))))));
]]></code>
                            </bodycontent>
                        </request>
                        <parameters>
                            <actionparameter name="Collection of Documents" expose="true" datatype="1">
                                <initialvalue><![CDATA[<collection />]]></initialvalue>
                                <description><![CDATA[]]></description>
                            </actionparameter>
                        </parameters>
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Recognised Sentiment" path="$.documents" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                </actions>
                <commonparameters>
                    <actionparameter name="API Region" expose="true" datatype="64">
                        <initialvalue><![CDATA[northeurope]]></initialvalue>
                        <description><![CDATA[]]></description>
                    </actionparameter>
                </commonparameters>
                <commonheaders>
                    <httpheader name="Ocp-Apim-Subscription-Key" value="[Credential.Password]" />
                </commonheaders>
                <commonauthentications>
                    <authentication type="6">
                        <credential credentialname="Microsoft Text Analytics" exposetoprocess="true" inputparametername="Microsoft Text Analytics Credential Name" />
                    </authentication>
                </commonauthentications>
                <commoncode>
                    <codeproperties code="" language="csharp">
                        <namespaces>
                            <namespace>System</namespace>
                            <namespace>System.Drawing</namespace>
                            <namespace>System.Data</namespace>
                            <namespace>System.Collections.Generic</namespace>
                            <namespace>Newtonsoft.Json</namespace>
                            <namespace>Newtonsoft.Json.Linq</namespace>
                            <namespace>System.Linq</namespace>
                        </namespaces>
                        <references>
                            <reference>System.dll</reference>
                            <reference>System.Data.dll</reference>
                            <reference>System.Xml.dll</reference>
                            <reference>System.Drawing.dll</reference>
                            <reference>Newtonsoft.Json.dll</reference>
                            <reference>System.Core.dll</reference>
                        </references>
                    </codeproperties>
                </commoncode>
                <configurationsettings>
                    <configurationsettings requesttimeout="10" authserverrequesttimeout="10" />
                </configurationsettings>
            </configuration>
        </webapiservice>
        <webapiservice id="c53cf715-dd2e-4599-a592-6843f27d4cd2" name="Microsoft: Translate" enabled="true" xmlns="http://www.blueprism.co.uk/product/webapiservice">
            <configuration baseurl="https://api.cognitive.microsofttranslator.com" xmlns="">
                <actions>
                    <action id="14" name="Translate" enabled="true" enableRequestOutputParameter="false" disableSendingOfRequest="false">
                        <description><![CDATA[]]></description>
                        <request httpmethod="POST" urlpath="/translate?api-version=3.0&amp;to=[Target Translation]">
                            <headers>
                                <httpheader name="content-type" value="application/json" />
                            </headers>
                            <bodycontent type="4">
                                <code><![CDATA[List<JObject> sentences = new List<JObject>();

foreach (DataRow row in Collection_of_Documents.Rows)
{
	sentences.Add(new JObject(
		new JProperty("text", row["Text"].ToString())));
}

Request_Content = JsonConvert.SerializeObject(            
						new JArray(
							from sentence in sentences
							select new JObject(
								new JProperty("Text", sentence["text"].ToObject<string>()))));
]]></code>
                            </bodycontent>
                        </request>
                        <parameters>
                            <actionparameter name="Collection of Documents" expose="true" datatype="1">
                                <initialvalue><![CDATA[<collection />]]></initialvalue>
                                <description><![CDATA[]]></description>
                            </actionparameter>
                            <actionparameter name="Target Translation" expose="true" datatype="64">
                                <initialvalue><![CDATA[]]></initialvalue>
                                <description><![CDATA[]]></description>
                            </actionparameter>
                        </parameters>
                        <outputparameters>
                            <parameters>
                                <customoutputparameter type="JsonPath" name="Translated Documents" path="$" datatype="collection"></customoutputparameter>
                            </parameters>
                            <code><![CDATA[]]></code>
                        </outputparameters>
                    </action>
                </actions>
                <commonparameters>
                    <actionparameter name="SubscriptionRegion" expose="true" datatype="64">
                        <initialvalue><![CDATA[]]></initialvalue>
                        <description><![CDATA[Per Microsoft, region is required if using the multi-service Text API subscription. The region you select is the only region that you can use for text translation when using the multi-service subscription key, and must be the same region you selected when you signed up for your multi-service subscription through the Azure portal.]]></description>
                    </actionparameter>
                </commonparameters>
                <commonheaders>
                    <httpheader name="Ocp-Apim-Subscription-Key" value="[Credential.Password]" />
                    <httpheader name="Ocp-Apim-Subscription-Region" value="[SubscriptionRegion]" />
                </commonheaders>
                <commonauthentications>
                    <authentication type="6">
                        <credential credentialname="Microsoft Translation" exposetoprocess="true" inputparametername="Microsoft Translation Credential Name" />
                    </authentication>
                </commonauthentications>
                <commoncode>
                    <codeproperties code="" language="csharp">
                        <namespaces>
                            <namespace>System</namespace>
                            <namespace>System.Drawing</namespace>
                            <namespace>System.Data</namespace>
                            <namespace>Newtonsoft.Json</namespace>
                            <namespace>Newtonsoft.Json.Linq</namespace>
                            <namespace>System.Linq</namespace>
                            <namespace>System.Collections.Generic</namespace>
                        </namespaces>
                        <references>
                            <reference>System.dll</reference>
                            <reference>System.Data.dll</reference>
                            <reference>System.Xml.dll</reference>
                            <reference>System.Drawing.dll</reference>
                            <reference>Newtonsoft.Json.dll</reference>
                            <reference>System.Core.dll</reference>
                        </references>
                    </codeproperties>
                </commoncode>
                <configurationsettings>
                    <configurationsettings requesttimeout="10" authserverrequesttimeout="10" />
                </configurationsettings>
            </configuration>
        </webapiservice>
    </bpr:contents>
</bpr:release>