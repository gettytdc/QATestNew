<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link type="text/css" href="AutomateHelp.css" rel="stylesheet"/>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>アーカイブ</title>
	<script type="text/javascript" src="script/imagezoom.js"></script>
</head>

<body class="slick">
	<div class="header">
		<h1 class="pagetitle">Blue Prism</h1>
		<h2>アーカイブ</h2>
	</div>

	<h3 id="overview">概要</h3>

	<p>Blue Prismは、すべてのアクティビティの完全かつ正確なレコードを保持しながら、データベースサーバーの継続的かつ効率的な稼働を保証するアーカイブ機能を備えています。アーカイブでは、データベースからファイル構造にセッションログデータが転送されます。これにより、データベーススペースが解放され、古いデータの恒久的なアーカイブが可能になります。アーカイブされたデータはいつでもデータベースに復元できます。</p>

	<p>アーカイブに使用できるメカニズムは3つあります。2つは手動で開始する方法で、もう1つはリソースを実行するための自動バックグラウンドタスクです。</p>
	<dl class="listplease">

		<dt><a href="#manual">システムマネージャーインターフェイス</a></dt>
		<dd>この操作モードでは、特定のセッションログをさまざまなレベルの粒度（日、月、プロセス、PCなど）で正確に選択してアーカイブできます。同様に、選択したログを復元できます。</dd>

		<dt><a href="#commandline">コマンドラインインターフェイス</a></dt>
		<dd>この方法では、スケジュールされたタスクを設定して定期的にアーカイブすることが簡単にできます。たとえば、6か月以上前のログを対象としたアーカイブを夜間に実行できます。
		</dd>

		<dt><a href="#automatic">自動アーカイブ</a></dt>
		<dd>登録済みのリソースは、定期的にセッションログを自動でアーカイブするように指定できます。このリソースは、稼働している間、終日チェックを行い、必要に応じてバックグラウンドでアーカイブを実行します。</dd>
	</dl>

	<h3 id="manual">ログを手動でアーカイブする</h3>

	<p>手動アーカイブは、マシンごとに構成および実行されます。つまり、あるマシンでアーカイブディレクトリを変更した場合、そのマシンでのみローカルに変更されます。</p>

	<ul>
		<li><a href="helpUserPermissions.htm">システムマネージャー</a>にアクセスする<a href="frmSystemManager.htm">十分な許可</a>があるBlue Prismユーザーとしてサインインします。</li>

		 <li>システムマネージャーの［システム］セクションに入り、［アーカイブ］タブにアクセスします。</li>

		<li>［アーカイブフォルダー］で、［参照］ボタンを使用してログを保存するディレクトリを選択します。注意：Blue Prismはこのディレクトリへの読み書き許可を必要とし、（たとえば、マッピングされたネットワークドライブの場合には）アーカイブを実行するときにこの場所にアクセス可能である必要があります（つまり、ディレクトリをホストしているリモートマシンの電源がオンになっている必要があります）。</li>

		<li>選択したディレクトリが次にアーカイブするときに記憶されるように、［保存］ボタンを使用してディレクトリをローカルPCの構成ファイルに保存できます。この保存されたディレクトリは、コマンドラインアーカイブにも使用されます。</li>

		<li>右側の［データベース］ツリービューでリーフノードにチェックマークを入れて、アーカイブするログを選択します。</li>

		<li>右側のツリービューで選択内容を確認し、［アーカイブ］ボタンをクリックします（アーカイブの進捗状況は進捗バーによって示されます）。</li>

		<li>選択したログが左側の［アーカイブ］ツリービューに新しく表示されたことを確認します。</li>
	</ul>

	<h3 id="commandline">コマンドラインアーカイブ</h3>

	<p>このアーカイブ操作は、コマンドラインで<code>AutomateC</code>プログラムを使用して実行できます。</p>

	<p>使用可能なオプションの詳細については、「<a href="helpCommandLine.htm">コマンドラインオプション</a>」ヘルプを参照してください。</p>

	<p>利用可能な実行中のリソースを必要としないスケジュールされたアーカイブタスクは、Windowsのスケジュールされたタスク内でコマンドラインアーカイブコマンドを呼び出すことによって実行できます。</p>

	<p>たとえば、次のコマンドは、シングルサインオン環境で6か月以上前のログをすべてアーカイブします。</p>

	<pre>AutomateC /archive /sso /age 6m</pre>

	<p>コマンドラインを使用してアーカイブおよび復元する場合は、システムマネージャーのインターフェイスで選択したアーカイブフォルダーが使用されます。必要に応じてこれを直接設定するためのコマンドラインオプションもあります。</p>

	<h3 id="automatic">自動アーカイブ</h3>

	<p>自動アーカイブを使用すると、セッションログが指定された期間を超えたときに必ずアーカイブ操作を実行することで、ログが大きくなりすぎるのを防止できます。</p>

	<p>これにより、登録済みの実行中リソースが、指定された日時より前に終了したセッションログを終日定期的にチェックし、見つかるとアーカイブ/削除します。</p>

	<p>これは、システムマネージャーの<a href="#manual">手動アーカイブ</a>と同じ場所で有効化および構成されます。</p>

	<p>自動モードを有効にするには、［<code>自動モードに切り替え</code>］ボタンを押します。このモードに固有のオプションが表示されます。</p>

	<dl class="listplease">
		<dt>リソース</dt>
		<dd>自動アーカイブバックグラウンドタスクを実行するリソースについて詳しく説明します。</dd>

		<dt>モード</dt>
		<dd>後でデータベースに復元可能なリソースのローカルフォルダーにログをアーカイブするか、単にログデータを削除できます。</dd>

		<dt>アーカイブフォルダー</dt>
		<dd>リソースがアーカイブされたセッションログを書き込むフォルダー。このパスは、アーカイブ操作を実行するリソース上にローカルに存在する必要があります。そのため、たとえば<code>C:\logs\BluePrism\sessions</code>フォルダーに指定されたリソースがアクセスできるようにする必要があります。そうしないと、アーカイブ操作は失敗します。</dd>
		<dd>構成したモードが、ログが直接削除されることを示す場合、このフィールドは必要ありません。</dd>

		<dt>これ以前をアーカイブ</dt>
		<dd>アーカイブの期間を指定できます。アーカイブ操作は、指定された期間より早く<em>終了した</em>セッションログをアーカイブしようとします。</dd>
		<dd>一部のデバッグセッションは終了日を取得できない可能性があるため、自動アーカイブではアーカイブに含まれません。これらは<a href="#manual">手動で</a>アーカイブする必要があります。

	</dl>

	<h3 id="restore">ログを復元する</h3>

	<p>ログは、アーカイブディレクトリからデータベースに手動で復元することしかできません。自動アーカイブを有効にしていて、指定されたアーカイブ期間より古いログを復元した場合、それらのログは利用可能な次の機会に再アーカイブされます。このシナリオでは、自動アーカイブを一時的に無効にすることを推奨します。</p>

	<p>手順は次のとおりです。</p>

	<ul>
		<li>「<a href="#manual">手動アーカイブ</a>」セクションの説明に従ってシステムマネージャーのアーカイブ領域に入り、正しい「アーカイブフォルダー」を選択します。</li>

		<li>左側の［アーカイブ］ツリーの適切なエントリにチェックマークを入れて復元するログを選択します。</li>

		<li>［<code>復元</code>］ボタンをクリックします。</li>

		<li>選択したログが右側の［データベース］ツリービューに新しく表示されたことを確認します。</li>
	</ul>

	<p><strong>注意：</strong>他の環境から取得したセッションログは復元できません。ログを正しく復元するには、同じプロセス、リソース、ユーザーが存在する必要があります。</p>

	<h3 id="view">データベースとアーカイブのログを表示する</h3>

	<p>データベースまたはアーカイブのログを表示する場合は、システムマネージャーから表示できます。</p>

	<ul>
		<li>「<a href="#manual">手動アーカイブ</a>」セクションの説明に従ってシステムマネージャーのアーカイブ領域に入ります。</li>

		<li>表示するログを見つけて選択します。エントリにチェックマークを付ける必要はありません。エントリのラベルをクリックして選択するだけです。いずれかのツリーのエントリを選択できます。</li>

		<li>選択したログまたはファイルを表示するには、［<code>ログを表示</code>］または［<code>ファイルを表示</code>］ボタンをそれぞれクリックします。</li>
	</ul>
	
	<div class="captioned-image screenshot">
		<img src="Graphics/release-archive-lock.png" alt="アーカイブロックを解除する"/>
	</div>
	<h3 id="releaselock">アーカイブロックを解除する</h3>
	
	<p>アーカイブ操作中に何らかの理由でアーカイブリソースに障害が発生した場合、データベースにロックが残ったままになり、再起動時にリソースがアーカイブを再開できなくなる可能性があります。リソースから「<i>アーカイブに失敗しました - このコンピューターはすでにアーカイブプロセスを実行しています</i>」というエラーが報告される場合があります。このような状況が発生した場合、システム管理者（または［アーカイブ］画面にアクセスできるユーザー）は、メニューボタンのオプションを使用してこのロックを手動で解除できます。</p>

</body>
</html>
