<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" href="AutomateHelp.css" rel="stylesheet"/>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ステージのプロパティ - 待機</title>
</head>

<body>
    <div class="header">
        <h1 class="pagetitle">ステージタイプ</h1>
    </div>
	
	<h3>待機ステージ</h3>

    <p>待機ステージでは、対象アプリケーションで特定の条件が満たされるまで、ビジネスオブジェクトの実行を一時停止できます。例としては、ウィンドウが表示されるまで待つ、特定のステータスバーメッセージを待つ、などがあります。ビジネスオブジェクトは、さまざまな結果のうちの1つが発生するのを待っている場合があります。たとえば、新しいデータをコミットした後に、ポップアップウィンドウが表示されたり、エラーメッセージウィンドウが表示されたり、あるいはまったく異なる何かが発生する可能性があります。変更が検出されない場合は、ビジネスオブジェクトが特定の「タイムアウト」期間の経過後に移動するように設計されている可能性があります。待機ステージでは、観察された結果に応じてビジネスオブジェクトのフローを分岐できるようにすることで、この不確実性に対処します。この意味では、待機ステージは<a href="frmStagePropertiesChoice.htm">選択ステージ</a>とほとんど同じです（選択ステージの［その他の場合］オプションが待機ステージの［タイムアウト］オプションに対応する場合）。</p>

	<h3>用途</h3>
	<p>
 待機ステージには、対話の準備状態を検出することと、特定のアクションの結果を検出するという、主に2つの用途があります。
	</p>
	<p>
 待機ステージは、対象アプリケーションの準備を確実にするために使用できます。たとえば、アプリケーションを起動した後は、ロードが完了するのを待つ必要があります。これは、メインアプリケーションウィンドウが表示されるのを待つことで実現できます。別の例では、新しいデータを送信する前に、ステータスバーの「システムアイドル」メッセージを待つ必要があるとします。これは、ステータスバーのテキストに「system idle」と表示されるのを待つことで実現できます。
	</p>
	<p>
 前述のように、複数の条件チェックが行われると、どちらの結果が最初に発生するかに応じて、ビジネスオブジェクトのフローを分岐する機会が生じます。
	</p>

    <h3>プロパティのフォーム</h3>

    <p>［待機プロパティ］フォームには、チェックする条件のリストが表示されます。条件はリストの上から下に表示される順序でチェックされます。条件の1つが満たされるとすぐに、ビジネスオブジェクトはプロセス図の対応する分岐に従います。条件ごとに1つの分岐があり、分岐はリスト内の条件と同じ順序で図に表示されます。最後の条件がチェックされた後にどの条件も満たされない場合、チェックは最初の行から再開されます。このループは、条件が満たされるか、<a href="#Timeout">タイムアウト期間</a>が経過するまで続きます。
	</p>
	
	<p>
 たとえば、最初の条件は「「名前を付けて保存」ダイアログが存在するかどうかを確認する」で、2番目の条件は、「エラーメッセージウィンドウが存在するかどうかを確認する」である場合があります。
	</p>

    <p>それぞれの待機条件は、<a href="frmIntegrationAssistant.htm#Elements">アプリケーション要素</a>、条件、比較タイプ、期待値で構成されています。アプリケーション要素は条件の対象です（存在を確認するウィンドウなど）。
 条件はどの状態がその要素に対してチェックされるべきかを記述します（CheckExists、GetWindowTextなど）。比較タイプは、提供された値を対象アプリケーションで見つかったデータと比較する方法を説明します。これは、データが等しいか、等しくないか、<a href="helpWildcardsAndRegex.htm">ワイルドカード</a>パターンと一致するかどうかを検出する、またはある値が別の値よりも大きいかどうか（数値の場合）を確認するためです。</p>

    <h5 class="bold">新しい待機条件を追加する</h5>

    <p>まず［追加］ボタンをクリックして新しい行を追加します。次に、左側の<a href="frmIntegrationAssistant.htm">アプリケーションエクスプローラ</a>から適切なフィールドにアプリケーション要素をドラッグアンドドロップします。</p>

    <p>アプリケーション要素の性質（具体的には、作成時にアプリケーション要素を<a href="frmIntegrationAssistant.htm#dynamic">動的</a>にすることを選択したかどうか）によっては、適切なボタンをクリックしてアプリケーション要素にパラメーターを指定する必要があります。これにより、実行時にライブデータを使用して要素を識別できます。</p>

    <p>次にドロップダウンリストから条件を選択します。このリストは、選択したアプリケーション要素の種類によって動的に変化します。条件がリストに表示されない場合は、選択したアプリケーション要素に対する条件を確認できません。</p>

	<p>たとえば、<a href="helpWildcardsAndRegex.htm">ワイルドカード</a>パターンの一致を実行する場合は、カスタム比較タイプを選択することをお勧めします。ただし、ほとんどの場合は、等価性のテストであるデフォルトの比較タイプの使用をお勧めします。</p>
	
    <p>最後のフィールドには期待値を入力します。たとえば、CheckExistsの場合、値は「True」または「False」になります。GetTextの場合、値は期待されるテキストになります。条件が正に一致するためには、ここに入力された値が完全に一致する必要があります。</p>
	
	
	<h5 class="bold">タイムアウト期間を指定する<a name="Timeout" id="Timeout"></a></h5>
   	<p>［待機ステージプロパティ］フォームの一番下には［タイムアウト］フィールドがあります。ここには、待機ステージが満たされるべき条件の1つをチェックし続ける最大時間を秒単位で表す数値を入力できます。または、タイムアウト値に式を入力します。これは、グローバルタイムアウト値をデータアイテムに格納し、このデータをすべての待機ステージで参照する場合などに便利です。</p>
	
	<p>
 タイムアウト期間が経過した後にいずれの条件も満たされない場合、ビジネスオブジェクトフローはプロセス図のタイムアウトステージからのリンクをたどります。このリンクがない場合、ビジネスオブジェクトはエラーで停止します。
	</p>
</body>
</html>
