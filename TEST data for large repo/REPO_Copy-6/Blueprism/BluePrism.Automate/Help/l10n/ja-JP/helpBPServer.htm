<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" href="AutomateHelp.css" rel="stylesheet"/>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>Blue Prismサーバー</title>
	<script type="text/javascript" src="script/imagezoom.js"></script>
</head>

<body class="slick">
    <div class="header">
        <h1 class="pagetitle">Blue Prismサーバー</h1>
		<h2>はじめに</h2>
    </div>
	
	<div class="captioned-image overview-screenshot nozoom">
		<a href="Graphics/bpserver.png" title="サーバー構成 - クリックすると大きな画像が表示されます">
		<img alt="サーバー構成 - クリックすると大きな画像が表示されます" src="Graphics/bpserver.png"/></a>
		<p>直接アクセスとBlue Prismサーバーアーキテクチャの比較</p>
	</div>
	
	<h3 id="overview">概要</h3>
	<p>Blue Prismは、2つの異なるネットワークアーキテクチャで稼働できます。</p>
	<dl class="listplease">
		<dt>直接アクセス</dt>
		<dd>
			<p>Blue Prismクライアントは、完全なBlue Prismクライアントソフトウェアを実行しているか、単にランタイムリソースとして動作しているかにかかわらず、Blue Prism環境を管理するデータベースに直接アクセスできます。</p>
			<p>このためには、各クライアントがデータベースの認証情報を保存し、使用される認証モードによっては、ユーザーにBlue Prismデータベースへのフルアクセスを付与する必要がありますが、これは望ましくありません。</p>
		</dd>
		<dt>Blue Prismサーバー</dt>
		<dd>
			<p>Blue Prismクライアントとリソースは、中央のマシンで実行されているBPサーバーサービスに接続します。これはデータベースのプロキシとして機能し、データにアクセスして変更するために認証データを必要とするシステム内の唯一の場所になります。</p>
		</dd>
	</dl>
	<p><a href="helpScheduler.htm">Blue Prismスケジューラー</a>もBPサーバーサービスス内で実行され、主にスケジューラーを実行する目的で動作しているBPサーバーインスタンスとの「直接アクセス」アーキテクチャを維持できます。</p>
	
	<div class="captioned-image screenshot"><img src="Graphics/bpserver-config.png" alt="BPサーバーを構成する"/>
	</div>
	<h3 id="configuring">BPサーバーを構成する</h3>
	<h4>サーバー構成の概要</h4>
	<p>Blue Prismサーバーサービスは、Blue Prismソフトウェアのインストールプロセスの一部としてインストールされます。これはスタートメニューの［<code>インストール済みサービス</code>］リストにあります。このリストには、<code>［すべてのプログラム］：［管理ツール］：サービス</code>。</p>
	
	<p>サーバーは、Blue Prismのインストールディレクトリ（通常は<code>C:\Program Files\Blue Prism Limited\Blue Prism Automate</code>）にインストールされているBPServer.exeを実行することによって構成します。</p>
	
	<p>表示されるダイアログボックスでは、Blue Prismサーバーの複数の構成を指定できます。これにより、Blue Prismサーバーは異なるデータベースに接続したり、複数のクライアントをリッスンしたりできます。</p>
	
	<p>このダイアログは、<a href="helpScheduler.htm">Blue Prismスケジューラー</a>の構成には使用されなくなりました。これは、<a href="helpSystemManagerScheduler.htm">システムマネージャー</a>で環境全体に対して構成できるようになりました。</p>

	<hr class="clearer light"></hr>
	
	<h4>既存の構成を編集する</h4>
	<p>インストール時に、Blue Prismサーバーのデフォルト構成が「<code>Default</code>」という名前で作成されます。［サーバー］構成ダイアログを開いたとき、［<code>構成</code>］ドロップダウンボックスで選択されるのはこの構成です。</p>
	
	<p>構成を編集するには、その構成が［<code>構成</code>］ドロップダウンで選択されていることを確認し、［<code>編集...］
	</code> ボタンをクリックします。</p>
	
	<p>これにより、［<a href="#server-details">サーバー構成の詳細</a>］ダイアログが開き、選択した構成用に保存されている現在の詳細が表示されます。</p>
	
	<p><strong>注意：</strong>Blue Prismのインストール時にデフォルトでインストールされるBlue Prismサーバーサービスは、「Default」という名前のサーバー構成をロードしようとします。この構成が存在しない場合は起動しません。サービスを構成して別の構成をロードする方法については、「<a href="#running-multiple">複数のBPサーバーを実行する</a>」を参照してください。</p>
	
	<h4>新しい構成を作成する</h4>
	<p>［新規...］ボタンをクリックすると、［<a href="#server-details">サーバー構成の詳細</a>］ダイアログが開き、そこで構成を指定できます。</p>
	
	<h4>構成を削除する</h4>
	<p>構成を削除するには、その構成が［<code>構成</code>］ドロップダウンで選択されていることを確認し、［<code>削除</code>］ボタンをクリックします。</p>
	<p>構成が削除され、変更内容がすぐに保存されます。</p>

	<div class="clearer"></div>
	<div class="captioned-image screenshot"><img src="Graphics/bpserver-instance-config.png" alt="BPサーバーインスタンスを構成する"/>
	</div>
	<h3 id="server-details">サーバー構成の詳細</h3>
	<p>［サーバー構成の詳細］ダイアログでは、次の項目を指定できます。</p>
	<h4>［詳細］タブ</h4>
	<dl class="bulleted">
		<dt id="config-name">名前</dt>
		<dd>構成の名前。これは主にドキュメンタリーですが、<a href="#running-multiple">複数のBPサーバーサービス</a>を定義する際にサービスが使用するサーバー構成を指定するためにも使用されます。
 その場合、対応するサービスを簡単にインストールできるように、スペースや句読点を含まないシンプルな名前を使用することを推奨します。
		</dd>
		
		<dt id="config-connection">接続</dt>
		<dd>サーバー構成がサービスを提供しているBlue Prismデータベースに接続するために使用する必要がある接続構成。利用可能な接続は、ログインページからアクセスできるBlue Prismクライアントの［<a href="helpConnections.htm">接続</a>］ダイアログで構成されている接続から取得されます。</dd>
		
		<dt id="config-port">リスニングポート</dt>
		<dd>Blue Prismクライアントからの接続をリッスンするTCP/IPポート。複数のサーバーを同時に実行する場合は、サーバー構成ごとに異なるポートを指定する必要があります。そうしないと、サーバーが起動できなくなる可能性があります。</dd>

        <dt id="connection-mode">接続モード</dt>
        <dd>
 Blue PrismクライアントとBlue Prismサーバー間の接続には、以下の接続モードを使用できます。
            <dl class="listplease">
                <dt>WCF：メッセージの暗号化付きSOAP＆Windows認証</dt>
                <dd>
                    <ul>
                        <li>デバイス間に信頼関係が必要です。はい</li>
                        <li>Blue Prism認証モード：Blue Prismネイティブ/シングルサインオン</li>
                        <li>サーバー側の証明書が必要です。いいえ</li>
                        <li>トランスポート：SOAP over HTTP</li>
                    </ul>
                    <p>
 メッセージコンテンツのみが暗号化されます。  SOAPヘッダーとHTTPヘッダーは暗号化されないままであるため、複雑なルーティング、ロードバランサー、プロキシなどが容易になります。  クライアントとサーバーIDは、Windows/Active Directoryを介して検証されます。
                    </p>
                </dd>
                <dt>WCF：転送の暗号化付きSOAP＆Windows認証</dt>
                <dd>
                    <ul>
                        <li>デバイス間に信頼関係が必要です。はい</li>
                        <li>Blue Prism認証モード：Blue Prismネイティブ/シングルサインオン</li>
                        <li>サーバー側の証明書が必要です。はい</li>
                        <li>トランスポート：SOAP over HTTPS</li>
                    </ul>
                    <p>
 SOAPヘッダーを含むトランスポートは、証明書ベースの暗号化を使用して暗号化されます。クライアントとサーバーIDは、Windows/Active Directoryを介して検証されます。
                    </p>
                </dd>
                <dt>WCF：転送の暗号化付きSOAP</dt>
                <dd>
                    <ul>
                        <li>デバイス間に信頼関係が必要です。いいえ</li>
                        <li>Blue Prism認証モード：Blue Prismネイティブ</li>
                        <li>サーバー側の証明書が必要です。はい</li>
                        <li>トランスポート：SOAP over HTTPS</li>
                    </ul>
                    <p>
 SOAPヘッダーを含むトランスポートは、証明書ベースの暗号化を使用して暗号化されます。サーバーIDは証明書を使用して検証されます。
                    </p>
                </dd>
                <dt>.NET Remoting：セキュア</dt>
                <dd>
                    <ul>
                        <li>デバイス間に信頼関係が必要です。はい</li>
                        <li>Blue Prism認証モード：Blue Prismネイティブ/シングルサインオン</li>
                        <li>サーバー側の証明書が必要です。はい</li>
                        <li>トランスポート：TcpChannel over SChannel</li>
                    </ul>
                    <p>
 後方互換用に提供されます。暗号化はクライアントとサーバーの間でネゴシエートされます。クライアントとサーバーIDは、Windows/Active Directoryを介して検証されます。
                    </p>
                </dd>
                <dt>.NET Remoting：非セキュア</dt>
                <dd>
                    <ul>
                        <li>デバイス間に信頼関係が必要です。いいえ</li>
                        <li>Blue Prism認証モード：Blue Prismネイティブ</li>
                        <li>サーバー側の証明書が必要です。いいえ</li>
                        <li>トランスポート：TcpChannel</li>
                    </ul>
                    <p>
 推奨しません - 後方互換用に提供されます。
 接続セキュリティはサードパーティのソリューションによって全面的に提供される必要があります。
                    </p>
                </dd>
                <dt>WCF：非セキュア</dt>
                <dd>
                    <ul>
                        <li>デバイス間に信頼関係が必要です。はい</li>
                        <li>Blue Prism認証モード：Blue Prismネイティブ/シングルサインオン</li>
                        <li>サーバー側の証明書が必要です。はい</li>
                        <li>トランスポート：SOAP over HTTP</li>
                    </ul>
                    <p>
 推奨しません。接続セキュリティはサードパーティのソリューションによって全面的に提供される必要があります。
                    </p>
                </dd>
            </dl>
        </dd>
   
		<dt id="config-bind">ホスト名またはIPアドレス/IPアドレス</dt>
		<dd>サーバーに複数のネットワークインターフェイスがある場合は、サーバーが接続をリッスンするために使用するIPアドレスを指定できます。WCF接続モードを使用する場合は、IPアドレスの代わりにホスト名を使用できます。</dd>	
		<dd>このフィールドを空白のままにすると、Blue Prismサーバーは任意のアドレスでリクエストを受け入れます。
		</dd>

		<dt id="disable-scheduler">スケジューラーを無効化</dt>
		<dd>このオプションをオンにすると、この構成を使用しているサーバーはスケジュールされたタスクを実行しようとしません。これは、単一のサーバーがスケジュールを実行する必要がある複数サーバー環境で役立つ場合があります。</dd>		
		
		<dt id="enable-dashboards">パブリッシュされたダッシュボードを有効化</dt>
		<dd>オンにすると、サーバーは構成済みの<a href="dashboards-ui.htm#Published">パブリッシュされたダッシュボード</a>のデータを定期的に取得し、その結果を外部のアプリケーションで使用できるようにJSON形式でWindowsイベントログに書き込みます。</dd>
		
	</dl>
	
	<h4>［証明書］タブ（WCF接続モードのみ）</h4>
	<dl class="bulleted">
	<dt>証明書リスト</dt>
	<dd>このパネルには、マシンで見つかった現在のポートの証明書バインディングのリストが表示されます。ポートのすべてのバインディングが表示されるため、ユーザーは選択したホスト名とIPアドレスのどちらに適用するかを判断できます。</dd>
	<dd>このセクションから新しい証明書バインディングを追加できます。既存の証明書バインディングを表示または削除できます。</dd>	
	
	<h4>［新しい証明書バインディングを追加］ウィンドウ（WCF接続モードのみ）</h4>
	<p>新しい証明書バインディングは［証明書］タブから追加できます。</p>
	<dl class="bulleted">
	<dt>証明書バインディングアドレス</dt>
	<dd>このセクションでは、「ワイルドカード」IPアドレス、特定のIPアドレス、またはホスト名のどれを使用して現在のポートに証明書バインディングを追加するかを選択できます。オプションは、サーバーに対して指定されているIPアドレスまたはホスト名によって異なります。</dd>
	<dd>Windows 8より前のオペレーティングシステムでは、ホスト名を使用したバインディングはサポートされません。警告が表示され、代わりに［任意のIPアドレス］オプションを使用してバインディングを追加する必要があります。</dd>	
	<dt>ローカルマシン証明書ストア</dt>
	<dd>ここでは、証明書を選択するストアを指定できます。ほとんどの場合、デフォルトの［自分の（個人の）］オプションを使用することを推奨します。［OK］ボタンをクリックすると、このストアから証明書を選択するように求められます。</dd>
	</dl></dl>
		
	<h4>［キーストア］タブ</h4>
	<dl class="bulleted">
	<dt>暗号化キー</dt>
	<dd>Blue Prism内で定義されている<a href="helpEncryption.htm">暗号化方式</a>に関連付けられているキーがデータベースに保持されていない場合は、そのキーを関連する方式の名前と一緒にサーバーキーストアに追加する必要があります。</dd>
	<dd>キーが適切に配置され、サーバーが起動すると、接続されているBlue Prismクライアントは、このキーを使用してこの接続の認証情報やキュー項目データを暗号化および復号できるようになります。</dd>
	
	<dt>個々のファイルに個別にキーを保存</dt>
	<dd>このオプションがオンになっている場合、キー自体がメインサーバー構成とは別に保持されます。そのため、必要に応じてオペレーティングシステムの許可および暗号化ポリシーを使用してキーへのアクセスを制御できます。各キーは、指定されたフォルダー内の個別のファイルに書き込まれ、関連付けられている<a href="helpEncryption.htm">暗号化方式名</a>に従って名前が付けられます。</dd>
	<dd>指定されたフォルダーは、Blue Prism暗号化キーファイルを保持するためにのみ使用することを推奨します。複数のサーバー構成で同じフォルダーを使用することはできません。</dd>
	<dd>サーバー構成を変更しているユーザーが1つ以上のキーファイルへの読み取りアクセス権を持っていない場合、不慮のキー損失を防ぐためにこのオプションは無効になります。</dd>
	</dl>
	
	<h4>［サーバーサービス］タブ</h4>
	<dl class="bulleted">
	<dt>Windowsサービスリスト</dt>
        <dd>
 ここには、ローカルマシンで検出されたBlue PrismサーバーWindowsサービスのリストが表示されます。このリストには、編集中の構成に関連付けられているサービスのみが表示されます。このリストには、サービスの設定とステータスに関する情報が含まれています。
        </dd>
        <dd>
 さらに、サービスを実行するユーザーアカウントに、サーバー構成用に指定されたアドレスとポートをリッスンする許可があるかどうかに関する詳細も含まれます。［許可を管理］リンクをクリックすると、これらの許可を管理できるウィンドウが開きます。
        </dd>
        <dd>
 現在編集中の構成に関連するWindowsサービスがローカルマシンで検出されない場合は、［<code>サービスを作成</code>］ボタンをクリックするか、管理者特権のコマンドプロンプトのタブに表示されるコマンドテキストの例を実行して新しいサービスを作成できます。
        </dd>

	
	<h4>［URL許可を管理］ウィンドウ（WCF接続モードのみ）</h4>
	<dl class="bulleted">
	<dt>URL許可リスト</dt>
	<dd>このパネルには、マシンで見つかった構成のアドレスおよびポートのURL許可のリストが表示されます。</dd>
	<dd>http URL用に設定されたURL許可は、httpsを使用するサーバーでは機能しません。その逆も同様です。http URLとhttps URL（URLはhttp/https部分以外は同一）の両方に個別のURL許可を設定することもできません。リストには、http URLとhttps URLの両方を使用する許可が含まれるため、競合する可能性があります。</dd>
	<dd>このセクションから新しいURL許可を追加できます。既存の許可を編集または削除できます。</dd>	
	
	<h4>［URL許可を追加/編集］ウィンドウ（WCF接続モードのみ）</h4>
	<p>URL許可は、［URL許可を管理］ウィンドウから追加または編集できます。</p>
	<dl class="bulleted">
		<dt>URL</dt>
		<dd>このセクションでは、「ワイルドカード」IPアドレス、特定のIPアドレス、またはサーバーで使用されるホストのどれを使用してURL許可を追加するかを選択できます。利用可能なオプションは、サーバーに対して指定されているアドレスによって異なります。</dd>
		<dt>ユーザー</dt>
		<dd>マシンで検出されたWindowsサービスを実行するように設定されているユーザーアカウント（および編集時に既存のURL許可に属するその他のアカウント）は、ここで選択できます。</dd>
	</dl></dl></dl>
	
	<h4>［ロギング］タブ</h4>
	<dl class="bulleted">
		<dt id="config-log">イベントログにサービスステータスメッセージを送信
		</dt>
		<dd>この構成でステータスメッセージをWindowsイベントログに記録するには、選択済みに構成します。</dd>

		<dt id="log-verbose">詳細メッセージをログに記録</dt>
		<dd>これを選択済みにすると、ステータスメッセージに加えて、すべての「マーシャリング」および「切断」メッセージがWindowsイベントログに記録されます。</dd>
		
		<dt id="log-traffic">トラフィック詳細をログに記録</dt>
		<dd>有効にすると、クライアントからサーバー上のリモートオブジェクトインスタンスへのすべての呼び出しがログに記録されます。このオプションは、診断のためにのみ用意されています。</dd>
	</dl>
	
	<p>［<code>OK</code>］ボタンをクリックすると変更が確定し、［<code>キャンセル</code>］をクリックすると変更が破棄されます。［<code>OK</code>］をクリックすると、構成が恒久的に保存されます。</p>
		
	<h3 id="running">BPサーバーを実行する</h3>
	<p>サーバーは構成プログラムから直接実行できます。これを行うには、［<code>構成</code>］ドロップダウンで目的のサーバー構成の詳細を選択して［<code>開始</code>］ボタンをクリックします。サーバーは、プログラムが閉じるか、［<code>停止</code>］ボタンがクリックされるまで実行されます。</p>
	
	<p>または、Windowsサービスの形で実行することもできます。［<code>サービス</code>］管理ツールを開き、［<code>Blue Prismサーバー</code>］エントリを見つけます。</p>
	
	<p>ここから、サービスを開始または停止できます。サービスは、Windowsが起動するたびに自動的に開始するようにしたり、エラーが発生した場合は再起動するように構成したりできます。デフォルトでは、これは「<code>Default</code>」という名前の構成を使用します。この構成の名前が変更されるか、この構成が削除された場合、サービスは開始されません。</p>
	
	<h3 id="running-userContext">ユーザーコンテキストでBPサーバーを実行する</h3>
	<p>Blue Prismインストールディレクトリ（通常は<code>C:\Program Files\Blue Prism Limited\Blue Prism Automate</code>）に移動し、コマンドラインを開いて次を入力すれば、ユーザーコンテキストで<code>BPServer.exe</code>を実行することを選択できます。</p>
	
	<pre>BPServer.exe /useropts</pre>
	
	<p>また、Windowsサービスの形式での実行を選択する場合は、［<code>サービス</code>］管理ツールを開き、［<code>Blue Prismサーバー</code>］エントリを見つけます。このエントリを右クリックし、［<code>許可</code>］を選択します。ここから、［<code>開始パラメーター</code>］テキストボックスに次を入力して、サービスを通常の方法で起動します。</p>
	
	<pre>useropts=true</pre>
	
	<h3 id="running-multiple">複数のBPサーバーを実行する</h3>
	<p>同じマシン上で複数のBlue Prismサーバーインスタンスを同時に実行して、複数の異なるデータベースに接続したり、異なるクライアントにサービスを提供したりできます。</p>
	
	<p>サーバー構成プログラムから実行している場合は、サーバー構成プログラムを複数回開いて異なる構成を選択し、それぞれを個別に開始できます。</p>
	
	<p>サービスとして実行している場合にこれを有効にするには、複数のサービスを設定する必要があります。</p>

	<p>サービスは、Microsoftの「サービスコントロール」プログラムを使用して構成できます。サービスコントロール（SC）プログラムの詳細については、<a href="http://support.microsoft.com/kb/251192">Microsoftナレッジベース記事Q251192</a>を参照してください。</p>

	<p>構成ダイアログで必要な構成を構成したら、次のコマンドを実行してその構成用のサービスを登録できます。</p>
	
	<pre>sc create <span style="color: #088">{SERVICENAME}</span> binPath= "C:\Program Files\Blue Prism Limited\Blue Prism Automate\BPServerService.exe <span style="color:#088">{CONFIGURATIONNAME}</span>"</pre>
	
	<p><code style="color: #088">{SERVICENAME}</code>は使用するサービスの名前で、<code style="color: #088">{CONFIGURATIONNAME}</code>はそのサービスが使用するサーバー構成の名前です。</p>

	<p>「binPath」と等号の間にスペースがないことに注意してください。また、その後の等号とパスの間のスペースは重要です。</p>
	
	<p>目的のサービス名にスペース文字が含まれている場合は、引用符で囲む必要があります。<i>次に例を示します。</i></p>
	
	<pre>sc create <span style="color:#088">"BP Server II"</span> binPath= <i>...etc...</i></pre>
	
	<p>構成名にはスペースや引用符を含めないでください。サービスコントロールプログラムが正しく参照できなくなります。</p>

	<h3>BPサーバーに接続する</h3>
	<p>Blue Prismサーバーインスタンスと通信できる接続を構成するには、Blue Prismクライアントの［<a href="helpConnections.htm">ログイン</a>］ページから入手できる<a href="frmLogin.htm">［接続］ダイアログ</a>を参照してください。</p>
	
</body>
</html>
