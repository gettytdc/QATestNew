<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" href="AutomateHelp.css" rel="stylesheet" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>环节属性—等待</title>
</head>

<body>
    <div class="header">
        <h1 class="pagetitle">环节类型</h1>
    </div>
	
	<h3>等待环节</h3>

    <p>等待环节可用于暂停业务对象的执行，直至目标应用程序满足某个条件。例如，等到某个窗口出现，或者等到特定状态栏消息显示。您的业务对象可能会等待多个不同结果中的一个结果出现。例如，在提交新数据后，可能会出现一个弹出式窗口、出现一个错误消息窗口或发生一些完全不同的事情。如果没有检测到任何变化，那业务对象可能是被设计成了在某个特定“超时”期限过后再继续运行。为了应对这种不确定性，等待环节允许您根据观察到的结果，让业务对象沿着相应的工作流程分支继续运行。在这种情况下，这个环节与<a href="frmStagePropertiesChoice.htm">选择环节</a>非常相似（选择环节的“否则”选项对于等待环节的“超时”选项）。</p>

	<h3>使用</h3>
	<p>等待环节有两个主要用途：检测交互的就绪情况；检测特定操作的结果。</p>
	<p>等待环节可用于确保目标应用程序已准备就绪。例如，在启动应用程序后，可能需要等待它完成加载。这可通过等待主应用程序窗口出现来实现。又如，可能需要等到状态栏中出现“系统空闲”消息，再提交新的数据。这可通过等待状态栏文本显示为“系统空闲”来实现。</p>
	<p>如上所述，如果进行的是多条件检查，则业务对象可能会根据最新出现的结果沿着不同的工作流程分支继续运行。</p>

    <h3>属性窗体</h3>

    <p>等待属性表单中列有要检查的条件。系统将按照条件在列表中的显示顺序从上至下地检查这些条件。只要满足了某个条件，业务对象就会沿着流程示意图中的对应分支继续运行。每个条件都有一个对应的分支，这些分支在示意图中的显示顺序与相应条件在列表中的显示顺序相同。如果在检查过最后一个条件后都没有满足的条件，则会从第一行重新开始检查。这个循环会一直继续，直至某个条件得到满足，或是已<a href="#Timeout">超时</a>。</p>
	
	<p>例如，第一个条件可能是“检查是否存在‘另存为’对话框”，第二个条件可能是“检查是否存在错误消息窗口”。</p>

    <p>每个条件均由<a href="frmIntegrationAssistant.htm#Elements">应用程序元素</a>、条件、比较类型和预期值组成。应用程序元素是条件所针对的目标（例如，要接受存在性检查的窗口）。条件描述了要针对元素所检查的状态（例如，CheckExists、GetWindowText 等）。比较类型描述了所提供的值与目标应用程序中所找到的数据之间应该满足的比较结果。可能会是检测数据是否等于或不等于该值、是否与某个<a href="helpWildcardsAndRegex.htm">通配符</a>模式匹配，或者看看一个值是否大于另一个字（例如，如果值是数字）。</p>

    <h5 class="bold">添加新的等待条件</h5>

    <p>请先点击“添加”按钮，以添加新的行。然后，从左侧的<a href="frmIntegrationAssistant.htm">应用程序资源管理器</a>中将应用程序元素拖放到相应的字段中。</p>

    <p>根据应用程序元素的性质（尤其是您在创建应用程序元素时是否选择使其成为<a href="frmIntegrationAssistant.htm#dynamic">动态</a>元素），您可能需要通过点击相应的按钮，来为应用程序元素提供参数。这样就能在运行时根据实时数据来识别元素。</p>

    <p>接着，您应该从下拉列表中选择条件。这个列表会根据所选应用程序元素的类型发生动态变化。如果某个条件未出现在这个列表中，则意味着无法针对所选应用程序元素检查这个条件。</p>

	<p>您可能会想要选择某个自定义比较类型；例如，执行<a href="helpWildcardsAndRegex.htm">通配符</a>模式比较。但是，在大多数情况下，您可能都是想要使用默认比较类型，即进行相等性测试。</p>
	
    <p>最后一个字段可用于输入预期值。例如，对于 CheckExists，值将会是“True”或“False”，对于 GetText，值将会是预期的文本。此处输入的值必须完全匹配，才算满足条件。</p>
	
	
	<h5 class="bold">指定超时期限<a name="Timeout" id="Timeout"></a></h5>
   	<p>等待环节属性表单的最底部有一个超时字段。此处可以填充一个简单的数字值，以表示等待环节在检查某个条件是否已满足时将会持续的最长时长（以秒为单位）。或者，也可以使用表达式来填充超时值。这非常有用，比如在以下情况下：您想将某个全局超时值存储在数据项中，然后在所有等待环节中引用该数据。</p>
	
	<p>如果超时之后都没有满足的条件，业务对象工作流程将会遵循流程示意图上超时环节中的链接。如果不存在此类链接，业务对象将会停止运行并显示错误。</p>
</body>
</html>
