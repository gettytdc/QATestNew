<process name="Screenshot Automation" version="1.0" bpversion="6.9.0.24001" narrative="Process to test screenshot functionality.&#xD;&#xA;Default setting (currently off) is set, updates, runs a process then checks screenshot is available. Turns setting off and checks screenshot can no longer be viewed " byrefcollection="true" preferredid="e95f5c2b-a45b-4064-a1ce-f119afdbfe4c">
  <view>
    <camerax>15</camerax>
    <cameray>-619</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="8c8e7cbb-3b24-47df-a702-502a2720b8b7" type="Normal" published="False">
    <name>Screenshot Default Option Test</name>
    <view>
      <camerax>0</camerax>
      <cameray>-75</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="4718c0c2-8208-467b-a789-ad82c7fec429" type="Normal" published="False">
    <name>Screen Capture Test</name>
    <view>
      <camerax>4</camerax>
      <cameray>233</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="702f2b88-63e9-4ff0-adb5-04804d5acad9" type="Normal" published="False">
    <name>Screen Capture Negative</name>
    <view>
      <camerax>0</camerax>
      <cameray>-60</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="5658ff15-31e7-4e7e-b4e2-d02d73dcd225" name="Stage1" type="ProcessInfo">
    <display x="-135" y="-780" w="150" h="120" />
  </stage>
  <stage stageid="75eb45d1-1305-4edb-b26a-fc05bc0f8dbc" name="Screen Capture Test" type="SubSheetInfo">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="-150" w="150" h="90" />
  </stage>
  <stage stageid="1acb56e1-d574-4566-9a4e-23c2dc3684f7" name="Start" type="Start">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="-180" />
    <onsuccess>d92454f7-1486-432d-a0cf-df82a66df29c</onsuccess>
  </stage>
  <stage stageid="c514df9b-cd11-4dd0-a8a6-c19e0fce5df5" name="End" type="End">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="570" />
  </stage>
  <stage stageid="b4114c10-216e-4828-87d6-eb3087da75bc" name="Screen Capture Negative" type="SubSheetInfo">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="-135" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="6199e9bf-90b6-4ff3-9470-4eb60ba8fc0e" name="Start" type="Start">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="-330" />
    <onsuccess>9877d8db-9979-482b-b5d3-3145dc03d457</onsuccess>
  </stage>
  <stage stageid="15ab63ac-8bac-41c6-90df-79505c8a240d" name="Set Screen Capture Option" type="Action">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="-150" w="90" h="30" />
    <inputs>
      <input type="flag" name="Set &quot;Start local Resource&quot;" expr="" />
      <input type="flag" name="Start Local Resource Value" expr="" />
      <input type="flag" name="Set 'Process / Object Auto Backup'" expr="" />
      <input type="flag" name="Process / Object Auto Backup Flag" expr="" />
      <input type="text" name="Process / Object Auto Backup Value" expr="" />
      <input type="flag" name="Set 'Forced Changes Summary'" expr="" />
      <input type="flag" name="Force Changes Summary Flag" expr="" />
      <input type="flag" name="Set 'Allow Pasted Passwords'" expr="" />
      <input type="flag" name="Allow Pasted Passwords Flag" expr="" />
      <input type="flag" name="Set 'Require Secure Inbound Connections'" expr="" />
      <input type="flag" name="Require Secure Inbound Connections Flag" expr="" />
      <input type="flag" name="Set 'Allow Anonymous Resources'" expr="" />
      <input type="flag" name="Allow Anonymous Resources Flag" expr="" />
      <input type="flag" name="Set 'Prevent Registration of New Resources'" expr="" />
      <input type="flag" name="Prevent Registration of New Resources Flag" expr="" />
      <input type="flag" name="Set 'Resource Registation &amp; Addressing'" expr="" />
      <input type="text" name="Resource and Registation &amp; Addressing Value" expr="" />
      <input type="flag" name="Set 'Enable Unicode for Session Logs'" expr="" />
      <input type="flag" name="Enable Unicode for Session Logs Flag" expr="" />
      <input type="flag" name="Set 'Allow latest Runtime Resource screen capture' " expr="True" />
      <input type="flag" name="Allow latest Runtime Resource screen capture Flag" expr="False" />
    </inputs>
    <outputs>
      <output type="flag" name="Allow  Runtime Resource" stage="" />
    </outputs>
    <onsuccess>3da561f7-3af5-4ed9-b40e-9d617702bdba</onsuccess>
    <resource object="Blue Prism - System - System" action="Set System Settings" />
  </stage>
  <stage stageid="4ef227d3-999a-4b44-9d75-1ae0967f9d16" name="End" type="End">
    <display x="15" y="225" />
  </stage>
  <stage stageid="1d77f043-3dae-4c1d-ad0a-e9425f074b0d" name="Start" type="Start">
    <display x="15" y="-825" />
    <onsuccess>5790813d-aaed-4dd3-9a4e-fab24b35e321</onsuccess>
  </stage>
  <stage stageid="fb908193-8b75-4c26-a592-0b4beae4bcfc" name="Sign In" type="Action">
    <display x="15" y="-495" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" expr="" />
      <input type="password" name="Password" expr="" />
      <input type="password" name="New Password" narrative="If this is your first login it will prompt you to change the password." expr="" />
    </inputs>
    <onsuccess>cfcd7697-98ce-482a-b3e1-797f73f8c6b8</onsuccess>
    <resource object="Blue Prism" action="Sign In" />
  </stage>
  <stage stageid="e20a1c6e-51e1-42be-9db9-b753e3919957" name="Process Name" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="45" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Screenshot</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1a0d2055-7d79-4ea7-91d2-3a73c3cbf301" name="Machine Name" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="-15" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">BPWIN7</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f85f0199-6e35-43fb-8244-7669366ad3f3" name="Check Resource Screen Capture" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="390" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Name" expr="[Resource]" />
      <input type="flag" name="Test Screenshot" expr="[Test Screen Capture]" />
      <input type="text" name="Resource Group to Expand" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Screen Cap Opt" stage="Screen Cap Opt" />
      <output type="image" name="ScreenShot Image" stage="ScreenShot Image" />
    </outputs>
    <onsuccess>0ef05684-0153-4fe8-8544-49e47cc97dfe</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Control Room - Get Resource Screen Capture" />
  </stage>
  <stage stageid="cf3b9de7-f65b-4736-a68f-0503ad4d67bc" name="Resource" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="15" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5360af5c-909c-4e68-9303-f02b650a3a31" name="Screenshot Default Option Test" type="SubSheetInfo">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="-120" y="-210" w="150" h="90" />
  </stage>
  <stage stageid="e410e913-95fa-4a1c-8aff-c4fec60f80a0" name="Start" type="Start">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="15" y="-240" />
    <onsuccess>7ccb2f7b-ef4a-4cdf-b1d3-e48ce19c0740</onsuccess>
  </stage>
  <stage stageid="f219dc5a-1a6c-4d87-82b0-bbfa2f0aed6a" name="Close Blue Prism" type="Action">
    <display x="15" y="30" w="90" h="30" />
    <onsuccess>6e3163f8-f5ae-47aa-abe4-5d3d98134705</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="b13b55be-a1a4-4ebf-b3a4-a6d09f8e0bd6" name="Screenshot Default Option Test" type="SubSheet">
    <display x="15" y="-120" w="90" h="30" />
    <onsuccess>38974a02-5bc0-42b7-b178-4f7a32f7591f</onsuccess>
    <processid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</processid>
  </stage>
  <stage stageid="38974a02-5bc0-42b7-b178-4f7a32f7591f" name="Screen Capture Test" type="SubSheet">
    <display x="15" y="-75" w="90" h="30" />
    <onsuccess>c9359532-61cf-4612-83b3-b257e68ed200</onsuccess>
    <processid>4718c0c2-8208-467b-a789-ad82c7fec429</processid>
  </stage>
  <stage stageid="c9359532-61cf-4612-83b3-b257e68ed200" name="Screen Capture Negative" type="SubSheet">
    <display x="15" y="-30" w="90" h="30" />
    <onsuccess>f219dc5a-1a6c-4d87-82b0-bbfa2f0aed6a</onsuccess>
    <processid>702f2b88-63e9-4ff0-adb5-04804d5acad9</processid>
  </stage>
  <stage stageid="3b7ff2f0-de57-4d1d-9951-e8621492718f" name="End" type="End">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="15" y="-15" />
  </stage>
  <stage stageid="c9e122c5-3778-44cc-baa9-8afa5f07ae6d" name="Check System Setting" type="Action">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="15" y="-150" w="90" h="30" />
    <inputs>
      <input type="flag" name="Set &quot;Start local Resource&quot;" expr="" />
      <input type="flag" name="Start Local Resource Value" expr="" />
      <input type="flag" name="Set 'Process / Object Auto Backup'" expr="" />
      <input type="flag" name="Process / Object Auto Backup Flag" expr="" />
      <input type="text" name="Process / Object Auto Backup Value" expr="" />
      <input type="flag" name="Set 'Forced Changes Summary'" expr="" />
      <input type="flag" name="Force Changes Summary Flag" expr="" />
      <input type="flag" name="Set 'Allow Pasted Passwords'" expr="" />
      <input type="flag" name="Allow Pasted Passwords Flag" expr="" />
      <input type="flag" name="Set 'Require Secure Inbound Connections'" expr="" />
      <input type="flag" name="Require Secure Inbound Connections Flag" expr="" />
      <input type="flag" name="Set 'Allow Anonymous Resources'" expr="" />
      <input type="flag" name="Allow Anonymous Resources Flag" expr="" />
      <input type="flag" name="Set 'Prevent Registration of New Resources'" expr="" />
      <input type="flag" name="Prevent Registration of New Resources Flag" expr="" />
      <input type="flag" name="Set 'Resource Registation &amp; Addressing'" expr="" />
      <input type="text" name="Resource and Registation &amp; Addressing Value" expr="" />
      <input type="flag" name="Set 'Enable Unicode for Session Logs'" expr="" />
      <input type="flag" name="Enable Unicode for Session Logs Flag" expr="" />
      <input type="flag" name="Set 'Allow latest Runtime Resource screen capture' " expr="" />
      <input type="flag" name="Allow latest Runtime Resource screen capture Flag" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Allow  Runtime Resource" stage="Allow  Runtime Resource" />
    </outputs>
    <onsuccess>7d81a9ee-a614-4af5-935e-2bf4c2141caf</onsuccess>
    <resource object="Blue Prism - System - System" action="Set System Settings" />
  </stage>
  <stage stageid="7c50bc73-1911-4789-9b6d-24f73795c80d" name="FAIL" type="Exception">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="90" y="-105" w="30" h="30" />
    <exception type="Bug" detail="&quot;Default should be False&quot;" />
  </stage>
  <stage stageid="7d81a9ee-a614-4af5-935e-2bf4c2141caf" name="Is Default correct?" type="Decision">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="15" y="-105" w="90" h="30" />
    <decision expression="[Allow  Runtime Resource] = False" />
    <ontrue>462705b3-b94a-446d-a7f0-eebe20a80ed8</ontrue>
    <onfalse>7c50bc73-1911-4789-9b6d-24f73795c80d</onfalse>
  </stage>
  <stage stageid="462705b3-b94a-446d-a7f0-eebe20a80ed8" name="Set Screen Capture Option" type="Action">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="flag" name="Set &quot;Start local Resource&quot;" expr="" />
      <input type="flag" name="Start Local Resource Value" expr="" />
      <input type="flag" name="Set 'Process / Object Auto Backup'" expr="" />
      <input type="flag" name="Process / Object Auto Backup Flag" expr="" />
      <input type="text" name="Process / Object Auto Backup Value" expr="" />
      <input type="flag" name="Set 'Forced Changes Summary'" expr="" />
      <input type="flag" name="Force Changes Summary Flag" expr="" />
      <input type="flag" name="Set 'Allow Pasted Passwords'" expr="" />
      <input type="flag" name="Allow Pasted Passwords Flag" expr="" />
      <input type="flag" name="Set 'Require Secure Inbound Connections'" expr="" />
      <input type="flag" name="Require Secure Inbound Connections Flag" expr="" />
      <input type="flag" name="Set 'Allow Anonymous Resources'" expr="" />
      <input type="flag" name="Allow Anonymous Resources Flag" expr="" />
      <input type="flag" name="Set 'Prevent Registration of New Resources'" expr="" />
      <input type="flag" name="Prevent Registration of New Resources Flag" expr="" />
      <input type="flag" name="Set 'Resource Registation &amp; Addressing'" expr="" />
      <input type="text" name="Resource and Registation &amp; Addressing Value" expr="" />
      <input type="flag" name="Set 'Enable Unicode for Session Logs'" expr="" />
      <input type="flag" name="Enable Unicode for Session Logs Flag" expr="" />
      <input type="flag" name="Set 'Allow latest Runtime Resource screen capture' " expr="True" />
      <input type="flag" name="Allow latest Runtime Resource screen capture Flag" expr="True" />
    </inputs>
    <outputs>
      <output type="flag" name="Allow  Runtime Resource" stage="" />
    </outputs>
    <onsuccess>3b7ff2f0-de57-4d1d-9951-e8621492718f</onsuccess>
    <resource object="Blue Prism - System - System" action="Set System Settings" />
  </stage>
  <stage stageid="546cbca7-e8d8-4ccf-9904-98efe1b20a83" name="Allow  Runtime Resource" type="Data">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="120" y="-150" w="90" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8fc966f8-404b-460b-9caa-7bc4705bd867" name="Test Screen Capture" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="105" w="150" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f289c144-b6bb-40e8-b321-8f4973ef2dda" name="ScreenShot Image" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="135" w="150" h="30" />
    <datatype>image</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3812f0ba-a264-4b89-be52-5f0f94334ea0" name="Screen Cap Opt" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="165" w="150" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="654fa04c-3c23-48a6-9d95-064cfa21ce75" name="Screenshot" type="Exception">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="105" y="435" />
    <exception type="Screenshot" detail="&quot;Resource screenshot not available where expected&quot;" />
  </stage>
  <stage stageid="7440d343-99a0-4bba-adcf-35b4a5d6ce87" name="Check Region" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="480" w="90" h="30" />
    <inputs>
      <input type="image" name="Image" narrative="The image to check" expr="[ScreenShot Image]" />
    </inputs>
    <outputs>
      <output type="flag" name="White" narrative="True if the image is white" stage="Region Blank?" />
    </outputs>
    <onsuccess>48728761-a358-4acd-8303-cbf81f2da348</onsuccess>
    <resource object="Utility - Image Manipulation" action="Image is White" />
  </stage>
  <stage stageid="b7eb3ed0-3f8e-4604-8e7a-1df8acf381f7" name="Region Blank?" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="195" w="150" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="48728761-a358-4acd-8303-cbf81f2da348" name="Screenshot blank" type="Decision">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="525" w="90" h="30" />
    <decision expression="[Region Blank?] = True" />
    <ontrue>f55ecaf2-b1e1-4711-86d1-47b101071b46</ontrue>
    <onfalse>bc117b18-b6e9-4b49-8013-b427ea7aed93</onfalse>
  </stage>
  <stage stageid="f55ecaf2-b1e1-4711-86d1-47b101071b46" name="Screenshot" type="Exception">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="105" y="525" />
    <exception type="Screenshot" detail="&quot;Screenshot is blank&quot;" />
  </stage>
  <stage stageid="0ef05684-0153-4fe8-8544-49e47cc97dfe" name="screenshot available" type="Decision">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="435" w="90" h="30" />
    <decision expression="[Screen Cap Opt] = True" />
    <ontrue>7440d343-99a0-4bba-adcf-35b4a5d6ce87</ontrue>
    <onfalse>654fa04c-3c23-48a6-9d95-064cfa21ce75</onfalse>
  </stage>
  <stage stageid="b8f1790d-9d8b-4733-84f4-f8246f92f40a" name="Check resource screen capture" type="Action">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="45" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Name" expr="[Resource]" />
      <input type="flag" name="Test Screenshot" expr="False" />
      <input type="text" name="Resource Group to Expand" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Screen Cap Opt" stage="" />
      <output type="image" name="ScreenShot Image" stage="" />
    </outputs>
    <onsuccess>ae940be4-8b25-48f9-8434-70ba5fe69e7d</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Control Room - Get Resource Screen Capture" />
  </stage>
  <stage stageid="10a7388c-8e6e-4f5b-a55c-1cfac529b958" name="Port Number" type="Data">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="-135" y="0" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue>8011</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3da561f7-3af5-4ed9-b40e-9d617702bdba" name="Set Resource Name" type="MultipleCalculation">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="-105" w="90" h="30" />
    <onsuccess>3144366d-5266-45f1-b1fe-695797f4a699</onsuccess>
    <steps>
      <calculation expression="GetResourceName()" stage="Machine Name" />
      <calculation expression="Left([Machine Name], Len([Machine Name]) - Len(&quot;_debug&quot;))" stage="Machine Name" />
      <calculation expression="[Machine Name] &amp; &quot;:&quot; &amp; [Port Number]" stage="Resource" />
    </steps>
  </stage>
  <stage stageid="5142dac5-7ae7-4000-b0d7-5a2e1940b819" name="Machine Name" type="Data">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="-135" y="30" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9a831220-8a7a-4093-a811-c43c9be83378" name="Resource" type="Data">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="-135" y="60" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="77483548-fb90-4c43-a39f-94290150dc74" name="Expected Failure" type="Block">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="-45" y="15" w="120" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="43ba0f3e-d2fd-44db-aaae-5a20b2796359" name="Recover1" type="Recover">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="90" />
    <onsuccess>a068d368-adb3-43b8-95fd-4a3b2ebe0be0</onsuccess>
  </stage>
  <stage stageid="a068d368-adb3-43b8-95fd-4a3b2ebe0be0" name="Resume1" type="Resume">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="150" />
    <onsuccess>15cacc98-1dd3-493a-8324-26ab7ef20a67</onsuccess>
  </stage>
  <stage stageid="15cacc98-1dd3-493a-8324-26ab7ef20a67" name="End1" type="End">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="ae940be4-8b25-48f9-8434-70ba5fe69e7d" name="Screenshot Negative" type="Exception">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="120" y="45" />
    <exception type="Screenshot" detail="&quot;Screenshot found where NOT expected&quot;" />
  </stage>
  <stage stageid="b87d5b02-fb87-4b22-902b-99a501702258" name="Position of Pending Session" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="225" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b3532cb3-3c89-4da2-af5b-b70ab787c322" name="Publish Process (2)" type="Action">
    <display x="15" y="-720" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" narrative="The name of the process to publish" expr="&quot;Screenshot (Preserved)&quot;" />
    </inputs>
    <onsuccess>ab5e64be-2238-4db6-a4eb-86150c16b7e2</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Publish Process" />
  </stage>
  <stage stageid="6e3163f8-f5ae-47aa-abe4-5d3d98134705" name="UnPublish Process" type="Action">
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" narrative="The name of the process to publish" expr="&quot;Screenshot&quot;" />
    </inputs>
    <onsuccess>b20bedd2-5ef1-419f-b3a1-4d8e966b0bd7</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Unpublish Process" />
  </stage>
  <stage stageid="788f543d-ca3e-47a2-a06f-824ce3aef043" name="Scheme Name" type="Data">
    <display x="-135" y="-630" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Screenshot Scheme</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b2565e76-a310-4dd2-8106-a7d8d14bd2f6" name="Clean Up" type="Block">
    <display x="-45" y="0" w="120" h="195" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ac596738-d242-4b5b-bee4-95c4a8c86060" name="Setup" type="Block">
    <display x="-45" y="-795" w="120" h="645" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="63f9d69f-a9b1-4193-b7a8-e81a97f94fd8" name="Start Resource" type="Action">
    <display x="15" y="-405" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number on which the resource PC should listen" expr="[Port Number]" />
      <input type="flag" name="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="" />
      <input type="text" name="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="" />
      <input type="password" name="Password" narrative="The password to use for the resource. Only used if Username is given" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" narrative="The PID of the newly created process" stage="" />
    </outputs>
    <onsuccess>7ced289d-71f6-4a63-afd0-2e983529bda1</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="cfc04195-2f4c-47b4-9386-8bb380446c5b" name="Port Number" type="Data">
    <display x="-135" y="-690" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>8011</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b20bedd2-5ef1-419f-b3a1-4d8e966b0bd7" name="Stop Resource" type="Action">
    <display x="15" y="120" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number whose resource should be stopped" expr="[Port Number]" />
    </inputs>
    <onsuccess>f7166bc5-7ad7-42d0-acd1-2f28e6cf950b</onsuccess>
    <resource object="Resource Manager" action="Stop Resource" />
  </stage>
  <stage stageid="d92454f7-1486-432d-a0cf-df82a66df29c" name="Get Machine Name" type="Calculation">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="-135" w="90" h="30" />
    <onsuccess>a4d0bfd4-18f2-41a0-90ff-43a48d36f6c8</onsuccess>
    <calculation expression="GetResourceName()" stage="Machine Name" />
  </stage>
  <stage stageid="88451d2c-b1c3-4dba-ac9a-b7bc6aca6b2e" name="Strip _debug" type="Calculation">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="120" y="-90" w="90" h="30" />
    <onsuccess>926cd99f-db3f-4c03-b893-32f6b26c3f4a</onsuccess>
    <calculation expression="Left([Machine Name], Len([Machine Name]) - Len(&quot;_debug&quot;))&#xA;" stage="Machine Name" />
  </stage>
  <stage stageid="ad02d97e-fa5c-4354-9a43-349093be952a" name="Add Port" type="Calculation">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="-45" w="90" h="30" />
    <onsuccess>7f74950a-404b-4296-a304-82d404bf158c</onsuccess>
    <calculation expression="[Machine Name] &amp; &quot;:&quot; &amp; [Port Number]&#xA;" stage="Resource" />
  </stage>
  <stage stageid="a4d0bfd4-18f2-41a0-90ff-43a48d36f6c8" name="_debug?" type="Decision">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <narrative>[Machine Name]="BPWIN7_debug"</narrative>
    <display x="15" y="-90" w="90" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
    <decision expression="InStr(Upper(Trim([Machine Name])), Upper(&quot;_debug&quot;)) &gt; 0" />
    <ontrue>88451d2c-b1c3-4dba-ac9a-b7bc6aca6b2e</ontrue>
    <onfalse>ad02d97e-fa5c-4354-9a43-349093be952a</onfalse>
  </stage>
  <stage stageid="926cd99f-db3f-4c03-b893-32f6b26c3f4a" name="Anchor1" type="Anchor">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="120" y="-45" w="10" h="10" />
    <onsuccess>ad02d97e-fa5c-4354-9a43-349093be952a</onsuccess>
  </stage>
  <stage stageid="f1bf13cc-9dbf-4b78-9c4f-d627d0e14b27" name="Note1" type="Note">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <narrative>The machine name was hardcoded as "BPWIN7_debug" and as a result, the result of this decision stage will always be 'No' when process is running on machines other than BPWIN7_debug.

Changed the expression from:
[Machine Name]="BPWIN7_debug"
to
InStr(Upper(Trim([Machine Name])), Upper("_debug")) &gt; 0

To look for the term _debug within the Machine Name.</narrative>
    <display x="150" y="-240" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
    <onsuccess>a4d0bfd4-18f2-41a0-90ff-43a48d36f6c8</onsuccess>
  </stage>
  <stage stageid="9ffc9e90-86a9-472e-8294-5baa27245a6a" name="Create Session" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="165" w="90" h="30" />
    <inputs>
      <input type="text" name="Process Name" narrative="The name of the process of interest - if it is not found, the 'Ungrouped Processes' group will be opened and checked" expr="[Process Name]" />
      <input type="text" name="Resource Name" narrative="The name of the Resource PC on which to create the session" expr="[Resource]" />
      <input type="text" name="Group to Expand" narrative="Default value is 'Default'." expr="" />
      <input type="flag" name="Negative Test" narrative="Check for negative testing " expr="" />
      <input type="text" name="Resource Group to Expand" narrative="Default value is 'Default'" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Position of Pending Session" narrative="The 1-based index of the newly created session in the Environment list in Control Room" stage="Position of Pending Session" />
      <output type="text" name="Error Message (expected)" narrative="Error message returned (negative testing)" stage="" />
    </outputs>
    <onsuccess>ed08d148-feb3-414b-89bb-daa452717098</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Create Session" />
  </stage>
  <stage stageid="7f74950a-404b-4296-a304-82d404bf158c" name="Open Control Tab" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>e664e9d3-1663-494f-bd4a-8e5c443a8043</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="ed08d148-feb3-414b-89bb-daa452717098" name="Select Session" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="210" w="90" h="30" />
    <inputs>
      <input type="number" name="Session Position" narrative="The 1-based index of the session of interest, in the Environment list" expr="[Position of Pending Session]" />
      <input type="text" name="Process Name" narrative="The expected process name of the session of interest. This will be double checked before starting the session at the specified position." expr="[Process Name]" />
      <input type="text" name="Resource Name" narrative="The expected resource name of the pending session of interset. This will be double checked before starting the session" expr="[Resource]" />
      <input type="text" name="Session Status" narrative="The expected status of the session. This will be double checked." expr="&quot;Pending&quot;" />
    </inputs>
    <onsuccess>a26b21d1-041a-4b76-afaa-b499e3a201a7</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Select Session" />
  </stage>
  <stage stageid="a26b21d1-041a-4b76-afaa-b499e3a201a7" name="Start Session" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="255" w="90" h="30" />
    <inputs>
      <input type="flag" name="Set Parameter Flag?" expr="" />
      <input type="flag" name="Parameter Flag Value" expr="" />
      <input type="number" name="Flag's Match Index" expr="" />
      <input type="flag" name="Use ClickLink" expr="" />
    </inputs>
    <onsuccess>e006fb03-b290-4906-aa3e-079a68bb5c1b</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Start Session" />
  </stage>
  <stage stageid="3ab6b670-aeaf-46ed-8f88-264beede48e9" name="Open Control Tab" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="345" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>f85f0199-6e35-43fb-8244-7669366ad3f3</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="e006fb03-b290-4906-aa3e-079a68bb5c1b" name="Go Home Tab" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="300" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Home&quot;" />
    </inputs>
    <onsuccess>3ab6b670-aeaf-46ed-8f88-264beede48e9</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="623d9c74-e18c-4142-9767-335a1e938185" name="Open Control Tab" type="Action">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>b8f1790d-9d8b-4733-84f4-f8246f92f40a</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="3144366d-5266-45f1-b1fe-695797f4a699" name="Go Home Tab" type="Action">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Home&quot;" />
    </inputs>
    <onsuccess>623d9c74-e18c-4142-9767-335a1e938185</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="3491b9e9-1396-4086-b59d-5c5ed33fb9b3" name="Create Encrypt Scheme" type="Action">
    <display x="15" y="-225" w="90" h="30" />
    <inputs>
      <input type="text" name="Scheme Name" narrative="The name in which you want to call your encrpytion scheme." expr="[Scheme Name]" />
      <input type="flag" name="Available?" narrative="This will tick a box that allows the encryption scheme to become available." expr="True" />
      <input type="flag" name="Database?" narrative="Mark as true if you want to store the scheme on the database. Please note that this will default to true." expr="True" />
      <input type="text" name="Method" narrative="The encryption method used with the scheme." expr="&quot;AES-256 AesCryptoService (256 bit)&quot;" />
    </inputs>
    <onsuccess>f6236cda-d610-41f5-a03e-3d5a1992be91</onsuccess>
    <resource object="Blue Prism - System - Security" action="Encryption Schemes - Create Encryption Scheme" />
  </stage>
  <stage stageid="cf770a93-e729-4515-8f12-5294ce39ebad" name="Click Encryption Schemes" type="Action">
    <display x="15" y="-270" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Security&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Encryption Schemes&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="True" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="False" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="False" />
    </inputs>
    <onsuccess>3491b9e9-1396-4086-b59d-5c5ed33fb9b3</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="a54ed2ff-a593-414a-8ffe-17f3709cf061" name="Go to System" type="Action">
    <display x="15" y="-315" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>cf770a93-e729-4515-8f12-5294ce39ebad</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="f6236cda-d610-41f5-a03e-3d5a1992be91" name="Select Encrypt Scheme" type="Action">
    <display x="15" y="-180" w="90" h="30" />
    <inputs>
      <input type="text" name="Scheme Name" narrative="The name of the scheme you wish to select." expr="[Scheme Name]" />
    </inputs>
    <onsuccess>b13b55be-a1a4-4ebf-b3a4-a6d09f8e0bd6</onsuccess>
    <resource object="Blue Prism - System - Security" action="Encryption Schemes - Select Encryption Scheme for Credentials" />
  </stage>
  <stage stageid="ab5e64be-2238-4db6-a4eb-86150c16b7e2" name="Launch Blue Prism" type="Action">
    <display x="15" y="-675" w="90" h="30" />
    <outputs>
      <output type="number" name="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>fa1ab768-ee42-425b-b3bb-3878c7887063</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="fa1ab768-ee42-425b-b3bb-3878c7887063" name="Attach Control" type="Action">
    <display x="15" y="-630" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>e460d6d0-8f5e-49a2-9e49-5473cc471342</onsuccess>
    <resource object="Blue Prism - Control Room (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="e460d6d0-8f5e-49a2-9e49-5473cc471342" name="Attach Studio" type="Action">
    <display x="15" y="-585" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>5b8d3adc-9535-4da5-a4ba-0de9f137aa35</onsuccess>
    <resource object="Blue Prism - Studio (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="5b8d3adc-9535-4da5-a4ba-0de9f137aa35" name="Attach System" type="Action">
    <display x="15" y="-540" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>fb908193-8b75-4c26-a592-0b4beae4bcfc</onsuccess>
    <resource object="Blue Prism - System (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="daa115fe-fa38-4bd4-ae55-3426ae2db4a1" name="pid" type="Data">
    <display x="-135" y="-600" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9877d8db-9979-482b-b5d3-3145dc03d457" name="Go Home Tab" type="Action">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="-285" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Home&quot;" />
    </inputs>
    <onsuccess>a7c8c84d-1851-4ff2-96ed-61ad55e30c54</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="a7c8c84d-1851-4ff2-96ed-61ad55e30c54" name="Go System Tab" type="Action">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="-240" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>92e425f4-b439-4ab5-b902-89a1bc414ea9</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="92e425f4-b439-4ab5-b902-89a1bc414ea9" name="Go To Settings" type="Action">
    <subsheetid>702f2b88-63e9-4ff0-adb5-04804d5acad9</subsheetid>
    <display x="15" y="-195" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;System&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Settings&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="True" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="False" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="False" />
    </inputs>
    <onsuccess>15ab63ac-8bac-41c6-90df-79505c8a240d</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="7ccb2f7b-ef4a-4cdf-b1d3-e48ce19c0740" name="Go To Settings" type="Action">
    <subsheetid>8c8e7cbb-3b24-47df-a702-502a2720b8b7</subsheetid>
    <display x="15" y="-195" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;System&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Settings&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="True" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="False" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="False" />
    </inputs>
    <onsuccess>c9e122c5-3778-44cc-baa9-8afa5f07ae6d</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="d95a57fc-45f3-453b-94e2-1cb7b5d6f4d9" name="Check Resource Screen Capture" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="390" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Name" expr="[Resource]" />
      <input type="flag" name="Test Screenshot" expr="[Test Screen Capture]" />
      <input type="text" name="Resource Group to Expand" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Screen Cap Opt" stage="Screen Cap Opt" />
      <output type="image" name="ScreenShot Image" stage="ScreenShot Image" />
    </outputs>
    <onsuccess>268ba2bd-f6e8-4bd9-971f-d515f3762d2e</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Control Room - Get Resource Screen Capture" />
  </stage>
  <stage stageid="f4042bef-e317-4518-b24d-0f65308c30e9" name="Screenshot" type="Exception">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="300" y="435" />
    <exception type="Screenshot" detail="&quot;Resource screenshot not available where expected&quot;" />
  </stage>
  <stage stageid="01a9741e-3f1c-4db2-aa9e-b4b98c9c26c4" name="Check Region" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="480" w="90" h="30" />
    <inputs>
      <input type="image" name="Image" narrative="The image to check" expr="[ScreenShot Image]" />
    </inputs>
    <outputs>
      <output type="flag" name="White" narrative="True if the image is white" stage="Region Blank?" />
    </outputs>
    <onsuccess>eb49c799-5b5f-42c1-b7b3-8ec08e348e5a</onsuccess>
    <resource object="Utility - Image Manipulation" action="Image is White" />
  </stage>
  <stage stageid="eb49c799-5b5f-42c1-b7b3-8ec08e348e5a" name="Screenshot blank" type="Decision">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="525" w="90" h="30" />
    <decision expression="[Region Blank?] = True" />
    <ontrue>0088a4c3-3325-4ec7-a70d-9322c5e661d1</ontrue>
    <onfalse>c514df9b-cd11-4dd0-a8a6-c19e0fce5df5</onfalse>
  </stage>
  <stage stageid="0088a4c3-3325-4ec7-a70d-9322c5e661d1" name="Screenshot" type="Exception">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="300" y="525" />
    <exception type="Screenshot" detail="&quot;Screenshot is blank&quot;" />
  </stage>
  <stage stageid="268ba2bd-f6e8-4bd9-971f-d515f3762d2e" name="screenshot available" type="Decision">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="435" w="90" h="30" />
    <decision expression="[Screen Cap Opt] = True" />
    <ontrue>01a9741e-3f1c-4db2-aa9e-b4b98c9c26c4</ontrue>
    <onfalse>f4042bef-e317-4518-b24d-0f65308c30e9</onfalse>
  </stage>
  <stage stageid="bbbb2380-44f3-41f9-af5c-fba86ed96973" name="Create Session" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="165" w="90" h="30" />
    <inputs>
      <input type="text" name="Process Name" narrative="The name of the process of interest - if it is not found, the 'Ungrouped Processes' group will be opened and checked" expr="[Process Name (2)]" />
      <input type="text" name="Resource Name" narrative="The name of the Resource PC on which to create the session" expr="[Resource]" />
      <input type="text" name="Group to Expand" narrative="Default value is 'Default'." expr="" />
      <input type="flag" name="Negative Test" narrative="Check for negative testing " expr="" />
      <input type="text" name="Resource Group to Expand" narrative="Default value is 'Default'" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Position of Pending Session" narrative="The 1-based index of the newly created session in the Environment list in Control Room" stage="Position of Pending Session" />
      <output type="text" name="Error Message (expected)" narrative="Error message returned (negative testing)" stage="" />
    </outputs>
    <onsuccess>4d9b0117-b1f9-4a88-a72e-fc96d5abdb52</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Create Session" />
  </stage>
  <stage stageid="4d9b0117-b1f9-4a88-a72e-fc96d5abdb52" name="Select Session" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="210" w="90" h="30" />
    <inputs>
      <input type="number" name="Session Position" narrative="The 1-based index of the session of interest, in the Environment list" expr="[Position of Pending Session]" />
      <input type="text" name="Process Name" narrative="The expected process name of the session of interest. This will be double checked before starting the session at the specified position." expr="[Process Name (2)]" />
      <input type="text" name="Resource Name" narrative="The expected resource name of the pending session of interset. This will be double checked before starting the session" expr="[Resource]" />
      <input type="text" name="Session Status" narrative="The expected status of the session. This will be double checked." expr="&quot;Pending&quot;" />
    </inputs>
    <onsuccess>400a37e7-b613-4010-a8f9-8e4bb3bd42cc</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Select Session" />
  </stage>
  <stage stageid="400a37e7-b613-4010-a8f9-8e4bb3bd42cc" name="Start Session" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="255" w="90" h="30" />
    <inputs>
      <input type="flag" name="Set Parameter Flag?" expr="" />
      <input type="flag" name="Parameter Flag Value" expr="" />
      <input type="number" name="Flag's Match Index" expr="" />
      <input type="flag" name="Use ClickLink" expr="" />
    </inputs>
    <onsuccess>16556c1c-2687-47b6-813b-c59a8fb51575</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Start Session" />
  </stage>
  <stage stageid="8b5595a7-4965-4afa-b52e-f25792918789" name="Open Control Tab" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="345" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>d95a57fc-45f3-453b-94e2-1cb7b5d6f4d9</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="16556c1c-2687-47b6-813b-c59a8fb51575" name="Go Home Tab" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="300" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Home&quot;" />
    </inputs>
    <onsuccess>8b5595a7-4965-4afa-b52e-f25792918789</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="bc117b18-b6e9-4b49-8013-b427ea7aed93" name="Anchor2" type="Anchor">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="555" w="10" h="10" />
    <onsuccess>0cb6db2d-28da-4489-a22d-1d6a021d3778</onsuccess>
  </stage>
  <stage stageid="0cb6db2d-28da-4489-a22d-1d6a021d3778" name="Anchor3" type="Anchor">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="150" y="555" w="10" h="10" />
    <onsuccess>6ae95e41-a228-4ac0-bc25-e23fd0f230a1</onsuccess>
  </stage>
  <stage stageid="6ae95e41-a228-4ac0-bc25-e23fd0f230a1" name="Anchor4" type="Anchor">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="150" y="0" w="10" h="10" />
    <onsuccess>25fe01e7-3284-4179-9caa-e9082889558d</onsuccess>
  </stage>
  <stage stageid="42d1aab8-775c-415c-ab57-1a297d008e22" name="Process Name (2)" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="75" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Screenshot (Preserved)</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5790813d-aaed-4dd3-9a4e-fab24b35e321" name="Publish Process" type="Action">
    <display x="15" y="-765" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" narrative="The name of the process to publish" expr="&quot;Screenshot&quot;" />
    </inputs>
    <onsuccess>b3532cb3-3c89-4da2-af5b-b70ab787c322</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Publish Process" />
  </stage>
  <stage stageid="7ced289d-71f6-4a63-afd0-2e983529bda1" name="Start Resource" type="Action">
    <display x="15" y="-360" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number on which the resource PC should listen" expr="[Port Number (2)]" />
      <input type="flag" name="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="" />
      <input type="text" name="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="" />
      <input type="password" name="Password" narrative="The password to use for the resource. Only used if Username is given" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" narrative="The PID of the newly created process" stage="" />
    </outputs>
    <onsuccess>a54ed2ff-a593-414a-8ffe-17f3709cf061</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="efbb6649-923a-439f-a6ef-8a925a0a1a52" name="Port Number (2)" type="Data">
    <display x="-135" y="-660" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>8012</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f7166bc5-7ad7-42d0-acd1-2f28e6cf950b" name="Stop Resource (2)" type="Action">
    <display x="15" y="165" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number whose resource should be stopped" expr="[Port Number (2)]" />
    </inputs>
    <onsuccess>4ef227d3-999a-4b44-9d75-1ae0967f9d16</onsuccess>
    <resource object="Resource Manager" action="Stop Resource" />
  </stage>
  <stage stageid="19824373-606a-4aee-a405-2a43bd8b39f1" name="Port Number" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="-75" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue>8011</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f5acbe2c-ad49-4f6c-989a-b50bcf7ec5c7" name="Port Number (2)" type="Data">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="-135" y="-45" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue>8012</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="25fe01e7-3284-4179-9caa-e9082889558d" name="Add Port" type="Calculation">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="0" w="90" h="30" />
    <onsuccess>99363e1f-e6ef-4c0a-846e-53ae5dc78a34</onsuccess>
    <calculation expression="[Machine Name] &amp; &quot;:&quot; &amp; [Port Number (2)]&#xA;" stage="Resource" />
  </stage>
  <stage stageid="e664e9d3-1663-494f-bd4a-8e5c443a8043" name="Sort sessions by ID (once)" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="15" y="45" w="90" h="30" />
    <inputs>
      <input type="text" name="Header" narrative="The name of the header that you want to sort by." expr="&quot;ID&quot;" />
    </inputs>
    <onsuccess>e2e43ef5-8d78-4dcd-a688-d41682aaffef</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Sort Sessions (Dynamic)" />
  </stage>
  <stage stageid="e2e43ef5-8d78-4dcd-a688-d41682aaffef" name="Sort Sessions by ID (second time)" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <narrative>By this time newest sessions should be at the top of the list</narrative>
    <display x="15" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Header" narrative="The name of the header that you want to sort by." expr="&quot;ID&quot;" />
    </inputs>
    <onsuccess>9ffc9e90-86a9-472e-8294-5baa27245a6a</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Sort Sessions (Dynamic)" />
  </stage>
  <stage stageid="99363e1f-e6ef-4c0a-846e-53ae5dc78a34" name="Sort sessions by ID (once)" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <display x="210" y="45" w="90" h="30" />
    <inputs>
      <input type="text" name="Header" narrative="The name of the header that you want to sort by." expr="&quot;ID&quot;" />
    </inputs>
    <onsuccess>76dc0736-8ce5-4796-b26b-dac04c1d1c90</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Sort Sessions (Dynamic)" />
  </stage>
  <stage stageid="76dc0736-8ce5-4796-b26b-dac04c1d1c90" name="Sort Sessions by ID (second time)" type="Action">
    <subsheetid>4718c0c2-8208-467b-a789-ad82c7fec429</subsheetid>
    <narrative>By this time newest sessions should be at the top of the list</narrative>
    <display x="210" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Header" narrative="The name of the header that you want to sort by." expr="&quot;ID&quot;" />
    </inputs>
    <onsuccess>bbbb2380-44f3-41f9-af5c-fba86ed96973</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Sort Sessions (Dynamic)" />
  </stage>
  <stage stageid="1188be3e-566a-4808-a999-61b886b1f0ed" name="Start Resource (SSO)" type="Action">
    <display x="120" y="-405" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number on which the resource PC should listen" expr="[Port Number]" />
      <input type="flag" name="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="True" />
      <input type="text" name="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="" />
      <input type="password" name="Password" narrative="The password to use for the resource. Only used if Username is given" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" narrative="The PID of the newly created process" stage="" />
    </outputs>
    <onsuccess>d231f1a7-6376-4848-8f37-188a3acee1fd</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="d231f1a7-6376-4848-8f37-188a3acee1fd" name="Start Resource (SSO)" type="Action">
    <display x="120" y="-360" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number on which the resource PC should listen" expr="[Port Number (2)]" />
      <input type="flag" name="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="True" />
      <input type="text" name="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="" />
      <input type="password" name="Password" narrative="The password to use for the resource. Only used if Username is given" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" narrative="The PID of the newly created process" stage="" />
    </outputs>
    <onsuccess>f5ce0250-9e7e-43da-9f23-877c0ec08a92</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="cfcd7697-98ce-482a-b3e1-797f73f8c6b8" name="SSO?" type="Decision">
    <display x="15" y="-450" w="90" h="30" />
    <decision expression="SingleSignon()" />
    <ontrue>eaaafb8b-19e2-412a-bd47-24229d8efcc6</ontrue>
    <onfalse>63f9d69f-a9b1-4193-b7a8-e81a97f94fd8</onfalse>
  </stage>
  <stage stageid="eaaafb8b-19e2-412a-bd47-24229d8efcc6" name="Anchor5" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="120" y="-450" w="10" h="10" />
    <onsuccess>1188be3e-566a-4808-a999-61b886b1f0ed</onsuccess>
  </stage>
  <stage stageid="f5ce0250-9e7e-43da-9f23-877c0ec08a92" name="Anchor6" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="120" y="-315" w="10" h="10" />
    <onsuccess>a54ed2ff-a593-414a-8ffe-17f3709cf061</onsuccess>
  </stage>
</process>