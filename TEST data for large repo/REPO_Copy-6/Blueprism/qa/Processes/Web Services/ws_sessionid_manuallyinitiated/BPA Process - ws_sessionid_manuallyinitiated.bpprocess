<process name="ws_sessionid_manuallyinitiated" version="1.0" bpversion="6.11.0.36438" narrative="" byrefcollection="true" preferredid="8b886a8c-ab8c-4f35-8237-48ba6fee0c9d">
  <view>
    <camerax>66</camerax>
    <cameray>570</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="30f5163d-8e7f-462b-ac7b-34a009d394fa" type="Normal" published="False">
    <name>Setup</name>
    <view>
      <camerax>-65</camerax>
      <cameray>765</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="d54b26fe-5763-469e-9992-11aa8c2b3c95" type="Normal" published="False">
    <name>Run Process</name>
    <view>
      <camerax>0</camerax>
      <cameray>495</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ff9e58b9-f417-4226-ad10-2d8113704411" type="Normal" published="False">
    <name>Control Room - Check Session</name>
    <view>
      <camerax>0</camerax>
      <cameray>90</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="50d82475-80a2-4fbb-9d0a-142ea7f810eb" type="Normal" published="False">
    <name>Run Process - Resource Re-started</name>
    <view>
      <camerax>87</camerax>
      <cameray>540</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="e39903fa-fa98-4ee0-9be8-4501d7935a06" type="Normal" published="False">
    <name>CleanUp</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="597e31bd-02ed-4142-9972-2e6c3c096449" name="Stage1" type="ProcessInfo">
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="f0ec0c92-9a81-4b50-8eed-9c7ae77afb77" name="Start" type="Start">
    <display x="90" y="-135" />
    <onsuccess>d3dfd447-853f-4743-9620-14787fd54c1f</onsuccess>
  </stage>
  <stage stageid="66a21e43-9679-469f-8807-f39f3a96ac03" name="End1" type="End">
    <loginhibit onsuccess="true" />
    <display x="90" y="570" />
  </stage>
  <stage stageid="d3dfd447-853f-4743-9620-14787fd54c1f" name="Note1" type="Note">
    <narrative>GIVEN I have a process, an object consumed by a Web Service and a runtime resource running on the port configured in the web service</narrative>
    <display x="90" y="-75" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>235dcad7-0dd6-4ac6-903b-4002f9c9781d</onsuccess>
  </stage>
  <stage stageid="6d611a28-450c-4ee5-8a7c-e6665494e202" name="Cleanup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="90" y="480" w="150" h="30" />
    <onsuccess>63e60cc3-f32d-4935-a3bb-ea41a6679def</onsuccess>
    <processid>e39903fa-fa98-4ee0-9be8-4501d7935a06</processid>
  </stage>
  <stage stageid="f4523fab-499e-4ce1-b059-125ae0a94b24" name="Resume" type="Resume">
    <loginhibit />
    <display x="315" y="420" />
    <onsuccess>b15601f3-d35e-46a2-8514-ffdcf06d9ab1</onsuccess>
  </stage>
  <stage stageid="b2dcafde-4f36-4e23-bf56-c9df53c525bd" name="Get Exception" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="315" y="375" />
    <onsuccess>f4523fab-499e-4ce1-b059-125ae0a94b24</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="63e60cc3-f32d-4935-a3bb-ea41a6679def" name="Failed?" type="Decision">
    <display x="90" y="525" w="150" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>86a1a1de-d283-4ed3-9151-f1543969cba7</ontrue>
    <onfalse>66a21e43-9679-469f-8807-f39f3a96ac03</onfalse>
  </stage>
  <stage stageid="86a1a1de-d283-4ed3-9151-f1543969cba7" name="RETHROW" type="Exception">
    <display x="210" y="525" />
    <exception localized="yes" type="Test Fail" detail="[Exception]" />
  </stage>
  <stage stageid="b15601f3-d35e-46a2-8514-ffdcf06d9ab1" name="Anchor31" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="315" y="480" w="10" h="10" />
    <onsuccess>6d611a28-450c-4ee5-8a7c-e6665494e202</onsuccess>
  </stage>
  <stage stageid="cec4007f-188b-42df-b24b-f5a7c12cc1fc" name="Failed?" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-195" y="180" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="b08e90da-8977-489b-a877-dace258e73ab" name="Exception" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-195" y="210" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="235dcad7-0dd6-4ac6-903b-4002f9c9781d" name="Setup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="90" y="-30" w="360" h="30" />
    <onsuccess>903f4a5e-b0fc-4122-81e6-9829bc5a9167</onsuccess>
    <processid>30f5163d-8e7f-462b-ac7b-34a009d394fa</processid>
  </stage>
  <stage stageid="903f4a5e-b0fc-4122-81e6-9829bc5a9167" name="Note1" type="Note">
    <narrative>WHEN the process is run from Studio &gt; Debug
THEN a sessionID GUID is generated and populated in the data item and the output is 100</narrative>
    <display x="90" y="15" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>9732ad18-dfa6-45de-b5e3-30f533701d1f</onsuccess>
  </stage>
  <stage stageid="af20b423-93bf-4892-b91d-87d83b4840b9" name="Setup" type="SubSheetInfo">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="d9ad9ed9-085c-4e0b-9f99-646e74fc707d" name="Run Process" type="SubSheetInfo">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <display x="-180" y="-150" w="150" h="90" />
  </stage>
  <stage stageid="75d5b193-d932-4915-a1de-a67f48a0c17f" name="Start" type="Start">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <display x="-45" y="-180" />
    <onsuccess>18897fad-7c8a-4fff-b955-4da494773f59</onsuccess>
  </stage>
  <stage stageid="317031ac-f17d-4bb4-ba0c-062107a6e74f" name="End" type="End">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <display x="-45" y="585" />
  </stage>
  <stage stageid="9732ad18-dfa6-45de-b5e3-30f533701d1f" name="Run Process - Session ID generated" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="90" y="60" w="360" h="30" />
    <onsuccess>2c3f293c-5809-49b2-8f55-249ebac82d17</onsuccess>
    <processid>d54b26fe-5763-469e-9992-11aa8c2b3c95</processid>
  </stage>
  <stage stageid="2c3f293c-5809-49b2-8f55-249ebac82d17" name="Note1" type="Note">
    <narrative>WHEN checking the sessions from the Control Room
THEN a completed session is displayed for the process run</narrative>
    <display x="90" y="105" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>973e69e8-6027-433c-b933-3336da15cb39</onsuccess>
  </stage>
  <stage stageid="973e69e8-6027-433c-b933-3336da15cb39" name="Control Room - Check Session" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="90" y="150" w="360" h="30" />
    <inputs>
      <input type="number" name="Expected Sessions" friendlyname="Expected Sessions" expr="1" />
    </inputs>
    <onsuccess>e9beb0eb-24d6-4c7f-a9fe-3ae2213205c0</onsuccess>
    <processid>ff9e58b9-f417-4226-ad10-2d8113704411</processid>
  </stage>
  <stage stageid="765d52eb-22db-4ea3-8cab-9c1fcbe6cfcc" name="Control Room - Check Session" type="SubSheetInfo">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-180" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="5f469451-63b5-4587-ba60-26cced47df84" name="Note1" type="Note">
    <narrative>WHEN the resource is stopped and then restarted and the process is run from Studio &gt; Debug
THEN a sessionID GUID is generated and populated in the data item and the output is 100</narrative>
    <display x="90" y="375" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>6a4eb59b-5501-422c-8a99-425407a2d80b</onsuccess>
  </stage>
  <stage stageid="6a4eb59b-5501-422c-8a99-425407a2d80b" name="Run Process - Session ID generated after re-starting Resource" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="90" y="420" w="360" h="30" />
    <onsuccess>6d611a28-450c-4ee5-8a7c-e6665494e202</onsuccess>
    <processid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</processid>
  </stage>
  <stage stageid="d0ebb0f6-54b8-4207-8137-fad08f44b90d" name="Run Process - Resource Re-started" type="SubSheetInfo">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-195" y="-120" w="150" h="90" />
  </stage>
  <stage stageid="6b3f9b03-1214-4e0b-82ef-4e111b3dd970" name="Start" type="Start">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-15" y="-150" />
    <onsuccess>9263f358-5b0a-46e3-887b-eceace87be99</onsuccess>
  </stage>
  <stage stageid="fda9f7f1-5d2f-49e3-a3b1-4db0ddb89010" name="Process Name" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">TFM372-WsCalleeProcess-ManualInstance</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="31ee62ba-de35-4a7d-b533-c92c49a360eb" name="Port" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-195" y="45" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>8190</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="a866e0bd-dafa-47cf-8a21-59ef15aebfe8" name="Start" type="Start">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>923b6481-d206-46b2-8c74-2380b52b9a9e</onsuccess>
  </stage>
  <stage stageid="70e3c070-040f-498a-a879-00e4af02432d" name="Launch" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="0" w="90" h="30" />
    <outputs>
      <output type="number" name="pid" friendlyname="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>21d12110-4ec9-491d-95c1-4121d493d26b</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="21d12110-4ec9-491d-95c1-4121d493d26b" name="Attach Control" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="45" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" friendlyname="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>01670b73-bb25-42d1-8d67-a710d76546e6</onsuccess>
    <resource object="Blue Prism - Control Room (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="01670b73-bb25-42d1-8d67-a710d76546e6" name="Attach Studio" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="90" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" friendlyname="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>afd849c8-8818-47ec-b9f5-0e56e7b9e6d9</onsuccess>
    <resource object="Blue Prism - Studio (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="923b6481-d206-46b2-8c74-2380b52b9a9e" name="Resource Manager: Start Resource" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="flag" name="SSO" friendlyname="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="&quot;False&quot;" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to use for the resource. Only used if Username is given" expr="" />
      <input type="number" name="Port" friendlyname="Port" narrative="The port number on which the resource PC should listen" expr="[Port]" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" friendlyname="Process ID" narrative="The PID of the newly created process" stage="Resource Process ID" />
    </outputs>
    <onsuccess>55f326cd-6a46-4b71-a797-07ed114811b1</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="55f326cd-6a46-4b71-a797-07ed114811b1" name="Get Resource Name + Port" type="Calculation">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <display x="-45" y="-45" w="90" h="30" />
    <onsuccess>70e3c070-040f-498a-a879-00e4af02432d</onsuccess>
    <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;) &amp; &quot;:&quot; &amp; [Port]" stage="Resource" />
  </stage>
  <stage stageid="6e6a546c-06bb-44df-a267-91644ad63b23" name="Sign In" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="180" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" expr="&quot;admin&quot;" />
      <input type="password" name="Password" friendlyname="Password" expr="&quot;admin&quot;" />
      <input type="password" name="New Password" friendlyname="New Password" narrative="If this is your first login it will prompt you to change the password." expr="" />
      <input type="flag" name="Expect Password Reset" friendlyname="Expect Password Reset" expr="False" />
      <input type="flag" name="Expected License Wizard" friendlyname="Expected License Wizard" expr="False" />
      <input type="flag" name="Sign in Active Directorry" friendlyname="Sign in Active Directorry" narrative="Do you want sign in using Active Directory" expr="False" />
      <input type="flag" name="Sign in" friendlyname="Sign in" narrative="Do you want sign in using legacy sso environment" expr="True" />
    </inputs>
    <outputs>
      <output type="text" name="Error Message" friendlyname="Error Message" narrative="Error message received while Login" stage="" />
    </outputs>
    <onsuccess>fec0b1b8-2e39-4a15-a191-cb7fb27ab75a</onsuccess>
    <resource object="Blue Prism" action="Sign In" />
  </stage>
  <stage stageid="41592715-33c8-4718-aa07-00b66b01a738" name="Resource" type="Data">
    <display x="-195" y="75" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="db8455c8-97c8-42a5-99e8-19458c1f450a" name="Open Process" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Process Name" friendlyname="Process Name" expr="[Process Name]" />
      <input type="text" name="Folder to Select" friendlyname="Folder to Select" expr="&quot;Default&quot;" />
      <input type="number" name="MatchIndex" friendlyname="MatchIndex" expr="1" />
    </inputs>
    <outputs>
      <output type="text" name="Access Warning" friendlyname="Access Warning" narrative="Access warning when opening member" stage="" />
    </outputs>
    <onsuccess>c69fbca1-4952-434e-b1b2-4051493f9c49</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Open Process" />
  </stage>
  <stage stageid="3af710d8-df71-4d6d-9d4f-6f2aea6b5c28" name="Run Process" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="135" w="90" h="30" />
    <inputs>
      <input type="number" name="Time to Wait" friendlyname="Time to Wait" narrative="How long to wait (in seconds) before raising an exception due to run not being completed. Default to 30." expr="60" />
    </inputs>
    <onsuccess>0056ea2a-8ba8-4c18-8724-df45dcfeec38</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Run Process/Object" />
  </stage>
  <stage stageid="9ab786a1-6e4c-4cdc-b2a4-2e0fe4e7bfd2" name="CleanUp" type="SubSheetInfo">
    <subsheetid>e39903fa-fa98-4ee0-9be8-4501d7935a06</subsheetid>
    <display x="-150" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="7f578ced-5c18-4ca8-a0b9-d978423bae36" name="Start" type="Start">
    <subsheetid>e39903fa-fa98-4ee0-9be8-4501d7935a06</subsheetid>
    <display x="0" y="-105" />
    <onsuccess>c5f71f1e-ab08-4dbe-94b9-c37f2a76d4cc</onsuccess>
  </stage>
  <stage stageid="10f1b80e-0adc-4a38-9fb2-3650638b866f" name="End" type="End">
    <subsheetid>e39903fa-fa98-4ee0-9be8-4501d7935a06</subsheetid>
    <display x="0" y="30" />
  </stage>
  <stage stageid="eeecb48a-7039-46de-86db-ee7ff861e257" name="Terminate" type="Action">
    <subsheetid>e39903fa-fa98-4ee0-9be8-4501d7935a06</subsheetid>
    <display x="0" y="-15" w="90" h="30" />
    <onsuccess>10f1b80e-0adc-4a38-9fb2-3650638b866f</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="fec0b1b8-2e39-4a15-a191-cb7fb27ab75a" name="Go to Control Tab" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="225" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>c7144aa7-1bb5-4afe-ad6f-01a265fccc42</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="160406c7-663b-4181-b084-8b9e3265745a" name="Search for Resource that IS CONNECTED" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="315" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Name" friendlyname="Resource Name" narrative="The name of the Resource PC of interest" expr="[Resource]" />
      <input type="timespan" name="Timeout" friendlyname="Timeout" narrative="The maximum length of time to wait for the Resource of interest to become available. Default is immediate timeout of resource is not available, ie. zero" expr="" />
      <input type="text" name="Resource Group to Expand" friendlyname="Resource Group to Expand" narrative="Group set to Default" expr="&quot;Default&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Resource Available" friendlyname="Resource Available" narrative="Indicates whether the resource is available. This will be false if a timeout occurs." stage="Resource is connected" />
    </outputs>
    <onsuccess>e2b454b6-6326-4e63-9c68-996725a3ca25</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Control Room - Wait for Resource to Come Online" />
  </stage>
  <stage stageid="e2b454b6-6326-4e63-9c68-996725a3ca25" name="Is the resource connected?" type="Decision">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <display x="-45" y="360" w="90" h="30" />
    <decision expression="[Resource is connected]" />
    <ontrue>3940c11a-d922-499b-af90-2e765932816a</ontrue>
    <onfalse>6b0079b5-56cc-46b4-8dd5-ecba2648c053</onfalse>
  </stage>
  <stage stageid="6b0079b5-56cc-46b4-8dd5-ecba2648c053" name="Fail" type="Exception">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <display x="30" y="360" w="30" h="30" />
    <exception localized="yes" type="FAIL" detail="&quot;Resource is not connected&quot;" />
  </stage>
  <stage stageid="c7144aa7-1bb5-4afe-ad6f-01a265fccc42" name="Collapse Reource Group" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="270" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Group Name" friendlyname="Resource Group Name" narrative="Resource Group Name to Collapse" expr="&quot;Default&quot;" />
    </inputs>
    <onsuccess>160406c7-663b-4181-b084-8b9e3265745a</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Collapse Resource Group By Group Name" />
  </stage>
  <stage stageid="13856644-f48c-4d93-9ded-c75c27e559d4" name="Resource is connected" type="Data">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b0cf3418-78ea-4885-80e8-88f4a292d877" name="Local variables" type="Block">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="9263f358-5b0a-46e3-887b-eceace87be99" name="Resource Manager: Stop Resource" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-15" y="-90" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" friendlyname="Port" narrative="The port number whose resource should be stopped" expr="[Port]" />
    </inputs>
    <onsuccess>7f27485f-df8d-4f89-a97d-056aa7db6791</onsuccess>
    <resource object="Resource Manager" action="Stop Resource" />
  </stage>
  <stage stageid="b16df5f1-1dd9-4ffd-8c05-c41d0a9f1e42" name="Check Resource Status" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="270" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Name" friendlyname="Resource Name" narrative="The name of the Resource PC of interest" expr="[Resource]" />
    </inputs>
    <outputs>
      <output type="text" name="Resource Status" friendlyname="Resource Status" narrative="The status of the resource" stage="Resource Status (Offline)" />
    </outputs>
    <onsuccess>761eaf92-44eb-465e-b8f0-3617408c0d91</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Check Resource Status" />
  </stage>
  <stage stageid="761eaf92-44eb-465e-b8f0-3617408c0d91" name="Is the Resource now Offline?" type="Decision">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-15" y="315" w="90" h="30" />
    <decision expression="[Resource Status (Offline)] = &quot;Offline&quot;" />
    <ontrue>2a244552-351b-47ad-9209-f0afb210bf20</ontrue>
    <onfalse>0f7ada43-b11c-433e-8329-4b2175633bce</onfalse>
  </stage>
  <stage stageid="0f7ada43-b11c-433e-8329-4b2175633bce" name="Fail" type="Exception">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="75" y="315" />
    <exception localized="yes" type="Fail" detail="&quot;Expected resource to be offline and it isn't&quot;" />
  </stage>
  <stage stageid="31d51e29-1272-4460-93f5-29e8beca91fe" name="Collapse Reource Group" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Group Name" friendlyname="Resource Group Name" narrative="Resource Group Name to Collapse" expr="&quot;Default&quot;" />
    </inputs>
    <onsuccess>fb6a031e-adea-4714-b99c-2586aa0d0fca</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Collapse Resource Group By Group Name" />
  </stage>
  <stage stageid="fb6a031e-adea-4714-b99c-2586aa0d0fca" name="Expand Reource Group" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="45" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Group Name" friendlyname="Resource Group Name" narrative="Resource Group Name to Expand" expr="&quot;Default&quot;" />
    </inputs>
    <onsuccess>1cd9994e-c415-4238-9275-2e4b6e88b013</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Expand Resource Group By Group Name" />
  </stage>
  <stage stageid="1cd9994e-c415-4238-9275-2e4b6e88b013" name="Get Names of Visible Resources" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="90" w="90" h="30" />
    <outputs>
      <output type="collection" name="Availabe Resources" friendlyname="Availabe Resources" stage="Availabe Resources" />
    </outputs>
    <onsuccess>d41fbd73-005a-4e50-bc8e-5df877a2c86f</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Get Names of Visible resources" />
  </stage>
  <stage stageid="d41fbd73-005a-4e50-bc8e-5df877a2c86f" name="Check Available Resources" type="LoopStart">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="135" w="90" h="30" />
    <onsuccess>cea7af5f-5765-4e79-8e38-3e6be623c5a5</onsuccess>
    <groupid>f18fb2eb-b0c1-4211-90e1-da6119f96c0b</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Availabe Resources</loopdata>
  </stage>
  <stage stageid="d5902727-66b3-41d7-8f26-5d52fb2fd4f9" name="Check Available Resources" type="LoopEnd">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="225" w="90" h="30" />
    <onsuccess>623b8151-ebaa-4fad-8e58-dd9029ecf44b</onsuccess>
    <groupid>f18fb2eb-b0c1-4211-90e1-da6119f96c0b</groupid>
  </stage>
  <stage stageid="cea7af5f-5765-4e79-8e38-3e6be623c5a5" name="Is the Resource Missing?" type="Decision">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-15" y="180" w="90" h="30" />
    <decision expression="[Availabe Resources.Name] = [Resource]" />
    <ontrue>d1f09844-a1fa-4251-aaf6-a08967edc6e0</ontrue>
    <onfalse>d5902727-66b3-41d7-8f26-5d52fb2fd4f9</onfalse>
  </stage>
  <stage stageid="d1f09844-a1fa-4251-aaf6-a08967edc6e0" name="Anchor5" type="Anchor">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="180" w="10" h="10" />
    <onsuccess>e1ba82f2-712b-4670-b373-8e5c3646c7e9</onsuccess>
  </stage>
  <stage stageid="e1ba82f2-712b-4670-b373-8e5c3646c7e9" name="Anchor7" type="Anchor">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="270" w="10" h="10" />
    <onsuccess>b16df5f1-1dd9-4ffd-8c05-c41d0a9f1e42</onsuccess>
  </stage>
  <stage stageid="623b8151-ebaa-4fad-8e58-dd9029ecf44b" name="Fail" type="Exception">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="75" y="225" />
    <exception localized="yes" type="Fail" detail="&quot;Expected resource is available&quot;" />
  </stage>
  <stage stageid="7f27485f-df8d-4f89-a97d-056aa7db6791" name="Search for Resource that IS NOT CONNECTED" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-45" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Name" friendlyname="Resource Name" narrative="The name of the Resource PC of interest" expr="[Resource]" />
      <input type="timespan" name="Timeout" friendlyname="Timeout" narrative="The maximum length of time to wait for the Resource of interest to become available. Default is immediate timeout of resource is not available, ie. zero" expr="[Time Span]" />
      <input type="text" name="Resource Group to Expand" friendlyname="Resource Group to Expand" narrative="Defaults to 'Default'" expr="&quot;Default&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Resource Available" friendlyname="Resource Available" narrative="Indicates whether the resource is available. This will be false if a timeout occurs." stage="Resource is  not connected" />
    </outputs>
    <onsuccess>31d51e29-1272-4460-93f5-29e8beca91fe</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Control Room - Wait for Resource to not be Connected" />
  </stage>
  <stage stageid="97fecf00-fbe9-42f1-b505-c9981e5a7a2d" name="Get Data Item value" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="270" w="90" h="30" />
    <outputs>
      <output type="text" name="Current Value" friendlyname="Current Value" narrative="Current Value in Data Item" stage="Current Value Session ID" />
      <output type="text" name="Initial Value" friendlyname="Initial Value" narrative="Initial Value in Data Item" stage="Initial Value Session ID" />
    </outputs>
    <onsuccess>f67cd772-3852-4369-9522-a7de8d239ed8</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Get Data Item Initial and Current Value" />
  </stage>
  <stage stageid="c69fbca1-4952-434e-b1b2-4051493f9c49" name="Get Start Bounds" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit />
    <display x="-45" y="-45" w="90" h="30" />
    <inputs>
      <input type="text" name="Page Name" narrative="Name of the page in which the element resides." expr="&quot;Main Page&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Bounds" narrative="Bounds of the Start stage on screen." stage="Start Bounds" />
    </outputs>
    <onsuccess>eb9912fe-99b8-4672-9b7c-d94cec679549</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Get Start Stage Bounds" />
  </stage>
  <stage stageid="eb9912fe-99b8-4672-9b7c-d94cec679549" name="Find Y Stage 1" type="Calculation">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="0" w="90" h="30" />
    <onsuccess>76389cdd-7517-4d20-b5f8-31c482a05ab2</onsuccess>
    <calculation expression="[Start Bounds.Bottom] + 80" stage="Y Stage 1" />
  </stage>
  <stage stageid="19e771f8-ffc0-4602-96dd-9bb576a7a413" name="Find X " type="Calculation">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="90" w="90" h="30" />
    <onsuccess>3af710d8-df71-4d6d-9d4f-6f2aea6b5c28</onsuccess>
    <calculation expression="([Start Bounds.Left]+([Start Bounds.Width]/2))" stage="X" />
  </stage>
  <stage stageid="76389cdd-7517-4d20-b5f8-31c482a05ab2" name="Find Y Stage 2" type="Calculation">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="45" w="90" h="30" />
    <onsuccess>19e771f8-ffc0-4602-96dd-9bb576a7a413</onsuccess>
    <calculation expression="[Start Bounds.Bottom] + 160" stage="Y Stage 2" />
  </stage>
  <stage stageid="0056ea2a-8ba8-4c18-8724-df45dcfeec38" name="Select Stage" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="180" w="90" h="30" />
    <inputs>
      <input type="number" name="X" friendlyname="X" narrative="X Coordinate" expr="[X]" />
      <input type="number" name="Y" friendlyname="Y" narrative="Y Coordinate" expr="[Y Stage 1]" />
    </inputs>
    <onsuccess>a11a9e3a-6d4f-4e0f-8818-90596b7d86fc</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Global Click By Coordinates" />
  </stage>
  <stage stageid="4c7ef6c6-1f97-4213-91ac-3f189d84e36e" name="Select Stage" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="360" w="90" h="30" />
    <inputs>
      <input type="number" name="X" friendlyname="X" narrative="X Coordinate" expr="[X]" />
      <input type="number" name="Y" friendlyname="Y" narrative="Y Coordinate" expr="[Y Stage 2]" />
    </inputs>
    <onsuccess>9cc389a8-9008-42a6-b477-fe81d39a08b2</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Global Click By Coordinates" />
  </stage>
  <stage stageid="65deff3d-f809-4188-b00d-6d1237e8dc6b" name="Get Data Item value" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="450" w="90" h="30" />
    <outputs>
      <output type="text" name="Current Value" friendlyname="Current Value" narrative="Current Value in Data Item" stage="Current Value - Output" />
      <output type="text" name="Initial Value" friendlyname="Initial Value" narrative="Initial Value in Data Item" stage="Initial Value - Output" />
    </outputs>
    <onsuccess>74616abf-ac92-4cd9-bfde-05785cd4e8d1</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Get Data Item Initial and Current Value" />
  </stage>
  <stage stageid="f67cd772-3852-4369-9522-a7de8d239ed8" name="SessionID GUID returned?" type="Decision">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <display x="-45" y="315" w="90" h="30" />
    <decision expression="[Initial Value Session ID]=&quot;&quot;&#xA;AND&#xA;[Current Value Session ID]&lt;&gt;&quot;&quot;" />
    <ontrue>4c7ef6c6-1f97-4213-91ac-3f189d84e36e</ontrue>
    <onfalse>10543486-3311-4c28-867c-cb4cb62fdc12</onfalse>
  </stage>
  <stage stageid="74616abf-ac92-4cd9-bfde-05785cd4e8d1" name="Output correct?" type="Decision">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <display x="-45" y="495" w="90" h="30" />
    <decision expression="[Initial Value - Output]=0&#xA;AND&#xA;[Current Value - Output]=100" />
    <ontrue>ff0069a3-2c3f-4f3b-9440-82d3930a36d6</ontrue>
    <onfalse>787466af-2fbf-4ee7-aebb-f7300dd3f445</onfalse>
  </stage>
  <stage stageid="10543486-3311-4c28-867c-cb4cb62fdc12" name="Failed" type="Exception">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <display x="45" y="315" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;SessionID value is blank&quot;" />
  </stage>
  <stage stageid="787466af-2fbf-4ee7-aebb-f7300dd3f445" name="Failed" type="Exception">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <display x="45" y="495" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;The ouput value is incorrect&quot;" />
  </stage>
  <stage stageid="8dfc9c57-e3ee-4f81-ae75-f758af076eee" name="Resource Process ID" type="Data">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <display x="-195" y="15" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="677e5643-09e5-4ad0-aa8c-12e04e6959fc" name="pid" type="Data">
    <display x="-195" y="105" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="a11a9e3a-6d4f-4e0f-8818-90596b7d86fc" name="Open Stage" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="225" w="90" h="30" />
    <onsuccess>97fecf00-fbe9-42f1-b505-c9981e5a7a2d</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Open Properties For Selected Stage" />
  </stage>
  <stage stageid="9cc389a8-9008-42a6-b477-fe81d39a08b2" name="Open Stage" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="405" w="90" h="30" />
    <onsuccess>65deff3d-f809-4188-b00d-6d1237e8dc6b</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Open Properties For Selected Stage" />
  </stage>
  <stage stageid="ff0069a3-2c3f-4f3b-9440-82d3930a36d6" name="Close Process" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="540" w="90" h="30" />
    <onsuccess>317031ac-f17d-4bb4-ba0c-062107a6e74f</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Close All Child Windows" />
  </stage>
  <stage stageid="669bfc29-ec2f-4315-8bd7-d26ad5f6273a" name="Resource is  not connected" type="Data">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-195" y="-30" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="773556b4-ff8a-40ad-8ce5-ac449dfde554" name="Availabe Resources" type="Collection">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-195" y="0" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7447bc52-e637-4536-9d02-5595baa416d5" name="Resource Status (Offline)" type="Data">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-195" y="30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2a244552-351b-47ad-9209-f0afb210bf20" name="Resource Manager: Start Resource" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="360" w="90" h="30" />
    <inputs>
      <input type="flag" name="SSO" friendlyname="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="&quot;False&quot;" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to use for the resource. Only used if Username is given" expr="" />
      <input type="number" name="Port" friendlyname="Port" narrative="The port number on which the resource PC should listen" expr="[Port]" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" friendlyname="Process ID" narrative="The PID of the newly created process" stage="Resource Process ID" />
    </outputs>
    <onsuccess>bc1aa03d-6ebb-4ea3-baa2-128c2514103b</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="bc1aa03d-6ebb-4ea3-baa2-128c2514103b" name="Get Resource Name + Port" type="Calculation">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-15" y="405" w="90" h="30" />
    <onsuccess>96b6d3ad-d303-4c71-88eb-9c85650cb0e1</onsuccess>
    <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;) &amp; &quot;:&quot; &amp; [Port]" stage="Resource" />
  </stage>
  <stage stageid="5127c9a8-210d-43d8-9cb5-eadf66fa97ae" name="Search for Resource that IS CONNECTED" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="495" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Name" friendlyname="Resource Name" narrative="The name of the Resource PC of interest" expr="[Resource]" />
      <input type="timespan" name="Timeout" friendlyname="Timeout" narrative="The maximum length of time to wait for the Resource of interest to become available. Default is immediate timeout of resource is not available, ie. zero" expr="" />
      <input type="text" name="Resource Group to Expand" friendlyname="Resource Group to Expand" narrative="Group set to Default" expr="&quot;Default&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Resource Available" friendlyname="Resource Available" narrative="Indicates whether the resource is available. This will be false if a timeout occurs." stage="Resource is connected" />
    </outputs>
    <onsuccess>ded61ed4-3826-44ca-8d42-ca9ef9b913ed</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Control Room - Wait for Resource to Come Online" />
  </stage>
  <stage stageid="ded61ed4-3826-44ca-8d42-ca9ef9b913ed" name="Is the resource connected?" type="Decision">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-15" y="540" w="90" h="30" />
    <decision expression="[Resource is  not connected]" />
    <ontrue>58839a72-1f8d-4588-8941-7f38e3a078f1</ontrue>
    <onfalse>b31c8e54-924f-4c58-8e90-21a7a4762822</onfalse>
  </stage>
  <stage stageid="b31c8e54-924f-4c58-8e90-21a7a4762822" name="Fail" type="Exception">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="60" y="540" w="30" h="30" />
    <exception localized="yes" type="FAIL" detail="&quot;Resource is not connected&quot;" />
  </stage>
  <stage stageid="96b6d3ad-d303-4c71-88eb-9c85650cb0e1" name="Collapse Reource Group" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="450" w="90" h="30" />
    <inputs>
      <input type="text" name="Resource Group Name" friendlyname="Resource Group Name" narrative="Resource Group Name to Collapse" expr="&quot;Default&quot;" />
    </inputs>
    <onsuccess>5127c9a8-210d-43d8-9cb5-eadf66fa97ae</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Collapse Resource Group By Group Name" />
  </stage>
  <stage stageid="8916911b-b581-4601-bf19-0c6d8b93ce7e" name="Go to Tab: Studio" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;Studio&quot;" />
    </inputs>
    <onsuccess>b513aeaa-d8c3-4ec3-8378-fd18833a5ea6</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="07a4ef61-4e1d-4ce1-9556-b6e99fcd26c2" name="End" type="End">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="225" y="645" />
  </stage>
  <stage stageid="b513aeaa-d8c3-4ec3-8378-fd18833a5ea6" name="Open Process" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="-45" w="90" h="30" />
    <inputs>
      <input type="text" name="Process Name" friendlyname="Process Name" expr="[Process Name]" />
      <input type="text" name="Folder to Select" friendlyname="Folder to Select" expr="&quot;Default&quot;" />
      <input type="number" name="MatchIndex" friendlyname="MatchIndex" expr="1" />
    </inputs>
    <outputs>
      <output type="text" name="Access Warning" friendlyname="Access Warning" narrative="Access warning when opening member" stage="" />
    </outputs>
    <onsuccess>8d1c6842-1214-4f48-8d36-8dcaa09cdeda</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Open Process" />
  </stage>
  <stage stageid="217656cf-c036-4eda-8cac-e57d23d12bbe" name="Run Process" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="180" w="90" h="30" />
    <inputs>
      <input type="number" name="Time to Wait" friendlyname="Time to Wait" narrative="How long to wait (in seconds) before raising an exception due to run not being completed. Default to 30." expr="60" />
    </inputs>
    <onsuccess>55b83503-33fe-4957-b174-00e8823bbadd</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Run Process/Object" />
  </stage>
  <stage stageid="9c0ac1d0-e800-483f-802d-affe1e4e31df" name="Get Data Item value" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="315" w="90" h="30" />
    <outputs>
      <output type="text" name="Current Value" friendlyname="Current Value" narrative="Current Value in Data Item" stage="Current Value Session ID" />
      <output type="text" name="Initial Value" friendlyname="Initial Value" narrative="Initial Value in Data Item" stage="Initial Value Session ID" />
    </outputs>
    <onsuccess>720d2504-c087-4dcc-8090-e30eb39edace</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Get Data Item Initial and Current Value" />
  </stage>
  <stage stageid="8d1c6842-1214-4f48-8d36-8dcaa09cdeda" name="Get Start Bounds" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit />
    <display x="225" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Page Name" narrative="Name of the page in which the element resides." expr="&quot;Main Page&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Bounds" narrative="Bounds of the Start stage on screen." stage="Start Bounds" />
    </outputs>
    <onsuccess>3dd70e94-3f66-474d-abde-96d0104a4afb</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Get Start Stage Bounds" />
  </stage>
  <stage stageid="3dd70e94-3f66-474d-abde-96d0104a4afb" name="Find Y Stage 1" type="Calculation">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="45" w="90" h="30" />
    <onsuccess>775fd82b-dd80-42c0-ba8a-6353aac86414</onsuccess>
    <calculation expression="[Start Bounds.Bottom] + 80" stage="Y Stage 1" />
  </stage>
  <stage stageid="3c3d506c-4c1f-4ef5-a8f6-556f0942c7e1" name="Find X " type="Calculation">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="135" w="90" h="30" />
    <onsuccess>217656cf-c036-4eda-8cac-e57d23d12bbe</onsuccess>
    <calculation expression="([Start Bounds.Left]+([Start Bounds.Width]/2))" stage="X" />
  </stage>
  <stage stageid="775fd82b-dd80-42c0-ba8a-6353aac86414" name="Find Y Stage 2" type="Calculation">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="90" w="90" h="30" />
    <onsuccess>3c3d506c-4c1f-4ef5-a8f6-556f0942c7e1</onsuccess>
    <calculation expression="[Start Bounds.Bottom] + 160" stage="Y Stage 2" />
  </stage>
  <stage stageid="55b83503-33fe-4957-b174-00e8823bbadd" name="Select Stage" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="225" w="90" h="30" />
    <inputs>
      <input type="number" name="X" friendlyname="X" narrative="X Coordinate" expr="[X]" />
      <input type="number" name="Y" friendlyname="Y" narrative="Y Coordinate" expr="[Y Stage 1]" />
    </inputs>
    <onsuccess>faba15df-d648-42ef-8982-5ce330c6dd95</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Global Click By Coordinates" />
  </stage>
  <stage stageid="84f5aaa1-95f3-4578-b8a1-9ae3f2c5e3f7" name="Select Stage" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="405" w="90" h="30" />
    <inputs>
      <input type="number" name="X" friendlyname="X" narrative="X Coordinate" expr="[X]" />
      <input type="number" name="Y" friendlyname="Y" narrative="Y Coordinate" expr="[Y Stage 2]" />
    </inputs>
    <onsuccess>8c343567-2522-47c0-af7f-20e655f45dd6</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Global Click By Coordinates" />
  </stage>
  <stage stageid="bd00560a-8804-4952-abb9-153c94d06fde" name="Get Data Item value" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="495" w="90" h="30" />
    <outputs>
      <output type="text" name="Current Value" friendlyname="Current Value" narrative="Current Value in Data Item" stage="Current Value - Output" />
      <output type="text" name="Initial Value" friendlyname="Initial Value" narrative="Initial Value in Data Item" stage="Initial Value - Output" />
    </outputs>
    <onsuccess>0a05d495-2b38-40f2-a16d-f06318b1bb40</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Get Data Item Initial and Current Value" />
  </stage>
  <stage stageid="720d2504-c087-4dcc-8090-e30eb39edace" name="SessionID GUID returned?" type="Decision">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="225" y="360" w="90" h="30" />
    <decision expression="[Initial Value Session ID]=&quot;&quot;&#xA;AND&#xA;[Current Value Session ID]&lt;&gt;&quot;&quot;" />
    <ontrue>84f5aaa1-95f3-4578-b8a1-9ae3f2c5e3f7</ontrue>
    <onfalse>29b31b66-84ab-4257-9762-8a1ab8cba9bf</onfalse>
  </stage>
  <stage stageid="0a05d495-2b38-40f2-a16d-f06318b1bb40" name="Output correct?" type="Decision">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="225" y="540" w="90" h="30" />
    <decision expression="[Initial Value - Output]=0&#xA;AND&#xA;[Current Value - Output]=100" />
    <ontrue>cb201a30-cd35-4ea4-9071-bac621e70971</ontrue>
    <onfalse>3669058d-6536-421d-9a03-2dbab091c03a</onfalse>
  </stage>
  <stage stageid="29b31b66-84ab-4257-9762-8a1ab8cba9bf" name="Failed" type="Exception">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="315" y="360" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;SessionID value is blank&quot;" />
  </stage>
  <stage stageid="3669058d-6536-421d-9a03-2dbab091c03a" name="Failed" type="Exception">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="315" y="540" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;The ouput value is incorrect&quot;" />
  </stage>
  <stage stageid="faba15df-d648-42ef-8982-5ce330c6dd95" name="Open Stage" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="270" w="90" h="30" />
    <onsuccess>9c0ac1d0-e800-483f-802d-affe1e4e31df</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Open Properties For Selected Stage" />
  </stage>
  <stage stageid="8c343567-2522-47c0-af7f-20e655f45dd6" name="Open Stage" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="450" w="90" h="30" />
    <onsuccess>bd00560a-8804-4952-abb9-153c94d06fde</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Stage Manipulation - Open Properties For Selected Stage" />
  </stage>
  <stage stageid="cb201a30-cd35-4ea4-9071-bac621e70971" name="Close Process" type="Action">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="600" w="90" h="30" />
    <onsuccess>07a4ef61-4e1d-4ce1-9556-b6e99fcd26c2</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Close All Child Windows" />
  </stage>
  <stage stageid="58839a72-1f8d-4588-8941-7f38e3a078f1" name="Anchor1" type="Anchor">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="585" w="10" h="10" />
    <onsuccess>873636d1-79cd-4713-ac02-89c99d4640e6</onsuccess>
  </stage>
  <stage stageid="873636d1-79cd-4713-ac02-89c99d4640e6" name="Anchor6" type="Anchor">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="585" w="10" h="10" />
    <onsuccess>50828ba9-2d5a-4c87-a50d-4ada9da4ebe0</onsuccess>
  </stage>
  <stage stageid="50828ba9-2d5a-4c87-a50d-4ada9da4ebe0" name="Anchor8" type="Anchor">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-135" w="10" h="10" />
    <onsuccess>0338354c-5ed3-4279-b485-1102c57051e4</onsuccess>
  </stage>
  <stage stageid="0338354c-5ed3-4279-b485-1102c57051e4" name="Anchor9" type="Anchor">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="-135" w="10" h="10" />
    <onsuccess>8916911b-b581-4601-bf19-0c6d8b93ce7e</onsuccess>
  </stage>
  <stage stageid="3bf88a5c-334d-4393-8666-95ffd75ee525" name="Re-start resource" type="Block">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="-120" w="225" h="690" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0f7a3744-670e-4842-b172-60a868c8252c" name="Local variables" type="Block">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-60" w="150" h="210" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="f15bbacb-d35f-4625-aca5-6259f11e5f7c" name="Run Process" type="Block">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="165" y="-120" w="195" h="690" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c5f71f1e-ab08-4dbe-94b9-c37f2a76d4cc" name="Resource Manager: Stop Resource" type="Action">
    <subsheetid>e39903fa-fa98-4ee0-9be8-4501d7935a06</subsheetid>
    <display x="0" y="-60" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" friendlyname="Port" narrative="The port number whose resource should be stopped" expr="[Port]" />
    </inputs>
    <onsuccess>eeecb48a-7039-46de-86db-ee7ff861e257</onsuccess>
    <resource object="Resource Manager" action="Stop Resource" />
  </stage>
  <stage stageid="300a02cc-77bf-4888-a9ac-37c12a5d3ed5" name="Start Bounds" type="Collection">
    <display x="-360" y="-15" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
  </stage>
  <stage stageid="64946ed1-8e17-4ec3-af16-84ac7612f28d" name="X" type="Data">
    <display x="-360" y="15" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="fc7bb790-2197-40fa-a4fb-1b448bfbcba5" name="Y Stage 2" type="Data">
    <display x="-360" y="75" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="360e58d3-a04d-41e5-9010-969ed974340e" name="Y Stage 1" type="Data">
    <display x="-360" y="45" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="36c44b8c-bd05-40ee-afeb-c165b69c8806" name="Initial Value - Output" type="Data">
    <display x="-360" y="135" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="301f8975-d121-40b5-8ac8-032cb44e79de" name="Current Value - Output" type="Data">
    <display x="-360" y="105" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="184b2f42-adbe-4e76-af30-6898efda7362" name="Current Value Session ID" type="Data">
    <display x="-360" y="165" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="85afe085-823c-4206-bc84-19e7ad8d4786" name="Initial Value Session ID" type="Data">
    <display x="-360" y="195" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="0dc1c0d7-4988-459c-969b-580a44793591" name="Resource is connected" type="Data">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-195" y="60" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="130176d8-09de-4dbd-b8a3-2f1f3881eae1" name="Resource Process ID" type="Data">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <display x="-195" y="90" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a2c11cc0-d9af-4d0b-875c-fb63afbbe76f" name="CleanUp Block" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-105" y="-105" w="465" h="555" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="42020b47-5094-47d5-a620-caaa9b8c8a5d" name="Global variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="36a97f3f-e8b6-4d4b-9bb9-0d14015a46f3" name="Local variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-270" y="150" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="04b15c44-0c16-4218-aa48-93f92e52aeae" name="Process variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-435" y="-45" w="150" h="270" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="7149f5da-93d8-45f8-a06f-7c65932602c3" name="Time Span" type="Data">
    <subsheetid>50d82475-80a2-4fbb-9d0a-142ea7f810eb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="120" w="120" h="30" />
    <datatype>timespan</datatype>
    <initialvalue>0.00:01:00</initialvalue>
  </stage>
  <stage stageid="3cb21a0c-e3f0-4a0a-b7a1-df4f02055ceb" name="End2" type="End">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="810" />
  </stage>
  <stage stageid="3940c11a-d922-499b-af90-2e765932816a" name="Go to Tab: System" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="405" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>085304f4-493b-4521-9127-c3dc6ad8f365</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="afd849c8-8818-47ec-b9f5-0e56e7b9e6d9" name="Attach System" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="135" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" friendlyname="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>6e6a546c-06bb-44df-a267-91644ad63b23</onsuccess>
    <resource object="Blue Prism - System (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="085304f4-493b-4521-9127-c3dc6ad8f365" name="Click Item From System Tree" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="450" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" friendlyname="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Objects&quot;" />
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Exposure&quot;" />
      <input type="text" name="Sub Item Name" friendlyname="Sub Item Name" narrative="Name of the sub item to be clicked on." expr="" />
      <input type="flag" name="Select Item Method?" friendlyname="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" friendlyname="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" friendlyname="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>c2d2c676-5e9e-4634-8801-85abd9224de7</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="415dd1ab-e05c-45b3-bafe-704b65dbebd4" name="Object Name" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-195" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">A TFM-372-Count Exposure</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="c2d2c676-5e9e-4634-8801-85abd9224de7" name="Press Expose an Object" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="495" w="90" h="30" />
    <onsuccess>e505bfe4-bccf-459f-ac23-923501ed4d43</onsuccess>
    <resource object="Blue Prism - System - Objects" action="Expose - Press Expose an Object" />
  </stage>
  <stage stageid="e505bfe4-bccf-459f-ac23-923501ed4d43" name="Select Object to Expose" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="540" w="90" h="30" />
    <inputs>
      <input type="text" name="Group Name" friendlyname="Group Name" expr="&quot;Default&quot;" />
      <input type="text" name="Object Name" friendlyname="Object Name" expr="[Object Name]" />
    </inputs>
    <onsuccess>7d6b5b43-1548-47f4-833e-e9785ac249cc</onsuccess>
    <resource object="Blue Prism - System - Objects" action="Exposure - Select Object to Expose" />
  </stage>
  <stage stageid="7d6b5b43-1548-47f4-833e-e9785ac249cc" name="Press Next" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="585" w="90" h="30" />
    <onsuccess>f4336995-0686-4034-8d6d-508658d2fd41</onsuccess>
    <resource object="Blue Prism - System - Processes" action="Exposure Wizard - Press Next" />
  </stage>
  <stage stageid="f4336995-0686-4034-8d6d-508658d2fd41" name="Press Finish" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="630" w="90" h="30" />
    <onsuccess>73834199-7520-42b1-9d07-8bc56f990939</onsuccess>
    <resource object="Blue Prism - System - Objects" action="Exposure - Press Finish" />
  </stage>
  <stage stageid="73834199-7520-42b1-9d07-8bc56f990939" name="Click Item From System Tree" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="675" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" friendlyname="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Objects&quot;" />
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="Name of the item to be clicked on." expr="&quot;SOAP Web Services&quot;" />
      <input type="text" name="Sub Item Name" friendlyname="Sub Item Name" narrative="Name of the sub item to be clicked on." expr="" />
      <input type="flag" name="Select Item Method?" friendlyname="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" friendlyname="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" friendlyname="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>4e503f23-b852-4acd-94b1-812c6c0d42bd</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="b3d3a16b-b86e-44cd-aba6-3b4fa5c3cd16" name="Create Web Service" type="Action">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="765" w="90" h="30" />
    <inputs>
      <input type="text" name="URL" friendlyname="URL" narrative="The URL of the Web Service Description file" expr="[WS URL]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to access the web service. If this is present, it overrides the Credential Name parameter" expr="&quot;admin&quot;" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password with which to access the web service" expr="&quot;admin&quot;" />
      <input type="number" name="Timeout" friendlyname="Timeout" narrative="The number of milliseconds to allow a response from the web service" expr="50000" />
      <input type="text" name="Name" friendlyname="Name" narrative="The name to give the web service" expr="&quot;TFM-372-CountExposureService&quot;" />
      <input type="collection" name="Actions" friendlyname="Actions" narrative="NOT YET IMPLEMENTED - The actions on the web service to enable, if not given this will enable all of them" expr="" />
    </inputs>
    <onsuccess>3cb21a0c-e3f0-4a0a-b7a1-df4f02055ceb</onsuccess>
    <resource object="Blue Prism - System - Objects" action="Create Web Service" />
  </stage>
  <stage stageid="4e503f23-b852-4acd-94b1-812c6c0d42bd" name="Generate WS URL" type="Calculation">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="720" w="90" h="30" />
    <onsuccess>b3d3a16b-b86e-44cd-aba6-3b4fa5c3cd16</onsuccess>
    <calculation expression="&quot;http://&quot; &amp; [Resource] &amp;&quot;/ws/ATFM372CountExposure?wsdl&quot;" stage="WS URL" />
  </stage>
  <stage stageid="90749f28-31b7-4b2e-9a98-9375d2f58ed1" name="WS URL" type="Data">
    <subsheetid>30f5163d-8e7f-462b-ac7b-34a009d394fa</subsheetid>
    <display x="-195" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6c36a9b7-3774-44f1-8f65-d442904f1720" name="Start" type="Start">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-45" y="-135" />
    <inputs>
      <input type="number" name="Expected Sessions" stage="Expected Sessions" />
    </inputs>
    <onsuccess>77bef176-847e-4174-8e22-9252fb131286</onsuccess>
  </stage>
  <stage stageid="89714cfe-2ab8-448a-81a9-3f5758f15aa9" name="End" type="End">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-45" y="270" />
  </stage>
  <stage stageid="77bef176-847e-4174-8e22-9252fb131286" name="Go to Tab: Control" type="Action">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>98654cee-a2cc-4b2c-8b95-93bace44b2aa</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="029af49f-45ea-4a0d-bcf0-3beba5ef083a" name="Get Sessions" type="Action">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-45" y="45" w="90" h="30" />
    <outputs>
      <output type="collection" name="Sessions" narrative="A list of the sessions that are in the list." stage="Ran Sessions" />
    </outputs>
    <onsuccess>59e9c521-ed8f-4c46-94e9-79ac07cb2f65</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Get Sessions" />
  </stage>
  <stage stageid="98654cee-a2cc-4b2c-8b95-93bace44b2aa" name="Select Session Management" type="Action">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-45" y="-45" w="90" h="30" />
    <inputs>
      <input type="text" name="Control Item to Click" narrative="Control Item to click in left hand side control Tree" expr="&quot;Session Management&quot;" />
    </inputs>
    <onsuccess>f3dc319b-48ae-4e67-8ccf-6732a38e3b30</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Click Item from Control's Left Tree" />
  </stage>
  <stage stageid="dcd6d0b5-8fdf-4af8-b8e4-efa23ecf713e" name="Found Session?" type="Decision">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-45" y="135" w="90" h="30" />
    <decision expression="[Ran Sessions.Process]=&quot;A TFM-372-Count Exposure&quot;&#xA;AND &#xA;[Ran Sessions.Resource]=[Resource]&#xA;AND&#xA;[Ran Sessions.User]=&quot;admin&quot; &#xA;AND &#xA;[Ran Sessions.Status]=&quot;Completed&quot;" />
    <ontrue>171ef4ca-3eda-414d-a361-b6425920e805</ontrue>
    <onfalse>b49c2f64-6851-4241-80b3-f2fbbcff809f</onfalse>
  </stage>
  <stage stageid="f3dc319b-48ae-4e67-8ccf-6732a38e3b30" name="Set Last 30 Minutes" type="Action">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-45" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Session Start Time" narrative="Allowed value can be one of the following: All, Last 15 Minutes, Last 30 Minutes, Last 1 Hour, Last 2 Hours, Last 4 Hours, Last 8 Hours, Last 12 Hours, Last 18 Hours, Last 24 Hours, Today, Last 3 Days, Last 7 Days, Last 31 Days" expr="&quot;Last 30 Minutes&quot;" />
    </inputs>
    <onsuccess>029af49f-45ea-4a0d-bcf0-3beba5ef083a</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Change Session Start Time" />
  </stage>
  <stage stageid="cf586f7c-c61e-4b8e-a568-3b03685527d0" name="Failed" type="Exception">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="60" y="225" />
    <exception localized="yes" type="RETHROW" detail="&quot;Session(s) not found. We expected &quot;&amp;[Expected Sessions]&amp;&quot; however we found &quot;&amp;[Found Sessions]" />
  </stage>
  <stage stageid="ea698ce8-af5a-4ae0-97a4-f01168b9a88a" name="Ran Sessions" type="Collection">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-180" y="60" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4d3719fe-b6c1-4954-9dc8-d3f6edcec35c" name="Local Variables" type="Block">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="59e9c521-ed8f-4c46-94e9-79ac07cb2f65" name="Loops Ran Sessions" type="LoopStart">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="90" w="90" h="30" />
    <onsuccess>dcd6d0b5-8fdf-4af8-b8e4-efa23ecf713e</onsuccess>
    <groupid>80d587a3-53aa-4107-b75b-f6c0fa5f624b</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Ran Sessions</loopdata>
  </stage>
  <stage stageid="b49c2f64-6851-4241-80b3-f2fbbcff809f" name="Loops Ran Sessions" type="LoopEnd">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="180" w="90" h="30" />
    <onsuccess>c401470f-6995-439b-8d1b-eb9b20cb3c7c</onsuccess>
    <groupid>80d587a3-53aa-4107-b75b-f6c0fa5f624b</groupid>
  </stage>
  <stage stageid="b257bb0d-959b-4f2b-b26d-fd54a3c24d28" name="Anchor3" type="Anchor">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="180" w="10" h="10" />
    <onsuccess>b49c2f64-6851-4241-80b3-f2fbbcff809f</onsuccess>
  </stage>
  <stage stageid="977f5fc5-ef7b-49fa-a258-54650edc1cfc" name="Expected Sessions" type="Data">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-180" y="-15" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ca372954-1d11-4f82-bf42-e932485a32e5" name="Input Variables" type="Block">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="41fe3e20-de60-486c-bc21-02d7b4561d29" name="Found Sessions" type="Data">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-180" y="90" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="171ef4ca-3eda-414d-a361-b6425920e805" name="Found Sessions ++" type="Calculation">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="135" w="90" h="30" />
    <onsuccess>b257bb0d-959b-4f2b-b26d-fd54a3c24d28</onsuccess>
    <calculation expression="[Found Sessions]+1" stage="Found Sessions" />
  </stage>
  <stage stageid="c401470f-6995-439b-8d1b-eb9b20cb3c7c" name="Correct Number of Sessions Found?" type="Decision">
    <subsheetid>ff9e58b9-f417-4226-ad10-2d8113704411</subsheetid>
    <display x="-45" y="225" w="90" h="30" />
    <decision expression="[Expected Sessions]=[Found Sessions]" />
    <ontrue>89714cfe-2ab8-448a-81a9-3f5758f15aa9</ontrue>
    <onfalse>cf586f7c-c61e-4b8e-a568-3b03685527d0</onfalse>
  </stage>
  <stage stageid="e9beb0eb-24d6-4c7f-a9fe-3ae2213205c0" name="Note1" type="Note">
    <narrative>WHEN the process is run again from Studio &gt; Debug
THEN a new sessionID GUID is generated and populated in the data item and the output is 100</narrative>
    <display x="90" y="195" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>912a3543-d813-4efe-b24c-c9b2e8be580e</onsuccess>
  </stage>
  <stage stageid="912a3543-d813-4efe-b24c-c9b2e8be580e" name="Run Process - Session ID generated" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="90" y="240" w="360" h="30" />
    <onsuccess>de31f2ce-0c4e-43c5-a58a-ae97049c510e</onsuccess>
    <processid>d54b26fe-5763-469e-9992-11aa8c2b3c95</processid>
  </stage>
  <stage stageid="de31f2ce-0c4e-43c5-a58a-ae97049c510e" name="Note1" type="Note">
    <narrative>WHEN checking the sessions from the Control Room
THEN a second completed session is displayed for the process run</narrative>
    <display x="90" y="285" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>16de5a0e-f6d8-4b93-a5ca-0ebfbf5e7e67</onsuccess>
  </stage>
  <stage stageid="16de5a0e-f6d8-4b93-a5ca-0ebfbf5e7e67" name="Control Room - Check Session" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="90" y="330" w="360" h="30" />
    <inputs>
      <input type="number" name="Expected Sessions" friendlyname="Expected Sessions" expr="2" />
    </inputs>
    <onsuccess>5f469451-63b5-4587-ba60-26cced47df84</onsuccess>
    <processid>ff9e58b9-f417-4226-ad10-2d8113704411</processid>
  </stage>
  <stage stageid="18897fad-7c8a-4fff-b955-4da494773f59" name="Go to Tab: Studio" type="Action">
    <subsheetid>d54b26fe-5763-469e-9992-11aa8c2b3c95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-135" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;Studio&quot;" />
    </inputs>
    <onsuccess>db8455c8-97c8-42a5-99e8-19458c1f450a</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="405e3575-40c7-4dfd-804e-16df494ee2eb" name="Recover" type="Recover">
    <loginhibit />
    <display x="315" y="330" />
    <onsuccess>b2dcafde-4f36-4e23-bf56-c9df53c525bd</onsuccess>
  </stage>
</process>