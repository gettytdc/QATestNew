<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" href="AutomateHelp.css" rel="stylesheet" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <title>Blue Prism Server</title>
	<script type="text/javascript" src="script/imagezoom.js"></script>
</head>

<body class="slick">
    <div class="header">
        <h1 class="pagetitle">Blue Prism Server</h1>
		<h2>Introduction</h2>
    </div>
	
	<div class="captioned-image overview-screenshot nozoom">
		<a href="Graphics/bpserver.png" 
			title="Server Configurations - Click for a larger image">
		<img alt="Server Configurations - Click for a larger image"
			src="Graphics/bpserver.png"/></a>
		<p>A comparison of the Direct Access and Blue Prism Server
			architectures</p>
	</div>
	
	<h3 id="overview">Overview</h3>
	<p>Blue Prism can be operated in two different network
		architectures :-</p>
	<dl class="listplease">
		<dt>Direct Access</dt>
		<dd>
			<p>Blue Prism clients, whether running the full Blue
			Prism client software, or simply running as a Runtime Resource,
			have direct access to the database which governs the Blue
			Prism environment.</p>
			<p>This requires each client to store the authentication
			details for the database, and, depending on the
			authentication mode utilised, may give the user full access
			to the Blue Prism database, which is not desirable.</p>
		</dd>
		<dt>Blue Prism Server</dt>
		<dd>
			<p>The Blue Prism clients and resources connect to the BP Server 
            service running on a central machine. This acts as a proxy for 
            the database, and becomes the only place within the system which 
            needs the authentication data to access and modify the data.</p>
		</dd>
	</dl>
	<p>The <a href="helpScheduler.htm">Blue Prism Scheduler</a> also
	runs within a BP Server service and it is possible to retain a
	'Direct Access' architecture with a BP Server instance running
	primarily for the purpose of running the scheduler.</p>
	
	<div class="captioned-image screenshot"><img
		src="Graphics/bpserver-config.png" alt="Configuring BP Server"/>
	</div>
	<h3 id="configuring">Configuring BP Server</h3>
	<h4>Server Configuration Overview</h4>
	<p>A Blue Prism Server service is installed as part of the Blue
	Prism software installation process. It can be found in the <code>
	Installed Services</code> list in the Start Menu, reachable under:
	<code>All Programs : Administrative Tools : Services</code>.</p>
	
	<p>The server is configured by running BPServer.exe, which is
	installed in the Blue Prism installation directory (usually <code>
	C:\Program Files\Blue Prism Limited\Blue Prism Automate</code>).</p>
	
	<p>The dialog box which opens can be used to specify multiple
	configurations of Blue Prism Server, which can connect to disparate
	databases and listen to multiple clients.</p>
	
	<p>This dialog is no longer used to configure the <a
	href="helpScheduler.htm">Blue Prism Scheduler</a>. This can now be
	configured on an environment-wide basis in <a
	href="helpSystemManagerScheduler.htm">System Manager</a>.</p>

	<hr class="clearer light"></hr>
	
	<h4>Editing an existing configuration</h4>
	<p>On installation, a default configuration for Blue Prism Server is
	created with the name <code>Default</code>. On opening the Server
	configuration dialog, it is this configuration which will be
	selected in the <code>Configuration</code> drop down box.</p>
	
	<p>To edit a configuration, ensure that it is selected in the
	<code>Configuration</code> drop down and click on the <code>Edit...
	</code> button.</p>
	
	<p>This will open the <a href="#server-details">Server Configuration
	Details</a> dialog with the current details stored for the selected
	configuration.</p>
	
	<p><strong>Note: </strong> The Blue Prism Server service which is
	installed by default when installing Blue Prism attempts to load a
	server configuration named 'Default' - if that doesn't exist, it
	will not start up. See <a href="#running-multiple">Running Multiple
	BP Servers</a> for guidance on how to configure a service to load a
	different configuration.</p>
	
	<h4>Creating a new configuration</h4>
	<p>Clicking on the 'New...' button will open the <a
	href="#server-details">Server Configuration Details</a> dialog where
	the configuration can be specified.</p>
	
	<h4>Deleting a configuration</h4>
	<p>To delete a configuration, ensure that it is selected in the
	<code>Configuration</code> drop down and click on the <code>Delete
	</code> button.</p>
	<p>Note that the configuration will be deleted and the changes saved immediately.</p>

	<div class="clearer"></div>
	<div class="captioned-image screenshot"><img
		src="Graphics/bpserver-instance-config.png"
		alt="Configuring a BP Server Instance"/>
	</div>
	<h3 id="server-details">Server Configuration Details</h3>
	<p>Within the 'Server configuration details' dialog, you can
	specify:-</p>
	<h4>Details tab</h4>
	<dl class="bulleted">
		<dt id="config-name">Name</dt>
		<dd>The name of the configuration. This is largely documentary,
			but is also used to indicate which server configuration a
			service should use when defining <a
			href="#running-multiple">multiple BP Server services</a>.
			Note that in that case, a simple name without spaces or
			punctuation is recommended in order to simplify the
			installation of the corresponding service.
		</dd>
		
		<dt id="config-connection">Connection</dt>
		<dd>The connection settings that the server configuration should
		use to connect to the Blue Prism database it is serving. The
		available connections are drawn from the connections configured
		within the Blue Prism Client's <a href="helpConnections.htm">
		Connections</a> dialog, available from the login page.</dd>
		
		<dt id="config-port">Listening port</dt>
		<dd>The TCP/IP port on which it should listen for connections
		from Blue Prism clients. If running multiple servers
		simultaneously, these must be different for each server
		configuration or the server may not be able to start.</dd>

        <dt id="connection-mode">Connection Mode</dt>
        <dd>
                There following connection modes can be used for
                connections between a Blue Prism client and the Blue Prism server:-
            <dl class="listplease">
                <dt>WCF: SOAP with Message Encryption & Windows Authentication</dt>
                <dd>
                    <ul>
                        <li>Requires trust relationship between devices: Yes</li>
                        <li>Blue Prism Authentication Modes: Blue Prism Native / Single Sign-on</li>
                        <li>Requires server-side certificate: No</li>
                        <li>Transport: SOAP over HTTP</li>
                    </ul>
                    <p>
                        Only the message content is encrypted.  The SOAP and HTTP headers remain
                        unencrypted which assists complex routing, load balancers, proxies etc. 
                        Client and server identity is validated via Windows / Active Directory.
                    </p>
                </dd>
                <dt>WCF: SOAP with Transport Encryption & Windows Authentication</dt>
                <dd>
                    <ul>
                        <li>Requires trust relationship between devices: Yes</li>
                        <li>Blue Prism Authentication Modes: Blue Prism Native / Single Sign-on</li>
                        <li>Requires server-side certificate: Yes</li>
                        <li>Transport: SOAP over HTTPS</li>
                    </ul>
                    <p>
                        The transport including SOAP headers are encrypted using certificate-based
                        encryption.	Client and server identity is validated via
                        Windows / Active Directory.
                    </p>
                </dd>
                <dt>WCF: SOAP with Transport Encryption</dt>
                <dd>
                    <ul>
                        <li>Requires trust relationship between devices: No</li>
                        <li>Blue Prism Authentication Modes: Blue Prism Native</li>
                        <li>Requires server-side certificate: Yes</li>
                        <li>Transport: SOAP over HTTPS</li>
                    </ul>
                    <p>
                        The transport including SOAP headers are encrypted using certificate-based
                        encryption. Server identity is validated using certificates.
                    </p>
                </dd>
                <dt>.NET Remoting: Secure</dt>
                <dd>
                    <ul>
                        <li>Requires trust relationship between devices: Yes</li>
                        <li>Blue Prism Authentication Modes: Blue Prism Native / Single Sign-on</li>
                        <li>Requires server-side certificate: Yes</li>
                        <li>Transport: TcpChannel over SChannel</li>
                    </ul>
                    <p>
                        Provided for backwards compatibility. Encryption is negotiated
                        between the client and server. Client and server identity is
                        validated via Windows / Active Directory.
                    </p>
                </dd>
                <dt>.NET Remoting: Insecure</dt>
                <dd>
                    <ul>
                        <li>Requires trust relationship between devices: No</li>
                        <li>Blue Prism Authentication Modes: Blue Prism Native</li>
                        <li>Requires server-side certificate: No</li>
                        <li>Transport: TcpChannel</li>
                    </ul>
                    <p>
                        Not recommended - provided for backwards compatibility.
                        Connection security will need to be provided entirely by third-party
                        solutions.
                    </p>
                </dd>
                <dt>WCF: Insecure</dt>
                <dd>
                    <ul>
                        <li>Requires trust relationship between devices: Yes</li>
                        <li>Blue Prism Authentication Modes: Blue Prism Native / Single Sign-on</li>
                        <li>Requires server-side certificate: Yes</li>
                        <li>Transport: SOAP over HTTP</li>
                    </ul>
                    <p>
                        Not recommended. Connection security will need to be provided
                        entirely by third-party solutions.
                    </p>
                </dd>
            </dl>
        </dd>
   
		<dt id="config-bind">Host Name or IP Address / IP Address</dt>
		<dd>When a server has multiple network interfaces, you can
		specify which IP address the server should use to listen on
		for connections. When using WCF connection modes, a host name 
		can be used as an alternative to an IP address. </dd>	
		<dd>If this field is left empty, then Blue Prism Server will accept 
		requests on any address.
		</dd>

		<dt id="disable-scheduler">Disable scheduler</dt>
		<dd>With this option checked the server using this configuration will
		not attempt to run any scheduled tasks. This might be useful in multiple
		server environments where a single server is required to be responsible
		for running schedules.</dd>		
		
		<dt id="enable-dashboards">Enable published dashboards</dt>
		<dd>When checked the server will periodically retrieve data for any configured
		<a href="dashboards-ui.htm#Published">Published Dashboards</a> and write the
		results to the Windows Event Log in JSON format for consumption by external applications.</dd>
		
	</dl>
	
	<h4>Certificate Tab (WCF connection modes only)</h4>
	<dl class="bulleted">
	<dt>Certificate Listing</dt>
	<dd>Any certificate bindings found on the machine for the current port
	will be listed on this panel. All bindings for the port are listed so that 
	the user can determine whether they apply to the selected host name or IP Address.</dd>
	<dd>New certificate bindings can be added from this section. Existing certificate bindings
	can be viewed or removed.</dd>	
	
	<h4>Add New Certificate Binding Window (WCF connection modes only)</h4>
	<p>New certificate bindings can be added from the &quot;Certificate&quot; 
	tab.</p>
	<dl class="bulleted">
	<dt>Certificate Binding Address</dt>
	<dd>This section allows you to select whether to add your certificate binding 
	for the current port using a &quot;wildcard&quot; IP address, a specific IP
	address or a host name. Options will vary according to the IP address or hostname
	specified for the server.</dd>
	<dd>Note that operating systems prior to Windows 8 do not support bindings
	using host names. A warning will be displayed and you will need to add a binding using
	the "Any IP address" option instead.</dd>	
	<dt>Local Machine Certificate Store</dt>
	<dd>This allows you to specify the store to select certificates from. In most cases 
	you should use the default &quot;My (Personal)&quot; option. You will be asked to select 
	a certificate from this store after clicking the OK button.</dd>
	</dl></dl>
		
	<h4>Key Store tab</h4>
	<dl class="bulleted">
	<dt>Encryption keys</dt>
	<dd>Any <a href="helpEncryption.htm">Encryption Schemes</a> defined
	within Blue Prism that do not have their associated key held in the
	database, should have their key added to the Server Key Store along
	with the name of the scheme it is associated with.</dd>
	<dd>Once in place, and the Server started, connected Blue Prism clients
	will be able to use the keys to encrypt and decrypt credentials and queue
	item data for this connection.</dd>
	
	<dt>Store keys separately in individual files</dt>
	<dd>When this option is selected the keys themselves are held separately from
	the main server configuration, allowing access to them to be controlled via
	operating system permissions and encryption policies where required. Each key
	will be written to a separate file in the specified folder and named according
	to its associated <a href="helpEncryption.htm">Encryption Scheme</a> name.</dd>
	<dd>It is recommended that the specified folder is only used to hold Blue Prism
	encryption key files. Note that multiple server configurations cannot use the same
	folder.</dd>
	<dd>In the event that the user modifying the server configuration does not have
	read access to one or more of the key files, this option will be disabled to
	prevent accidental key loss.</dd>
	</dl>
	
	<h4>Server Services tab</h4>
	<dl class="bulleted">
	<dt>Windows Services Listing</dt>
        <dd>
            A list of Blue Prism Server Windows services that have been detected on the
            local machine are displayed here. The list only displays services that are associated with the
            configuration being edited. The list includes information about the service setup and
            status.
        </dd>
        <dd>
            In addition, it also includes details of whether the user account that runs the
	        service has permission to listen on the address and port specified for the server 
	        configuration. Clicking the &quot;Manage Permissions&quot; link will open a window where
	        these permissions can be managed.
        </dd>
        <dd>
            If there are no Windows Services detected on the local machine for configuration 
            currently being edited then you can create a new service by clicking the <code>Create Service</code>
            button or by running the example command text displayed on the tab from an elevated
            command prompt.
        </dd>

	
	<h4>Manage URL Permissions Window (WCF connection modes only)</h4>
	<dl class="bulleted">
	<dt>URL Permissions Listing</dt>
	<dd>Any URL permissions found on the machine for the configuration's address and port
	will be listed on this panel.</dd>
	<dd>Note that URL permissions set up for an http URL will not work with a server that uses https and vice versa. It is also not possible to set up separate URL permissions for both http and https URLs (where the URLs are identical other than the http / https part). The listing will include permissions that use both 
	http and https URLs so that the user can see any possible conflicts. </dd>
	<dd>New URL permissions can be added from this section. Existing permissions can be edited
	or removed.</dd>	
	
	<h4>Add / Edit URL Permissions Window (WCF connection modes only)</h4>
	<p>URL permissions can be added or edited from the &quot;Manage URL Permissions&quot; 
	window.</p>
	<dl class="bulleted">
		<dt>URL</dt>
		<dd>This section allows you to select whether to add your URL permission 
		using a &quot;wildcard&quot; IP address or a specific IP address or host 
		used by the server. Available options will vary according to the address 
		specified for the server.</dd>
		<dt>Users</dt>
		<dd>User accounts that are set to run the Windows services detected on the machine 
		(together with other accounts that belong to an existing URL permission when editing) will
		be available to select here.</dd>
	</dl></dl></dl>
	
	<h4>Logging Tab</h4>
	<dl class="bulleted">
		<dt id="config-log">Send Service status messages to Event Log
		</dt>
		<dd>Set checked to log status messages to the windows event log
		for this configuration.</dd>

		<dt id="log-verbose">Log verbose messages</dt>
		<dd>With this option checked all 'marshaled' and 'disconnected' messages
		will be logged to the Windows event log in addition to status messages.</dd>
		
		<dt id="log-traffic">Log traffic detail</dt>
		<dd>When enabled, all calls from clients to remote object instancesn on
		the server are logged. This option is provided for diagnostic purposes only.</dd>
	</dl>
	
	<p>The <code>OK</code> button will commit your changes, and <code>
	Cancel</code> will discard them. Note that the configuration will
	be saved permanently when you click <code>OK</code>.</p>
		
	<h3 id="running">Running BP server</h3>
	<p>The server can be executed directly from the configuration
	program by selecting the desired server configuration details in the
	<code>Configuration</code> drop down and clicking the <code>Start
	</code> button. The server will run until the program is closed, or
	the <code>Stop</code> button is clicked.</p>
	
	<p>Alternatively, it can be executed in the form of a Windows
	Service. Open the <code>Services</code> administrative tool and
	locate the <code>Blue Prism Server</code> entry.</p>
	
	<p>From here, the service can be started or stopped, it can be made
	to start up automatically whenever Windows opens, and it can be
	configured to restart if any errors occur. Note that this will, by
	default, use the configuration named <code>Default</code>. If this
	has been renamed or removed, the service will fail to start.</p>
	
	<h3 id="running-userContext">Running BP server in user context</h3>
	<p>You can choose to run <code>BPServer.exe</code> in user context
	by navigating to the Blue Prism installation directory (usually <code>
	C:\Program Files\Blue Prism Limited\Blue Prism Automate</code>), 
	opening command line and inputting the following:</p>
	
	<pre>BPServer.exe /useropts</pre>
	
	<p>Alternatively, if you choose to execute it in the form of a Windows 
	Service, open the <code>Services</code> administrative tool and
	locate the <code>Blue Prism Server</code> entry. Right click on this entry 
	and select <code>Permissions</code>. From here, in the <code>Start Parameters</code> 
	text box, input the following before starting the service as normal:</p>
	
	<pre>useropts=true</pre>
	
	<h3 id="running-multiple">Running multiple BP Servers</h3>
	<p>You can run multiple Blue Prism Server instances on the same
	machine concurrently, potentially connecting to different databases,
	and serving different clients.</p>
	
	<p>If running from the server configuration program, you can just
	open it multiple times, select different configurations to use and
	start each one independently.</p>
	
	<p>If running as a service, then multiple services must be set up in
	order to enable this.</p>

	<p>A service can be configured using the 'Service Control' program
	from Microsoft. See the <a
	href="http://support.microsoft.com/kb/251192">Microsoft Knowledge
	Base article Q251192</a> for further details regarding the Service
	Control (SC) program.</p>

	<p>Once the required configuration has  been set up in the
	configuration dialog, a service can be registered specifically for
	that configuration by running the command :-</p>
	
	<pre>sc create <span style="color: #088">{SERVICENAME}</span> binPath= "C:\Program Files\Blue Prism Limited\Blue Prism Automate\BPServerService.exe <span style="color:#088">{CONFIGURATIONNAME}</span>"</pre>
	
	<p>where <code style="color: #088">{SERVICENAME}</code> represents
	the name of the service to be used, and <code style="color: #088">
	{CONFIGURATIONNAME}</code> is the name of the server configuration
	that the service should use.</p>

	<p>Note that the lack of space between 'binPath' and the equals
	sign, and the subsequent space between the equals sign and the path
	are important.</p>
	
	<p>If the desired service name contains space characters, it should
	be wrapped in quotes, <i>eg.</i></p>
	
	<pre>sc create <span style="color:#088">"BP Server II"</span> binPath= <i>...etc...</i></pre>
	
	<p>The configuration name should not contain any spaces or quote
	characters in order to be correctly referenced by the service
	control program.</p>

	<h3>Connecting to a BP Server</h3>
	<p>To configure a connection which can communicate with a Blue Prism
	Server instance, see <a href="helpConnections.htm">the Connections
	dialog</a>, available from the <a href="frmLogin.htm">Login</a>
	page of the Blue Prism Client.</p>
	
</body>
</html>
