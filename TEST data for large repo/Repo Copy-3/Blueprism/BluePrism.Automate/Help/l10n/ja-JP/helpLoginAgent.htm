<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link type="text/css" href="AutomateHelp.css" rel="stylesheet"/>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ログインエージェント</title>
    <script type="text/javascript" src="script/imagezoom.js"></script>
    <style type="text/css">
        h3, h4 {
            clear: left !important;
        }

        span.filter {
            color: #666;
            font-weight: bold;
        }

        div.section-screenshot, div.screenshot {
            width: 100px;
        }

        ul.nobullets li, dl.nobullets dt {
            list-style-type: none;
        }
    </style>
</head>

<body class="slick">
    <div class="header">
        <h1 class="pagetitle">ログインエージェント</h1>
    </div>
    <div class="captioned-image overview-screenshot nozoom">
        <a href="Graphics/control-room-with-login-agent-resources.png" title="ログインエージェントランタイムリソースを表示しているコントロールルーム">
            <img src="Graphics/control-room-with-login-agent-resources.png" alt="ログインエージェントランタイムリソースを表示しているコントロールルーム"/>
        </a>
    </div>
    <p> Blue Prismログインエージェントは、Windowsデバイスでセキュアなログインを実行できるメカニズムを提供することによって、Blue Prismランタイムリソースの機能を拡張するコンポーネントです。</p>
    <p>ログインエージェントは、次の目的で、原則的にランタイムリソースを許可します。
    </p>
    <ul>
        <li>デバイスをWindowsにログインする前に指示を受け取るため（例：デバイスがプレログイン状態にあるとき）</li>
        <li>認可情報をオペレーティングシステムに送信し、ローカルまたはネットワークの認証情報を使用してデバイスにログインするため</li>
        <li>パスワードのリセットなどの追加アクションを実行するため</li>
    </ul>
    <p>ログインエージェントは、Windowsログオンを実行するためにオペレーティングシステムと通信できる専用のログインエージェントランタイムリソースを開始する役割を持ったWindowsサービスを作成および構成します。
    </p>
    
    <p>ログインエージェントランタイムリソースは、コントロールルーム内に専用アイコンを使って表示されます。</p>
    
    <p>適切に構成されると、マシンがプレログイン状態にあるときはいつでもログイン エージェント ランタイム リソースが開始され、デバイスにログオンし、従来型Blue Prismランタイム リソースが開始されるまでアクティブ状態が維持されます。ログイン エージェント ランタイム リソースは、Blue Prismランタイム リソースのスタートアップによって、自動的にシャットダウンされます。</p>
    <div class="Highlighted" style="background-color: lightgrey"><p><font color="black">
 ログインエージェントランタイムリソースはアクセスが制限されたアカウントで動作し、ローカルマシンへのフルアクセスはありません。
 そのため、ログインアクションを実行するためにのみ使用できます。</font> 
</p></div>  
<h2>ログインエージェントをインストールする</h2>   
    <h3>前提条件</h3>
    <p>WindowsデスクトップOS：XP、Vista、7、8.1、10（32ビットおよび64ビット） </p>
    <p>Windows Server OS：2008、2008 R2、2012、2012 R2（32ビットおよび64ビット）</p>
    <p>ログインエージェントをインストールするには管理者アクセス権が必要です。</p>
    <p> 対象デバイスに次のセキュリティポリシーを適用することが不可欠です。</p> 
  
    <ul>
        <li>ユーザー名とパスワードフィールドが表示される前にCtrl + Alt + Delを押すという要件があってはなりません。</li>
        <li>ログイン プロセスの一部として、利用規約など、画面上にメッセージを表示するという要件があってはなりません。</li>
        <li>ロック画面を表示するという要件があってはなりません（Windows 8.1およびWindows 10）。</li>
    </ul>
    <p>
 ログインエージェントをインストールすると、これらがデバイス上のローカルポリシーに適用されますが、企業ネットワーク内では変更を一元的に適用する必要があります。
    </p>

    <h3>ログインエージェントをインストールする</h3>
    <div class="captioned-image overview-screenshot">
        <img src="Graphics/login-agent-installer-connection-name.png" alt="Blue Prism接続名を選択する"/>
    </div> <p>ログインエージェントのインストーラーは、Blue Prismのインストールディレクトリにあります。
対象デバイスのCPUアーキテクチャと一致するインストールファイルを選択する必要があります。
</p>
    <p>32ビットオペレーティングシステムの場合は<code> [Blue Prism Location]\Installers\LoginAgent_x86.msi</code></p>
    <p>64ビットオペレーティングシステムの場合は<code> [Blue Prism Location]\Installers\LoginAgent_x64.msi</code></p>
 <p>インストール手順の一部として、ローカルデバイス上の既存のBlue Prism接続名と完全に一致する接続名を指定する必要があります。</p>   
    <p>現在構成済みの接続のリストは、Blue Prismクライアント内で見られます（画像）</p>
    
<h3>ログインエージェントのサンプルプロセスとビジネスオブジェクト</h3>   
  <p>ログインエージェントが必要なデバイスにデプロイされたら、ログインエージェントリリースパッケージ（ログインエージェントインストールディレクトリ内の<code>Login Agent Release.bprelease</code>）を環境にインポートできます。これは、任意の単一のデバイスで［ファイル］ -> ［インポート］メニューオプションを使用して実現されます。すべての関連Blue Prism環境に対して1回だけ完了すればいいように、データはデータベースにコピーされます。</p>   

<p>提供されている2つのサンプルプロセス（ログインとパスワード変更）では、各デバイスに認証情報レコードを作成する必要があります。これらの認証情報レコードは、デフォルトの命名形式<code>Windows Login:  [MachineName]</code> を使用して作成する必要があります。たとえば、ランタイムリソースがポート8190のrobot0001に構成される場合、デフォルトの認証情報名は<code>Windows Login: robot0001</code>にする必要があります。</p>
    <p>このVBOでは、ログイン、ログイン済み、ログアウト、パスワード変更など、オペレーティングシステムとの共通認証アクションを実行するために使用できる一連のサンプルアクションが提供されます。</p>
    <p>ログインエージェントVBOに関する情報とそのアクションは、［ヘルプ］ > ［APIドキュメント］の下にある［APIドキュメント］にあります。</p>
    <div class="Highlighted" style="background-color:lightgrey">
        <p><font color="black">ログイン エージェントVBOの既存バージョンを上書きするときは、提供された機能を使うプロセスを再検証する必要があります。</font>  </p></div>

    <h2>上級者向けトピック</h2>
    <h3>ログインエージェント構成の更新やカスタマイズを行う</h3>
    <p>ログイン エージェント ランタイム リソースの初期化を担当するBlue Prismログイン エージェント サービスは、以下のローカル構成ファイル内に保存されています。</p>
    <p><code>C:\ProgramData\Blue Prism Limited\Automate V3\LoginAgentService.config</code></p>
    <p><code>workingdirectory</code>要素は、Blue Prismソフトウェアのインストールディレクトリを示します。</p>
    <div class="captioned-image section-screenshot">
        <img src="Graphics/login-agent-config.png" alt="ログインエージェントを構成する"/>
    </div><p>
 <code>startuparguments</code>要素は、ログインエージェントランタイムリソースを起動するときに使用される引数を提供します。
 たとえば、このセクションは、ランタイムリソースがリッスンするポート、または環境への接続に使用する接続名を更新するように構成できます。
    </p>
        
    
        <h3>証明書ベースの暗号化で構成されるリソース</h3>
        <p>
            <div class="captioned-image section-screenshot  ">
                <img src="Graphics/login-agent-config-2.png" alt="証明書ベースの暗号化を構成する"/>
            </div>

            <div class="captioned-image section-screenshot   ">
                <img src="Graphics/login-agent-config-3.png" alt="証明書ベースの暗号化を構成する"/>
            </div>
 従来型ランタイム リソースが、指定された証明書を使用して着信接続の暗号化を強制するよう構成される場合（例：ランタイム リソースが/sslcertスイッチを使って開始される場合）、ログイン エージェント ランタイム リソースに適切な構成を手動で適用する必要があります。
        </p>

        <p>
 以下のように、構成ファイル内の<code>startuparguments</code>要素は、適切な情報を含めるように更新できます。
        </p>
       
    <h3>サイレントインストール</h3>
    <p>
 サイレントインストールはmsiexecを使用して実現できます。
 CPUアーキテクチャに対して正しいインストーラーが選択されているのを確認することが重要です（x86は32ビットオペレーティングシステム用、x64は64ビットオペレーティングシステム用）。
    </p>
    <p>次のパラメーターを指定する必要があります。</p>
    <ul>
        <li><b>[Blue Prism Install Location]</b>：Blue Prismがインストールされている場所です。これは通常、ログインエージェントインストールファイルがある場所です。</li>
        <li><b>[Connection Name]</b>：これはローカルデバイス上の既存のBlue Prism接続名と正確に一致する必要があります。デバイスで現在構成済みの接続のリストは、Blue Prismクライアント内にあります。</li>
    </ul>
    <p>例（32ビットインストール）：</p>
    <p><code>msiexec /i "[Blue Blue Install Location]\Installers\LoginAgent_x86.msi " /quiet BPCONN="[Connection Name]"</code></p>
    <p>例（32ビットインストール）：</p>
    <p><code>msiexec /i "c:\Program Files\Blue Prism Limited\Blue Prism Automate\Installers\LoginAgent_x86.msi " /quiet BPCONN="Prod:  Financial Services"</code></p>
    
    <p>例（64ビットインストール）：</p>
    <p><code>msiexec /i "[Blue Blue Install Location]\Installers\LoginAgent_x86.msi " /quiet CONNECTIONNAME="[Connection Name]"</code></p>
    <p>例（64ビットインストール）：</p>
    <p><code>msiexec /i "c:\Program Files\Blue Prism Limited\Blue Prism Automate\Installers\LoginAgent_x86.msi " /quiet CONNECTIONNAME="Prod:  Financial Services"</code></p>

    <h3>ロギングを設定する</h3>
   
    <p>ログインエージェントは、適切なレジストリキー設定を構成することによって、特定デバイスの診断ログを生成するよう構成できます。</p>
    <p>ログインエージェントの適切なバージョンのキーは、以下の場所のレジストリ内にあります。</p>
    <p><code>HKEY_LOCAL_MACHINE\SOFTWARE\Blue Prism Limited\LoginAgent</code></p>
    <ul>
        <li><b>LogFileDir</b>：ログファイルが生成される場所を指定します。</li>
        <li><b>LogLevel:</b> ログの粒度を 「 0：無効（デフォルト）、1：エラーメッセージ、2：デバッグメッセージ、4：トレースメッセージ」と指定します。レベルを組み合わせるために、値を合計することができます。たとえば、7という値でエラーメッセージ、デバッグメッセージ、トレースメッセージを得られます。</li>
    </ul>
    <div class="Highlighted" style="background-color:lightgrey">
        <p><font color="Black">
 ロギングは、トラブルシューティング中のみ推奨します。
 レジストリ設定変更を適用するには、デバイスを再起動する必要があります。
          </font>
        </p>
    </div>
</body>
</html>
