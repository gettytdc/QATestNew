<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link type="text/css" href="AutomateHelp.css" rel="stylesheet" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>故障排除—大型机集成</title>
	<script type="text/javascript" src="script/imagezoom.js"></script>
</head>

<body class="slick troubleshooting">
	<div class="header">
		<h1 class="pagetitle">故障排除</h1>
		<h2>大型机集成</h2>
	</div>
	
	<h3>简介</h3>
	<p>此页面提供在 Blue Prism 中使用大型机自动化的一些常见问题和建议的解决方法</p>

	<h5>启动大型机应用程序会导致出现错误消息，类似于：“无法加载 DLL‘LLLAPI32.DLL’：找不到所指定的模块”</h5>
	
	<p>这是因为大型机安装没有将其安装目录添加到 Windows <code>PATH</code> 环境变量。</p>
	
	<p>要解决此问题，请在 Windows“控制面板”中打开“系统属性”<code></code>，进入“高级”<code></code>，点击“环境变量”<code></code>按钮，然后将包含引用文件的目录的路径追加到 PATH 变量，以分号为前缀。</p>
	
	
	<h5>当我的流程完成/重置时，我的大型机应用程序退出</h5>

	<p>Blue Prism 可视业务对象访问大型机时，它会通过终端仿真程序打开到该大型机的连接，并通过该仿真程序处理任何通信。</p>
	
	<p>当使用 VBO 的流程完成或重置时，VBO 将关闭它在终端仿真程序中打开的连接。</p>
	
	<p>一些仿真程序将让大型机连接和相应的窗口保持打开状态，但是一些（特别是一些 EHLLAPI 仿真程序）将自行关闭、切断与大型机的连接，作为其断开连接流程的一部分。如果流程没有正常将其注销，这可能会使用户保持登录到大型机会话的状态。</p>
	
	<p>解决此问题的一种方法是单独启动仿真程序并使用 VBO 中的相应操作将其附加到仿真程序。这可确保在重置 VBO 时不终止大型机会话。</p>
	
	<p>另一种方法是在应用程序参数中设置附加 <a href="helpApplicationParameters.htm#Options">nodisconnect 选项</a>。</p>

	<p>或者，应注意确保会话在 VBO 的<a href="helpInitAndCleanup.htm#cleanup">清理</a>页面中注销。</p>

	<h5>设置光标位置不起作用</h5>

	<p>即使终端仿真程序 API 支持设置光标位置，基础大型机应用程序也可能不支持。在这种情况下，可能根本不会注意到光标移动，或者虽然光标可能会移动，但后续文本输入会将其恢复到之前的位置。此行为由应用程序自身定义，不能更改。</p>

	<h5>附加到现有会话。</h5>

	<p>只有基于 (E)HLLAPI 的终端仿真程序允许附加到现有会话。在 Blue Prism 和大型机应用程序（有时称为短名称）中设置会话标识符后，您可以使用导航环节中的附加操作附加到现有会话。</p>

	<h5>在同一资源上同时运行两个会话时出现意外结果。</h5>

	<p>无法使用任何基于 (E)HLLAPI 的终端仿真程序在同一 Windows 进程中模拟运行多个会话。这是 API 自身的设计限制。</p>

	<p>有两种方法可以解决这个问题。您可以使用两个（或更多）单独的资源 PC 实例，并在这些实例上运行这些流程。从 V4.2 开始，更简单的解决方案是使用任何外部流程模式选项（通过应用程序建模器设置），使应用程序管理器作为相关业务对象的单独 Windows 进程运行。</p>

    <h5>Attachmate Reflection (.NET API)</h5>

    <p>要使用 Reflection .NET API，必须选择 Reflection 安装程序中的<b>应用程序编程接口</b>组件。请参阅终端仿真设置支持指南，了解更多详细信息。</p>

    <h5>IBM Personal communicator—国际考虑因素</h5>

    <p>使用具有双字节字符集 (DBCS) 的 IBM Personal communicator 时。可以在 .ws 会话文件中配置显示 Shitf-In/Shift-Out 字符的选项。<ul>
            <li>如果 .ws 文件中的 SoSiToSpace=Y，那么 SO/SI 将转换为空格 (0x20)</li>
            <li>如果 .ws 文件中的 SoSiToSpace=N ，那么 SO/SI 转换为等效的 SO/SI (0x0e/0x0f)</li>
            <li>如果未设置 SoSiToSpace 变量，则将其视为 SoSiToSpace=N</li>
        </ul>SoSiToSpace 值需要放在 ini 文件的 [DBCS] 部分下。建议使用 Windows 记事本以外的文本编辑器编辑该文件，因为如果文件包含非 asci 数据，则记事本可能会损坏该文件。</p>
    <p>示例：</p>
    <ul>
        <li>[DBCS]</li>
        <li>SoSiToSpace=Y</li>
    </ul>
    <div class="captioned-image section-screenshot">
    <a title="配置 .ws 会话文件—点击查看大图" href="Graphics/example-ws-sessionfile.png">
    <img src="Graphics/example-ws-sessionfile.png" alt="配置 .ws 会话文件—点击查看大图"/></a>
    </div>
    

