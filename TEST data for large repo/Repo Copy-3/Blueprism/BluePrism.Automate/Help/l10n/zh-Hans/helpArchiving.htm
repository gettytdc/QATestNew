<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link type="text/css" href="AutomateHelp.css" rel="stylesheet" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>存档</title>
	<script type="text/javascript" src="script/imagezoom.js"></script>
</head>

<body class="slick">
	<div class="header">
		<h1 class="pagetitle">Blue Prism</h1>
		<h2>存档</h2>
	</div>

	<h3 id="overview">概述</h3>

	<p>Blue Prism 提供了一个存档工具，可确保数据库服务器持续高效地运行，并为所有活动保留完整且准确的记录。存档操作会将会话日志数据从数据库传输至文件结构，以释放数据库空间并使旧数据能够永久存档。已存档的数据也可随时恢复到数据库中。</p>

	<p>存档时有三种机制可供选择—两种机制会通过手动方式来启动存档，还有一种机制则会针对正在运行的资源启动一个自动化后台任务。</p>
	<dl class="listplease">

		<dt><a href="#manual">系统管理器接口</a></dt>
		<dd>在这一运行模式下，您能以各种详细程度级别（例如，按照天、月、流程、PC）准确地选择特定的会话日志并将其存档。同样，您也可以恢复所选的日志</dd>

		<dt><a href="#commandline">命令行接口</a></dt>
		<dd>使用这一方法可以轻松地设置计划任务，以进行定期存档。例如，您可能决定要存档 6 个月之前的日志，而且每晚都要执行一次该操作。</dd>

		<dt><a href="#automatic">自动存档</a></dt>
		<dd>可以指定已注册的资源自动地定期归档会话日志。此项设置会在资源运行时进行全天候检查，并根据需要在后台进行存档。</dd>
	</dl>

	<h3 id="manual">手动存档日志</h3>

	<p>手动存档操作的配置和执行只针对于单台计算机—也就是说，如果更改某台计算机上的存档目录，则只有这台计算机上的本地目录会发生变化。</p>

	<ul>
		<li>以<a href="helpUserPermissions.htm">有权</a>访问<a href="frmSystemManager.htm">系统管理器</a>的 Blue Prism 用户的身份进行登录。</li>

		 <li>进入系统管理器的“系统”部分，并访问“存档”选项卡。</li>

		<li>对于“存档文件夹”，请使用“浏览”按钮来选择要用于存储日志的目录。注意： Blue Prism 需要这个目录的读取和写入权限，而且（例如，如果是映射的网络驱动器）这个位置在您想要进行存档时要可供访问（即，需要启动托管这个目录的远程计算机）。</li>

		<li>您可以使用“保存”按钮将所选目录保存到本地 PC 的配置文件中，以便系统在您下次存档时记得使用这个目录。命令行存档操作也将使用这个已保存的目录。</li>

		<li>请在右侧的“数据库”树视图中选中相应的叶节点，以选择您想要存档的日志。</li>

		<li>检查您在右侧树视图中所选的节点，然后点击“存档”按钮（存档进度会通过进度条来指明）。</li>

		<li>验证您所选的日志是否已出现在左侧的“存档”树视图中。</li>
	</ul>

	<h3 id="commandline">命令行存档</h3>

	<p>存档操作可以通过在命令行中使用 <code>AutomateC</code> 程序来执行。</p>

	<p>请参阅<a href="helpCommandLine.htm">命令行选项</a>帮助，以全面了解各个可用选项。</p>

	<p>如果某个计划存档任务无需使用正在运行的可用资源，则可通过在 Windows 计划任务中调用命令行存档命令来执行这个计划存档任务。</p>

	<p>例如，以下命令将会存档某个单点登录环境中的早于六个月之前的所有日志。</p>

	<pre>AutomateC /archive /sso /age 6m</pre>

	<p>通过命令行进行存档和恢复时，系统会使用您在系统管理器界面中所选的存档文件夹。如果需要，您还可以通过命令行选项直接设置存档文件夹。</p>

	<h3 id="automatic">自动存档</h3>

	<p>自动存档可在会话日志存在超过指定时长后执行存档操作，以确保日志永远不会过大。</p>

	<p>它会让正在运行的已注册资源全天候定期检查是否存在任何在指定日期/时间之前结束的会话日志，并在找到此类日志时予以存档/删除。</p>

	<p>您可以在系统管理器中启用和配置这种存档方式，具体的操作位置和<a href="#manual">手动存档</a>相同。</p>

	<p>按下“切换到自动模式”<code></code>按钮即可启用自动模式。系统将会显示特定于此模式的选项。</p>

	<dl class="listplease">
		<dt>资源</dt>
		<dd>详细显示应该负责运行自动存档后台任务的资源。</dd>

		<dt>模式</dt>
		<dd>可以将日志存档至资源的本地文件夹（日后可将存档恢复到数据库中），或者直接删除日志数据。</dd>

		<dt>存档文件夹</dt>
		<dd>资源应将所存档会话日志写入到的目标文件夹。请注意，这个路径必须是将要运行存档操作的资源上的本地路径，这样指定的资源才能访问这个路径（例如，路径为 <code>C:\logs\BluePrism\sessions</code> 的文件夹），否则存档操作将会失败。</dd>
		<dd>如果已配置的模式指明日志应该直接删除，则无需设置此字段。</dd>

		<dt>存档旧于</dt>
		<dd>可以指定要存档多久之前的日志。存档操作将尝试存档<em>结束时间</em>早于指定时限的所有会话日志。</dd>
		<dd>请注意，某些调试会话可能没有具体的结束日期，所以自动存档操作不会将其纳入存档范围。这些会话必须<a href="#manual">通过手动方式</a>进行存档。</dl>

	<h3 id="restore">恢复日志</h3>

	<p>日志只能通过手动方式从存档目录恢复到数据库中。请注意，如果您启用了“自动存档”，并恢复了早于指定存档时限的日志，那么系统将在下一次进行自动存档时重新存档这些日志。在这种情况下，您可能会想要暂时禁用“自动存档”。</p>

	<p>具体的操作步骤如下所示：</p>

	<ul>
		<li>按照<a href="#manual">手动存档</a>部分所述，进入系统管理器的“存档”区域并选择正确的“存档文件夹”。</li>

		<li>在左侧的“存档”树中勾选相应的条目，以选择您想要恢复的日志。</li>

		<li>点击“恢复”<code></code>按钮。</li>

		<li>验证您所选的日志是否已出现在右侧的“数据库”树视图中。</li>
	</ul>

	<p><strong>注意： </strong>获取自其他环境的会话日志无法恢复—必须存在相同的流程、资源和用户，日志才能正确恢复。</p>

	<h3 id="view">查看数据库中和已存档的日志</h3>

	<p>如果想要查看数据库中或已存档的任意日志，可以在系统管理器中进行相应操作。</p>

	<ul>
		<li>按照<a href="#manual">手动存档</a>部分所述，进入系统管理器的“存档”区域。</li>

		<li>查找并选择想要查看的日志。请注意，无需勾选相应条目，只需通过点击条目标签来选择条目。两个树中的条目均可选择。</li>

		<li>点击“查看日志”<code></code>或“查看文件”<code></code>按钮，以便相应地查看所选的日志或文件。</li>
	</ul>
	
	<div class="captioned-image screenshot">
		<img src="Graphics/release-archive-lock.png" alt="释放存档锁"/>
	</div>
	<h3 id="releaselock">释放存档锁</h3>
	
	<p>如果资源存档操作在执行期间因某些原因而宣告失败，这可能是因为数据库处于锁定状态，从而导致资源在重新启动后无法继续进行存档。这类资源可能会报告错误，如“存档失败—该计算机已在执行存档流程”<i></i>。如果出现这种情况，系统管理员（或有权访问“存档”屏幕的用户）可以使用菜单按钮上的选项手动释放存档锁。</p>

</body>
</html>
