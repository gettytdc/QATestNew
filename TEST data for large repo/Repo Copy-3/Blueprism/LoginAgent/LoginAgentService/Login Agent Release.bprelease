<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>Login Agent Release</bpr:name>
    <bpr:release-notes>Logout action now shuts down the resourcepc as soon as the session ends.</bpr:release-notes>
    <bpr:created>2019-06-11 12:56:53Z</bpr:created>
    <bpr:package-id>1</bpr:package-id>
    <bpr:package-name>Login Agent Release</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="9">
        <process id="11b51477-dd7f-445b-8a4c-361cc14e4c5e" name="Change Password" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Change Password" version="1.0" bpversion="6.0.0.0" narrative="Changes the password for the target resource, storing the new password back in the credential" byrefcollection="true"><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><stage stageid="d55d6ca1-fd61-496f-99a5-4fa58e756754" name="Start" type="Start"><narrative></narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>60c00151-4664-43dd-a741-920a631b0c6f</onsuccess></stage><stage stageid="1ad504c6-6f38-44a9-a2de-33c7fa297227" name="End" type="End"><narrative></narrative><displayx>15</displayx><displayy>300</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1f08c301-ae6c-43aa-81d5-7d7a0ed8e205" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="bcdeeb9d-c7dd-4487-a154-65f2acd21389" name="Get Current Credentials" type="Action"><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><displayx>15</displayx><displayy>45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials to get" expr="[Credential Name]" /></inputs><outputs><output type="text" name="Username" narrative="The user name" stage="Username" /><output type="password" name="Password" narrative="The password" stage="Old Password" /></outputs><onsuccess>558b9152-125d-4620-864e-620629172f72</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="5bc11b3c-d698-433a-bc00-2b97ca5e7fa3" name="Credential Name" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a3234d50-0628-4d69-a2f1-9f8337ddb171" name="Get Credential Name" type="Action"><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Credential Name" narrative="The name of the credential for this machine" stage="Credential Name" /></outputs><onsuccess>bcdeeb9d-c7dd-4487-a154-65f2acd21389</onsuccess><resource object="Login Agent" action="Get Credential Name" /></stage><stage stageid="ec785d69-aef8-420d-b38d-27d71f27dd6d" name="Username" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f476514d-bd2b-4fe5-bda5-6a7ed15f75f2" name="Old Password" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="60c00151-4664-43dd-a741-920a631b0c6f" name="Check Logged In" type="Action"><narrative></narrative><displayx>15</displayx><displayy>-90</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Logged In" stage="Logged In" /></outputs><onsuccess>0e088825-9b49-4bd5-bb3d-0a8bcfd95ee0</onsuccess><resource object="Login Agent" action="Is Logged In" /></stage><stage stageid="aec4e634-2e25-4088-a3d8-de4daf95b3ca" name="Logged In" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0e088825-9b49-4bd5-bb3d-0a8bcfd95ee0" name="Is Logged In?" type="Decision"><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Logged In]" /><ontrue>a3234d50-0628-4d69-a2f1-9f8337ddb171</ontrue><onfalse>c4d6b82b-c703-41e6-a83c-2d0e48b21f79</onfalse></stage><stage stageid="558b9152-125d-4620-864e-620629172f72" name="Change Password on Credential" type="Action"><narrative>Set the specified credentials, with a random password.

An Exception will occur if access to these credentials is not allowed (based on the running Resource, Process and User). If the credentials are currently invalid they will be marked as valid.</narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Username" narrative="The user name" expr="[Username]" /><input type="number" name="Length" narrative="The length of the password, must be between 1 and 20" expr="[Length]" /><input type="flag" name="Use Upper Case" narrative="Whether to use upper case letters" expr="[Upper]" /><input type="flag" name="Use Lower Case" narrative="Whether to use lower case letters" expr="[Lower]" /><input type="flag" name="Use Numeric" narrative="Whether to use numeric characters" expr="[Numeric]" /><input type="text" name="Additional Characters" narrative="Any additional characters, one of which should be used at least once. All characters given in this argument must be unique" expr="&quot;&quot;" /></inputs><onsuccess>d62c9cba-559e-4ba0-b09f-fc59da81dcd2</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Generate and Set" /></stage><stage stageid="f7bcd4f3-1ee4-499c-95dd-547a07bb724c" name="New Password" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="592192f4-4c34-4a7f-ab9e-16b7440c7614" name="Length" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>20</initialvalue><private /><alwaysinit /></stage><stage stageid="b8831587-b0b0-453c-a4ed-4eae54b84bd1" name="Upper" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>195</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="0a4cf776-7907-4824-a134-1e7d487fee21" name="Lower" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>225</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="488eb35d-9367-4720-ae88-2b819708e396" name="Numeric" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>255</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="e53111b5-996d-47a8-91f9-6ebcabc19537" name="Password Constraints" type="Block"><narrative></narrative><displayx>-255</displayx><displayy>120</displayy><displaywidth>120</displaywidth><displayheight>165</displayheight><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="d62c9cba-559e-4ba0-b09f-fc59da81dcd2" name="Get New Credentials" type="Action"><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><displayx>15</displayx><displayy>135</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials to get" expr="[Credential Name]" /></inputs><outputs><output type="text" name="Username" narrative="The user name" stage="Username" /><output type="password" name="Password" narrative="The password" stage="New Password" /></outputs><onsuccess>2cb14879-f9fa-42e2-a5de-dd313f518aef</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="2cb14879-f9fa-42e2-a5de-dd313f518aef" name="Change Password on Windows" type="Action"><narrative></narrative><displayx>15</displayx><displayy>195</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="password" name="Old Password" expr="[Old Password]" /><input type="password" name="New Password" expr="[New Password]" /></inputs><onsuccess>1ad504c6-6f38-44a9-a2de-33c7fa297227</onsuccess><resource object="Login Agent" action="Change Password" /></stage><stage stageid="ae89a931-dae5-4a12-9f0a-39f881264b17" name="Recover" type="Recover"><narrative></narrative><displayx>105</displayx><displayy>195</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>40aff166-49a0-48e1-9858-5411a56928b1</onsuccess></stage><stage stageid="51d12aa2-77d9-4926-80df-a243c4930682" name="Update On Win" type="Block"><narrative></narrative><displayx>-60</displayx><displayy>165</displayy><displaywidth>375</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="5676abbd-3eca-4e2b-a09e-bc8cd250667a" name="Note1" type="Note"><narrative>If this fails, we need to reset the credential to its old value</narrative><displayx>225</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="40aff166-49a0-48e1-9858-5411a56928b1" name="Reset Password on Credential" type="Action"><narrative>Set the specified credentials.

An Exception will occur if access to these credentials is not allowed (based on the running Resource, Process and User). If the credentials are currently invalid they will be marked as valid.</narrative><displayx>105</displayx><displayy>255</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials to set" expr="[Credential Name]" /><input type="text" name="Username" narrative="The user name" expr="[Username]" /><input type="password" name="Password" narrative="The password" expr="[Old Password]" /></inputs><onsuccess>4d9dfe53-4b0e-45b4-8b8f-e0cd6e9d7116</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Set" /></stage><stage stageid="4d9dfe53-4b0e-45b4-8b8f-e0cd6e9d7116" name="REFAIL" type="Exception"><narrative></narrative><displayx>195</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception localized="yes" type="" detail="" usecurrent="yes" /></stage><stage stageid="c4d6b82b-c703-41e6-a83c-2d0e48b21f79" name="FAIL" type="Exception"><narrative></narrative><displayx>105</displayx><displayy>-45</displayy><displaywidth>30</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="Invalid Login State" detail="&quot;The machine must be logged in to change the password on it&quot;" /></stage></process></process>
        <process id="fe175ce9-5b01-440e-8d92-a26685b7384f" name="Check Logged In" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Check Logged In" version="1.0" bpversion="6.0.0.0" narrative="Checks if the given resource is logged in or not. The state can be checked by looking at the log after the session has finished" byrefcollection="true"><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><stage stageid="7b8ab1af-7129-49fb-83f8-eb0d315e11dd" name="Start" type="Start"><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>881396ed-8a5a-4728-9ef6-23b17795cf28</onsuccess></stage><stage stageid="fcaad6cf-b639-4d6e-8e58-fc517dcce3ee" name="End" type="End"><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="165b8383-782d-43ea-9896-f133ad89e85c" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="881396ed-8a5a-4728-9ef6-23b17795cf28" name="Check Logged In" type="Action"><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Logged In" stage="Logged In" /></outputs><onsuccess>fcaad6cf-b639-4d6e-8e58-fc517dcce3ee</onsuccess><resource object="Login Agent" action="Is Logged In" /></stage><stage stageid="afbf6336-6f8a-4f2c-a719-c3c77952e1d3" name="Logged In" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage></process></process>
        <process id="740feb4a-58b8-4376-931b-0197f16920c3" name="Login" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Login" version="1.0" bpversion="6.0.0.0" narrative="Logs into the target resource using the credential for the machine as specified in the environment variable &quot;Login Format String&quot;" byrefcollection="true"><view><camerax>0</camerax><cameray>-11</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><stage stageid="dc8e4faa-326c-461d-89b2-9d965b7dd09a" name="Start" type="Start"><narrative></narrative><displayx>15</displayx><displayy>-150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Login Locally" narrative="Flag indicating if the login should be performed onto a local Windows account (True) or using a domain login (False)" stage="Login Locally" /><input type="text" name="Domain" narrative="The name of the domain to authenticate with. Ignored if 'Local' is true; If blank will use the domain that the machine is a member of" stage="Domain" /><input type="flag" name="Send Secure Attention Sequence" narrative="Flag indicating if the the Secure Attention Sequence (CTRL +ALT + DELETE) should be sent" stage="Send Secure Attention Sequence" /></inputs><onsuccess>b603824c-a2c6-43b0-bf59-9c89ee17a7f0</onsuccess></stage><stage stageid="741ae93c-0151-4a34-a5e1-613dda34b7cc" name="End" type="End"><narrative></narrative><displayx>15</displayx><displayy>195</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5cfd7575-4993-48e7-9c88-e564bb8f48d5" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="501fc692-4ee3-45dd-9e9a-451687d1f36a" name="Log In" type="Action"><narrative></narrative><displayx>15</displayx><displayy>150</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Username" narrative="The username to use to authenticate to windows" expr="[Username]" /><input type="password" name="Password" narrative="The password to use to authenticate to Windows" expr="[Password]" /><input type="flag" name="Local" narrative="True to authenticate using local machine authentication; False to use domain authentication" expr="[Login Locally]" /><input type="text" name="Domain" narrative="The name of the domain to authenticate with. Ignored if 'Local' is true; If blank will use the domain that the machine is a member of" expr="[Domain]" /></inputs><onsuccess>741ae93c-0151-4a34-a5e1-613dda34b7cc</onsuccess><resource object="Login Agent" action="Log In" /></stage><stage stageid="f4c9f6a4-1617-4614-ae40-dfd54fb36569" name="Username" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7c88eec7-daad-4824-b91e-a7a50e829921" name="Password" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="5104ed46-c516-40dd-9d8a-7b7583edbd2d" name="Get Credentials" type="Action"><narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials to get" expr="[Credential Name]" /></inputs><outputs><output type="text" name="Username" narrative="The user name" stage="Username" /><output type="password" name="Password" narrative="The password" stage="Password" /></outputs><onsuccess>501fc692-4ee3-45dd-9e9a-451687d1f36a</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get" /></stage><stage stageid="ca7fd240-2fe1-463c-8ae9-0294a3471759" name="Get Credential Name" type="Action"><narrative></narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Credential Name" narrative="The name of the credential for this machine" stage="Credential Name" /></outputs><onsuccess>5104ed46-c516-40dd-9d8a-7b7583edbd2d</onsuccess><resource object="Login Agent" action="Get Credential Name" /></stage><stage stageid="36e5c40c-e98b-4e4b-9046-02c4ddfa091e" name="Credential Name" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="56e8e3e7-2e8a-494a-af96-12b420283956" name="Login Locally" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="d6cb06ef-05cc-4535-9d90-f5d3a8ff712a" name="Domain" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b603824c-a2c6-43b0-bf59-9c89ee17a7f0" name="Check Logged In" type="Action"><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Logged In" stage="Logged In" /></outputs><onsuccess>86ba1da9-ebc7-445d-acd6-17680b549977</onsuccess><resource object="Login Agent" action="Is Logged In" /></stage><stage stageid="86ba1da9-ebc7-445d-acd6-17680b549977" name="Is Logged In?" type="Decision"><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Logged In]" /><ontrue>ae62da09-7059-4326-8199-69a049220ea0</ontrue><onfalse>bdd1aa51-d7bd-4c1b-8083-1fe9cc5aae18</onfalse></stage><stage stageid="ae62da09-7059-4326-8199-69a049220ea0" name="FAIL" type="Exception"><narrative></narrative><displayx>105</displayx><displayy>-45</displayy><displaywidth>30</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="Invalid Login State" detail="&quot;The machine must be logged out to accept a login request&quot;" /></stage><stage stageid="a4e5771a-1f53-4483-aaf9-627e36507201" name="Logged In" type="Data"><narrative></narrative><displayx>150</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="20666209-d556-4920-a721-05e951f480b5" name="Send SAS" type="Action"><narrative></narrative><displayx>120</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>ca7fd240-2fe1-463c-8ae9-0294a3471759</onsuccess><resource object="Login Agent" action="Send Secure Attention Sequence" /></stage><stage stageid="947d08f8-e755-4dda-8c76-27e384caf297" name="Send Secure Attention Sequence" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="bdd1aa51-d7bd-4c1b-8083-1fe9cc5aae18" name="Send SAS?" type="Decision"><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Send Secure Attention Sequence]" /><ontrue>20666209-d556-4920-a721-05e951f480b5</ontrue><onfalse>ca7fd240-2fe1-463c-8ae9-0294a3471759</onfalse></stage></process></process>
        <process id="1c808a33-3c5a-4c88-a189-1c2b07968d01" name="Logout" published="true" xmlns="http://www.blueprism.co.uk/product/process"><process name="Logout" version="1.0" bpversion="6.0.0.0" narrative="Logs off the affected resource such that it returns to the login prompt" byrefcollection="true"><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><stage stageid="0f2fedaa-4133-4307-b823-6c5b82be187f" name="Start" type="Start"><narrative></narrative><displayx>-60</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="timespan" name="Delay" narrative="The amount of time to wait after receiving the logout command for the affected resource to log out" stage="Logout Delay" /><input type="flag" name="Force" narrative="Flag indicating if the logout should be forced - ie. if all open / unsaved documents should be forced closed, then the logout performed. Default is 'True'." stage="Force" /></inputs><onsuccess>1d3a3e32-96db-4ec1-84ff-c4b344481347</onsuccess></stage><stage stageid="1e575b0c-7b9f-4c63-a376-8582dd8f27f2" name="End" type="End"><narrative></narrative><displayx>-60</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="2fe558d7-01da-4aa0-8084-dd6a06e31e6f" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1d3a3e32-96db-4ec1-84ff-c4b344481347" name="Logout in n seconds" type="Action"><narrative></narrative><displayx>-60</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Force" narrative="Forces a shutdown if applications are running" expr="[Force]" /><input type="timespan" name="Delay" narrative="A Delay before shutdown occours" expr="[Logout Delay]" /></inputs><onsuccess>1e575b0c-7b9f-4c63-a376-8582dd8f27f2</onsuccess><resource object="Login Agent" action="Log Out" /></stage><stage stageid="33be58f9-f00b-4b9d-9ce0-88bdec8b5ce2" name="Logout Delay" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>timespan</datatype><initialvalue>0.00:00:05</initialvalue><private /><alwaysinit /></stage><stage stageid="c20524a3-3e50-4dcf-b3a2-0454f634cc83" name="Force" type="Data"><narrative></narrative><displayx>-195</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage></process></process>
        <process id="d410d9be-a5cd-4cf1-abef-c56f42508b94" name="Unlock" xmlns="http://www.blueprism.co.uk/product/process"><process name="Unlock" version="1.0" bpversion="6.0.0.0" narrative="" byrefcollection="true"><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><stage stageid="fe959dac-a762-449a-9bf7-8aeaa22110f4" name="Start" type="Start"><narrative></narrative><displayx>45</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Send Secure Attention Sequence" narrative="Flag indicating if the the Secure Attention Sequence (CTRL +ALT + DELETE) should be sent" stage="Send Secure Attention Sequence" /><input type="password" name="Password" stage="Password" /><input type="flag" name="Login Locally" stage="Login Locally" /></inputs><onsuccess>2ebf7ef1-a60c-4f0f-8137-5ae59fb43528</onsuccess></stage><stage stageid="1ab5515e-0370-491c-9fd5-69706cd227a3" name="End" type="End"><narrative></narrative><displayx>45</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="a4757390-9185-4811-8321-4a6d4c0253a4" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-105</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="c97e8e91-90ae-4fb7-bd54-d61270648632" name="Send SAS" type="Action"><narrative></narrative><displayx>150</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>11c0790d-c0b0-4a39-bd74-2557c4defb64</onsuccess><resource object="Login Agent" action="Send Secure Attention Sequence" /></stage><stage stageid="d10ff5ee-535e-419a-b761-46b1c5f78b82" name="Unlock" type="Action"><narrative></narrative><displayx>45</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="password" name="Password" narrative="The password for the currently logged on user" expr="[Password]" /><input type="flag" name="Local" narrative="Indicates if the currently logged on user is a local or network account. (True = local; False = Network)" expr="[Login Locally]" /></inputs><onsuccess>1ab5515e-0370-491c-9fd5-69706cd227a3</onsuccess><resource object="Login Agent" action="Unlock Screen" /></stage><stage stageid="ed2b4deb-c2dd-450c-a0b8-d3d20bb2b2cb" name="Password" type="Data"><narrative></narrative><displayx>-105</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="f465d57b-52c2-4048-bf14-a176642f3b5c" name="Login Locally" type="Data"><narrative></narrative><displayx>-105</displayx><displayy>60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="03fc1225-26f4-45e9-be05-58758000a0f0" name="Send Secure Attention Sequence" type="Data"><narrative></narrative><displayx>-105</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="2ebf7ef1-a60c-4f0f-8137-5ae59fb43528" name="Send SAS?" type="Decision"><narrative></narrative><displayx>45</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Send Secure Attention Sequence]" /><ontrue>c97e8e91-90ae-4fb7-bd54-d61270648632</ontrue><onfalse>d10ff5ee-535e-419a-b761-46b1c5f78b82</onfalse></stage><stage stageid="11c0790d-c0b0-4a39-bd74-2557c4defb64" name="Anchor1" type="Anchor"><narrative></narrative><displayx>150</displayx><displayy>15</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>d10ff5ee-535e-419a-b761-46b1c5f78b82</onsuccess></stage></process></process>
        <object id="7dce60b6-0b96-4fe1-9490-be356b6325bc" name="Login Agent" xmlns="http://www.blueprism.co.uk/product/process"><process name="Login Agent" version="1.0" bpversion="6.0.0.0" narrative="Business Object for interacting with the operating system for the purposes of authenticating with Windows and managing user passwords. " byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>46713547-5924-43ae-becb-743e33ff287e</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="fced009d-9e12-4a77-bb34-39c1b5b5f09a" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="8844e841-e52e-4c9e-8e09-83f96fe6b114" type="Normal" published="True"><name>Get Credential Name</name><view><camerax>84</camerax><cameray>-95</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31" type="Normal" published="False"><name>Authenticate To Windows</name><view><camerax>52</camerax><cameray>24</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="58da59f5-3981-487b-bce1-4955720512fd" type="Normal" published="True"><name>Logged In Users</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="0b60b666-16ec-46c7-b20f-7601ea1b30a4" type="Normal" published="True"><name>Send Secure Attention Sequence</name><view><camerax>69</camerax><cameray>87</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="496ea765-a2a8-40ba-abdc-f03c5adc3c11" type="Normal" published="True"><name>Change Password</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="fc7330a9-6031-4a16-9d1a-37eaad47dd3c" type="Normal" published="True"><name>Log In</name><view><camerax>0</camerax><cameray>-64</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="16600e55-0e0d-48bb-af54-c9481546764d" type="Normal" published="True"><name>Log Out</name><view><camerax>0</camerax><cameray>-42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="9be1bfb7-5b8e-4745-835d-94edb996a86d" type="Normal" published="True"><name>Is Logged In</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="591a313e-ab53-49d4-8aa0-867fc82c9d18" type="Normal" published="True"><name>Lock Screen</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="92b155c1-247d-473f-9f8b-f093f6dffbcf" type="Normal" published="True"><name>Unlock Screen</name><view><camerax>0</camerax><cameray>7</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="8b88ea92-5fc1-4135-8889-56a9438354ad" type="Normal" published="True"><name>Is Locked</name><view><camerax>18</camerax><cameray>-56</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="0b82de45-8e17-403c-b535-9e27aff5d856" name="Start" type="Start"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d92454db-9a9c-4c01-b3d1-565149f45600</onsuccess></stage><stage stageid="d92454db-9a9c-4c01-b3d1-565149f45600" name="End" type="End"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="347da190-6f5b-4b64-84be-4d0db90b5013" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><references><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>System.DirectoryServices.dll</reference><reference>System.Management.dll</reference><reference>System.Core.dll</reference><reference>System.Threading.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.DirectoryServices</import><import>System.Runtime.InteropServices</import><import>Microsoft.VisualBasic</import><import>System.Collections.Generic</import><import>System.Management</import><import>System.Data</import><import>Microsoft.Win32.SafeHandles</import><import>System.IO</import><import>System.Text</import><import>System.Reflection</import><import>System.IO.Pipes</import><import>System.Security.Principal</import><import>System.Threading</import><import>System.Net</import><import>System.Net.Sockets</import><import>System.Text.RegularExpressions</import></imports><language>visualbasic</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[Implements IDisposable

<DllImport("user32.dll")> _
Public Shared Function LockWorkStation() As Boolean
End Function

<DllImport("user32.dll")> _
Public Shared Sub ExitWindowsEx(ByVal uFlags As Integer, ByVal dwReason As Integer)
End Sub

<DllImport("user32.dll")> _
Private Shared Function OpenInputDesktop( _
  ByVal dwFlags As UInteger, _
  ByVal fInherit As Boolean, _
  ByVal dwDesiredAccess As UInteger) As IntPtr
End Function

<DllImport("user32.dll")> _
Private Shared Function CloseDesktop(ByVal hDesktop As IntPtr) As Boolean
End Function

<DllImport("kernel32.dll", SetLastError:=True)> _
 Public Shared Function CreateFile( _
  ByVal pipeName As String, _
  ByVal dwDesiredAccess As UInt32, _
  ByVal dwShareMode As UInt32, _
  ByVal lpSecurityAttributes As IntPtr, _
  ByVal dwCreationDisposition As UInt32, _
  ByVal dwFlagsAndAttributes As UInt32, _
  ByVal hTemplate As IntPtr) As SafeFileHandle
End Function

Public Enum NET_API_STATUS As UInteger
   NERR_Success = 0
   NERR_InvalidComputer = 2351
   NERR_NotPrimary = 2226
   NERR_SpeGroupOp = 2234
   NERR_LastAdmin = 2452
   NERR_BadPassword = 2203
   NERR_PasswordTooShort = 2245
   NERR_UserNotFound = 2221
   ERROR_ACCESS_DENIED = 5
   ERROR_NOT_ENOUGH_MEMORY = 8
   ERROR_INVALID_PARAMETER = 87
   ERROR_INVALID_NAME = 123
   ERROR_INVALID_LEVEL = 124
   ERROR_SESSION_CREDENTIAL_CONFLICT = 1219
   RPC_S_SERVER_UNAVAILABLE = 2147944122
   RPC_E_REMOTE_DISABLED = 2147549468
End Enum

<DllImport("netapi32.dll")> _
Public Shared Function NetUserChangePassword( _
    <MarshalAs(UnmanagedType.LPWStr)> ByVal Domain As String, _
    <MarshalAs(UnmanagedType.LPWStr)> ByVal User As String, _
    <MarshalAs(UnmanagedType.LPWStr)> ByVal OldPass As String, _
    <MarshalAs(UnmanagedType.LPWStr)> ByVal NewPass As String) As NET_API_STATUS
End Function

Public Const GENERIC_READ As UInt32 = &H80000000UI ' "UI" suffix = unsigned int
Public Const GENERIC_WRITE As UInt32 = &H40000000
Public Const OPEN_EXISTING As UInt32 = 3
Public Const FILE_FLAG_OVERLAPPED As UInt32 = &H40000000

Private Const PipeName As String = "BluePrismCredentialProviderPipe"

Public Enum ExitWindowsFlags
	LogOff = &H0
	ShutDown = &H1
	Reboot = &H2
	PowerOff = &H8
	RestartApps = &H40

	Force = &H4
	ForceIfHung = &H10
End Enum

Public Sub New()
	AddHandler Microsoft.Win32.SystemEvents.SessionSwitch, AddressOf SessionSwitch
End Sub

Private m_Locked As Boolean

Public Sub SessionSwitch(ByVal Sender As Object, ByVal e As Microsoft.Win32.SessionSwitchEventArgs)
	Select Case e.Reason
		Case Microsoft.Win32.SessionSwitchReason.SessionLock
			m_Locked = True
		Case Microsoft.Win32.SessionSwitchReason.SessionUnlock
			m_Locked = False
	End Select
End Sub

Public Sub ExitWindowsDelay(ByVal o As Object)
	Dim args As Object() = DirectCast(o, Object())
	Dim Flags As Integer = DirectCast(args(0), Integer)
	Dim Delay As TimeSpan = DirectCast(args(1), TimeSpan)
	System.Threading.Thread.Sleep(Delay)
	ExitWindowsEx(Flags, 0)
End Sub

Public Function GetLoggedInUsers() As ICollection(Of String)
	Dim users As New List(Of String)

	Dim options As New ConnectionOptions()
	Dim scope As New ManagementScope("\\localhost", options)

	Dim query As New ObjectQuery("select * from Win32_ComputerSystem")
	Dim searcher As New ManagementObjectSearcher(scope, query)
	Dim results As ManagementObjectCollection = searcher.[Get]()

	For Each result As ManagementObject In results
		Dim username As String = TryCast(result("UserName"), String)
		If username IsNot Nothing Then
			users.Add(username)
		End If
	Next

	Return users
End Function

Public Overloads Sub Dispose() Implements IDisposable.Dispose
	Dispose(True)
	GC.SuppressFinalize(Me)
End Sub

Protected Overloads Sub Dispose(ByVal disposing As Boolean)
	If disposing Then
		RemoveHandler Microsoft.Win32.SystemEvents.SessionSwitch, AddressOf SessionSwitch
	End If
End Sub

Protected Overrides Sub Finalize()
	Dispose(False)
End Sub

Public Class StreamString
    Private ioStream As Stream
    Private streamEncodingRead As UnicodeEncoding
    Private streamEncodingWrite As UTF8Encoding

    Public Sub New(ioStream As Stream)
        Me.ioStream = ioStream
        streamEncodingRead = New UnicodeEncoding(False, False)
        streamEncodingWrite = New UTF8Encoding(False)
    End Sub

    Public Function ReadString() As String
        Dim len As Integer = 2048
        Dim inBuffer As Array = Array.CreateInstance(GetType(Byte), len)
        ioStream.Read(inBuffer, 0, len)

        Return streamEncodingRead.GetString(inBuffer)
    End Function

    Public Function WriteString(outString As String) As Integer
        Dim outBuffer() As Byte = streamEncodingWrite.GetBytes(outString)
        ioStream.Write(outBuffer, 0, outBuffer.Length)
        ioStream.Flush()

        Return outBuffer.Length
    End Function
End Class]]></code></stage><stage stageid="b7dfc087-cf26-4d2c-bd34-a466b2fadeb5" name="Clean Up" type="SubSheetInfo"><subsheetid>fced009d-9e12-4a77-bb34-39c1b5b5f09a</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="6e3b12a4-b1eb-4ccb-9fd0-e42c3aa02287" name="Start" type="Start"><subsheetid>fced009d-9e12-4a77-bb34-39c1b5b5f09a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>b29afe99-70c6-4e8a-afb5-a8f3a2e83643</onsuccess></stage><stage stageid="b29afe99-70c6-4e8a-afb5-a8f3a2e83643" name="End" type="End"><subsheetid>fced009d-9e12-4a77-bb34-39c1b5b5f09a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1d3d4e0d-9e4c-466d-aed2-f31dc9fb5e49" name="Change Password" type="SubSheetInfo"><subsheetid>496ea765-a2a8-40ba-abdc-f03c5adc3c11</subsheetid><narrative>Attempts to update the Windows password for the currently logged in user.  If the password change in Windows fails, the credential is reverted to its previous value and the process is terminated.

Suitable for Login Agent Runtime Resource? No – terminates immediately. 
Suitable for Blue Prism Runtime Resource? Yes.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>120</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="36705d55-0e5b-4a3b-bb7a-0e0c502b837b" name="Start" type="Start"><subsheetid>496ea765-a2a8-40ba-abdc-f03c5adc3c11</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="password" name="Old Password" narrative="The current password for the logged in user" stage="Old Password" /><input type="password" name="New Password" narrative="The new password to be set" stage="New Password" /></inputs><onsuccess>d7909204-65b8-456f-938a-f56a9e178208</onsuccess></stage><stage stageid="3abddde9-203a-44ea-998e-46c94f498b48" name="End" type="End"><subsheetid>496ea765-a2a8-40ba-abdc-f03c5adc3c11</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="a9716bd2-f48c-4229-92e5-1930717935d8" name="new" type="Note"><subsheetid>fced009d-9e12-4a77-bb34-39c1b5b5f09a</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="c0f82a1a-7831-469d-9d19-a424e7e6b349" name="new" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b4bf3f9e-550c-4f46-99d4-141767b98f95" name="Old Password" type="Data"><subsheetid>496ea765-a2a8-40ba-abdc-f03c5adc3c11</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="10f89c79-e344-4100-b461-e45d84c6b07b" name="New Password" type="Data"><subsheetid>496ea765-a2a8-40ba-abdc-f03c5adc3c11</subsheetid><narrative></narrative><displayx>150</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="d7909204-65b8-456f-938a-f56a9e178208" name="Change Password" type="Code"><subsheetid>496ea765-a2a8-40ba-abdc-f03c5adc3c11</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="password" name="oldPass" expr="[Old Password]" /><input type="password" name="newPass" expr="[New Password]" /></inputs><onsuccess>3abddde9-203a-44ea-998e-46c94f498b48</onsuccess><code><![CDATA[Dim res As NET_API_STATUS = NetUserChangePassword(Environment.UserDomainName, Environment.UserName, oldPass, newPass)
If res <> NET_API_STATUS.NERR_Success Then
   Throw New ApplicationException("Error setting password - Error code:" & res.ToString())
End If]]></code></stage><stage stageid="575e4443-3f94-4663-8eb8-10d3f0978316" name="Lock Screen" type="SubSheetInfo"><subsheetid>591a313e-ab53-49d4-8aa0-867fc82c9d18</subsheetid><narrative>Locks the Windows screen such that the desktop is no longer visible and authentication is required to re-enter Windows proper.  It has no effect if the screen is already locked.

Suitable for Login Agent Runtime Resource? No. 
Suitable for Blue Prism Runtime Resource? Yes.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1cbcdecd-d2b5-4b18-81c7-d6b36a3c0b29" name="Start" type="Start"><subsheetid>591a313e-ab53-49d4-8aa0-867fc82c9d18</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>dd07b920-d654-4c33-b274-460788bd6985</onsuccess></stage><stage stageid="f4b4fb18-6797-4ab8-9e69-d8d5d119e668" name="End" type="End"><subsheetid>591a313e-ab53-49d4-8aa0-867fc82c9d18</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="7e0cf464-c1c2-4c1a-b885-d55f2b4d6deb" name="Lock Screen" type="Code"><subsheetid>591a313e-ab53-49d4-8aa0-867fc82c9d18</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f4b4fb18-6797-4ab8-9e69-d8d5d119e668</onsuccess><code><![CDATA[LockWorkStation()]]></code></stage><stage stageid="fb0f2048-7568-4f40-96ce-44524ee7fb96" name="Log Out" type="SubSheetInfo"><subsheetid>16600e55-0e0d-48bb-af54-c9481546764d</subsheetid><narrative>Closes all programs in the user session and logs out of Windows. An optional delay can be passed in as the parameter 'Delay' which will hold off from logging out for the time specified.  Irrespective of the delay the process will complete immediately, and the session will log out after the delay has passed. 

Suitable for Login Agent Runtime Resource? No. 
Suitable for Blue Prism Runtime Resource? Yes.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>120</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="7bf32b65-ec43-4f09-a270-92a4bdd3cda3" name="Start" type="Start"><subsheetid>16600e55-0e0d-48bb-af54-c9481546764d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Force" narrative="Forces a shutdown if applications are running" stage="Force" /><input type="timespan" name="Delay" narrative="Time to delay before requesting shutdown" stage="Delay" /></inputs><onsuccess>250b72f5-e05c-4422-82d4-a466d4619a93</onsuccess></stage><stage stageid="5c619424-d049-4499-a7af-4a8caa73c838" name="End" type="End"><subsheetid>16600e55-0e0d-48bb-af54-c9481546764d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5c4d00c8-ea22-4a0c-8f86-f1557aca83c4" name="Log Out" type="Code"><subsheetid>16600e55-0e0d-48bb-af54-c9481546764d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Force" expr="[Force]" /><input type="timespan" name="Delay" expr="[Delay]" /><input type="text" name="ResourceName" expr="[Resource Name]" /></inputs><onsuccess>5c619424-d049-4499-a7af-4a8caa73c838</onsuccess><code><![CDATA[Try
    Dim match = Regex.Match(ResourceName, ":([0-9]*)$")
    Dim port = If(match.Success, Integer.Parse(match.Groups(1).Value), 8181)

    Using tcp As New TcpClient()
        tcp.Connect(IPAddress.Loopback, port)
        Using sw As New StreamWriter(tcp.GetStream(), New UTF8Encoding(False))
            sw.WriteLine("shutdown waitforsessions")
            sw.Flush()
        End Using
    End Using
Catch
End Try

Dim flags as ExitWindowsFlags = ExitWindowsFlags.LogOff
If Force Then flags = flags Or ExitWindowsFlags.Force

Dim t As New Threading.Thread(Addressof ExitWindowsDelay)
t.Start({flags, Delay})]]></code></stage><stage stageid="8795c94f-4605-43b5-a515-a358ce7259bf" name="Force" type="Data"><subsheetid>16600e55-0e0d-48bb-af54-c9481546764d</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="84ef1c60-5f00-4c91-bef3-0ae7369d94ca" name="Unlock Screen" type="SubSheetInfo"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative>Unlocks a locked device.

Suitable for Login Agent Runtime Resource? No. 
Suitable for Blue Prism Runtime Resource? Yes.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>180</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4dfea8a1-86a0-45e8-8d9c-6eee47f8b53b" name="Start" type="Start"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="password" name="Password" narrative="The password for the currently logged on user" stage="Password" /><input type="flag" name="Local" narrative="Indicates if the currently logged on user is a local or network account. (True = local; False = Network)" stage="Local" /></inputs><onsuccess>6a9ee0ab-36bc-4582-8f61-90946fc87ac2</onsuccess></stage><stage stageid="8a0ffee8-4561-44b5-be27-ab6b6989810d" name="End" type="End"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>165</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="a05c287e-8eea-4f02-be52-d591f9a34e43" name="Log In" type="SubSheetInfo"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative>Uses the provided inputs to execute a Windows login.  Can login using a local account (by setting Local = true), or a network account (by setting Local = false).
If the Log In request is rejected by Windows such as because the user account is disabled, or the password has expired the Authenticate to Windows action will fail.  The failure reason will be displayed within the session logs and can optionally be captured within the process.

Suitable for Login Agent Runtime Resource? Yes. 
Suitable for Blue Prism Runtime Resource? No.</narrative><displayx>-255</displayx><displayy>-195</displayy><displaywidth>210</displaywidth><displayheight>120</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ce3cef39-0134-470c-b59c-273616b66622" name="End" type="End"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f6144f11-a343-4acb-b935-4c9900f34a2f" name="Is Locked" type="SubSheetInfo"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><narrative>Checks if the resource is currently logged on and locked. Returns true if the device is logged on and locked.
Suitable for Login Agent Runtime Resource? Yes. 
Suitable for Blue Prism Runtime Resource? Yes.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="422854bf-de95-47a8-82ad-9a4faba10ec0" name="Start" type="Start"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><narrative></narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>9fe2dde9-48a0-40ad-89b5-046add650133</onsuccess></stage><stage stageid="f738eca2-c3bf-42d5-b5b5-aedfaa9295f5" name="End" type="End"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Locked" narrative="True to indicate that the resource is logged on and locked, otherwise false." stage="Locked" /></outputs></stage><stage stageid="a16812d6-ceff-457c-96ee-f5e859924734" name="Locked" type="Data"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><narrative></narrative><displayx>90</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="f206c22a-d1c7-4c7f-9a17-3181943398bc" name="Locked?" type="Code"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><narrative></narrative><displayx>15</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Locked" stage="Locked" /></outputs><onsuccess>f738eca2-c3bf-42d5-b5b5-aedfaa9295f5</onsuccess><code><![CDATA[If m_Locked Then Locked = True : Return

' If we've not got 'locked' set, it may be that
' we're not locked, or it might mean that the
' VBO wasn't active when the screen was locked
' Try and get the desktop window to see if we're
' currently locked or not

Dim hDesk as IntPtr = OpenInputDesktop(0, False, 1)
Locked = (hDesk = IntPtr.Zero)
CloseDesktop(hDesk)
]]></code></stage><stage stageid="7a388dca-6f91-48dc-bdab-97fef8f04515" name="Password" type="Data"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="5c5a86db-ef99-4e1e-a81e-6bc5be62d1aa" name="Is Locked?" type="Decision"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Locked]" /><ontrue>17da5cbb-398c-46f9-80df-256cf8f1aeb3</ontrue><onfalse>bc8bc43d-b16e-4e90-846a-38edc5d9c052</onfalse></stage><stage stageid="6a9ee0ab-36bc-4582-8f61-90946fc87ac2" name="Is Locked" type="SubSheet"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Locked" stage="Locked" /></outputs><onsuccess>5c5a86db-ef99-4e1e-a81e-6bc5be62d1aa</onsuccess><processid>8b88ea92-5fc1-4135-8889-56a9438354ad</processid></stage><stage stageid="bca60a1a-50dc-43d5-b42e-ca8b9631768f" name="Locked" type="Data"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bc8bc43d-b16e-4e90-846a-38edc5d9c052" name="End1" type="End"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>-75</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f4c2bd72-767a-4d95-8dcc-e6a5d17ee779" name="Username" type="Data"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="140a269f-f46d-402a-a773-2f88ad2d26b9" name="Password" type="Data"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="a2bbd219-9ae0-4281-9907-d85e1a7ca496" name="Unlock" type="SubSheet"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Username" narrative="The username to use to authenticate to windows" expr="[Username]" /><input type="password" name="Password" narrative="The password to use to authenticate to Windows" expr="[Password]" /><input type="flag" name="Local" narrative="True to authenticate using local machine authentication; False to use domain authentication" expr="[Local]" /><input type="text" name="Domain" narrative="The name of the domain to authenticate with. Ignored if 'Local' is true; If blank will use the domain that the machine is a member of" expr="[Domain]" /></inputs><onsuccess>8a0ffee8-4561-44b5-be27-ab6b6989810d</onsuccess><processid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</processid></stage><stage stageid="17da5cbb-398c-46f9-80df-256cf8f1aeb3" name="Get Username &amp; Domain" type="Code"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Username" stage="Username" /><output type="text" name="Domain" stage="Domain" /></outputs><onsuccess>a2bbd219-9ae0-4281-9907-d85e1a7ca496</onsuccess><code><![CDATA[Username = Environment.UserName
Domain = Environment.UserDomainName]]></code></stage><stage stageid="cfe76f8a-10ba-4bb3-b827-5b48b8628960" name="Username" type="Data"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="80cfeada-7b35-4af0-942e-3583ceba3e24" name="Is Locked?" type="Decision"><subsheetid>591a313e-ab53-49d4-8aa0-867fc82c9d18</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Locked]" /><ontrue>4765a529-45f2-4cd1-a8c9-73317e3346f7</ontrue><onfalse>7e0cf464-c1c2-4c1a-b885-d55f2b4d6deb</onfalse></stage><stage stageid="dd07b920-d654-4c33-b274-460788bd6985" name="Is Locked" type="SubSheet"><subsheetid>591a313e-ab53-49d4-8aa0-867fc82c9d18</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Locked" stage="Locked" /></outputs><onsuccess>80cfeada-7b35-4af0-942e-3583ceba3e24</onsuccess><processid>8b88ea92-5fc1-4135-8889-56a9438354ad</processid></stage><stage stageid="4765a529-45f2-4cd1-a8c9-73317e3346f7" name="End1" type="End"><subsheetid>591a313e-ab53-49d4-8aa0-867fc82c9d18</subsheetid><loginhibit /><narrative></narrative><displayx>165</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b49c72a0-9e78-4f8c-94fb-75e3174cc0f8" name="Locked" type="Data"><subsheetid>591a313e-ab53-49d4-8aa0-867fc82c9d18</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d0f1be0b-aa8b-409b-93ab-569b6d5867b0" name="Delay" type="Data"><subsheetid>16600e55-0e0d-48bb-af54-c9481546764d</subsheetid><narrative></narrative><displayx>150</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>timespan</datatype><initialvalue>0.00:00:00</initialvalue><private /><alwaysinit /></stage><stage stageid="3263716a-0ab1-4830-b951-c6b3675e24c7" name="Is Logged In" type="SubSheetInfo"><subsheetid>9be1bfb7-5b8e-4745-835d-94edb996a86d</subsheetid><narrative>Checks if the device has currently logged on users.  Returns true if the device is logged on.  False indicates that there are no users logged onto the device.

Suitable for Login Agent Runtime Resource? Yes. 
Suitable for Blue Prism Runtime Resource? Yes.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>210</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5b001eae-cc4a-453a-b193-0da5ab00915e" name="Start" type="Start"><subsheetid>9be1bfb7-5b8e-4745-835d-94edb996a86d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1ade2596-f773-4263-b2f8-9ac78dd13808</onsuccess></stage><stage stageid="320de7cd-31f9-44ac-8f91-6802faa49907" name="End" type="End"><subsheetid>9be1bfb7-5b8e-4745-835d-94edb996a86d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Logged In" narrative="Returns true if the device is logged on and a Blue Prism Runtime Resource is running.  False indicates that the device is not logged on and a Blue Prism Login Agent Resource is running." stage="Logged In" /></outputs></stage><stage stageid="1ade2596-f773-4263-b2f8-9ac78dd13808" name="Logged In" type="Code"><subsheetid>9be1bfb7-5b8e-4745-835d-94edb996a86d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Logged In" stage="Logged In" /></outputs><onsuccess>320de7cd-31f9-44ac-8f91-6802faa49907</onsuccess><code><![CDATA[Logged_In = (GetLoggedInUsers().Count > 0)]]></code></stage><stage stageid="05e45da1-427b-4a7e-bf38-75b73c0015ec" name="Logged In" type="Data"><subsheetid>9be1bfb7-5b8e-4745-835d-94edb996a86d</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="58cf41b0-bce5-48ec-9c82-3069394077fd" name="Logged In Users" type="SubSheetInfo"><subsheetid>58da59f5-3981-487b-bce1-4955720512fd</subsheetid><narrative>Returns a collection of the user names of the users currently logged in to the machine.

Suitable for Login Agent Runtime Resource? No. 
Suitable for Blue Prism Runtime Resource? Yes.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="38c585a6-1b8f-4104-83a0-2265075ae1e0" name="Start" type="Start"><subsheetid>58da59f5-3981-487b-bce1-4955720512fd</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>a460e229-02b0-46fc-a383-ca3ea186c1d1</onsuccess></stage><stage stageid="69b4c3ce-f00d-4d23-84d6-fd410c1f1a4a" name="End" type="End"><subsheetid>58da59f5-3981-487b-bce1-4955720512fd</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Users" narrative="List of users" stage="Users" /></outputs></stage><stage stageid="a460e229-02b0-46fc-a383-ca3ea186c1d1" name="Get Logged In Users" type="Code"><subsheetid>58da59f5-3981-487b-bce1-4955720512fd</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Users" stage="Users" /></outputs><onsuccess>69b4c3ce-f00d-4d23-84d6-fd410c1f1a4a</onsuccess><code><![CDATA[Users = New DataTable()
Const userNameCol As String = "Name"
Users.Columns.Add(userNameCol)
For Each username As String In GetLoggedInUsers()
	Dim row As DataRow = Users.NewRow()
	row(userNameCol) = username
	Users.Rows.Add(row)
Next]]></code></stage><stage stageid="b143f0e3-7091-43dc-8048-8f52afef6834" name="Users" type="Collection"><subsheetid>58da59f5-3981-487b-bce1-4955720512fd</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="748cda20-fa82-47bd-bab0-5745fc42796d" name="Local" type="Data"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="4890907d-a0bf-4db7-ae32-ff9e1a78e198" name="Local" type="Data"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="24be8ab1-3a7a-4af6-b752-fb6afe58bf49" name="Get Credential Name" type="SubSheetInfo"><subsheetid>8844e841-e52e-4c9e-8e09-83f96fe6b114</subsheetid><narrative>Uses the machine name to generate a string in the format defined in the Login Format String environment variable (Default: “Windows Login: [MachineName]”) which is expected to match a Credential record.  This can be used within a retrieve credential action as demonstrated in the example process.

Suitable for Login Agent Runtime Resource? Yes. 
Suitable for Blue Prism Runtime Resource? Yes.</narrative><displayx>-255</displayx><displayy>-165</displayy><displaywidth>210</displaywidth><displayheight>120</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f83cf421-5801-4b2d-9c8c-c35ff4229bcf" name="Start" type="Start"><subsheetid>8844e841-e52e-4c9e-8e09-83f96fe6b114</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>30d0a48e-145c-41cb-b8f3-d809b852d6a9</onsuccess></stage><stage stageid="6ce678f8-2b76-48cf-8bdb-f4f576c04049" name="End" type="End"><subsheetid>8844e841-e52e-4c9e-8e09-83f96fe6b114</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Credential Name" narrative="The name of the credential for this machine" stage="Credential Name" /></outputs></stage><stage stageid="d5a611a7-bebe-4331-8234-77dd30061dc5" name="Login Format String" type="Data"><subsheetid>8844e841-e52e-4c9e-8e09-83f96fe6b114</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Windows Login: {0}</initialvalue><exposure>Environment</exposure><private /><alwaysinit /></stage><stage stageid="4bf9d81c-3233-4f0e-8d6e-b25a24446184" name="Credential Name" type="Data"><subsheetid>8844e841-e52e-4c9e-8e09-83f96fe6b114</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="30d0a48e-145c-41cb-b8f3-d809b852d6a9" name="Get Credential Name" type="Code"><subsheetid>8844e841-e52e-4c9e-8e09-83f96fe6b114</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="FormatString" expr="[Login Format String]" /></inputs><outputs><output type="text" name="Credential Name" stage="Credential Name" /></outputs><onsuccess>6ce678f8-2b76-48cf-8bdb-f4f576c04049</onsuccess><code><![CDATA[Credential_Name = String.Format( _
	FormatString, Environment.MachineName)]]></code></stage><stage stageid="b2970195-9328-4dee-b504-5cd2bc373ddd" name="Is Logged In" type="SubSheet"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Logged In" stage="Logged In" /></outputs><onsuccess>b71ecff7-e01d-465a-8db3-73fc7038381e</onsuccess><processid>9be1bfb7-5b8e-4745-835d-94edb996a86d</processid></stage><stage stageid="962450d9-400d-4f40-b741-dee229f336a4" name="Logged In" type="Data"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b71ecff7-e01d-465a-8db3-73fc7038381e" name="Logged In?" type="Decision"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Logged In]" /><ontrue>6bdfa233-6b5f-4b5f-9f3d-3934c4659362</ontrue><onfalse>b72b5e50-4b85-446c-ad67-18738c8a411a</onfalse></stage><stage stageid="6bdfa233-6b5f-4b5f-9f3d-3934c4659362" name="End2" type="End"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>-75</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5d01782b-bf4f-4014-876f-6f99f816979a" name="Authenticate To Windows" type="SubSheetInfo"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><narrative>Authenticates to Windows using the given user name and password using either a local machine login or a domain login as specified.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b105a242-c87d-4b20-bcea-2c4dc2a729ac" name="Start" type="Start"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Username" narrative="The username to use to authenticate to windows" stage="Username" /><input type="password" name="Password" narrative="The password to use to authenticate to Windows" stage="Password" /><input type="flag" name="Local" narrative="True to authenticate using local machine authentication; False to use domain authentication" stage="Local" /><input type="text" name="Domain" narrative="The name of the domain to authenticate with. Ignored if 'Local' is true; If blank will use the domain that the machine is a member of" stage="Domain" /></inputs><onsuccess>d819e4e7-8492-4234-9578-c4d5c02ba865</onsuccess></stage><stage stageid="2f9731ab-8fd6-484d-ae58-915608eaf0cc" name="Username" type="Data"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d4f48493-05cf-411e-8ac1-0bc270d19967" name="Password" type="Data"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>180</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="1e9cc35c-6057-40b7-b081-c8e756a7fbbe" name="Local" type="Data"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>240</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="691183cf-3f78-4a1e-91f1-d32fea281c5c" name="End" type="End"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>135</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d819e4e7-8492-4234-9578-c4d5c02ba865" name="Authenticate" type="Code"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Username" expr="[Username]" /><input type="password" name="Password" expr="[Password]" /><input type="flag" name="Local" expr="[Local]" /><input type="text" name="Domain" expr="[Domain]" /></inputs><outputs><output type="text" name="Response" stage="Response" /><output type="text" name="ErrorCode" stage="ErrorCode" /><output type="text" name="ErrorMessage" stage="ErrorMessage" /></outputs><onsuccess>1fc7e35c-2555-4b61-819f-ccc61943c9bb</onsuccess><code><![CDATA[Try
	'Create a new pipe client
	Using pipeClient As New NamedPipeClientStream(
		".",
		"BluePrismCredentialProviderPipe",
		PipeDirection.InOut,
		PipeOptions.None,
		TokenImpersonationLevel.Impersonation)

		'Attempt to connect to it
		pipeClient.Connect(10000)

		'Send credentials
		Dim dom As String
		If Local Then
			dom = Environment.MachineName
		Else If Domain = "" Then
			dom = Environment.UserDomainName
		Else
			dom = Domain
		End If
		Dim ss As New StreamString(pipeClient)
		ss.WriteString(String.Format("LOGON{0}{1}{0}{2}{0}{3}", vbLf, dom, Username, Password))

		'Wait for reply
		Using pr As New StreamReader(pipeClient, Encoding.Unicode)
			Response = pr.ReadLine()
			If Response = "OK" OrElse Response = "UNKNOWN" Then Return

			ErrorCode = pr.ReadLine()
			ErrorMessage = pr.ReadLine()
		End Using
	End Using
Catch ex As TimeoutException
	Response = "ERROR"
	ErrorCode = "0x80131505"
	ErrorMessage = ex.Message
Catch ex As Exception
	Response = "ERROR"
	ErrorCode = ""
	ErrorMessage = ex.Message
End Try
]]></code></stage><stage stageid="18f685e1-5939-4381-ae5d-067ef0b6da8a" name="Error" type="Exception"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>135</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="" detail="[ErrorCode] &amp; &quot;: &quot; &amp; [ErrorMessage]" /></stage><stage stageid="b72b5e50-4b85-446c-ad67-18738c8a411a" name="Authenticate To Windows" type="SubSheet"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Username" narrative="The username to use to authenticate to windows" expr="[Username]" /><input type="password" name="Password" narrative="The password to use to authenticate to Windows" expr="[Password]" /><input type="flag" name="Local" narrative="True to authenticate using local machine authentication; False to use domain authentication" expr="[Local]" /><input type="text" name="Domain" narrative="The name of the domain to authenticate with. Ignored if 'Local' is true; If blank will use the domain that the machine is a member of" expr="[Domain]" /></inputs><onsuccess>ce3cef39-0134-470c-b59c-273616b66622</onsuccess><processid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</processid></stage><stage stageid="9fe2dde9-48a0-40ad-89b5-046add650133" name="Is Logged In" type="SubSheet"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Logged In" stage="Logged In" /></outputs><onsuccess>19ef5458-4e29-48e1-b1c1-8e3daf0f288c</onsuccess><processid>9be1bfb7-5b8e-4745-835d-94edb996a86d</processid></stage><stage stageid="19ef5458-4e29-48e1-b1c1-8e3daf0f288c" name="Logged In?" type="Decision"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Logged In]" /><ontrue>f206c22a-d1c7-4c7f-9a17-3181943398bc</ontrue><onfalse>066e6685-36e5-4c06-b927-cb4ba17ebad2</onfalse></stage><stage stageid="066e6685-36e5-4c06-b927-cb4ba17ebad2" name="End2" type="End"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><loginhibit /><narrative></narrative><displayx>-75</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Locked" narrative="True to indicate that the resource is logged on and locked, otherwise false." stage="Locked" /></outputs></stage><stage stageid="9fe49ac3-dc70-47bb-8828-0d08ba43b07a" name="Logged In" type="Data"><subsheetid>8b88ea92-5fc1-4135-8889-56a9438354ad</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d580bec5-8bc4-41f3-9826-f2092d81933b" name="Domain" type="Data"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><narrative></narrative><displayx>300</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dce64519-ae10-4069-82a8-31e5704b646a" name="Domain" type="Data"><subsheetid>92b155c1-247d-473f-9f8b-f093f6dffbcf</subsheetid><loginhibit /><narrative></narrative><displayx>270</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5a5aec3a-15b9-462c-bb92-d1a79b8cdfca" name="Domain" type="Data"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><narrative></narrative><displayx>270</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="85c4aec5-25b7-4651-bd6e-c69eb13bd6dd" name="Start" type="Start"><subsheetid>fc7330a9-6031-4a16-9d1a-37eaad47dd3c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Username" narrative="The username to use " stage="Username" /><input type="password" name="Password" narrative="The password to use " stage="Password" /><input type="flag" name="Local" narrative="True to authenticate using local machine authentication; False to use domain authentication. Default is true." stage="Local" /><input type="text" name="Domain" narrative="The name of the domain to authenticate with (e.g. mydomain or mydomain.com). Ignored if 'Local' is true; If blank will use the domain that the machine is a member of" stage="Domain" /></inputs><onsuccess>b2970195-9328-4dee-b504-5cd2bc373ddd</onsuccess></stage><stage stageid="427ee3ea-194f-4eaa-a51d-e5c3e94e18a4" name="len" type="Data"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><narrative></narrative><displayx>-75</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2edacc97-c38c-4085-b175-7ec15357b233" name="ErrorCode" type="Data"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><narrative></narrative><displayx>180</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="083c2428-eed0-4ef5-bb10-2697213a1b68" name="ErrorMessage" type="Data"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><narrative></narrative><displayx>240</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4f3582e5-ae61-400d-b97e-88050c777b91" name="Response" type="Data"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><narrative></narrative><displayx>120</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1fc7e35c-2555-4b61-819f-ccc61943c9bb" name="Check Response" type="ChoiceStart"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><groupid>03ca8937-68a2-4444-9fe2-90c3f279eeda</groupid><choices><choice expression="[Response] = &quot;UNKNOWN&quot;"><name>Unknown</name><distance>30</distance><ontrue>2d0ff810-5b00-484f-8fbf-588338dce222</ontrue></choice><choice expression="[Response] = &quot;OK&quot;"><name>Success</name><distance>75</distance><ontrue>691183cf-3f78-4a1e-91f1-d32fea281c5c</ontrue></choice></choices></stage><stage stageid="18718040-871b-4f2e-b806-4c3ab12e0399" name="Error" type="ChoiceEnd"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>18f685e1-5939-4381-ae5d-067ef0b6da8a</onsuccess><groupid>03ca8937-68a2-4444-9fe2-90c3f279eeda</groupid></stage><stage stageid="2d0ff810-5b00-484f-8fbf-588338dce222" name="Unknown outcome" type="Note"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><narrative>The result of the attempted logon is not available. This would be expected if using Windows XP (GINA) as it not able to provide information relating to the outcome.</narrative><displayx>270</displayx><displayy>45</displayy><displaywidth>180</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>7d67b0e5-f0a2-4066-9b08-53225a853625</onsuccess></stage><stage stageid="7d67b0e5-f0a2-4066-9b08-53225a853625" name="Anchor1" type="Anchor"><subsheetid>3b5b1d1e-cc3f-42d1-b366-db7b87ef1b31</subsheetid><loginhibit /><narrative></narrative><displayx>270</displayx><displayy>90</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>691183cf-3f78-4a1e-91f1-d32fea281c5c</onsuccess></stage><stage stageid="e778064a-0bdd-4284-af31-1f0df70d3fc4" name="Send Secure Attention Sequence" type="SubSheetInfo"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><narrative>Sends a SAS (Ctrl+Alt+Del) signal to the Blue Prism SAS Service,</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b6ab43b4-4555-4b02-9bee-d692ae2dec7f" name="Start" type="Start"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d85acbc0-5164-43f1-85af-8572bf6d3bc0</onsuccess></stage><stage stageid="c77d7b98-435f-4ff7-8e67-9aafe7498b4d" name="End" type="End"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><loginhibit /><narrative></narrative><displayx>135</displayx><displayy>150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d85acbc0-5164-43f1-85af-8572bf6d3bc0" name="SendSAS" type="Code"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Response" stage="Response" /><output type="text" name="ErrorCode" stage="ErrorCode" /><output type="text" name="ErrorMessage" stage="ErrorMessage" /></outputs><onsuccess>dfb15aba-03c7-4033-a84f-4ee5a4f15f4d</onsuccess><code><![CDATA[Try
	'Create a new pipe client
	Using pipeClient As New NamedPipeClientStream(
		".",
		"BluePrismSASPipe",
		PipeDirection.InOut,
		PipeOptions.None,
		TokenImpersonationLevel.Impersonation)

		'Attempt to connect to it
		pipeClient.Connect(10000)

		Dim sendBuffer As Byte() = Encoding.Unicode.GetBytes("SAS")
        pipeClient.Write(sendBuffer, 0, sendBuffer.Length)

		'Wait for reply
		Using pr As New StreamReader(pipeClient, Encoding.Unicode)
			Response = pr.ReadLine()
			
			If Response = "OK" OrElse Response = "UNKNOWN" Then 
				System.Threading.Thread.Sleep(2000)
				return 
			End if
			
			ErrorMessage = "Received unexpected reply:" + Response
		End Using
	End Using
Catch ex As Exception
	Response = "ERROR"
	ErrorCode = ""
	ErrorMessage = ex.Message
End Try
]]></code></stage><stage stageid="74916691-4c1a-48ab-904d-eb120de05f9c" name="Error" type="Exception"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><loginhibit /><narrative></narrative><displayx>135</displayx><displayy>195</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="" detail="[ErrorCode] &amp; &quot;: &quot; &amp; [ErrorMessage] &amp; &quot;:&quot; &amp; [Response]" /></stage><stage stageid="a10aefc4-ddef-41c0-9efe-74acc8d94217" name="ErrorCode" type="Data"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><narrative></narrative><displayx>180</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a5aa0525-0c30-4e36-9e38-61cfaeff8bd9" name="ErrorMessage" type="Data"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><narrative></narrative><displayx>240</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1a1ea379-4ccd-46d5-92b4-d89285da6179" name="Response" type="Data"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><narrative></narrative><displayx>120</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dfb15aba-03c7-4033-a84f-4ee5a4f15f4d" name="Check Response" type="ChoiceStart"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><groupid>965dbaaf-d982-475c-b926-f888720a1f2c</groupid><choices><choice expression="[Response] = &quot;UNKNOWN&quot;"><name>Unknown</name><distance>30</distance><ontrue>cc2b13c9-aaaa-429a-98cf-6fea93b44839</ontrue></choice><choice expression="[Response] = &quot;OK&quot;"><name>Success</name><distance>75</distance><ontrue>c77d7b98-435f-4ff7-8e67-9aafe7498b4d</ontrue></choice></choices></stage><stage stageid="d5eb83ea-4ea6-4052-a7dc-022cf04be540" name="Error" type="ChoiceEnd"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>195</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>74916691-4c1a-48ab-904d-eb120de05f9c</onsuccess><groupid>965dbaaf-d982-475c-b926-f888720a1f2c</groupid></stage><stage stageid="0df1e0b3-2fc2-40b0-89e0-fe72e6ecdff8" name="Anchor1" type="Anchor"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><loginhibit /><narrative></narrative><displayx>270</displayx><displayy>150</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>c77d7b98-435f-4ff7-8e67-9aafe7498b4d</onsuccess></stage><stage stageid="cc2b13c9-aaaa-429a-98cf-6fea93b44839" name="Anchor2" type="Anchor"><subsheetid>0b60b666-16ec-46c7-b20f-7601ea1b30a4</subsheetid><loginhibit /><narrative></narrative><displayx>270</displayx><displayy>105</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>0df1e0b3-2fc2-40b0-89e0-fe72e6ecdff8</onsuccess></stage><stage stageid="250b72f5-e05c-4422-82d4-a466d4619a93" name="Get Resource Name" type="Calculation"><subsheetid>16600e55-0e0d-48bb-af54-c9481546764d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>5c4d00c8-ea22-4a0c-8f86-f1557aca83c4</onsuccess><calculation expression="GetResourceName()" stage="Resource Name" /></stage><stage stageid="c53f2d6e-c320-436a-9926-814f20ca4c00" name="Resource Name" type="Data"><subsheetid>16600e55-0e0d-48bb-af54-c9481546764d</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage></process></object>
        <environment-variable id="Login Format String" name="Login Format String" type="text" value="Windows Login: {0}" xmlns="http://www.blueprism.co.uk/product/environment-variable">
            <description>d</description>
        </environment-variable>
        <process-group id="874c2f00-a3eb-4a12-8994-f15050501a31" name="Login Agent" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/process-group">
            <members>
                <process id="11b51477-dd7f-445b-8a4c-361cc14e4c5e" />
                <process id="fe175ce9-5b01-440e-8d92-a26685b7384f" />
                <process id="740feb4a-58b8-4376-931b-0197f16920c3" />
                <process id="1c808a33-3c5a-4c88-a189-1c2b07968d01" />
                <process id="d410d9be-a5cd-4cf1-abef-c56f42508b94" />
            </members>
        </process-group>
        <object-group id="e0c6812c-fcad-45fe-bb70-eeb37f2cd4e9" name="Default" isDefaultGroup="True" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="7dce60b6-0b96-4fe1-9490-be356b6325bc" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>