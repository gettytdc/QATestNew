<process name="DDE Commands" version="1.0" bpversion="6.7.0.16843" narrative="Tests the execution of DDE commands" byrefcollection="true" type="object" runmode="Exclusive" preferredid="f422cd76-4a29-436e-8535-ed2824cbba44">
  <appdef>
    <element name="DDE Commands">
      <id>b6a2d99f-85b3-47bb-b01b-d91727a8f0fc</id>
      <element name="Main Window">
        <id>75fd9bbd-34ab-46f6-8a36-28518bbf795b</id>
        <type>Window</type>
        <basetype>Window</basetype>
        <datatype>text</datatype>
        <diagnose>False</diagnose>
        <attributes>
          <attribute name="WindowText" comparisontype="dynamic" inuse="True">
            <ProcessValue datatype="text" value="Microsoft Excel - Excel Samples.xls  [Read-Only]" />
          </attribute>
          <attribute name="ClassName" inuse="True">
            <ProcessValue datatype="text" value="XLMAIN" />
          </attribute>
          <attribute name="CtrlID">
            <ProcessValue datatype="number" value="0" />
          </attribute>
          <attribute name="X">
            <ProcessValue datatype="number" value="-4" />
          </attribute>
          <attribute name="Y">
            <ProcessValue datatype="number" value="-4" />
          </attribute>
          <attribute name="Width">
            <ProcessValue datatype="number" value="1289" />
          </attribute>
          <attribute name="Height">
            <ProcessValue datatype="number" value="977" />
          </attribute>
          <attribute name="Visible" inuse="True">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="ScreenVisible" inuse="True">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="Enabled" inuse="True">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="Active">
            <ProcessValue datatype="flag" value="True" />
          </attribute>
          <attribute name="Ordinal">
            <ProcessValue datatype="number" value="152" />
          </attribute>
          <attribute name="ChildCount">
            <ProcessValue datatype="number" value="9" />
          </attribute>
        </attributes>
      </element>
      <element name="Excel Samples Book">
        <id>bc97747e-de72-48dd-a843-d2c34077da0b</id>
        <type>DDEElement</type>
        <basetype>DDEElement</basetype>
        <datatype>text</datatype>
        <diagnose>False</diagnose>
        <attributes>
          <attribute name="DDEServerName" inuse="True">
            <ProcessValue datatype="text" value="excel" />
          </attribute>
          <attribute name="DDETopicName" comparisontype="dynamic" inuse="True">
            <ProcessValue datatype="text" value="c:\blueprism\qa\code\MS Office\Excel Samples.xls" />
          </attribute>
          <attribute name="DDEItemName" inuse="True">
            <ProcessValue datatype="text" value="" />
          </attribute>
        </attributes>
      </element>
      <element name="Excel Book 1">
        <id>66b607bd-7571-41cb-bf4e-3799d6b4297d</id>
        <type>DDEElement</type>
        <basetype>DDEElement</basetype>
        <datatype>text</datatype>
        <diagnose>False</diagnose>
        <attributes>
          <attribute name="DDEServerName" inuse="True">
            <ProcessValue datatype="text" value="excel" />
          </attribute>
          <attribute name="DDETopicName" comparisontype="dynamic" inuse="True">
            <ProcessValue datatype="text" value="c:\blueprism\qa\code\ms office\Book1.xls" />
          </attribute>
          <attribute name="DDEItemName" inuse="True">
            <ProcessValue datatype="text" value="" />
          </attribute>
        </attributes>
      </element>
      <type>Application</type>
      <basetype>Application</basetype>
      <datatype>unknown</datatype>
      <diagnose>False</diagnose>
    </element>
    <apptypeinfo>
      <id>Win32Attach</id>
      <parameters>
        <parameter>
          <name>WindowTitle</name>
          <value>*Excel Samples*</value>
        </parameter>
        <parameter>
          <name>ProcessName</name>
          <value>
          </value>
        </parameter>
        <parameter>
          <name>Path</name>
          <value>
          </value>
        </parameter>
        <parameter>
          <name>CommandLineParams</name>
          <value>
          </value>
        </parameter>
        <parameter>
          <name>NonInvasive</name>
          <value>True</value>
        </parameter>
        <parameter>
          <name>ProcessMode</name>
          <value>Internal</value>
        </parameter>
        <parameter>
          <name>ExternalProcessTimeout</name>
          <value>0</value>
        </parameter>
        <parameter>
          <name>Options</name>
          <value>
          </value>
        </parameter>
      </parameters>
    </apptypeinfo>
  </appdef>
  <view>
    <camerax>0</camerax>
    <cameray>0</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="22b20e0d-220f-48fa-93d8-ebba1eab993d" type="CleanUp" published="True">
    <name>Clean Up</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="53e7584a-ad37-4c88-a9d3-cb9006c583eb" type="Normal" published="True">
    <name>Do Tests</name>
    <view>
      <camerax>195</camerax>
      <cameray>165</cameray>
      <zoom version="2">1.2</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="581314f5-8e5a-41cd-b5ef-436cef2c9e45" type="Normal" published="False">
    <name>Log Window Bounds</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="2d29eae1-3778-46d3-b8cb-3ae6d1989119" type="Normal" published="False">
    <name>Pause</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="ebeee08c-ef60-49d0-9a9b-eda0b04cf060" name="Start" type="Start">
    <loginhibit />
    <display x="15" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>060d1836-1f11-4e84-8553-72bab04f311b</onsuccess>
  </stage>
  <stage stageid="060d1836-1f11-4e84-8553-72bab04f311b" name="End" type="End">
    <loginhibit />
    <display x="15" y="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="197d504b-9285-42bb-9507-17c6044f4590" name="Stage1" type="ProcessInfo">
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <references>
      <reference>System.Data.dll</reference>
      <reference>System.Xml.dll</reference>
      <reference>System.Drawing.dll</reference>
      <reference>System.Windows.Forms.dll</reference>
    </references>
    <imports>
      <import>System</import>
      <import>System.Drawing</import>
      <import>System.Windows.Forms</import>
      <import>System.Runtime.InteropServices</import>
      <import>System.IO</import>
    </imports>
    <language>visualbasic</language>
    <globalcode><![CDATA[



]]></globalcode>
    <code><![CDATA[
<DllImport("user32.dll", setlasterror:=True)> _
Public Shared Function FindWindow(ByVal lpClassName As String, ByVal lpWindowName As String) As IntPtr
End Function

<DllImport("user32", CharSet:=CharSet.Ansi, SetLastError:=True, ExactSpelling:=True)> _
Public Shared Function GetWindowRect(ByVal hwnd As Integer, ByRef lpRect As RECT) As Integer
End Function


<StructLayout(LayoutKind.Sequential)> _
Public Structure RECT
	Public Left As Integer
	Public Top As Integer
	Public Right As Integer
	Public Bottom As Integer
	Public ReadOnly Property Width() As Integer
		Get
			Return Right - Left
		End Get
	End Property
	Public ReadOnly Property Height() As Integer
		Get
			Return Bottom - Top
		End Get
	End Property
End Structure
]]></code>
  </stage>
  <stage stageid="155f97b4-ee48-40ab-b0cc-b926539e9890" name="Clean Up" type="SubSheetInfo">
    <subsheetid>22b20e0d-220f-48fa-93d8-ebba1eab993d</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="82cdb04c-ac9e-4778-acd4-905c235c116f" name="Start" type="Start">
    <subsheetid>22b20e0d-220f-48fa-93d8-ebba1eab993d</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>81dbcb4a-aeac-4489-a1bd-3ba1e91fddf1</onsuccess>
  </stage>
  <stage stageid="81dbcb4a-aeac-4489-a1bd-3ba1e91fddf1" name="End" type="End">
    <subsheetid>22b20e0d-220f-48fa-93d8-ebba1eab993d</subsheetid>
    <loginhibit />
    <display x="15" y="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="107630af-2fc2-4c54-ab39-6fc6507ee3c3" name="Do Tests" type="SubSheetInfo">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="f18ebbe5-7cd8-4ff1-a3d9-abde0b84ab83" name="Start" type="Start">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="15" y="-345" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>2496bff2-47d8-4f81-b0ea-3098e0ded6c7</onsuccess>
  </stage>
  <stage stageid="a2f7579b-2fde-43e7-be18-4da6fdd34b5c" name="End" type="End">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="1650" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d7c1a28a-be97-4917-84df-f74b0cb2d95d" name="new" type="Note">
    <subsheetid>22b20e0d-220f-48fa-93d8-ebba1eab993d</subsheetid>
    <narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative>
    <display x="-180" y="60" w="180" h="230" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="33183eb4-b2b4-4341-b05d-0a36ce7d94b4" name="new" type="Note">
    <narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative>
    <display x="-180" y="60" w="180" h="230" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="ed4d50ed-df0f-4e73-8edb-d0eddd14d07c" name="Open Book" type="Action">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="15" y="-60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="File name" narrative="The path and name of the file which should be opened." expr="[QA Root] &amp; &quot;\code\MS Office\Excel Samples.xls&quot;" />
      <input type="number" name="handle" narrative="The integer handle identifying the instance on which the required workbook should be opened. The default of zero indicates the currently active instance." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Workbook Name" narrative="The name used by Excel to identify the workbook - usually this is the file name (without the path)." stage="" />
    </outputs>
    <onsuccess>125807c8-94b4-45d2-ab9b-da0ddb184858</onsuccess>
    <resource object="MS Excel VBO" action="Open Workbook" />
  </stage>
  <stage stageid="125807c8-94b4-45d2-ab9b-da0ddb184858" name="Show" type="Action">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="15" y="-15" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="handle" narrative="The integer handle identifying the instance which should have its window displayed. The default of zero indicates the currently active instance." expr="" />
    </inputs>
    <onsuccess>08d34cb6-b8f9-41b6-9ca4-249c46789c60</onsuccess>
    <resource object="MS Excel VBO" action="Show" />
  </stage>
  <stage stageid="4b32a72e-63ee-4647-9704-cd72ff8a0b7a" name="Attach" type="Navigate">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="15" y="105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>f02aee94-3608-4c4b-b0c0-29a26d1c9c52</onsuccess>
    <step>
      <element id="b6a2d99f-85b3-47bb-b01b-d91727a8f0fc" />
      <action>
        <id>Launch</id>
        <arguments>
          <argument>
            <id>WindowTitle</id>
            <value>[Window Title Match]</value>
          </argument>
        </arguments>
      </action>
    </step>
  </stage>
  <stage stageid="016d2f42-972b-4b2b-b4b1-90528610f9a4" name="Time Out2" type="WaitEnd">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="195" y="165" w="30" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <groupid>519d8ea9-b794-46c3-96f4-55cb29d9e88a</groupid>
  </stage>
  <stage stageid="f02aee94-3608-4c4b-b0c0-29a26d1c9c52" name="Check Main Window Present" type="WaitStart">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="15" y="165" w="60" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <groupid>519d8ea9-b794-46c3-96f4-55cb29d9e88a</groupid>
    <choices>
      <choice reply="True">
        <name>Main Window Check Exists</name>
        <distance>75</distance>
        <ontrue>db11d76c-0852-4705-a523-97cd71750296</ontrue>
        <element id="75fd9bbd-34ab-46f6-8a36-28518bbf795b">
          <elementparameter>
            <name>WindowText</name>
            <expression>[Window Title Match]</expression>
            <datatype>text</datatype>
            <comparisontype>Wildcard</comparisontype>
          </elementparameter>
        </element>
        <condition>
          <id>CheckExists</id>
        </condition>
        <comparetype>Equal</comparetype>
      </choice>
    </choices>
    <timeout>5</timeout>
  </stage>
  <stage stageid="db11d76c-0852-4705-a523-97cd71750296" name="Maximise Window (win32)" type="Navigate">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="225" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>dfbb3508-ca50-4e4d-a34a-a49ff80b80fc</onsuccess>
    <step>
      <element id="75fd9bbd-34ab-46f6-8a36-28518bbf795b">
        <elementparameter>
          <name>WindowText</name>
          <expression>[Window Title Match]</expression>
          <datatype>text</datatype>
          <comparisontype>Wildcard</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>MaximiseWindow</id>
      </action>
    </step>
  </stage>
  <stage stageid="ddc5bd15-109f-42e3-a0c1-16f2dd3c42db" name="Pause" type="SubSheetInfo">
    <subsheetid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="c7d68981-4de0-465a-b3d8-e6b152981bb6" name="Start" type="Start">
    <subsheetid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" stage="Seconds" />
    </inputs>
    <onsuccess>034222c1-fcf7-4c00-9db5-0aed9422f2fb</onsuccess>
  </stage>
  <stage stageid="a000f35a-e163-4d92-914d-ff7bcea7bbec" name="End" type="End">
    <subsheetid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</subsheetid>
    <loginhibit />
    <display x="15" y="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="1f836eca-cb4f-4650-8c5a-b141ef465f44" name="Time Out3" type="WaitEnd">
    <subsheetid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</subsheetid>
    <loginhibit />
    <display x="15" y="30" w="30" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>a000f35a-e163-4d92-914d-ff7bcea7bbec</onsuccess>
    <groupid>7f257cfb-448b-4bf1-8c4b-436d902326f4</groupid>
  </stage>
  <stage stageid="034222c1-fcf7-4c00-9db5-0aed9422f2fb" name="Wait2" type="WaitStart">
    <subsheetid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</subsheetid>
    <loginhibit />
    <display x="15" y="-30" w="30" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <groupid>7f257cfb-448b-4bf1-8c4b-436d902326f4</groupid>
    <choices />
    <timeout>[Seconds]</timeout>
  </stage>
  <stage stageid="610503a5-b544-4f29-8648-8e3ac6eba6e2" name="Seconds" type="Data">
    <subsheetid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</subsheetid>
    <display x="90" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="08d34cb6-b8f9-41b6-9ca4-249c46789c60" name="Pause" type="SubSheet">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="15" y="45" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" expr="15" />
    </inputs>
    <onsuccess>4b32a72e-63ee-4647-9704-cd72ff8a0b7a</onsuccess>
    <processid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</processid>
  </stage>
  <stage stageid="dfbb3508-ca50-4e4d-a34a-a49ff80b80fc" name="Pause" type="SubSheet">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="285" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" expr="1" />
    </inputs>
    <onsuccess>22e3f384-88b3-421b-9cab-2c304ff5548f</onsuccess>
    <processid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</processid>
  </stage>
  <stage stageid="22e3f384-88b3-421b-9cab-2c304ff5548f" name="Get Window Bounds" type="Read">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="330" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>0e80b22c-ac69-444c-a73a-4ac73b384c18</onsuccess>
    <step stage="Bounds">
      <element id="75fd9bbd-34ab-46f6-8a36-28518bbf795b">
        <elementparameter>
          <name>WindowText</name>
          <expression>[Window Title Match]</expression>
          <datatype>text</datatype>
          <comparisontype>Wildcard</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>GetElementBounds</id>
      </action>
    </step>
  </stage>
  <stage stageid="2240d104-5f57-4e31-8ce3-5f499053ee2b" name="Bounds" type="Collection">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="165" y="330" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d58e3f48-562a-4eba-a151-a3651eddf3c1" name="Validate Bounds" type="Decision">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="420" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Bounds.Height] &gt; [Height] - 10&#xA;and&#xA;[Bounds.Width] &gt; [Width] - 10" />
    <ontrue>686169e5-beb6-4acd-93a5-796291056de9</ontrue>
    <onfalse>2156ca7c-445e-4113-8677-6d5855da3066</onfalse>
  </stage>
  <stage stageid="686169e5-beb6-4acd-93a5-796291056de9" name="Minimise Using DDE" type="Navigate">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="495" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>e0b5db15-35c6-400c-9268-71bb9a22ed0f</onsuccess>
    <step>
      <element id="bc97747e-de72-48dd-a843-d2c34077da0b">
        <elementparameter>
          <name>DDETopicName</name>
          <expression>[QA Root]&amp;"\code\MS Office\Excel Samples.xls"</expression>
          <datatype>text</datatype>
          <comparisontype>Equal</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>ExecuteDDECommand</id>
        <arguments>
          <argument>
            <id>newtext</id>
            <value>"[App.Minimize()]"</value>
          </argument>
          <argument>
            <id>NoCheck</id>
            <value>
            </value>
          </argument>
        </arguments>
      </action>
    </step>
  </stage>
  <stage stageid="8b55ad7a-fe2d-4a77-9f66-051e22d00324" name="Pause" type="SubSheet">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="585" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" expr="1" />
    </inputs>
    <onsuccess>b395f43b-ddd4-46de-8a92-a2382a428031</onsuccess>
    <processid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</processid>
  </stage>
  <stage stageid="b395f43b-ddd4-46de-8a92-a2382a428031" name="Get Window Bounds" type="Read">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="630" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>920e5193-f1bc-4150-9d02-8ad449aec36e</onsuccess>
    <step stage="Bounds">
      <element id="75fd9bbd-34ab-46f6-8a36-28518bbf795b">
        <elementparameter>
          <name>WindowText</name>
          <expression>[Window Title Match]</expression>
          <datatype>text</datatype>
          <comparisontype>Wildcard</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>GetElementBounds</id>
      </action>
    </step>
  </stage>
  <stage stageid="e3e70c4c-2f52-49ce-9430-00f081c94560" name="Validate Bounds" type="Decision">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="720" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Bounds.Width] &lt; 200" />
    <ontrue>2c7d10ee-acfe-44fa-a8a8-e8854be85f8f</ontrue>
    <onfalse>044dc76f-0392-4cb5-9366-2710467c9dd5</onfalse>
  </stage>
  <stage stageid="2156ca7c-445e-4113-8677-6d5855da3066" name="Increment Retries" type="Calculation">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="-30" y="420" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>b3f2fe52-0c23-47b6-a24f-8c169ef49157</onsuccess>
    <calculation expression="1 + [Retries]" stage="Retries" />
  </stage>
  <stage stageid="95422a69-cbf0-4aad-8257-c5021b6c7276" name="Retries" type="Data">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="-105" y="420" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b3f2fe52-0c23-47b6-a24f-8c169ef49157" name="Too Many Retries?" type="Decision">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="-30" y="285" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Retries] &gt; 5" />
    <ontrue>ddb67489-ed0d-4758-8a1b-e29dc9cc2600</ontrue>
    <onfalse>dfbb3508-ca50-4e4d-a34a-a49ff80b80fc</onfalse>
  </stage>
  <stage stageid="ddb67489-ed0d-4758-8a1b-e29dc9cc2600" name="Note1" type="Note">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <narrative>FAIL</narrative>
    <display x="-150" y="285" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="044dc76f-0392-4cb5-9366-2710467c9dd5" name="Increment Retries" type="Calculation">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="-15" y="720" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>49a9fb66-c1a4-4081-a73a-f3e65de23769</onsuccess>
    <calculation expression="1 + [Retries]" stage="Retries" />
  </stage>
  <stage stageid="49a9fb66-c1a4-4081-a73a-f3e65de23769" name="Too Many Retries?" type="Decision">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="-15" y="585" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Retries] &gt; 5" />
    <ontrue>a83ff4c5-dd40-4298-9fb9-4731c85a4bba</ontrue>
    <onfalse>8b55ad7a-fe2d-4a77-9f66-051e22d00324</onfalse>
  </stage>
  <stage stageid="a83ff4c5-dd40-4298-9fb9-4731c85a4bba" name="Note1" type="Note">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <narrative>FAIL</narrative>
    <display x="-135" y="585" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="e0b5db15-35c6-400c-9268-71bb9a22ed0f" name="Reset Retries" type="Calculation">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="540" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>8b55ad7a-fe2d-4a77-9f66-051e22d00324</onsuccess>
    <calculation expression="0" stage="Retries" />
  </stage>
  <stage stageid="2c7d10ee-acfe-44fa-a8a8-e8854be85f8f" name="Maximise Using DDE" type="Navigate">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="780" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>730c32ba-6951-49de-b0e9-6a0be2f7a54f</onsuccess>
    <step>
      <element id="bc97747e-de72-48dd-a843-d2c34077da0b">
        <elementparameter>
          <name>DDETopicName</name>
          <expression>[QA Root]&amp;"\code\MS Office\Excel Samples.xls"</expression>
          <datatype>text</datatype>
          <comparisontype>Equal</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>ExecuteDDECommand</id>
        <arguments>
          <argument>
            <id>newtext</id>
            <value>"[App.Maximize()]"</value>
          </argument>
          <argument>
            <id>NoCheck</id>
            <value>
            </value>
          </argument>
        </arguments>
      </action>
    </step>
  </stage>
  <stage stageid="5dfdb0f3-1b12-4259-b495-61d5714c1e32" name="Pause" type="SubSheet">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="870" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="Seconds" expr="1" />
    </inputs>
    <onsuccess>279e703c-5a14-4687-857e-726b439439fe</onsuccess>
    <processid>2d29eae1-3778-46d3-b8cb-3ae6d1989119</processid>
  </stage>
  <stage stageid="279e703c-5a14-4687-857e-726b439439fe" name="Get Window Bounds" type="Read">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="915" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>304f62af-0423-4392-9465-5e0d58412a86</onsuccess>
    <step stage="Bounds">
      <element id="75fd9bbd-34ab-46f6-8a36-28518bbf795b">
        <elementparameter>
          <name>WindowText</name>
          <expression>[Window Title Match]</expression>
          <datatype>text</datatype>
          <comparisontype>Wildcard</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>GetElementBounds</id>
      </action>
    </step>
  </stage>
  <stage stageid="a6df18f1-8f6d-458c-b468-0aac64cbeacf" name="Validate Bounds" type="Decision">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="1005" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Bounds.Width] &gt; [Width] - 10" />
    <ontrue>a41b5305-44d0-4ab0-96c5-d94b99c3aad7</ontrue>
    <onfalse>7a56dfb7-b669-46dd-a211-ec1ead109b8c</onfalse>
  </stage>
  <stage stageid="7a56dfb7-b669-46dd-a211-ec1ead109b8c" name="Increment Retries" type="Calculation">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="-15" y="1005" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>1767e398-2310-4b4d-bc56-32bcc9fcbf73</onsuccess>
    <calculation expression="1 + [Retries]" stage="Retries" />
  </stage>
  <stage stageid="1767e398-2310-4b4d-bc56-32bcc9fcbf73" name="Too Many Retries?" type="Decision">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="-15" y="870" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Retries] &gt; 5" />
    <ontrue>4f19494f-1853-443e-ac11-269943e378cc</ontrue>
    <onfalse>5dfdb0f3-1b12-4259-b495-61d5714c1e32</onfalse>
  </stage>
  <stage stageid="4f19494f-1853-443e-ac11-269943e378cc" name="Note1" type="Note">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <narrative>FAIL</narrative>
    <display x="-135" y="870" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="730c32ba-6951-49de-b0e9-6a0be2f7a54f" name="Reset Retries" type="Calculation">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="825" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>5dfdb0f3-1b12-4259-b495-61d5714c1e32</onsuccess>
    <calculation expression="0" stage="Retries" />
  </stage>
  <stage stageid="a41b5305-44d0-4ab0-96c5-d94b99c3aad7" name="Save as Book1" type="Navigate">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="1065" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>0a32fa49-ed8c-4fec-8f52-560f41dd8b32</onsuccess>
    <step>
      <element id="bc97747e-de72-48dd-a843-d2c34077da0b">
        <elementparameter>
          <name>DDETopicName</name>
          <expression>[QA Root]&amp;"\code\MS Office\Excel Samples.xls"</expression>
          <datatype>text</datatype>
          <comparisontype>Equal</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>ExecuteDDECommand</id>
        <arguments>
          <argument>
            <id>newtext</id>
            <value>"[Save.As("""&amp;[QA Root]&amp;"\code\ms office\book1.xls"")]"</value>
          </argument>
          <argument>
            <id>NoCheck</id>
            <value>
            </value>
          </argument>
        </arguments>
      </action>
    </step>
  </stage>
  <stage stageid="5b65df2d-c622-43eb-94fa-fb8a64b4a285" name="Time Out1" type="WaitEnd">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="225" y="1125" w="30" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <groupid>8249ac8b-3be6-43fb-b752-50305dc4b6c7</groupid>
  </stage>
  <stage stageid="0a32fa49-ed8c-4fec-8f52-560f41dd8b32" name="Wait for Title to Say Book1" type="WaitStart">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="1125" w="60" h="60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <groupid>8249ac8b-3be6-43fb-b752-50305dc4b6c7</groupid>
    <choices>
      <choice reply="True">
        <name>Main Window Check Exists</name>
        <distance>60</distance>
        <ontrue>eda847ef-4f64-4b4a-8b52-92f9f5769a68</ontrue>
        <element id="75fd9bbd-34ab-46f6-8a36-28518bbf795b">
          <elementparameter>
            <name>WindowText</name>
            <expression>"*Book1*"</expression>
            <datatype>text</datatype>
            <comparisontype>Wildcard</comparisontype>
          </elementparameter>
        </element>
        <condition>
          <id>CheckExists</id>
        </condition>
        <comparetype>Equal</comparetype>
      </choice>
    </choices>
    <timeout>15</timeout>
  </stage>
  <stage stageid="07b529f9-cdfc-4dfa-a950-87e37af83bbf" name="Move Cell Right (to B1)" type="Navigate">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="1275" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>154e5fd9-e22a-4ff1-a450-6c2bc4eba069</onsuccess>
    <step>
      <element id="66b607bd-7571-41cb-bf4e-3799d6b4297d">
        <elementparameter>
          <name>DDETopicName</name>
          <expression>[QA Root]&amp;"\code\ms office\Book1.xls"</expression>
          <datatype>text</datatype>
          <comparisontype>Equal</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>ExecuteDDECommand</id>
        <arguments>
          <argument>
            <id>newtext</id>
            <value>"[Select(,""RC[1]"")]"</value>
          </argument>
          <argument>
            <id>NoCheck</id>
            <value>
            </value>
          </argument>
        </arguments>
      </action>
    </step>
  </stage>
  <stage stageid="eda847ef-4f64-4b4a-8b52-92f9f5769a68" name="Set Value of B1" type="Action">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="1185" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Cell Reference" narrative="The reference on the speficied sheet identifying the cell which should be set." expr="&quot;B1&quot;" />
      <input type="text" name="Value" narrative="The value to which the specified cell should be set." expr="&quot;5&quot;" />
      <input type="number" name="handle" narrative="The integer handle identifying the instance on which the required cell value should be set. The default of zero indicates the currently active instance." expr="" />
    </inputs>
    <onsuccess>0c03588f-163b-4c55-98b1-a1bf6251642e</onsuccess>
    <resource object="MS Excel VBO" action="Set Cell Value" />
  </stage>
  <stage stageid="0c03588f-163b-4c55-98b1-a1bf6251642e" name="Goto A1" type="Action">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="1230" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Cell Reference" narrative="The cell reference on the currently active sheet within the specified instance which should be navigated to." expr="&quot;A1&quot;" />
      <input type="number" name="handle" narrative="The integer handle identifying the instance on which the required cell should be navigated to. The default of zero indicates the currently active instance." expr="" />
    </inputs>
    <onsuccess>07b529f9-cdfc-4dfa-a950-87e37af83bbf</onsuccess>
    <resource object="MS Excel VBO" action="Go To Cell" />
  </stage>
  <stage stageid="154e5fd9-e22a-4ff1-a450-6c2bc4eba069" name="Get Value From Current Cell" type="Action">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="1320" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="handle" narrative="The integer handle identifying the instance on which the cell whose value is required resides. The default of zero indicates the currently active instance." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Value" narrative="The (unformatted) value found at the specified cell." stage="Value" />
    </outputs>
    <onsuccess>2a886526-7676-480d-b91e-b6a408f5db0a</onsuccess>
    <resource object="MS Excel VBO" action="Get Active Cell Value" />
  </stage>
  <stage stageid="169fb933-c126-4f9c-a7c8-12ed525a4f29" name="Value" type="Data">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="240" y="1320" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2a886526-7676-480d-b91e-b6a408f5db0a" name="Validate Value" type="Decision">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="1380" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <decision expression="[Value] = &quot;5&quot;" />
    <ontrue>05a9c377-83ad-4822-b897-451dd8406839</ontrue>
    <onfalse>d2ca731a-5b8e-4a84-8f1a-551f3a471899</onfalse>
  </stage>
  <stage stageid="3748de47-20e9-489e-a70b-69d2fd933ef1" name="Note2" type="Note">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <narrative>About:

This test uses a mixture of DDE and the MS Excel COM object to test that each is working.

Excel DDE commands are a subset of the Excel 4 macro language. Download the Macrofun.hlp file for more details.</narrative>
    <display x="-225" y="60" w="210" h="210" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d2ca731a-5b8e-4a84-8f1a-551f3a471899" name="Note1" type="Note">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <narrative>FAIL</narrative>
    <display x="30" y="1380" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="6aa3a6b9-62d0-4c97-8938-5ea2362da131" name="Quit" type="Navigate">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="1575" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>a2f7579b-2fde-43e7-be18-4da6fdd34b5c</onsuccess>
    <step>
      <element id="66b607bd-7571-41cb-bf4e-3799d6b4297d">
        <elementparameter>
          <name>DDETopicName</name>
          <expression>[QA Root]&amp;"\code\ms office\Book1.xls"</expression>
          <datatype>text</datatype>
          <comparisontype>Equal</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>ExecuteDDECommand</id>
        <arguments>
          <argument>
            <id>newtext</id>
            <value>"[Quit()]"</value>
          </argument>
          <argument>
            <id>NoCheck</id>
            <value>True</value>
          </argument>
        </arguments>
      </action>
    </step>
  </stage>
  <stage stageid="8cc46f49-cf88-4798-938b-81ba0617ee16" name="Window Title Match" type="Data">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <loginhibit />
    <display x="150" y="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">*Excel Samples*</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6a712472-a886-43bb-886c-6d8f1c7c9c16" name="Log Window Bounds" type="SubSheetInfo">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="4b40c480-3ea3-4d68-975d-7d2ef37175b2" name="Start" type="Start">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="15" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="Window Bounds" stage="Window Bounds" />
    </inputs>
    <onsuccess>c8b9504c-a2d4-4691-95e5-4ac7fa8ca0c4</onsuccess>
  </stage>
  <stage stageid="968d3a07-e285-471b-a3ce-f73a93172cd1" name="End" type="End">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="15" y="120" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="0a74c2a7-c24a-4b1b-b485-c84cfb4b8df2" name="Window Bounds" type="Collection">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="90" y="-105" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c8b9504c-a2d4-4691-95e5-4ac7fa8ca0c4" name="Cast Top" type="Calculation">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="15" y="-60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>52ebaf05-523f-4d18-9080-7e86459ca41d</onsuccess>
    <calculation expression="[Window Bounds.Top]" stage="Top" />
  </stage>
  <stage stageid="f518cd71-b6f2-4081-b74a-f64885ae3c8d" name="Top" type="Data">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="90" y="-60" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="52ebaf05-523f-4d18-9080-7e86459ca41d" name="Cast Bottom" type="Calculation">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="15" y="-15" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>7bd8b521-615f-4397-a61c-5ce6c860c059</onsuccess>
    <calculation expression="[Window Bounds.Bottom]" stage="Bottom" />
  </stage>
  <stage stageid="e71b6d0e-bc13-4e6d-adae-03efddf62ef2" name="Bottom" type="Data">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="90" y="-15" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7bd8b521-615f-4397-a61c-5ce6c860c059" name="Cast Left" type="Calculation">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="15" y="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>aff202ee-820f-44d6-9461-f64e331ef333</onsuccess>
    <calculation expression="[Window Bounds.Left]" stage="Left" />
  </stage>
  <stage stageid="aff202ee-820f-44d6-9461-f64e331ef333" name="Cast Right" type="Calculation">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="15" y="75" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>968d3a07-e285-471b-a3ce-f73a93172cd1</onsuccess>
    <calculation expression="[Window Bounds.Right]" stage="Right" />
  </stage>
  <stage stageid="5c0172b7-1386-4151-a568-b6dc56c4dad0" name="Right" type="Data">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="90" y="75" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f0135ec0-95ad-4059-8eb8-7b303d6fd2b9" name="Left" type="Data">
    <subsheetid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</subsheetid>
    <display x="90" y="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0e80b22c-ac69-444c-a73a-4ac73b384c18" name="Log Window Bounds" type="SubSheet">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <loginhibit />
    <display x="90" y="375" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="Window Bounds" expr="[Bounds]" />
    </inputs>
    <onsuccess>d58e3f48-562a-4eba-a151-a3651eddf3c1</onsuccess>
    <processid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</processid>
  </stage>
  <stage stageid="920e5193-f1bc-4150-9d02-8ad449aec36e" name="Log Window Bounds" type="SubSheet">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <loginhibit />
    <display x="90" y="675" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="Window Bounds" expr="[Bounds]" />
    </inputs>
    <onsuccess>e3e70c4c-2f52-49ce-9430-00f081c94560</onsuccess>
    <processid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</processid>
  </stage>
  <stage stageid="304f62af-0423-4392-9465-5e0d58412a86" name="Log Window Bounds" type="SubSheet">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <loginhibit />
    <display x="90" y="960" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="collection" name="Window Bounds" expr="[Bounds]" />
    </inputs>
    <onsuccess>a6df18f1-8f6d-458c-b468-0aac64cbeacf</onsuccess>
    <processid>581314f5-8e5a-41cd-b5ef-436cef2c9e45</processid>
  </stage>
  <stage stageid="0205e531-9bf1-4300-b2c4-a23f7859df5d" name="Get Desktop Size" type="Code">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="15" y="-180" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="number" name="Width" stage="Width" />
      <output type="number" name="Height" stage="Height" />
    </outputs>
    <onsuccess>ed4d50ed-df0f-4e73-8edb-d0eddd14d07c</onsuccess>
    <code><![CDATA[Dim TaskbarHeight as integer
Dim p as System.IntPtr = FindWindow("Shell_TrayWnd", Nothing)
If p <> System.IntPtr.Zero Then
	Dim R as RECT
	GetWindowRect(p, R)
   TaskbarHeight = R.Height
End If

Width = Screen.PrimaryScreen.Bounds.Width
Height = Screen.PrimaryScreen.Bounds.Height - TaskbarHeight]]></code>
  </stage>
  <stage stageid="807b1427-8ace-4b76-a14e-c2ebd3ef96aa" name="Width" type="Data">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="90" y="-180" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e3627b97-71c1-4ff3-8b2f-28e285255202" name="Height" type="Data">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="-180" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="05a9c377-83ad-4822-b897-451dd8406839" name="Save" type="Navigate">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <display x="150" y="1530" w="90" h="30" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <onsuccess>6aa3a6b9-62d0-4c97-8938-5ea2362da131</onsuccess>
    <step>
      <element id="66b607bd-7571-41cb-bf4e-3799d6b4297d">
        <elementparameter>
          <name>DDETopicName</name>
          <expression>[QA Root]&amp;"\code\ms office\Book1.xls"</expression>
          <datatype>text</datatype>
          <comparisontype>Equal</comparisontype>
        </elementparameter>
      </element>
      <action>
        <id>ExecuteDDECommand</id>
        <arguments>
          <argument>
            <id>newtext</id>
            <value>"[Save()]"</value>
          </argument>
          <argument>
            <id>NoCheck</id>
            <value>True</value>
          </argument>
        </arguments>
      </action>
    </step>
  </stage>
  <stage stageid="365048df-793b-4f8d-a5ca-5c793dc589c9" name="Delete file if exists" type="Code">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <loginhibit />
    <narrative>We save the workbook as a temporary file later in the test. If we don't remove it, we can only ever run this test once without manually removing it.</narrative>
    <display x="15" y="-240" />
    <font family="Tahoma" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="filepath" expr="[QA Root] &amp; [My File]" />
    </inputs>
    <onsuccess>0205e531-9bf1-4300-b2c4-a23f7859df5d</onsuccess>
    <code><![CDATA[Dim filename As String = filepath
If File.Exists(filename) Then
  File.Delete(filename)
End If]]></code>
  </stage>
  <stage stageid="5064985f-2499-4ccc-a4fc-69fbbeafc039" name="QA Root" type="Data">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <loginhibit />
    <display x="-180" y="-195" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="73896aba-86b1-4ca5-a42c-f6285f00dbfc" name="My File" type="Data">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <loginhibit />
    <display x="-180" y="-240" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">\code\ms office\book1.xls</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2496bff2-47d8-4f81-b0ea-3098e0ded6c7" name="Calc1" type="Calculation">
    <subsheetid>53e7584a-ad37-4c88-a9d3-cb9006c583eb</subsheetid>
    <loginhibit />
    <display x="15" y="-300" />
    <onsuccess>365048df-793b-4f8d-a5ca-5c793dc589c9</onsuccess>
    <calculation expression="[QA Root] &amp; &quot;\code\ms office\book1.xls&quot;" stage="My File" />
  </stage>
</process>