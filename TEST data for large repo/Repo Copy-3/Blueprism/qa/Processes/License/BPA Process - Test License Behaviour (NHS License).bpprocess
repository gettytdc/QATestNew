<process name="Test License Behaviour (NHS License)" version="1.0" bpversion="6.11.0.37206" narrative="" byrefcollection="true" preferredid="13787c53-0aa0-4e5c-96ba-e76f4c8ad9bc">
  <view>
    <camerax>-33</camerax>
    <cameray>105</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="8817ff13-b211-4a13-aa43-9b9d72dff902" type="Normal" published="False">
    <name>Setup</name>
    <view>
      <camerax>0</camerax>
      <cameray>420</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="aa23760a-c7e2-4951-9a4c-86469f3e5045" type="Normal" published="False">
    <name>Test NHS License</name>
    <view>
      <camerax>55</camerax>
      <cameray>1899</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="823ffd44-93ea-49ae-a690-c7eb56676117" type="Normal" published="False">
    <name>Add to Cleanup</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda" type="Normal" published="False">
    <name>Cleanup</name>
    <view>
      <camerax>109</camerax>
      <cameray>126</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="09c3082c-354e-4371-94c3-6b3b80fb28b6" name="Start" type="Start">
    <display x="15" y="-120" />
    <onsuccess>fa9f992f-63db-4cbc-8153-a82eabb5b70a</onsuccess>
  </stage>
  <stage stageid="6736e8b5-6eb6-49cf-8bed-1003bfd3a2b0" name="End" type="End">
    <display x="15" y="285" />
  </stage>
  <stage stageid="54bf3dab-815c-4e3d-9dfc-2768f871cc55" name="Stage1" type="ProcessInfo">
    <display x="-240" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="fa9f992f-63db-4cbc-8153-a82eabb5b70a" name="Note1" type="Note">
    <narrative>GIVEN I only have a NHS license installed</narrative>
    <display x="15" y="-45" w="300" h="60" />
    <onsuccess>725101eb-593b-4417-be48-8150ce390a11</onsuccess>
  </stage>
  <stage stageid="f16b5a69-5ab4-417f-9455-40bbb0f40448" name="Note1" type="Note">
    <narrative>WHEN I try and access the different areas of the product
THEN the apropriate functions should be avaliable </narrative>
    <display x="15" y="75" w="300" h="60" />
    <onsuccess>b16738ce-9bac-4f31-8534-545afbf41fc4</onsuccess>
  </stage>
  <stage stageid="328e932a-38d7-4a06-b01e-c87e900f70ea" name="Setup" type="SubSheetInfo">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="-120" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="34303645-ee70-4529-bfbf-6b8bcdeaeb24" name="Start" type="Start">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="-60" />
    <onsuccess>b0030a63-b1f4-4747-b331-bf627342bdcf</onsuccess>
  </stage>
  <stage stageid="935f41a0-b241-4b10-8d42-230b1baa8163" name="End" type="End">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="570" />
  </stage>
  <stage stageid="2f45f8d6-d03d-4cb2-95bc-b74bbf4cc7e9" name="Cleanup" type="SubSheetInfo">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="-120" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="d8ff9640-9a69-400e-8a0a-b8ffb32ca249" name="Add to Cleanup" type="SubSheetInfo">
    <subsheetid>823ffd44-93ea-49ae-a690-c7eb56676117</subsheetid>
    <display x="-120" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="0a26c498-b6b8-4166-85b4-2525fd388905" name="Test NHS License" type="SubSheetInfo">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-135" y="15" w="150" h="90" />
  </stage>
  <stage stageid="725101eb-593b-4417-be48-8150ce390a11" name="Setup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="15" w="300" h="30" />
    <onsuccess>f16b5a69-5ab4-417f-9455-40bbb0f40448</onsuccess>
    <processid>8817ff13-b211-4a13-aa43-9b9d72dff902</processid>
  </stage>
  <stage stageid="b16738ce-9bac-4f31-8534-545afbf41fc4" name="Test NHS License" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="135" w="300" h="30" />
    <onsuccess>50495d65-dbe4-4253-af0c-3058026acf91</onsuccess>
    <processid>aa23760a-c7e2-4951-9a4c-86469f3e5045</processid>
  </stage>
  <stage stageid="50495d65-dbe4-4253-af0c-3058026acf91" name="Cleanup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="195" w="300" h="30" />
    <onsuccess>8dcfc8e1-0e4f-47d7-a0a9-2b10ec5fd615</onsuccess>
    <processid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</processid>
  </stage>
  <stage stageid="8dcfc8e1-0e4f-47d7-a0a9-2b10ec5fd615" name="Failed?" type="Decision">
    <display x="15" y="240" w="120" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>871c350f-c9d6-4a6a-b8e3-3e1a839e1af7</ontrue>
    <onfalse>6736e8b5-6eb6-49cf-8bed-1003bfd3a2b0</onfalse>
  </stage>
  <stage stageid="871c350f-c9d6-4a6a-b8e3-3e1a839e1af7" name="FAIL" type="Exception">
    <display x="120" y="240" />
    <exception localized="yes" type="RETHOW" detail="[Exception]" />
  </stage>
  <stage stageid="6b8a4c88-a3fb-4c42-9a1a-a5e92af012d3" name="Anchor1" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="210" y="195" w="10" h="10" />
    <onsuccess>50495d65-dbe4-4253-af0c-3058026acf91</onsuccess>
  </stage>
  <stage stageid="8cd5c7d2-aecb-4687-85c3-2d4622c96530" name="Resume" type="Resume">
    <loginhibit />
    <display x="210" y="30" />
    <onsuccess>6b8a4c88-a3fb-4c42-9a1a-a5e92af012d3</onsuccess>
  </stage>
  <stage stageid="659be156-1dce-427f-afcb-81886d9a6375" name="Get Exception &amp; Mark Fail" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="210" y="-15" />
    <onsuccess>8cd5c7d2-aecb-4687-85c3-2d4622c96530</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="54e2b421-bb51-475a-bcb2-218a8d809c24" name="Failed?" type="Data">
    <display x="-240" y="165" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c4c84140-24ec-4339-8d0b-a39c2a26d83e" name="Exception" type="Data">
    <display x="-240" y="195" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8da092f1-bef6-4772-9757-ad5d55ea6d9c" name="QA Root" type="Data">
    <display x="-240" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="ab474e71-447e-496e-b77a-bed21b483946" name="Environment Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-315" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="189bbb0d-798c-4a67-ab1a-5cd98f34e408" name="Local Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-315" y="135" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4df1236a-babd-4abe-9946-7a02f2b6a79b" name="Global Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-315" y="60" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="276e541a-9f1b-4d3d-a317-e5ae70c3c6fd" name="Cleanup Block" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-150" y="-90" w="405" h="255" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="bf3303af-d502-4c8b-8fe0-661289364d43" name="Start" type="Start">
    <subsheetid>823ffd44-93ea-49ae-a690-c7eb56676117</subsheetid>
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="Item Name" narrative="The name of the item you want to clean up." stage="Item Name" />
    </inputs>
    <onsuccess>94428f83-a103-4a92-8d74-2b1e1755ba17</onsuccess>
  </stage>
  <stage stageid="312784c3-1212-4bdb-b05a-fa6eac91be65" name="End" type="End">
    <subsheetid>823ffd44-93ea-49ae-a690-c7eb56676117</subsheetid>
    <display x="15" y="30" />
  </stage>
  <stage stageid="19962438-689c-4ec0-925a-c53401af1d2b" name="Item Name" type="Data">
    <subsheetid>823ffd44-93ea-49ae-a690-c7eb56676117</subsheetid>
    <display x="-120" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="253f4f56-6e58-4e3b-ab5b-5de9530f98ee" name="Input Variables" type="Block">
    <subsheetid>823ffd44-93ea-49ae-a690-c7eb56676117</subsheetid>
    <display x="-195" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="94428f83-a103-4a92-8d74-2b1e1755ba17" name="Add Row" type="Action">
    <subsheetid>823ffd44-93ea-49ae-a690-c7eb56676117</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;CleanUp Collection&quot;" />
    </inputs>
    <onsuccess>a1bccebc-1555-4d47-9ce2-1161064f4f08</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="a1bccebc-1555-4d47-9ce2-1161064f4f08" name="Add To Row" type="Calculation">
    <subsheetid>823ffd44-93ea-49ae-a690-c7eb56676117</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <onsuccess>312784c3-1212-4bdb-b05a-fa6eac91be65</onsuccess>
    <calculation expression="[Item Name]" stage="CleanUp Collection.Item Name" />
  </stage>
  <stage stageid="e0c43245-0487-43a3-834f-917ce786286d" name="CleanUp Collection" type="Collection">
    <display x="-240" y="90" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Item Name" type="text" description="The name of the item that needs cleaning up." />
    </collectioninfo>
    <noalwaysinit />
  </stage>
  <stage stageid="f4759769-6551-4c0b-82ec-621aca704667" name="Start" type="Start">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>58d9c64d-fd16-482d-9a16-69618a97c352</onsuccess>
  </stage>
  <stage stageid="a7093033-862d-49f1-8827-70ada84a6657" name="To Clean" type="LoopStart">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <onsuccess>e7b923dd-00e9-4691-8348-762b2b246630</onsuccess>
    <groupid>762429a6-d27a-40fd-88b1-7322c776ff30</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Reversed CleanUp</loopdata>
  </stage>
  <stage stageid="58b905d5-9c26-4329-8233-32faf436553a" name="To Clean" type="LoopEnd">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="15" y="255" w="90" h="30" />
    <onsuccess>ae65f73f-1ae0-494d-a4fd-4a577b073945</onsuccess>
    <groupid>762429a6-d27a-40fd-88b1-7322c776ff30</groupid>
  </stage>
  <stage stageid="e7b923dd-00e9-4691-8348-762b2b246630" name="Which Clean Up" type="ChoiceStart">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="15" y="30" w="90" h="30" />
    <groupid>521c7e37-7e55-4992-b184-ed2b8cea3c5e</groupid>
    <choices>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Blue Prism&quot;">
        <name>Blue Prism</name>
        <distance>45</distance>
        <ontrue>ceabad56-e4c2-41a8-bbc6-1b1a729c7b9a</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;BluePrismQA&quot;">
        <name>BluePrismQA</name>
        <distance>90</distance>
        <ontrue>c66411ce-296b-4e92-8199-17547f948bed</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;NHS&quot;">
        <name>NHS</name>
        <distance>135</distance>
        <ontrue>d7f76b9a-f406-4892-a4a8-f5004ae462b1</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="ea1fbe16-365f-453a-9bbe-b6442237ff86" name="Otherwise" type="ChoiceEnd">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="15" y="210" w="90" h="30" />
    <onsuccess>5997f8ad-346b-447d-b804-bdad399f1c56</onsuccess>
    <groupid>521c7e37-7e55-4992-b184-ed2b8cea3c5e</groupid>
  </stage>
  <stage stageid="5997f8ad-346b-447d-b804-bdad399f1c56" name="FAIL" type="Exception">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="90" y="210" w="30" h="30" />
    <exception type="" detail="&quot;You have entered a clean up item the choice doesn't recognise.&quot;" />
  </stage>
  <stage stageid="58d9c64d-fd16-482d-9a16-69618a97c352" name="Reverse Collection" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" narrative="The collection to be reversed." expr="[CleanUp Collection]" />
    </inputs>
    <outputs>
      <output type="collection" name="Reversed Collection" narrative="The reversed collection." stage="Reversed CleanUp" />
    </outputs>
    <onsuccess>a7093033-862d-49f1-8827-70ada84a6657</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Reverse Collection" />
  </stage>
  <stage stageid="24cc1699-52d5-4427-ad12-cd0a1c1142a5" name="Reversed CleanUp" type="Collection">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="-120" y="15" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="52f7ba62-f5ff-42fa-9717-461a53404299" name="Local Variables" type="Block">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="-195" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="807b7691-70d5-4046-b544-9941e492a580" name="Anchor5" type="Anchor">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="540" y="255" w="10" h="10" />
    <onsuccess>58b905d5-9c26-4329-8233-32faf436553a</onsuccess>
  </stage>
  <stage stageid="f5d13fca-e60e-40e7-a799-94ef07c5e063" name="Anchor4" type="Anchor">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="540" y="120" w="10" h="10" />
    <onsuccess>2aaab0e2-3421-4565-b569-e03cb6c4464a</onsuccess>
  </stage>
  <stage stageid="2aaab0e2-3421-4565-b569-e03cb6c4464a" name="Anchor4" type="Anchor">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="540" y="165" w="10" h="10" />
    <onsuccess>807b7691-70d5-4046-b544-9941e492a580</onsuccess>
  </stage>
  <stage stageid="b492637e-697a-40fc-a410-d64eb0cc9796" name="Terminate" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="465" y="75" w="90" h="30" />
    <onsuccess>1a13820c-713c-40ce-a249-df4dc2f74a09</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="ceabad56-e4c2-41a8-bbc6-1b1a729c7b9a" name="Close all child windows" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="360" y="75" w="90" h="30" />
    <onsuccess>b492637e-697a-40fc-a410-d64eb0cc9796</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Close All Child Windows" />
  </stage>
  <stage stageid="1a13820c-713c-40ce-a249-df4dc2f74a09" name="Anchor9" type="Anchor">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="540" y="75" w="10" h="10" />
    <onsuccess>f5d13fca-e60e-40e7-a799-94ef07c5e063</onsuccess>
  </stage>
  <stage stageid="ae65f73f-1ae0-494d-a4fd-4a577b073945" name="End1" type="End">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="15" y="300" />
  </stage>
  <stage stageid="bdd0b293-8f00-471b-9886-2eae124f6d93" name="Goto System" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="255" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>62cee925-8286-4174-abc4-aed0afc9e3af</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="62cee925-8286-4174-abc4-aed0afc9e3af" name="Goto License" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="360" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;System&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;License&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>c7dbc754-577e-4a0f-ba59-f21cafbc403f</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="c66411ce-296b-4e92-8199-17547f948bed" name="Close all child windows" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="150" y="120" w="90" h="30" />
    <onsuccess>bdd0b293-8f00-471b-9886-2eae124f6d93</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Close All Child Windows" />
  </stage>
  <stage stageid="e6bfcf8c-5757-47b2-808d-bf9d70e13964" name="Goto System" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="255" y="165" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>f262a7ef-ca33-45cd-8168-1789d64371e2</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="f262a7ef-ca33-45cd-8168-1789d64371e2" name="Goto License" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="360" y="165" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;System&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;License&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>d2d108b2-0f28-4282-9467-0f924a622019</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="d7f76b9a-f406-4892-a4a8-f5004ae462b1" name="Close all child windows" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="150" y="165" w="90" h="30" />
    <onsuccess>e6bfcf8c-5757-47b2-808d-bf9d70e13964</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Close All Child Windows" />
  </stage>
  <stage stageid="b4eda2ec-636e-446c-a351-97541f4de79b" name="Sign In" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="165" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" expr="" />
      <input type="password" name="Password" expr="" />
      <input type="password" name="New Password" narrative="If this is your first login it will prompt you to change the password." expr="" />
    </inputs>
    <onsuccess>d731e067-db55-4aa0-9947-53c075d6ba52</onsuccess>
    <resource object="Blue Prism" action="Sign In" />
  </stage>
  <stage stageid="b0030a63-b1f4-4747-b331-bf627342bdcf" name="Launch Blue Prism" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <outputs>
      <output type="number" name="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>895f2547-0d4a-420c-9222-b6b27846ef7b</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="37d930db-28eb-4ecb-a92f-17ef482f933c" name="Attach Control" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>b152e0cd-31ec-430f-b8a8-3ae2d1383362</onsuccess>
    <resource object="Blue Prism - Control Room (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="b152e0cd-31ec-430f-b8a8-3ae2d1383362" name="Attach System" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="120" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>b4eda2ec-636e-446c-a351-97541f4de79b</onsuccess>
    <resource object="Blue Prism - System (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="d731e067-db55-4aa0-9947-53c075d6ba52" name="Goto System" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="210" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>0be7d603-8314-49d9-9d19-c5dd7de3145d</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="0be7d603-8314-49d9-9d19-c5dd7de3145d" name="Goto License" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="255" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;System&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;License&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>1c5e0c5f-397b-4919-bf2a-fccce2ec4923</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="1c5e0c5f-397b-4919-bf2a-fccce2ec4923" name="Remove License (QA)" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="300" w="90" h="30" />
    <inputs>
      <input type="text" name="License Owner Name" narrative="The owner name of the license you wish to delete" expr="&quot;BluePrismQA&quot;" />
    </inputs>
    <onsuccess>a242b386-e415-4e7a-9027-35a49bd20551</onsuccess>
    <resource object="Blue Prism - System - System" action="Remove License" />
  </stage>
  <stage stageid="895f2547-0d4a-420c-9222-b6b27846ef7b" name="Add to Cleanup (Blue Prism)" type="SubSheet">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Blue Prism&quot;" />
    </inputs>
    <onsuccess>37d930db-28eb-4ecb-a92f-17ef482f933c</onsuccess>
    <processid>823ffd44-93ea-49ae-a690-c7eb56676117</processid>
  </stage>
  <stage stageid="a242b386-e415-4e7a-9027-35a49bd20551" name="Add to Cleanup (BluePrismQA)" type="SubSheet">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="345" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;BluePrismQA&quot;" />
    </inputs>
    <onsuccess>78cc4d22-ac17-432c-b354-0ba3394935ff</onsuccess>
    <processid>823ffd44-93ea-49ae-a690-c7eb56676117</processid>
  </stage>
  <stage stageid="9edb2687-d921-4ecd-b4f2-e24bff942c8e" name="Add to Cleanup (NHS)" type="SubSheet">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="435" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;NHS&quot;" />
    </inputs>
    <onsuccess>a505c465-6f28-4d4b-9cc2-32a5a2a99a73</onsuccess>
    <processid>823ffd44-93ea-49ae-a690-c7eb56676117</processid>
  </stage>
  <stage stageid="aa548c7a-7e93-4ac2-8f77-507b92402f48" name="Start" type="Start">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="-15" />
    <onsuccess>7fd0ab3b-a535-4082-bbac-f4df8699086d</onsuccess>
  </stage>
  <stage stageid="33f5dfb8-6c11-44ef-8215-2a271c913ffc" name="Should Fail" type="Block">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-45" y="195" w="120" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="890bb0cf-556c-4160-8001-ce2c23bc5dab" name="Recover" type="Recover">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="270" w="90" h="30" />
    <onsuccess>9fd75dcd-2c6b-49af-b80d-46c698a57385</onsuccess>
  </stage>
  <stage stageid="1139ef39-12f3-4359-9a45-ddfc7c9d3f86" name="Resume" type="Resume">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="375" w="90" h="30" />
    <onsuccess>a6550e58-d9e9-4d16-a5e1-2978d85f09c3</onsuccess>
  </stage>
  <stage stageid="c0414922-55e3-4b0d-a95d-5647517fc019" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="330" />
    <exception localized="yes" type="SystemException" detail="&quot;The incorrect error was seen, you expected failed to load Releases tab, however you recieved the following: &quot;&amp;ExceptionDetail()" />
  </stage>
  <stage stageid="9fd75dcd-2c6b-49af-b80d-46c698a57385" name="Releases tab error correct?" type="Decision">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="330" w="90" h="30" />
    <decision expression="InStr(ExceptionDetail(), &quot;Failed to load Tab 'Releases'&quot;)&lt;&gt;0" />
    <ontrue>1139ef39-12f3-4359-9a45-ddfc7c9d3f86</ontrue>
    <onfalse>c0414922-55e3-4b0d-a95d-5647517fc019</onfalse>
  </stage>
  <stage stageid="d2d108b2-0f28-4282-9467-0f924a622019" name="Remove License (NHS)" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="465" y="165" w="90" h="30" />
    <inputs>
      <input type="text" name="License Owner Name" narrative="The owner name of the license you wish to delete" expr="&quot;BluePrismQA (NHS) - Internal&quot;" />
    </inputs>
    <onsuccess>2aaab0e2-3421-4565-b569-e03cb6c4464a</onsuccess>
    <resource object="Blue Prism - System - System" action="Remove License" />
  </stage>
  <stage stageid="c7dbc754-577e-4a0f-ba59-f21cafbc403f" name="Add License (QA)" type="Action">
    <subsheetid>7ffe3058-a0b4-44e0-b8f9-fc1e1d3e1dda</subsheetid>
    <display x="465" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="License Name" narrative="The name of your license you wish to add." expr="&quot;BluePrismQA&quot;" />
      <input type="text" name="File Path" narrative="The file path of your license. Eg. &quot;C:\QA\Licenses&quot;" expr="[QA Root]" />
    </inputs>
    <onsuccess>f5d13fca-e60e-40e7-a799-94ef07c5e063</onsuccess>
    <resource object="Blue Prism - System - System" action="Add License Key" />
  </stage>
  <stage stageid="3c3887b3-3940-4c8e-8ebb-11aff181764d" name="pid" type="Data">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="-120" y="15" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0045c935-75ec-44e4-97cf-fd58be45facf" name="Local Variables" type="Block">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="a505c465-6f28-4d4b-9cc2-32a5a2a99a73" name="Get License Status" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="480" w="90" h="30" />
    <inputs>
      <input type="text" name="License Name" narrative="The name of your license you wish to add." expr="&quot;BluePrismQA (NHS) - Internal&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="License Status" narrative="Status of the License - Example: Active, or Expired." stage="License Status" />
    </outputs>
    <onsuccess>97a008e2-d85e-43d6-92d0-d75bc2f48eac</onsuccess>
    <resource object="Blue Prism - System - System" action="Get License Status" />
  </stage>
  <stage stageid="97a008e2-d85e-43d6-92d0-d75bc2f48eac" name="License Active?" type="Decision">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="525" w="90" h="30" />
    <decision expression="[License Status] = &quot;Active&quot;" />
    <ontrue>935f41a0-b241-4b10-8d42-230b1baa8163</ontrue>
    <onfalse>a033c706-33d3-4fe3-9ac6-4a7f7d468b8b</onfalse>
  </stage>
  <stage stageid="a033c706-33d3-4fe3-9ac6-4a7f7d468b8b" name="FAIL" type="Exception">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="105" y="525" />
    <exception type="System Exception" detail="&quot;You expected the license to be active, but it wasn't, it was: &quot;&amp;[License Status]" />
  </stage>
  <stage stageid="c086ef4e-f5ff-422b-9f58-69df09a65ced" name="License Status" type="Data">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="-120" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7fd0ab3b-a535-4082-bbac-f4df8699086d" name="Go to Process Studio" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="30" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Studio&quot;" />
    </inputs>
    <onsuccess>1e2fa518-d213-4e48-845b-b776d2ec17c1</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="f8472521-a057-4f13-832c-efc50cec121b" name="Open Control Tab" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>32e87a28-424b-49bf-8306-7023e5ce17c2</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="1e2fa518-d213-4e48-845b-b776d2ec17c1" name="Open Analytics Tab" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Analytics&quot;" />
    </inputs>
    <onsuccess>f8472521-a057-4f13-832c-efc50cec121b</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="32e87a28-424b-49bf-8306-7023e5ce17c2" name="Open System Tab" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="165" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>7585c3e0-c20b-4d35-b487-2887c1b04cf8</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="7585c3e0-c20b-4d35-b487-2887c1b04cf8" name="Open Releases" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="225" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Releases&quot;" />
    </inputs>
    <onsuccess>a96a880e-4e93-4b58-aaff-8e3ed9ccf4b8</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="a6550e58-d9e9-4d16-a5e1-2978d85f09c3" name="Open Control Tab" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="420" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>6371811e-62b2-442b-9a72-8c6da0d95062</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="59badd4e-a85c-4be3-8f5a-eb8804894ac1" name="Should Fail" type="Block">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-45" y="450" w="120" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="6e2236b4-b42d-4d44-bd29-227b95213774" name="Recover" type="Recover">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="525" w="90" h="30" />
    <onsuccess>a3f9476a-3b43-4f39-a49b-5618461c507b</onsuccess>
  </stage>
  <stage stageid="2f320b86-1a41-496e-bd61-1c47d2ecda0f" name="Resume" type="Resume">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="630" w="90" h="30" />
    <onsuccess>235fff95-e7d1-4574-bfbf-c0d8aa4e8c07</onsuccess>
  </stage>
  <stage stageid="7c0170b5-add1-43ae-b18a-98f5c9259a0b" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="585" />
    <exception localized="yes" type="SystemException" detail="&quot;The incorrect error was seen, you expected a error saying you cant access schedules, however you recieved the following: &quot;&amp;ExceptionDetail()" />
  </stage>
  <stage stageid="a3f9476a-3b43-4f39-a49b-5618461c507b" name="Create Schedule error correct?" type="Decision">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="585" w="90" h="30" />
    <decision expression="InStr(ExceptionDetail(), &quot;Failed to perform step 1 in Navigate Stage 'Select Schedules Node' on page 'Create Schedule' - No treenode with the text 'Schedules' was found&quot;)&lt;&gt;0" />
    <ontrue>2f320b86-1a41-496e-bd61-1c47d2ecda0f</ontrue>
    <onfalse>7c0170b5-add1-43ae-b18a-98f5c9259a0b</onfalse>
  </stage>
  <stage stageid="6371811e-62b2-442b-9a72-8c6da0d95062" name="Create Schedule" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="480" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" narrative="The name of the schedule to create" expr="&quot;Blah Blah Blah Schedule&quot;" />
      <input type="date" name="Start Date" narrative="The start date for the schedule" expr="" />
      <input type="time" name="Start Time" narrative="The start time for the schedule" expr="" />
      <input type="collection" name="Tasks" narrative="The tasks to run" expr="" />
      <input type="text" name="Group To Expand" narrative="Group contianing Process" expr="" />
      <input type="text" name="Resource Group To Expand" narrative="Group containing resources in schedule" expr="" />
    </inputs>
    <onsuccess>cf2434fd-58ad-45d5-b2af-a75615e646b7</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Create Schedule" />
  </stage>
  <stage stageid="235fff95-e7d1-4574-bfbf-c0d8aa4e8c07" name="Go To System" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <loginhibit />
    <display x="15" y="675" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>3753d1aa-6747-4d90-842e-23d5ceab3926</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="3753d1aa-6747-4d90-842e-23d5ceab3926" name="Select Credentials" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <loginhibit />
    <display x="15" y="720" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Security&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Credentials&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="True" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="False" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="False" />
    </inputs>
    <onsuccess>4b644966-01f0-4846-adf0-89ddda76f67f</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="26ade99e-c7e1-486c-bbfe-7f172dcb99bc" name="Should Fail" type="Block">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-45" y="750" w="120" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="8018febb-b55e-4183-a3d7-8c9a74d778a7" name="Recover" type="Recover">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="825" w="90" h="30" />
    <onsuccess>565fd939-f2db-49b5-b72f-e60223a50258</onsuccess>
  </stage>
  <stage stageid="5dceae5a-6c28-4de1-8cb9-0794bd6be5d9" name="Resume" type="Resume">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="930" w="90" h="30" />
    <onsuccess>f6995b7e-babf-4678-8054-de88c3353038</onsuccess>
  </stage>
  <stage stageid="17c70825-b7fd-4c4d-b166-dd9fb3ac9b0d" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="885" />
    <exception localized="yes" type="SystemException" detail="&quot;The incorrect error was seen, you expected a error saying you cant access credentials, however you recieved the following: &quot;&amp;ExceptionDetail()" />
  </stage>
  <stage stageid="565fd939-f2db-49b5-b72f-e60223a50258" name="Create credential error correct?" type="Decision">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="885" w="90" h="30" />
    <decision expression="InStr(ExceptionDetail(), &quot;Credentials window didn't load&quot;)&lt;&gt;0" />
    <ontrue>5dceae5a-6c28-4de1-8cb9-0794bd6be5d9</ontrue>
    <onfalse>17c70825-b7fd-4c4d-b166-dd9fb3ac9b0d</onfalse>
  </stage>
  <stage stageid="4b644966-01f0-4846-adf0-89ddda76f67f" name="Create Credential" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="780" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" expr="" />
      <input type="password" name="Password" expr="" />
      <input type="collection" name="Roles" expr="" />
      <input type="text" name="Name" expr="&quot;Blah Blah Blah Credential&quot;" />
      <input type="text" name="Description" expr="" />
      <input type="collection" name="Processes" expr="" />
      <input type="collection" name="Resources" expr="" />
      <input type="flag" name="Close on creation" narrative="True as default. True or false, do you want to close the form on finish." expr="" />
    </inputs>
    <onsuccess>198f9c06-edf2-41d4-b05c-3a1410c57a94</onsuccess>
    <resource object="Blue Prism - System - Security" action="Credentials - Create Credential" />
  </stage>
  <stage stageid="e9f487b5-e61d-462e-9771-fa217f93615b" name="Should Fail" type="Block">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-45" y="960" w="120" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="d91ec831-2da5-41a6-9b42-ddf8e913c57d" name="Recover" type="Recover">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1035" w="90" h="30" />
    <onsuccess>5366538d-b935-4455-a90d-b5ad38cbf586</onsuccess>
  </stage>
  <stage stageid="8b108b72-68c4-480f-8113-fc7c3cc6f17c" name="Resume" type="Resume">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1140" w="90" h="30" />
    <onsuccess>958546ae-f644-4fe8-a331-18d30763261e</onsuccess>
  </stage>
  <stage stageid="1ffd3c0c-9d2c-459d-b68b-846498b27e9b" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="1095" />
    <exception localized="yes" type="SystemException" detail="&quot;The incorrect error was seen, you expected a error saying you cant access resource pool, however you recieved the following: &quot;&amp;ExceptionDetail()" />
  </stage>
  <stage stageid="5366538d-b935-4455-a90d-b5ad38cbf586" name="Create resource pool error correct?" type="Decision">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1095" w="90" h="30" />
    <decision expression="InStr(ExceptionDetail(), &quot;Resource Pools cannot be created in the NHS edition&quot;)&lt;&gt;0" />
    <ontrue>8b108b72-68c4-480f-8113-fc7c3cc6f17c</ontrue>
    <onfalse>1ffd3c0c-9d2c-459d-b68b-846498b27e9b</onfalse>
  </stage>
  <stage stageid="f6995b7e-babf-4678-8054-de88c3353038" name="Create Resource Pool" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="990" w="90" h="30" />
    <inputs>
      <input type="text" name="Pool Name" narrative="Name of the pool to create" expr="[Pool Name]" />
      <input type="collection" name="Port Numbers" narrative="The Port numbers of the local resources to add to the pool" expr="[Ports]" />
    </inputs>
    <onsuccess>b43f8a3d-5ab3-4d26-8ecf-dc27b418801d</onsuccess>
    <resource object="Blue Prism - System - Resources" action="Create Resource Pool (cmd)" />
  </stage>
  <stage stageid="958546ae-f644-4fe8-a331-18d30763261e" name="Click Encryption Schemes" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1185" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Security&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Encryption Schemes&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="True" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="False" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="False" />
    </inputs>
    <onsuccess>68537517-532a-413f-baf9-c977ea50c64f</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="0100e382-a565-4065-8e9b-9025519dc9a0" name="Should Fail" type="Block">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-45" y="1215" w="120" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="4c4ed5c2-0efa-439d-b271-d59f1bc0dca5" name="Recover" type="Recover">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1290" w="90" h="30" />
    <onsuccess>329f812a-849b-4de4-b22b-e172dc53a233</onsuccess>
  </stage>
  <stage stageid="80e56c19-b3c8-4c46-8a92-dfe03389fc7c" name="Resume" type="Resume">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1395" w="90" h="30" />
    <onsuccess>a1db90d2-962c-4691-b47b-fb2e358d0805</onsuccess>
  </stage>
  <stage stageid="ebd14324-a15c-46b3-ac05-e50deb82b18e" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="1350" />
    <exception localized="yes" type="SystemException" detail="&quot;The incorrect error was seen, you expected a error saying you cant access encryption schemes, however you recieved the following: &quot;&amp;ExceptionDetail()" />
  </stage>
  <stage stageid="329f812a-849b-4de4-b22b-e172dc53a233" name="Create Encryption Scheme error correct?" type="Decision">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1350" w="90" h="30" />
    <decision expression="InStr(ExceptionDetail(), &quot;Encryption scheme window didn't load&quot;)&lt;&gt;0" />
    <ontrue>80e56c19-b3c8-4c46-8a92-dfe03389fc7c</ontrue>
    <onfalse>ebd14324-a15c-46b3-ac05-e50deb82b18e</onfalse>
  </stage>
  <stage stageid="1c93dcfa-1abd-466c-abbd-3b3d5ee65a7e" name="Should Fail" type="Block">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-45" y="1470" w="120" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="53b264bf-c747-40e3-ac93-59271312deff" name="Recover" type="Recover">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1545" w="90" h="30" />
    <onsuccess>dabba00b-d969-4019-88eb-5e3137020cf1</onsuccess>
  </stage>
  <stage stageid="6bd64919-54b6-4a3d-87e9-5187f0ef603d" name="Resume" type="Resume">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1650" w="90" h="30" />
    <onsuccess>cf4fd1a9-195a-4bb8-80b6-a97b84e6e9d5</onsuccess>
  </stage>
  <stage stageid="22f0b3d9-63ab-4b96-824c-27b308bb6526" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="1605" />
    <exception localized="yes" type="SystemException" detail="&quot;The incorrect error was seen, you expected an error saying you cant mix the enterpise and NHS license, however you recieved the following: &quot;&amp;ExceptionDetail()" />
  </stage>
  <stage stageid="dabba00b-d969-4019-88eb-5e3137020cf1" name="Add enterprise license error correct?" type="Decision">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1605" w="90" h="30" />
    <decision expression="InStr(ExceptionDetail(), &quot;You cannot combine an Enterprise license with any other type of license&quot;)&lt;&gt;0" />
    <ontrue>6bd64919-54b6-4a3d-87e9-5187f0ef603d</ontrue>
    <onfalse>22f0b3d9-63ab-4b96-824c-27b308bb6526</onfalse>
  </stage>
  <stage stageid="3ad3d79e-0fd7-438f-b34b-5df0d88fb757" name="Should Fail" type="Block">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-45" y="1770" w="120" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="fa855e66-b824-4584-8746-102507ef03b4" name="Recover" type="Recover">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1845" w="90" h="30" />
    <onsuccess>d0f1631d-9ecb-497d-89fa-b57568c15977</onsuccess>
  </stage>
  <stage stageid="60649f1c-eb1e-4743-b49f-c8ff67e09bb9" name="Resume" type="Resume">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1950" w="90" h="30" />
    <onsuccess>606501aa-6fd2-4f75-b804-c3dbdd2082e7</onsuccess>
  </stage>
  <stage stageid="dbfef8e5-f092-4407-961b-63ac73973b82" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="1905" />
    <exception localized="yes" type="SystemException" detail="&quot;The incorrect error was seen, you expected a error saying you cant access common authentication, however you recieved the following: &quot;&amp;ExceptionDetail()" />
  </stage>
  <stage stageid="d0f1631d-9ecb-497d-89fa-b57568c15977" name="Select Common Authentication error correct?" type="Decision">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1905" w="90" h="30" />
    <decision expression="InStr(ExceptionDetail(), &quot;Failed to perform step 1 in Navigate Stage 'Select' on page 'Navigate to Common Headers / Parameters (Web API)' - Unable to match any UI Automation elements to the supplied query terms&quot;)&lt;&gt;0" />
    <ontrue>60649f1c-eb1e-4743-b49f-c8ff67e09bb9</ontrue>
    <onfalse>dbfef8e5-f092-4407-961b-63ac73973b82</onfalse>
  </stage>
  <stage stageid="68537517-532a-413f-baf9-c977ea50c64f" name="Create Encrypt Scheme" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1245" w="90" h="30" />
    <inputs>
      <input type="text" name="Scheme Name" narrative="The name in which you want to call your encrpytion scheme." expr="&quot;Blah Blah Blah Encryption Scheme&quot;" />
      <input type="flag" name="Available?" narrative="This will tick a box that allows the encryption scheme to become available." expr="" />
      <input type="flag" name="Database?" narrative="Mark as true if you want to store the scheme on the database. Please note that this will default to true." expr="" />
      <input type="text" name="Method" narrative="The encryption method used with the scheme." expr="" />
    </inputs>
    <onsuccess>e5336fd8-d885-40bf-918b-e59b23531912</onsuccess>
    <resource object="Blue Prism - System - Security" action="Encryption Schemes - Create Encryption Scheme" />
  </stage>
  <stage stageid="8a5a16f3-8db4-409b-adee-91ddeff6b31c" name="Add License (Enterprise)" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1500" w="90" h="30" />
    <inputs>
      <input type="text" name="License Name" narrative="The name of your license you wish to add." expr="&quot;BluePrismQA&quot;" />
      <input type="text" name="File Path" narrative="The file path of your license. Eg. &quot;C:\QA\Licenses&quot;" expr="[QA Root]" />
    </inputs>
    <onsuccess>a963c966-8a17-4539-adf4-ea5d93b39776</onsuccess>
    <resource object="Blue Prism - System - System" action="Add License Key" />
  </stage>
  <stage stageid="e1ef41be-9ab3-425e-b833-a1bde53e693f" name="Add Web API" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1740" w="90" h="30" />
    <onsuccess>56a27738-987f-4d51-828b-498886aeeb7b</onsuccess>
    <resource object="Blue Prism - System - Objects" action="Press Add (Web API)" />
  </stage>
  <stage stageid="cf4fd1a9-195a-4bb8-80b6-a97b84e6e9d5" name="Click Web API Services" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1695" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Objects&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Web API Services&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="True" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="False" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="False" />
    </inputs>
    <onsuccess>e1ef41be-9ab3-425e-b833-a1bde53e693f</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="56a27738-987f-4d51-828b-498886aeeb7b" name="Navigate to Common Authentication" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1800" w="90" h="30" />
    <inputs>
      <input type="text" name="Headers or Parameters" narrative="Enter &quot;Headers&quot; or &quot;Parameters&quot; depending where you want to go." expr="&quot;Authentication&quot;" />
    </inputs>
    <onsuccess>70144c7b-283f-47f8-8f40-a95d99fa7292</onsuccess>
    <resource object="Blue Prism - System - Objects" action="Navigate to Common Headers / Parameters (Web API)" />
  </stage>
  <stage stageid="606501aa-6fd2-4f75-b804-c3dbdd2082e7" name="Cancel adding API" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1995" w="90" h="30" />
    <onsuccess>31256eb6-2bea-4598-a16a-2148c660d72c</onsuccess>
    <resource object="Blue Prism - System - Objects" action="Press Cancel (Web API)" />
  </stage>
  <stage stageid="78cc4d22-ac17-432c-b354-0ba3394935ff" name="Add License (NHS)" type="Action">
    <subsheetid>8817ff13-b211-4a13-aa43-9b9d72dff902</subsheetid>
    <display x="15" y="390" w="90" h="30" />
    <inputs>
      <input type="text" name="License Name" narrative="The name of your license you wish to add." expr="&quot;BluePrismQA (NHS) - Internal&quot;" />
      <input type="text" name="File Path" narrative="The file path of your license. Eg. &quot;C:\QA\Licenses&quot;" expr="[QA Root]" />
    </inputs>
    <onsuccess>9edb2687-d921-4ecd-b4f2-e24bff942c8e</onsuccess>
    <resource object="Blue Prism - System - System" action="Add License Key" />
  </stage>
  <stage stageid="31256eb6-2bea-4598-a16a-2148c660d72c" name="End2" type="End">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="2040" />
  </stage>
  <stage stageid="e6678e7b-a4aa-4ad4-8887-06180b392a0b" name="Pool Name" type="Data">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-135" y="135" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">TestPool</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="01e0a335-e9bf-4943-b28a-53f10fbd507d" name="Ports" type="Collection">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="-135" y="105" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="Port" type="text" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Port" type="text" value="9100" />
      </row>
      <row>
        <field name="Port" type="text" value="9200" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="74ef9f77-372f-4a38-9afe-fbbd087527ba" name="Local Variables" type="Block">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="75" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="a1db90d2-962c-4691-b47b-fb2e358d0805" name="Goto License" type="Action">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="15" y="1440" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;System&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;License&quot;" />
      <input type="flag" name="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>8a5a16f3-8db4-409b-adee-91ddeff6b31c</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="6ce87876-4cea-496d-af14-bbcd97b05ca3" name="Recover" type="Recover">
    <loginhibit />
    <display x="210" y="-60" />
    <onsuccess>659be156-1dce-427f-afcb-81886d9a6375</onsuccess>
  </stage>
  <stage stageid="a96a880e-4e93-4b58-aaff-8e3ed9ccf4b8" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="225" />
    <exception localized="yes" type="Bug" detail="&quot;You managed to open releases when you shouldn't have been able to.&quot;" />
  </stage>
  <stage stageid="cf2434fd-58ad-45d5-b2af-a75615e646b7" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="480" />
    <exception localized="yes" type="Bug" detail="&quot;You managed to open schedules when you shouldn't have been able to.&quot;" />
  </stage>
  <stage stageid="198f9c06-edf2-41d4-b05c-3a1410c57a94" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="780" />
    <exception localized="yes" type="Bug" detail="&quot;You managed to open credentials when you shouldn't have been able to.&quot;" />
  </stage>
  <stage stageid="b43f8a3d-5ab3-4d26-8ecf-dc27b418801d" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="990" />
    <exception localized="yes" type="Bug" detail="&quot;You managed to open resource pool when you shouldn't have been able to.&quot;" />
  </stage>
  <stage stageid="e5336fd8-d885-40bf-918b-e59b23531912" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="1245" />
    <exception localized="yes" type="Bug" detail="&quot;You managed to open encryption schemes when you shouldn't have been able to.&quot;" />
  </stage>
  <stage stageid="a963c966-8a17-4539-adf4-ea5d93b39776" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="1500" />
    <exception localized="yes" type="Bug" detail="&quot;You managed to add an enterpise license when you shouldn't have been able to.&quot;" />
  </stage>
  <stage stageid="70144c7b-283f-47f8-8f40-a95d99fa7292" name="FAIL" type="Exception">
    <subsheetid>aa23760a-c7e2-4951-9a4c-86469f3e5045</subsheetid>
    <display x="120" y="1800" />
    <exception localized="yes" type="Bug" detail="&quot;You managed to open common authentication when you shouldn't have been able to.&quot;" />
  </stage>
</process>