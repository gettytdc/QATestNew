<process name="API - PUT Schedules - Retire and Unretire" version="1.0" bpversion="7.0.0.39659" narrative="" byrefcollection="true" preferredid="ba3e3f5b-d6f4-40db-b949-8f24ea86956f">
  <view>
    <camerax>-129</camerax>
    <cameray>345</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="fbedf4a4-75b9-45ed-a57b-eed85cda8032" type="Normal" published="False">
    <name>Setup</name>
    <view>
      <camerax>27</camerax>
      <cameray>990</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="4f7eb729-03d7-4938-a32c-efb59ec6c938" type="Normal" published="False">
    <name>Scenario 1</name>
    <view>
      <camerax>59</camerax>
      <cameray>621</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="71723e1c-d628-474b-9e41-403a82af0221" type="Normal" published="False">
    <name>Scenario 2</name>
    <view>
      <camerax>15</camerax>
      <cameray>519</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="5d2a81f4-43a6-4e26-a8c1-a3fefbfce144" type="Normal" published="False">
    <name>Scenario 3</name>
    <view>
      <camerax>15</camerax>
      <cameray>570</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="5bbc7468-44a2-4d4c-841e-0700b7e57a52" type="Normal" published="False">
    <name>Add to Clean Up Collection</name>
    <view>
      <camerax>0</camerax>
      <cameray>63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="a520a901-f85f-4cce-b137-cd4ba2cd6950" type="Normal" published="False">
    <name>Cleanup</name>
    <view>
      <camerax>228</camerax>
      <cameray>150</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="dced9ad9-34b4-441d-8d26-da0f487c7e80" name="Stage1" type="ProcessInfo">
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="63832f41-db25-44df-bd5e-5593b4572fec" name="Setup" type="SubSheetInfo">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="-135" y="-315" w="150" h="90" />
  </stage>
  <stage stageid="75faf9c9-6c1b-4f60-b032-c7de0930f7fb" name="Go to Control" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="210" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>76ffe1bf-2995-4091-a1de-564d58189874</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="76ffe1bf-2995-4091-a1de-564d58189874" name="Select Schedules" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="255" w="90" h="30" />
    <inputs>
      <input type="text" name="Control Item to Click" friendlyname="Control Item to Click" narrative="Control Item to click in left hand side control Tree" expr="&quot;Schedules&quot;" />
    </inputs>
    <onsuccess>6d1eaa24-d3e0-4051-b924-261e7b959660</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Click Item From Control's Left Tree (Select Item)" />
  </stage>
  <stage stageid="4bc97d37-1c25-4e61-9023-ad635548be98" name="Make Time and Store" type="MultipleCalculation">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="345" w="90" h="30" />
    <onsuccess>2a9f8f0b-17a2-4fef-8733-2f984b0be145</onsuccess>
    <steps>
      <calculation expression="LocalTime()+MakeTimeSpan(0, 1, 0, 0)" stage="Start Time" />
      <calculation expression="AddDays(Today(),+1)" stage="End Point" />
      <calculation expression="Now()" stage="Start DateTime" />
      <calculation expression="[Now() (Local)]+MakeTimeSpan(0,1,0,0)" stage="End of Schedule Time" />
    </steps>
  </stage>
  <stage stageid="4e99861e-f20b-478c-b5fd-ba234d51f680" name="Attach Control" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="30" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>30fc6511-1869-4585-87d4-c8379c308976</onsuccess>
    <resource object="Blue Prism - Control Room (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="3e223480-3366-4ca9-be73-30ba90b728db" name="Port" type="Data">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="-135" y="-225" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>4256</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="60c367cd-5eda-4918-8da0-d4f7491ed16a" name="pid" type="Data">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="-135" y="-195" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="83392f35-fae4-4ab5-9df2-b96b5808fcde" name="Local variable" type="Block">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-255" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="2a9f8f0b-17a2-4fef-8733-2f984b0be145" name="Create Schedule" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="390" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name of the schedule to create" expr="[Schedule Name]" />
      <input type="date" name="Start Date" friendlyname="Start Date" narrative="The start date for the schedule" expr="Today()" />
      <input type="time" name="Start Time" friendlyname="Start Time" narrative="The start time for the schedule" expr="[Start Time]" />
      <input type="collection" name="Tasks" friendlyname="Tasks" narrative="The tasks to run" expr="[Task Sessions 1]" />
      <input type="text" name="Group To Expand" friendlyname="Group To Expand" narrative="Group contianing Process" expr="&quot;Default&quot;" />
      <input type="text" name="Resource Group To Expand" friendlyname="Resource Group To Expand" narrative="Group containing resources in schedule" expr="&quot;Default&quot;" />
    </inputs>
    <onsuccess>da45f65f-f2b9-4c3a-bc48-d482d11a6485</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Create Schedule" />
  </stage>
  <stage stageid="b7f2476e-5cf4-40b0-acbd-9890dd843888" name="End3" type="End">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="1020" />
  </stage>
  <stage stageid="da45f65f-f2b9-4c3a-bc48-d482d11a6485" name="Add to CleanUp Collection" type="SubSheet">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="435" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Schedule BP-3199&quot;" />
    </inputs>
    <onsuccess>86037eed-d6ee-4e53-a771-b27a692a0164</onsuccess>
    <processid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</processid>
  </stage>
  <stage stageid="c33b8954-fd72-4bef-a294-5deb841c72cd" name="Add to CleanUp Collection" type="SubSheet">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="165" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Resource 4256&quot;" />
    </inputs>
    <onsuccess>75faf9c9-6c1b-4f60-b032-c7de0930f7fb</onsuccess>
    <processid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</processid>
  </stage>
  <stage stageid="30fc6511-1869-4585-87d4-c8379c308976" name="Resource Manager: Start Resource" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="flag" name="SSO" friendlyname="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="&quot;False&quot;" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="&quot;admin&quot;" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to use for the resource. Only used if Username is given" expr="&quot;admin&quot;" />
      <input type="number" name="Port" friendlyname="Port" narrative="The port number on which the resource PC should listen" expr="[Port]" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" friendlyname="Process ID" narrative="The PID of the newly created process" stage="" />
    </outputs>
    <onsuccess>30e995d3-b120-42c4-a8ad-94048bae444c</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="30e995d3-b120-42c4-a8ad-94048bae444c" name="Store resource name" type="MultipleCalculation">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="90" h="30" />
    <onsuccess>c33b8954-fd72-4bef-a294-5deb841c72cd</onsuccess>
    <steps>
      <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;) &amp; &quot;:&quot; &amp; [Port]" stage="Task Sessions 1.Sessions.Resource Name" />
      <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;) &amp; &quot;:&quot; &amp; [Port]" stage="Task Sessions 2.Sessions.Resource Name" />
    </steps>
  </stage>
  <stage stageid="653c4da8-27e6-4d2a-96b8-d365ac88d601" name="Press Apply" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="570" w="90" h="30" />
    <onsuccess>bad14c83-9377-4a24-963e-4403e8cabc37</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Press Apply" />
  </stage>
  <stage stageid="84b83e0f-2dce-419b-88b8-136db80df3eb" name="Add to Clean Up Collection" type="SubSheetInfo">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="95ebce4c-f4a1-41a2-baa5-d932678f2df2" name="Start" type="Start">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="Item Name" narrative="The name of the item you want to clean up." stage="Item Name" />
    </inputs>
    <onsuccess>529221af-683a-4dd8-a653-a890fe77c95f</onsuccess>
  </stage>
  <stage stageid="8547ff1c-2e3c-4cdc-91db-d10c1677ec45" name="End" type="End">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="15" y="30" />
  </stage>
  <stage stageid="e33a9357-f397-4e72-8d33-37f07411a0f7" name="Item Name" type="Data">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e3cc1068-0648-4504-9988-eb228203e425" name="Input Variables" type="Block">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="529221af-683a-4dd8-a653-a890fe77c95f" name="Add Row" type="Action">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;CleanUp Collection&quot;" />
    </inputs>
    <onsuccess>ab9031a3-85af-4ee3-b4ee-fb9325b816d7</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="6cd0edab-ab1a-46c4-b6a0-e6a963ec3e90" name="CleanUp Collection" type="Collection">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="-195" y="60" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Item Name" type="text" description="The name of the item that needs cleaning up." />
    </collectioninfo>
    <noalwaysinit />
  </stage>
  <stage stageid="b2d2ff26-d57a-40dd-b3e0-3bca6c67b985" name="Local Variables" type="Block">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="-270" y="30" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ab9031a3-85af-4ee3-b4ee-fb9325b816d7" name="Add To Row" type="Calculation">
    <subsheetid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <onsuccess>8547ff1c-2e3c-4cdc-91db-d10c1677ec45</onsuccess>
    <calculation expression="[Item Name]" stage="CleanUp Collection.Item Name" />
  </stage>
  <stage stageid="b82e076d-6104-4dad-8ba9-7010c2a5779d" name="Cleanup" type="SubSheetInfo">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="20b49c99-1858-4e77-a251-f3a31dda22e8" name="Start" type="Start">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>32bd5386-b0c6-4cad-bf55-547231fc1282</onsuccess>
  </stage>
  <stage stageid="e71d221b-a539-4426-966e-c99f168328dc" name="Terminate" type="Action">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="225" y="150" w="90" h="30" />
    <onsuccess>b2dd5714-9a95-417f-bfe4-531ca4c3b909</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="3632562e-2bc6-4b9e-aaba-d2411adab205" name="To Clean" type="LoopStart">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <onsuccess>aab3b3c1-3e73-45bb-ae53-533fc47b976b</onsuccess>
    <groupid>06ab7234-98bc-4d11-bffb-702b849dfd62</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Reversed CleanUp</loopdata>
  </stage>
  <stage stageid="19f1130d-65de-444f-987f-f7dc8f4f7cc8" name="To Clean" type="LoopEnd">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="15" y="225" w="90" h="30" />
    <onsuccess>f5d4b743-4346-40ea-9983-43bac0918415</onsuccess>
    <groupid>06ab7234-98bc-4d11-bffb-702b849dfd62</groupid>
  </stage>
  <stage stageid="525457b7-6ee1-4a1f-8f28-9b38c82b9170" name="Stop Resource" type="Action">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="330" y="60" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number whose resource should be stopped" expr="4256" />
    </inputs>
    <onsuccess>cd895b21-06c1-4278-8b5d-8daabe38de52</onsuccess>
    <resource object="Resource Manager" action="Stop Resource" />
  </stage>
  <stage stageid="04fb20be-199d-425a-802a-c8173c9c9746" name="Anchor9" type="Anchor">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="405" y="225" w="10" h="10" />
    <onsuccess>19f1130d-65de-444f-987f-f7dc8f4f7cc8</onsuccess>
  </stage>
  <stage stageid="32bd5386-b0c6-4cad-bf55-547231fc1282" name="Reverse Collection" type="Action">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" narrative="The collection to be reversed." expr="[CleanUp Collection]" />
    </inputs>
    <outputs>
      <output type="collection" name="Reversed Collection" narrative="The reversed collection." stage="Reversed CleanUp" />
    </outputs>
    <onsuccess>3632562e-2bc6-4b9e-aaba-d2411adab205</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Reverse Collection" />
  </stage>
  <stage stageid="69e4c36a-2ec0-4625-92ae-4c1a0a2347fd" name="Reversed CleanUp" type="Collection">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5cced5dd-1dac-4c1e-84ba-591fdeb8f4d9" name="Local Variables" type="Block">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="41f151bc-233f-4f24-91fa-1003141ce41e" name="Delete Schedule" type="Action">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="330" y="90" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" narrative="The name of the schedule which will be run" expr="&quot;Schedule BP-3199&quot;" />
    </inputs>
    <onsuccess>3db19249-2f81-48e4-bf20-d641e0437479</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Delete Schedule" />
  </stage>
  <stage stageid="cd895b21-06c1-4278-8b5d-8daabe38de52" name="Anchor6" type="Anchor">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="60" w="10" h="10" />
    <onsuccess>3db19249-2f81-48e4-bf20-d641e0437479</onsuccess>
  </stage>
  <stage stageid="f5d4b743-4346-40ea-9983-43bac0918415" name="End1" type="End">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="270" />
  </stage>
  <stage stageid="d2d31979-fcf9-4ab5-ba56-cbeeb5dd25ee" name="Open Control Tab" type="Action">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="225" y="90" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>41f151bc-233f-4f24-91fa-1003141ce41e</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="b2dd5714-9a95-417f-bfe4-531ca4c3b909" name="Anchor3" type="Anchor">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="150" w="10" h="10" />
    <onsuccess>04fb20be-199d-425a-802a-c8173c9c9746</onsuccess>
  </stage>
  <stage stageid="3db19249-2f81-48e4-bf20-d641e0437479" name="Anchor20" type="Anchor">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="90" w="10" h="10" />
    <onsuccess>96033e74-3e1f-4ee4-9a18-d10507b197e6</onsuccess>
  </stage>
  <stage stageid="4ddcc263-0fa9-483c-a6f1-184f7fc2ca49" name="Start" type="Start">
    <display x="15" y="-105" />
    <onsuccess>0c88f828-d749-437d-9228-06521a593fa0</onsuccess>
  </stage>
  <stage stageid="79f33b08-5507-4f1c-a6ed-f62fef0308e5" name="Setup" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="-45" w="405" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0c88f828-d749-437d-9228-06521a593fa0" name="Note1" type="Note">
    <narrative>GIVEN that 2 schedules were created with 1 task each and 1 is set to run</narrative>
    <display x="15" y="-15" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>0c2ef867-d197-4037-9161-088d2fd6e337</onsuccess>
  </stage>
  <stage stageid="0c2ef867-d197-4037-9161-088d2fd6e337" name="Setup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <onsuccess>96f958b0-40e1-433b-af6c-d9ba431c6728</onsuccess>
    <processid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</processid>
  </stage>
  <stage stageid="2060f4ee-7bf0-4393-bbc0-00006a35f883" name="Global Variables" type="Block">
    <display x="-345" y="-45" w="150" h="540" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0a3b8f34-4ad6-4d30-b9d2-85d0658edd74" name="Start Time" type="Data">
    <display x="-270" y="-15" w="120" h="30" />
    <datatype>time</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="af4306bd-b741-4ec0-aa3d-891a26f6561b" name="Start DateTime" type="Data">
    <display x="-270" y="15" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="8c5920d7-b30d-4002-bd98-077517c1ec0a" name="Local Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-345" y="510" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="a10dc2e1-b470-4451-a0ea-146f70704759" name="Failed?" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="540" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c77fcf0c-986d-4d0b-9791-77ad6e552004" name="Exception" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="570" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="2e459757-48fb-4740-aad6-6da43e9b650a" name="Response Content" type="Data">
    <display x="-270" y="180" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="e4a9197f-1830-4f7c-88d7-206b4f4abeca" name="HTTP Status Code" type="Data">
    <display x="-270" y="150" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="96f958b0-40e1-433b-af6c-d9ba431c6728" name="Note1" type="Note">
    <narrative>WHEN PUT schedule to retire is requested
AND the schedule is currently running whilst being set to retire
THEN the schedule will run to completion then it will retire</narrative>
    <display x="15" y="120" w="360" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>d0a1f5cf-80b2-4a6d-ad3c-6c4f0e40c4cd</onsuccess>
  </stage>
  <stage stageid="72c6ad96-6f70-428c-842c-fd171d010e17" name="Scenario 1" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="75" w="405" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="d0a1f5cf-80b2-4a6d-ad3c-6c4f0e40c4cd" name="Scenario 1" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="180" w="120" h="30" />
    <onsuccess>f5bfb894-a041-473f-bfb5-efa2acd63c6f</onsuccess>
    <processid>4f7eb729-03d7-4938-a32c-efb59ec6c938</processid>
  </stage>
  <stage stageid="982d7935-80d3-4ed3-b58f-075d4c688f83" name="Resume Setup" type="Resume">
    <loginhibit />
    <display x="345" y="30" />
    <onsuccess>c7dd3b6e-862d-4b0f-ba6c-6acdfef915b8</onsuccess>
  </stage>
  <stage stageid="a44586ad-c46a-4b1c-99bb-af364e019ddf" name="Get Exception Setup" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="270" y="30" />
    <onsuccess>982d7935-80d3-4ed3-b58f-075d4c688f83</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot;,Setup Failed. Exception details: &quot;&amp;ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="3f355932-7d69-4ff6-b76c-a8284454ebe1" name="Resume Scenario 1" type="Resume">
    <loginhibit />
    <display x="270" y="225" />
    <onsuccess>f5bfb894-a041-473f-bfb5-efa2acd63c6f</onsuccess>
  </stage>
  <stage stageid="d1c0bf62-ba43-4686-8fb1-43075410aec6" name="Get Exception 1" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="270" y="180" />
    <onsuccess>3f355932-7d69-4ff6-b76c-a8284454ebe1</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot;,Scenario 1 Failed. Exception details: &quot;&amp;ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="c7dd3b6e-862d-4b0f-ba6c-6acdfef915b8" name="Anchor10" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="345" y="555" w="10" h="10" />
    <onsuccess>a1a5aef6-67c0-47a5-a060-36adb9739b0d</onsuccess>
  </stage>
  <stage stageid="3f862416-a69b-4302-b339-654d4fd0bd74" name="End" type="End">
    <display x="15" y="675" />
  </stage>
  <stage stageid="d6bf6983-1a8e-4041-8ff6-838ab7596181" name="CleanUp" type="SubSheet">
    <display x="15" y="585" w="120" h="30" />
    <onsuccess>7d9c8c2c-f846-417c-85bf-3562036f1b96</onsuccess>
    <processid>a520a901-f85f-4cce-b137-cd4ba2cd6950</processid>
  </stage>
  <stage stageid="7d9c8c2c-f846-417c-85bf-3562036f1b96" name="Failed?" type="Decision">
    <display x="15" y="630" w="90" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>9fc7ef47-ae83-4547-b25c-a3fc0cc1f58c</ontrue>
    <onfalse>3f862416-a69b-4302-b339-654d4fd0bd74</onfalse>
  </stage>
  <stage stageid="9fc7ef47-ae83-4547-b25c-a3fc0cc1f58c" name="RETHROW" type="Exception">
    <display x="105" y="630" />
    <exception type="RETHROW" detail="[Exception]" />
  </stage>
  <stage stageid="b1b0e64a-5d07-47dc-99c0-4f91a4efe8f3" name="Anchor36" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="585" w="10" h="10" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>d6bf6983-1a8e-4041-8ff6-838ab7596181</onsuccess>
  </stage>
  <stage stageid="df6a0ea9-8cbe-4013-93e1-32af59837ba2" name="Task Sessions 1" type="Collection">
    <loginhibit />
    <display x="-270" y="360" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Task Name" type="text" description="The name of the task to create" />
      <field name="On Success" type="text" description="The task to perform on successful completion of the task, leave blank for default (Stop)" />
      <field name="On Failure" type="text" description="The task to perform on failure of the task, leave blank for default (Abort)" />
      <field name="Sessions" type="collection" description="The sessions to create on the task">
        <field name="Process Group" type="text" description="The group within which the process can be found, leave empty for no group" />
        <field name="Process Name" type="text" description="The name of the process to create in the session" />
        <field name="Resource Name" type="text" description="The name of the resource to run the process on" />
      </field>
      <field name="Fail Fast" type="flag" description="True to fail the task immediately on any errors; False to let other sessions run - Defaults to True" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Task Name" type="text" value="Task BP-3199" />
        <field name="On Success" type="text" value="Stop" />
        <field name="On Failure" type="text" value="Abort" />
        <field name="Sessions" type="collection">
          <row>
            <field name="Process Group" type="text" value="Default" />
            <field name="Process Name" type="text" value="Sub Process BP-3199" />
            <field name="Resource Name" type="text" value="" />
          </row>
        </field>
        <field name="Fail Fast" type="flag" value="False" />
      </row>
    </initialvalue>
    <noalwaysinit />
  </stage>
  <stage stageid="a1a5aef6-67c0-47a5-a060-36adb9739b0d" name="Anchor11" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="555" w="10" h="10" />
    <onsuccess>d6bf6983-1a8e-4041-8ff6-838ab7596181</onsuccess>
  </stage>
  <stage stageid="f5bfb894-a041-473f-bfb5-efa2acd63c6f" name="Anchor12" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="225" w="10" h="10" />
    <onsuccess>0c01751a-ec35-4ce3-8402-a9b12e6927ab</onsuccess>
  </stage>
  <stage stageid="86a705fc-8f9e-43a0-bb05-250b7f9243a4" name="Result Collection" type="Collection">
    <display x="-270" y="330" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="pagingToken" type="text" />
      <field name="items" type="collection">
        <field name="JSON:Array" type="collection">
          <field name="id" type="number" />
          <field name="name" type="text" />
          <field name="description" type="text" />
          <field name="isRetired" type="flag" />
          <field name="tasksCount" type="number" />
          <field name="intervalType" type="text" />
          <field name="timePeriod" type="number" />
          <field name="startPoint" type="datetime" />
          <field name="endPoint" type="datetime" />
          <field name="dayOfWeek" type="text" />
          <field name="dayOfMonth" type="text" />
          <field name="startDate" type="datetime" />
          <field name="endDate" type="datetime" />
          <field name="calendarId" type="text" />
          <field name="calendarName" type="text" />
        </field>
      </field>
    </collectioninfo>
  </stage>
  <stage stageid="ea44d4ad-55f6-4959-b069-85b3aa828c80" name="End Point" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="45" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="0c01751a-ec35-4ce3-8402-a9b12e6927ab" name="Note1" type="Note">
    <narrative>GIVEN that a schedule is set to retire
THEN the schedule will not run</narrative>
    <display x="15" y="270" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>f51bde54-87f3-4309-93f6-23843db5d467</onsuccess>
  </stage>
  <stage stageid="3598014e-edab-4d5f-bd75-13abc1f61c2f" name="Scenario 2" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="240" w="405" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="f51bde54-87f3-4309-93f6-23843db5d467" name="Scenario 2" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="315" w="120" h="30" />
    <onsuccess>f2d38f83-1172-40ee-9c84-6c3024179067</onsuccess>
    <processid>71723e1c-d628-474b-9e41-403a82af0221</processid>
  </stage>
  <stage stageid="0fb5a503-8084-4caf-b4d2-174d239968a5" name="Resume Scenario 2" type="Resume">
    <loginhibit />
    <display x="270" y="360" />
    <onsuccess>f2d38f83-1172-40ee-9c84-6c3024179067</onsuccess>
  </stage>
  <stage stageid="6eb3964c-3cee-44ca-a117-a68b7fd585f2" name="Get Exception 2" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="270" y="315" />
    <onsuccess>0fb5a503-8084-4caf-b4d2-174d239968a5</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot;,Scenario 2 Failed. Exception details: &quot;&amp;ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="f2d38f83-1172-40ee-9c84-6c3024179067" name="Anchor12" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="360" w="10" h="10" />
    <onsuccess>fedd7937-2d4c-4aa2-9921-161d689c642a</onsuccess>
  </stage>
  <stage stageid="1419961d-b8a5-4c04-94bd-737a65f70e91" name="Schedule Name" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="300" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Schedule BP-3199</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="9b080c68-3b40-4448-9d25-e6b2317dca62" name="Scenario 1" type="SubSheetInfo">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="3319a309-7fb5-4c9e-8777-790c99a67886" name="Start" type="Start">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>3cd844e4-119e-4c20-b6ad-4bb7b099b6fa</onsuccess>
  </stage>
  <stage stageid="bad14c83-9377-4a24-963e-4403e8cabc37" name="GET schedule 1" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="615" w="90" h="30" />
    <inputs>
      <input type="text" name="Name starts with" friendlyname="Name starts with" narrative="Schedule Name" expr="[Schedule Name]" />
      <input type="text" name="Retirement Status" friendlyname="Retirement Status" narrative="Active or Retired" expr="&quot;Active&quot;" />
      <input type="number" name="Items Per Page" friendlyname="Items Per Page" narrative="1" expr="1" />
      <input type="text" name="Paging Token" friendlyname="Paging Token" narrative="mixtures of text and numbers" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>ad8d72f1-7797-45e5-be9b-c4fdf94cbe37</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules" />
  </stage>
  <stage stageid="aeb26fef-8a94-4298-88bb-1175686e711a" name="End Time" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="75" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="ea06f8e4-73e0-4c95-aafb-cf3e7909b86c" name="Time span left at least 50 seconds left?" type="Decision">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="15" y="210" w="90" h="30" />
    <decision expression="[Time span left]&gt;=MakeTimeSpan(0,0,0, 50)" />
    <ontrue>540480f2-1117-42e4-882e-3195e402189e</ontrue>
    <onfalse>e9a6a0c2-023f-4b30-8929-f4db3f87c13d</onfalse>
  </stage>
  <stage stageid="540480f2-1117-42e4-882e-3195e402189e" name="API - Retire a schedule 1" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="255" w="90" h="30" />
    <inputs>
      <input type="flag" name="isRetired" friendlyname="isRetired" expr="True" />
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection.items.JSON:Array.id]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>79041c30-49c5-424a-9a2d-febb58753768</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="PUT schedules" />
  </stage>
  <stage stageid="f126cfb8-11d4-4a34-a61e-f094dd744a92" name="Note2" type="Note">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <narrative>Check that schedule is still running, even after requesting to retire.</narrative>
    <display x="15" y="360" w="180" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>053b506f-686f-429a-ae5a-5ed52648b5e2</onsuccess>
  </stage>
  <stage stageid="053b506f-686f-429a-ae5a-5ed52648b5e2" name="API - GET schedules log" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="405" w="90" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection.items.JSON:Array.id]" />
      <input type="number" name="Items per page" friendlyname="Items per page" expr="1" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>9497443a-6e25-4f00-85ad-4886c187c535</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules log" />
  </stage>
  <stage stageid="14e7de8c-e3d0-4aeb-bccc-d109915cd319" name="Convert Response to Collection" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="705" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection" />
    </outputs>
    <onsuccess>a7bf5c16-83e6-4c86-b264-477de0a710d9</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="ad8d72f1-7797-45e5-be9b-c4fdf94cbe37" name="Check HTTP response code is correct and response content has content" type="Decision">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="660" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;200&quot; AND&#xA;[Response Content]&lt;&gt;&quot;&quot;" />
    <ontrue>14e7de8c-e3d0-4aeb-bccc-d109915cd319</ontrue>
    <onfalse>5dd91b8e-4155-4929-84ee-ca4715954ed5</onfalse>
  </stage>
  <stage stageid="5dd91b8e-4155-4929-84ee-ca4715954ed5" name="Unexpected Response" type="Exception">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="105" y="660" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Expected GET schedules API call to return HTTP Status Code = 200 and return content in the response but this is not the case&quot;" />
  </stage>
  <stage stageid="9497443a-6e25-4f00-85ad-4886c187c535" name="Convert Response to Collection" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="450" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Schedule log collection default" />
    </outputs>
    <onsuccess>90860b9c-34b0-45ef-83be-8dfd7c5715b7</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="60836347-bc0d-4637-a8f5-7476b22bb62f" name="Local variable" type="Block">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="78f4b36b-932d-48a1-a766-21542da495eb" name="Schedule is still running?" type="Decision">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="15" y="540" w="90" h="30" />
    <decision expression="[Schedule log collection.JSON:Array.status]=&quot;Running&quot;" />
    <ontrue>fb0f5454-da16-4ac3-905a-20aafc2d9ee8</ontrue>
    <onfalse>fd844d62-3e8a-48c0-97cb-cd110fbd8c6f</onfalse>
  </stage>
  <stage stageid="fb0f5454-da16-4ac3-905a-20aafc2d9ee8" name="Schedule end time reached?" type="Decision">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="15" y="585" w="90" h="30" />
    <decision expression="[End Time]&lt;=Now()" />
    <ontrue>be3c9d3b-047c-4a14-abec-71bfa7183e4f</ontrue>
    <onfalse>fae4caf8-d0cb-4fd9-99c6-977e73ae3cef</onfalse>
  </stage>
  <stage stageid="390170fd-ca10-4e51-ac1d-c43075e483f1" name="Make an end time" type="Calculation">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="255" w="90" h="30" />
    <onsuccess>540480f2-1117-42e4-882e-3195e402189e</onsuccess>
    <calculation expression="Now()+MakeTimeSpan(0,0,2,0)" stage="End Time" />
  </stage>
  <stage stageid="fae4caf8-d0cb-4fd9-99c6-977e73ae3cef" name="Pause 70 seconds" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="585" w="90" h="30" />
    <inputs>
      <input type="number" name="Duration (Seconds)" friendlyname="Duration (Seconds)" expr="70" />
    </inputs>
    <onsuccess>dbe13199-0ea1-4f8d-9a52-0122c169dcb9</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Pause" />
  </stage>
  <stage stageid="dbe13199-0ea1-4f8d-9a52-0122c169dcb9" name="Anchor1" type="Anchor">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="615" w="10" h="10" />
    <onsuccess>74367444-6c97-447a-8044-7b5a409af006</onsuccess>
  </stage>
  <stage stageid="74367444-6c97-447a-8044-7b5a409af006" name="Anchor2" type="Anchor">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="615" w="10" h="10" />
    <onsuccess>fb0f5454-da16-4ac3-905a-20aafc2d9ee8</onsuccess>
  </stage>
  <stage stageid="be3c9d3b-047c-4a14-abec-71bfa7183e4f" name="Anchor4" type="Anchor">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="585" w="10" h="10" />
    <onsuccess>8ade947b-8a7d-4a07-8885-4034b80d6fca</onsuccess>
  </stage>
  <stage stageid="8ade947b-8a7d-4a07-8885-4034b80d6fca" name="Anchor5" type="Anchor">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="645" w="10" h="10" />
    <onsuccess>d10f6a16-c52e-405d-832a-9cf5bd977ae0</onsuccess>
  </stage>
  <stage stageid="582b69b9-6c54-40fd-ab03-3a1f287005e9" name="API - GET schedules log" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="690" w="90" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection.items.JSON:Array.id]" />
      <input type="number" name="Items per page" friendlyname="Items per page" expr="1" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>63996163-9521-4432-afb1-1dbc395cfa94</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules log" />
  </stage>
  <stage stageid="63996163-9521-4432-afb1-1dbc395cfa94" name="Convert Response to Collection" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="735" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Schedule log collection default" />
    </outputs>
    <onsuccess>6186bb50-8945-4aa0-b4fc-de88ce932c59</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="b6755300-a1a4-4842-b2ac-62e9773b6ef0" name="Schedule is now completed, Start and End Time Correct?" type="Decision">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="15" y="825" w="90" h="30" />
    <decision expression="[Schedule log collection.JSON:Array.status]=&quot;Completed&quot;&#xA;AND&#xA;[Schedule log collection.JSON:Array.startTime]&gt;=[Start DateTime]&#xA;AND&#xA;[Schedule log collection.JSON:Array.startTime]&lt;=Now()" />
    <ontrue>6f7903bf-f362-4c8c-96a6-71886063adcc</ontrue>
    <onfalse>915bb664-6339-48bd-807d-7501cdf48ee8</onfalse>
  </stage>
  <stage stageid="d10f6a16-c52e-405d-832a-9cf5bd977ae0" name="Note2" type="Note">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <narrative>Check that schedule is now retired because it has now finished it's cycle of tasks.</narrative>
    <display x="15" y="645" w="180" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>582b69b9-6c54-40fd-ab03-3a1f287005e9</onsuccess>
  </stage>
  <stage stageid="fd844d62-3e8a-48c0-97cb-cd110fbd8c6f" name="Schedule is not running" type="Exception">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="120" y="540" />
    <exception localized="yes" type="System Exception" detail="&quot;If a schedule is still running then it should not be retired even after the API retire a scheudle request has been put through&quot;" />
  </stage>
  <stage stageid="42453e09-917c-4d39-9190-f0d295eec9a1" name="Current time" type="Data">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6738165b-fd11-4db9-8507-90ecce7c9b16" name="Time span left" type="Data">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="-195" y="15" w="120" h="30" />
    <datatype>timespan</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="915bb664-6339-48bd-807d-7501cdf48ee8" name="FAIL" type="Exception">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="105" y="825" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;The sub process should be completed after pausing for 2 minutes and correct start and end time should be returned but this is not the case&quot;" />
  </stage>
  <stage stageid="6f7903bf-f362-4c8c-96a6-71886063adcc" name="GET schedule 1" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="870" w="90" h="30" />
    <inputs>
      <input type="text" name="Name starts with" friendlyname="Name starts with" narrative="Schedule Name" expr="[Schedule Name]" />
      <input type="text" name="Retirement Status" friendlyname="Retirement Status" narrative="Active or Retired" expr="&quot;Retired&quot;" />
      <input type="number" name="Items Per Page" friendlyname="Items Per Page" narrative="1" expr="1" />
      <input type="text" name="Paging Token" friendlyname="Paging Token" narrative="mixtures of text and numbers" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>abeddcfa-9fa9-4a36-8331-d188f51c5da8</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules" />
  </stage>
  <stage stageid="abeddcfa-9fa9-4a36-8331-d188f51c5da8" name="Convert Response to Collection" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="915" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection" />
    </outputs>
    <onsuccess>9b47e7e4-a5ef-416b-9fb4-983298a7cdc0</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="9b47e7e4-a5ef-416b-9fb4-983298a7cdc0" name="Schedule is now retired? All schedule information intact?" type="Decision">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="15" y="960" w="90" h="30" />
    <decision expression="[Result Collection.items.JSON:Array.isRetired]=True&#xA;AND&#xA;[Result Collection.items.JSON:Array.name]=[Schedule Name]&#xA;AND&#xA;[Result Collection.items.JSON:Array.intervalType]=&quot;Once&quot;&#xA;AND&#xA;[Result Collection.items.JSON:Array.startPoint]&lt;=[Start DateTime]&#xA;AND&#xA;[Result Collection.items.JSON:Array.endPoint]&lt;=[End Point]&#xA;AND&#xA;[Result Collection.items.JSON:Array.startDate]&gt;=[Start DateTime]" />
    <ontrue>0a465e14-70b3-4fdd-bdde-90d7c8298ff4</ontrue>
    <onfalse>9ad88dfa-e6ff-4b00-b2c5-15a646ae93f4</onfalse>
  </stage>
  <stage stageid="9ad88dfa-e6ff-4b00-b2c5-15a646ae93f4" name="Schedule not retired" type="Exception">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="105" y="960" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;The schedule should now be retired after it is requested by the API to be retired after it completes all its tasks, but this is not the case&quot;" />
  </stage>
  <stage stageid="0a465e14-70b3-4fdd-bdde-90d7c8298ff4" name="End2" type="End">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="1005" />
  </stage>
  <stage stageid="aab3b3c1-3e73-45bb-ae53-533fc47b976b" name="Which Clean Up" type="ChoiceStart">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="15" y="30" w="90" h="30" />
    <groupid>cd92d382-d06a-483b-960f-c066843b54c1</groupid>
    <choices>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Resource 4256&quot;">
        <name>Resource 4256</name>
        <distance>30</distance>
        <ontrue>525457b7-6ee1-4a1f-8f28-9b38c82b9170</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Schedule BP-3199&quot;">
        <name>Schedule BP-3199</name>
        <distance>60</distance>
        <ontrue>d2d31979-fcf9-4ab5-ba56-cbeeb5dd25ee</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Schedule BP-3199 B&quot;">
        <name>Schedule BP-3199 B</name>
        <distance>90</distance>
        <ontrue>c6889bec-020d-40e4-be32-a23e4450733a</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Blue Prism&quot;">
        <name>Blue Prism</name>
        <distance>120</distance>
        <ontrue>e71d221b-a539-4426-966e-c99f168328dc</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="7962f5df-9d18-4942-ae56-7b014c54e25c" name="Otherwise" type="ChoiceEnd">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="15" y="180" w="90" h="30" />
    <onsuccess>0ae1cdc6-4434-430e-994b-634432cd0da8</onsuccess>
    <groupid>cd92d382-d06a-483b-960f-c066843b54c1</groupid>
  </stage>
  <stage stageid="0ae1cdc6-4434-430e-994b-634432cd0da8" name="FAIL" type="Exception">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="105" y="180" />
    <exception type="" detail="&quot;You have entered a clean up item the choice doesn't recognise.&quot;" />
  </stage>
  <stage stageid="ada76c8e-6aeb-4a72-9d45-b65220b2bfb0" name="Scenario 2" type="SubSheetInfo">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="-150" y="-135" w="150" h="90" />
  </stage>
  <stage stageid="d408cc40-0b0b-4bfd-b7cc-1df37b13fbf9" name="Start" type="Start">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="15" y="-150" />
    <onsuccess>075ae853-ddf8-4d8b-b7cb-d37674d6d79a</onsuccess>
  </stage>
  <stage stageid="647b8ee2-2a79-4ce1-aab0-7b49b582b5b9" name="Get Sessions" type="Action">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="15" y="135" w="90" h="30" />
    <outputs>
      <output type="collection" name="Sessions" narrative="A list of the sessions that are in the list." stage="Ran Sessions" />
    </outputs>
    <onsuccess>cfdcb814-bda2-4cc7-a0d9-2e19153ea0a4</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Get Sessions" />
  </stage>
  <stage stageid="554a9b1e-9b9e-46ea-ab6f-b7010aa5f432" name="Select Session Management" type="Action">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="text" name="Control Item to Click" narrative="Control Item to click in left hand side control Tree" expr="&quot;Session Management&quot;" />
    </inputs>
    <onsuccess>f9d95e5f-020d-4a18-b6e5-83d9a717980e</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Click Item from Control's Left Tree" />
  </stage>
  <stage stageid="f9d95e5f-020d-4a18-b6e5-83d9a717980e" name="Set Last 15 Minutes" type="Action">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="15" y="30" w="90" h="30" />
    <inputs>
      <input type="text" name="Session Start Time" narrative="Allowed value can be one of the following: All, Last 15 Minutes, Last 30 Minutes, Last 1 Hour, Last 2 Hours, Last 4 Hours, Last 8 Hours, Last 12 Hours, Last 18 Hours, Last 24 Hours, Today, Last 3 Days, Last 7 Days, Last 31 Days" expr="&quot;Last 15 Minutes&quot;" />
    </inputs>
    <onsuccess>88258e2d-51f1-4f61-9922-21212d79ae4e</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Change Session Start Time" />
  </stage>
  <stage stageid="e3f51c32-cd2e-4c3a-bdb5-fdb8d1d54127" name="Ran Sessions" type="Collection">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="-150" y="-45" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cf2ad174-d428-4e05-8e5d-73c470cc7891" name="Local Variables" type="Block">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="-225" y="-75" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e3fbedcb-f878-43b7-8d07-4a44470b9d9a" name="Found Session?" type="Decision">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="15" y="225" w="90" h="30" />
    <decision expression="[Ran Sessions.Process]=&quot;Sub Process BP-3199&quot;&#xA;AND &#xA;[Ran Sessions.Resource]=[Task Sessions 1.Sessions.Resource Name]&#xA;AND &#xA;[Ran Sessions.User]=&quot;[Scheduler]&quot; &#xA;AND &#xA;[Ran Sessions.Status]=&quot;Running&quot;" />
    <ontrue>4c436032-cbc6-4edb-b899-ec3dadab1488</ontrue>
    <onfalse>3e07e069-7bc4-4502-9961-004366af6f12</onfalse>
  </stage>
  <stage stageid="cfdcb814-bda2-4cc7-a0d9-2e19153ea0a4" name="Ran Sessions" type="LoopStart">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="180" w="90" h="30" />
    <onsuccess>e3fbedcb-f878-43b7-8d07-4a44470b9d9a</onsuccess>
    <groupid>7db101f5-f620-47e6-a0f6-b7e57d2b823e</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Ran Sessions</loopdata>
  </stage>
  <stage stageid="3e07e069-7bc4-4502-9961-004366af6f12" name="Ran Sessions" type="LoopEnd">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="270" w="90" h="30" />
    <onsuccess>387df5bb-08a2-4e2d-aaaa-bcda1e4e1ec9</onsuccess>
    <groupid>7db101f5-f620-47e6-a0f6-b7e57d2b823e</groupid>
  </stage>
  <stage stageid="4c436032-cbc6-4edb-b899-ec3dadab1488" name="Session is found when it should not" type="Exception">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="105" y="225" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;A retired schedule should not be able to run, however this is not the case, check thick client&quot;" />
  </stage>
  <stage stageid="88258e2d-51f1-4f61-9922-21212d79ae4e" name="Pause 40 seconds" type="Action">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="number" name="Duration (Seconds)" friendlyname="Duration (Seconds)" expr="40" />
    </inputs>
    <onsuccess>647b8ee2-2a79-4ce1-aab0-7b49b582b5b9</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Pause" />
  </stage>
  <stage stageid="387df5bb-08a2-4e2d-aaaa-bcda1e4e1ec9" name="API - GET schedules log" type="Action">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="345" w="90" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection.items.JSON:Array.id]" />
      <input type="number" name="Items per page" friendlyname="Items per page" expr="1" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>82d8fd67-8b43-45a8-a9cb-cc5e6ef1558a</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules log" />
  </stage>
  <stage stageid="82d8fd67-8b43-45a8-a9cb-cc5e6ef1558a" name="Convert Response to Collection" type="Action">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="390" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Schedule log collection default" />
    </outputs>
    <onsuccess>8dce6e69-e42c-49eb-8d51-83584d6b4532</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="7c9e026e-40ef-49e5-8589-dbef91bf6b3b" name="Schedule is still completed and not running?" type="Decision">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="15" y="480" w="90" h="30" />
    <decision expression="[Schedule log collection.JSON:Array.status]=&quot;Completed&quot;&#xA;AND&#xA;[Schedule log collection.JSON:Array.startTime]&gt;=[Start DateTime]&#xA;AND&#xA;[Schedule log collection.JSON:Array.startTime]&lt;=Now()" />
    <ontrue>3d011deb-76b6-4bae-ae87-850d613eebbf</ontrue>
    <onfalse>92ad408f-cdf4-4015-b721-f49303a34262</onfalse>
  </stage>
  <stage stageid="92ad408f-cdf4-4015-b721-f49303a34262" name="Schedule is not showing as completed" type="Exception">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="105" y="480" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;The schedule has been run to completion previously, this status should not have changed, however this was not the case, check schedule log API response Scenario 2&quot;" />
  </stage>
  <stage stageid="e767454f-5482-47b4-a396-0598593594ad" name="Schedule log collection" type="Collection">
    <display x="-270" y="240" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="JSON:Array" type="collection">
        <field name="scheduleLogId" type="number" />
        <field name="status" type="text" />
        <field name="startTime" type="datetime" />
        <field name="endTime" type="datetime" />
        <field name="serverName" type="text" />
        <field name="scheduleId" type="number" />
        <field name="scheduleName" type="text" />
      </field>
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="JSON:Array" type="collection">
          <row>
            <field name="scheduleLogId" type="number" value="" />
            <field name="status" type="text" value="" />
            <field name="startTime" type="datetime" value="" />
            <field name="endTime" type="datetime" value="" />
            <field name="serverName" type="text" value="" />
            <field name="scheduleId" type="number" value="" />
            <field name="scheduleName" type="text" value="" />
          </row>
        </field>
      </row>
    </initialvalue>
  </stage>
  <stage stageid="3d011deb-76b6-4bae-ae87-850d613eebbf" name="End4" type="End">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="540" />
  </stage>
  <stage stageid="1d7b355d-b552-441c-945b-a2f18f04daf5" name="Checking Schedule log API response" type="Block">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="315" w="240" h="195" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c16af840-19c4-465d-9868-9c514c4a82c9" name="Checking Blue Prism Thick Client" type="Block">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="105" w="240" h="195" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="fedd7937-2d4c-4aa2-9921-161d689c642a" name="Note1" type="Note">
    <narrative>GIVEN that a schedule is retired
WHEN a request is made to the API to un-retire a schedule
THEN the schedule can be unretired and can be run again</narrative>
    <display x="15" y="420" w="360" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>ddb36b8b-f9c3-4828-8df6-c6d3c582ea67</onsuccess>
  </stage>
  <stage stageid="8b4f1322-58d0-43b7-9a05-927a053b6075" name="Scenario 3" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="375" w="405" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ddb36b8b-f9c3-4828-8df6-c6d3c582ea67" name="Scenario 3" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="480" w="120" h="30" />
    <onsuccess>2cffe523-94cf-4398-9260-47f4821c041e</onsuccess>
    <processid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</processid>
  </stage>
  <stage stageid="bc99d7fe-2986-468f-8ae8-3712bca22ccb" name="Resume Scenario 3" type="Resume">
    <loginhibit />
    <display x="270" y="525" />
    <onsuccess>2cffe523-94cf-4398-9260-47f4821c041e</onsuccess>
  </stage>
  <stage stageid="ba4914f7-5d9a-4f01-b755-af65b6866ebc" name="Get Exception 3" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="270" y="480" />
    <onsuccess>bc99d7fe-2986-468f-8ae8-3712bca22ccb</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot;,Scenario 3 Failed. Exception details: &quot;&amp;ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="2cffe523-94cf-4398-9260-47f4821c041e" name="Anchor12" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="525" w="10" h="10" />
    <onsuccess>a1a5aef6-67c0-47a5-a060-36adb9739b0d</onsuccess>
  </stage>
  <stage stageid="b8591e4b-ed3a-4771-adcd-46d4864cef9d" name="Scenario 3" type="SubSheetInfo">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="-150" y="-135" w="150" h="90" />
  </stage>
  <stage stageid="887ec96d-5933-4356-8dc4-397f34808090" name="Start" type="Start">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="15" y="-165" />
    <onsuccess>7edff87c-c32c-49ec-94cc-a40a7660f6e9</onsuccess>
  </stage>
  <stage stageid="cbe70d81-bbcf-4aed-9989-fecf2f545439" name="Get Sessions" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="15" y="360" w="90" h="30" />
    <outputs>
      <output type="collection" name="Sessions" narrative="A list of the sessions that are in the list." stage="Ran Sessions" />
    </outputs>
    <onsuccess>9b5d37cb-daea-43ad-aa05-e5fab295c8e2</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Get Sessions" />
  </stage>
  <stage stageid="7a76fc50-711a-45a7-abab-a1b857cb265e" name="Select Session Management" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="15" y="285" w="90" h="30" />
    <inputs>
      <input type="text" name="Control Item to Click" narrative="Control Item to click in left hand side control Tree" expr="&quot;Session Management&quot;" />
    </inputs>
    <onsuccess>cbe70d81-bbcf-4aed-9989-fecf2f545439</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Click Item from Control's Left Tree" />
  </stage>
  <stage stageid="acacab22-cfb1-43b3-95c7-0bc546efc3d8" name="Ran Sessions" type="Collection">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="-150" y="-45" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f29ea598-9685-44e5-a2d8-7791d4bd77cd" name="Local Variables" type="Block">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="-225" y="-75" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e767ecd1-957d-4170-9afd-ff505a80efa7" name="Found Session?" type="Decision">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="15" y="450" w="90" h="30" />
    <decision expression="[Ran Sessions.Process]=&quot;Sub Process BP-3199 B&quot;&#xA;AND &#xA;[Ran Sessions.Resource]=[Task Sessions 1.Sessions.Resource Name]&#xA;AND &#xA;[Ran Sessions.User]=&quot;[Scheduler]&quot; &#xA;AND &#xA;[Ran Sessions.Status]=&quot;Completed&quot;" />
    <ontrue>f2729b47-efcf-4ba9-8343-ad2726229a60</ontrue>
    <onfalse>451fe836-9173-4c9b-8da2-905570a0ee8d</onfalse>
  </stage>
  <stage stageid="9b5d37cb-daea-43ad-aa05-e5fab295c8e2" name="Ran Sessions" type="LoopStart">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="405" w="90" h="30" />
    <onsuccess>e767ecd1-957d-4170-9afd-ff505a80efa7</onsuccess>
    <groupid>089f9c18-3142-4237-9dde-74da53cf0867</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Ran Sessions</loopdata>
  </stage>
  <stage stageid="451fe836-9173-4c9b-8da2-905570a0ee8d" name="Ran Sessions" type="LoopEnd">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="495" w="90" h="30" />
    <onsuccess>e0f4dee7-9553-460e-95b0-1fabb0b06a25</onsuccess>
    <groupid>089f9c18-3142-4237-9dde-74da53cf0867</groupid>
  </stage>
  <stage stageid="e0f4dee7-9553-460e-95b0-1fabb0b06a25" name="Session is not found" type="Exception">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="105" y="495" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;An un-retired schedule should be able to run, however this is not the case, check thick client&quot;" />
  </stage>
  <stage stageid="a0f6ea49-1f90-4f91-a917-3bc1c2efb68b" name="API - GET schedules log" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="570" w="90" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection 2.items.JSON:Array.id]" />
      <input type="number" name="Items per page" friendlyname="Items per page" expr="1" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>b4a81c3e-a3f8-47e4-9dbf-98bf999626e6</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules log" />
  </stage>
  <stage stageid="b4a81c3e-a3f8-47e4-9dbf-98bf999626e6" name="Convert Response to Collection" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="615" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Schedule log collection default" />
    </outputs>
    <onsuccess>22dbc6b5-8a95-4edd-9b2a-a1f25679e36a</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="ab23173e-5d1c-41e8-babe-f6ab34387f66" name="Schedule is still completed and not running?" type="Decision">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="15" y="705" w="90" h="30" />
    <decision expression="[Schedule log collection.JSON:Array.status]=&quot;Completed&quot;&#xA;AND&#xA;[Schedule log collection.JSON:Array.startTime]&gt;=[Start DateTime]&#xA;AND&#xA;[Schedule log collection.JSON:Array.startTime]&lt;=Now()" />
    <ontrue>4300c8b5-7179-4a33-8ba9-5df64ba61eaf</ontrue>
    <onfalse>34fe6e8b-bc98-4530-939c-cd812ab2f07e</onfalse>
  </stage>
  <stage stageid="34fe6e8b-bc98-4530-939c-cd812ab2f07e" name="Schedule is not showing as completed" type="Exception">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="105" y="705" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;The schedule has been run to completion, this status should not change, check schedule log API response&quot;" />
  </stage>
  <stage stageid="4300c8b5-7179-4a33-8ba9-5df64ba61eaf" name="End4" type="End">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="765" />
  </stage>
  <stage stageid="01f1f17d-1290-456c-b6cc-ecddd282d400" name="Checking Schedule log API response" type="Block">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="540" w="240" h="195" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c889e278-85ed-4207-a0cc-38058dc1c0d6" name="Checking Blue Prism Thick Client" type="Block">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="330" w="240" h="195" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="7edff87c-c32c-49ec-94cc-a40a7660f6e9" name="API - Un-retire schedule 2" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" w="90" h="30" />
    <inputs>
      <input type="flag" name="isRetired" friendlyname="isRetired" expr="False" />
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection 2.items.JSON:Array.id]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>d52f3013-b32b-4579-afd8-a73a787b2613</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="PUT schedules" />
  </stage>
  <stage stageid="485600f7-0ed7-454b-b08b-ef0e656f7fe7" name="Pause 30 seconds" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-30" w="90" h="30" />
    <inputs>
      <input type="number" name="Duration (Seconds)" friendlyname="Duration (Seconds)" expr="30" />
    </inputs>
    <onsuccess>fc1669ef-77b5-4230-9dee-267ac1c44587</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Pause" />
  </stage>
  <stage stageid="86037eed-d6ee-4e53-a771-b27a692a0164" name="Create Schedule" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="480" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name of the schedule to create" expr="[Schedule Name 2]" />
      <input type="date" name="Start Date" friendlyname="Start Date" narrative="The start date for the schedule" expr="Today()" />
      <input type="time" name="Start Time" friendlyname="Start Time" narrative="The start time for the schedule" expr="[Start Time]" />
      <input type="collection" name="Tasks" friendlyname="Tasks" narrative="The tasks to run" expr="[Task Sessions 2]" />
      <input type="text" name="Group To Expand" friendlyname="Group To Expand" narrative="Group contianing Process" expr="&quot;Default&quot;" />
      <input type="text" name="Resource Group To Expand" friendlyname="Resource Group To Expand" narrative="Group containing resources in schedule" expr="&quot;Default&quot;" />
    </inputs>
    <onsuccess>927ef880-b350-449d-954e-05823fcb2871</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Create Schedule" />
  </stage>
  <stage stageid="917d9e92-3292-4187-b725-0342f43493b3" name="Schedule Name 2" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="405" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Schedule BP-3199 B</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="927ef880-b350-449d-954e-05823fcb2871" name="Add to CleanUp Collection" type="SubSheet">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="525" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Schedule BP-3199 B&quot;" />
    </inputs>
    <onsuccess>653c4da8-27e6-4d2a-96b8-d365ac88d601</onsuccess>
    <processid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</processid>
  </stage>
  <stage stageid="623e8294-9122-47a2-9450-a236275e346f" name="Delete Schedule" type="Action">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="330" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" narrative="The name of the schedule which will be run" expr="&quot;Schedule BP-3199 B&quot;" />
    </inputs>
    <onsuccess>96033e74-3e1f-4ee4-9a18-d10507b197e6</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Delete Schedule" />
  </stage>
  <stage stageid="c6889bec-020d-40e4-be32-a23e4450733a" name="Open Control Tab" type="Action">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <display x="225" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>623e8294-9122-47a2-9450-a236275e346f</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="96033e74-3e1f-4ee4-9a18-d10507b197e6" name="Anchor20" type="Anchor">
    <subsheetid>a520a901-f85f-4cce-b137-cd4ba2cd6950</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="120" w="10" h="10" />
    <onsuccess>b2dd5714-9a95-417f-bfe4-531ca4c3b909</onsuccess>
  </stage>
  <stage stageid="a7bf5c16-83e6-4c86-b264-477de0a710d9" name="GET schedule 2" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="750" w="90" h="30" />
    <inputs>
      <input type="text" name="Name starts with" friendlyname="Name starts with" narrative="Schedule Name" expr="[Schedule Name 2]" />
      <input type="text" name="Retirement Status" friendlyname="Retirement Status" narrative="Active or Retired" expr="&quot;Active&quot;" />
      <input type="number" name="Items Per Page" friendlyname="Items Per Page" narrative="1" expr="1" />
      <input type="text" name="Paging Token" friendlyname="Paging Token" narrative="mixtures of text and numbers" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>30fd747d-8c5c-4dc5-8d04-1037a92ba066</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules" />
  </stage>
  <stage stageid="ae44d671-0584-4caf-a6aa-75d34bd9d40b" name="Convert Response to Collection" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="840" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection 2" />
    </outputs>
    <onsuccess>9ac750b0-dea4-41dc-9436-4d6625baaf74</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="30fd747d-8c5c-4dc5-8d04-1037a92ba066" name="Check HTTP response code is correct and response content has content" type="Decision">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="795" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;200&quot; AND&#xA;[Response Content]&lt;&gt;&quot;&quot;" />
    <ontrue>ae44d671-0584-4caf-a6aa-75d34bd9d40b</ontrue>
    <onfalse>869b61df-1a62-4218-9817-e6f60a586501</onfalse>
  </stage>
  <stage stageid="869b61df-1a62-4218-9817-e6f60a586501" name="Unexpected Response" type="Exception">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="105" y="795" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Expected GET schedules API call to return HTTP Status Code = 200 and return content in the response but this is not the case&quot;" />
  </stage>
  <stage stageid="7c3bb90a-79dc-4e4b-aefe-2b6dc962c7dd" name="Result Collection 2" type="Collection">
    <display x="-270" y="435" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="pagingToken" type="text" />
      <field name="items" type="collection">
        <field name="JSON:Array" type="collection">
          <field name="id" type="number" />
          <field name="name" type="text" />
          <field name="description" type="text" />
          <field name="isRetired" type="flag" />
          <field name="tasksCount" type="number" />
          <field name="intervalType" type="text" />
          <field name="timePeriod" type="number" />
          <field name="startPoint" type="datetime" />
          <field name="endPoint" type="datetime" />
          <field name="dayOfWeek" type="text" />
          <field name="dayOfMonth" type="text" />
          <field name="startDate" type="datetime" />
          <field name="endDate" type="datetime" />
          <field name="calendarId" type="text" />
          <field name="calendarName" type="text" />
        </field>
      </field>
    </collectioninfo>
  </stage>
  <stage stageid="4cfe56e6-d9c6-4f50-97ce-43571cab4b45" name="API - Retire a schedule 2" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="flag" name="isRetired" friendlyname="isRetired" expr="True" />
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection 2.items.JSON:Array.id]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>20fed7a5-c2de-4458-a263-7c8d3c64af4f</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="PUT schedules" />
  </stage>
  <stage stageid="3cd844e4-119e-4c20-b6ad-4bb7b099b6fa" name="Note2" type="Note">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <narrative>Retire Schedule 2 in preparation for Scenario 3</narrative>
    <display x="15" y="-60" w="180" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>4cfe56e6-d9c6-4f50-97ce-43571cab4b45</onsuccess>
  </stage>
  <stage stageid="c81e6037-a252-4540-8436-c549faac05fa" name="Note2" type="Note">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <narrative>Retire Schedule 1 whilst it's still running</narrative>
    <display x="15" y="75" w="180" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>48e325e4-c626-4425-99d4-f9600a34ad16</onsuccess>
  </stage>
  <stage stageid="fc1669ef-77b5-4230-9dee-267ac1c44587" name="GET schedule 2" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="15" w="90" h="30" />
    <inputs>
      <input type="text" name="Name starts with" friendlyname="Name starts with" narrative="Schedule Name" expr="[Schedule Name 2]" />
      <input type="text" name="Retirement Status" friendlyname="Retirement Status" narrative="Active or Retired" expr="&quot;Active&quot;" />
      <input type="number" name="Items Per Page" friendlyname="Items Per Page" narrative="1" expr="1" />
      <input type="text" name="Paging Token" friendlyname="Paging Token" narrative="mixtures of text and numbers" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>27083b41-3562-47b2-abae-117da4a4222d</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules" />
  </stage>
  <stage stageid="27083b41-3562-47b2-abae-117da4a4222d" name="Convert Response to Collection" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="60" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection 2" />
    </outputs>
    <onsuccess>fd530261-8efb-4c48-9bb3-4bb7750212c5</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="fd530261-8efb-4c48-9bb3-4bb7750212c5" name="Schedule is now Active? All info still intact?" type="Decision">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="15" y="105" w="90" h="30" />
    <decision expression="[Result Collection 2.items.JSON:Array.isRetired]=False&#xA;AND&#xA;[Result Collection 2.items.JSON:Array.name]=[Schedule Name 2]&#xA;AND&#xA;[Result Collection 2.items.JSON:Array.intervalType]=&quot;Once&quot;&#xA;AND&#xA;[Result Collection 2.items.JSON:Array.startPoint]&lt;=[Start DateTime]&#xA;AND&#xA;[Result Collection 2.items.JSON:Array.endPoint]&lt;=[End Point]&#xA;AND&#xA;[Result Collection 2.items.JSON:Array.startDate]&gt;=[Start DateTime]" />
    <ontrue>1871f5e7-5982-41c4-a18b-7b06dfe7f467</ontrue>
    <onfalse>d71a05d8-01f3-46de-aaaf-ff4af472de91</onfalse>
  </stage>
  <stage stageid="d71a05d8-01f3-46de-aaaf-ff4af472de91" name="FAIL" type="Exception">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="105" y="105" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;The schedule should now be un-retired after it is requested by the API to be un-retired and all schedule information/config should retain its information, but this is not the case&quot;" />
  </stage>
  <stage stageid="06014289-362f-4a58-926e-3b99b5e45603" name="Pause 30 seconds" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="240" w="90" h="30" />
    <inputs>
      <input type="number" name="Duration (Seconds)" friendlyname="Duration (Seconds)" expr="30" />
    </inputs>
    <onsuccess>7a76fc50-711a-45a7-abab-a1b857cb265e</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Pause" />
  </stage>
  <stage stageid="d48b9cd9-de4a-4925-ad3f-87fa760ad312" name="Task Sessions 2" type="Collection">
    <loginhibit />
    <display x="-270" y="465" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Task Name" type="text" description="The name of the task to create" />
      <field name="On Success" type="text" description="The task to perform on successful completion of the task, leave blank for default (Stop)" />
      <field name="On Failure" type="text" description="The task to perform on failure of the task, leave blank for default (Abort)" />
      <field name="Sessions" type="collection" description="The sessions to create on the task">
        <field name="Process Group" type="text" description="The group within which the process can be found, leave empty for no group" />
        <field name="Process Name" type="text" description="The name of the process to create in the session" />
        <field name="Resource Name" type="text" description="The name of the resource to run the process on" />
      </field>
      <field name="Fail Fast" type="flag" description="True to fail the task immediately on any errors; False to let other sessions run - Defaults to True" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Task Name" type="text" value="Task BP-3199 B" />
        <field name="On Success" type="text" value="Stop" />
        <field name="On Failure" type="text" value="Abort" />
        <field name="Sessions" type="collection">
          <row>
            <field name="Process Group" type="text" value="Default" />
            <field name="Process Name" type="text" value="Sub Process BP-3199 B" />
            <field name="Resource Name" type="text" value="" />
          </row>
        </field>
        <field name="Fail Fast" type="flag" value="False" />
      </row>
    </initialvalue>
    <noalwaysinit />
  </stage>
  <stage stageid="20fed7a5-c2de-4458-a263-7c8d3c64af4f" name="Check HTTP status code is correct" type="Decision">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="15" y="30" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;204&quot;" />
    <ontrue>c81e6037-a252-4540-8436-c549faac05fa</ontrue>
    <onfalse>a2801d86-8c8c-4a07-b4bc-e6f96b99abf3</onfalse>
  </stage>
  <stage stageid="a2801d86-8c8c-4a07-b4bc-e6f96b99abf3" name="Unexpected Response Values" type="Exception">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="105" y="30" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Expected HTTP Status Code to be 204 but this is not the case when trying to Retire Schedule 2&quot;" />
  </stage>
  <stage stageid="79041c30-49c5-424a-9a2d-febb58753768" name="Check HTTP status code is correct" type="Decision">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="15" y="300" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;204&quot;" />
    <ontrue>f126cfb8-11d4-4a34-a61e-f094dd744a92</ontrue>
    <onfalse>08783bbd-4684-47b7-be10-127a02404845</onfalse>
  </stage>
  <stage stageid="08783bbd-4684-47b7-be10-127a02404845" name="Unexpected Response Values" type="Exception">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="105" y="300" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Expected HTTP Status Code to be 204 but this is not the case when trying to Retire Schedule 1&quot;" />
  </stage>
  <stage stageid="d52f3013-b32b-4579-afd8-a73a787b2613" name="Check HTTP status code is correct" type="Decision">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="15" y="-75" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;204&quot;" />
    <ontrue>485600f7-0ed7-454b-b08b-ef0e656f7fe7</ontrue>
    <onfalse>d5f56fe8-9659-4805-9eb4-dcd320dcb77d</onfalse>
  </stage>
  <stage stageid="d5f56fe8-9659-4805-9eb4-dcd320dcb77d" name="Unexpected Response Values" type="Exception">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="105" y="-75" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Expected HTTP Status Code to be 204 but this is not the case when trying to Un-retire Schedule 2&quot;" />
  </stage>
  <stage stageid="f2729b47-efcf-4ba9-8343-ad2726229a60" name="Anchor7" type="Anchor">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="450" w="10" h="10" />
    <onsuccess>c09ddda7-7b74-465f-81c7-c9ff5e7acb20</onsuccess>
  </stage>
  <stage stageid="c09ddda7-7b74-465f-81c7-c9ff5e7acb20" name="Anchor8" type="Anchor">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="570" w="10" h="10" />
    <onsuccess>a0f6ea49-1f90-4f91-a917-3bc1c2efb68b</onsuccess>
  </stage>
  <stage stageid="075ae853-ddf8-4d8b-b7cb-d37674d6d79a" name="API POST schedules to run now" type="Action">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" w="90" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection.items.JSON:Array.id]" />
      <input type="datetime" name="Start Time" friendlyname="Start Time" narrative="produces scheduled time" expr="Now()" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="datetime" name="scheduledTime" friendlyname="scheduledTime" stage="scheduledTime" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>86ce381d-2fa7-42ca-b5cd-6c90341c2a08</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="POST schedules to run at a given time" />
  </stage>
  <stage stageid="86ce381d-2fa7-42ca-b5cd-6c90341c2a08" name="HTTP Status code = 202 and schedule time is returned?" type="Decision">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;202&quot;&#xA;AND&#xA;[scheduledTime]&gt;=[Start DateTime]&#xA;AND&#xA;[scheduledTime]&lt;=[End of Schedule Time]" />
    <ontrue>554a9b1e-9b9e-46ea-ab6f-b7010aa5f432</ontrue>
    <onfalse>b2538d91-2f45-47bc-979e-883ec5e1d093</onfalse>
  </stage>
  <stage stageid="b2538d91-2f45-47bc-979e-883ec5e1d093" name="Unexpected response" type="Exception">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <display x="105" y="-60" />
    <exception localized="yes" type="Unexpected response" detail="&quot;Post schedule to run now failed to return HTTP Status Code = 202 and/or a scheduleTime&quot;" />
  </stage>
  <stage stageid="e3ecc36d-0a2c-443c-9c24-9895ab6fd4d7" name="scheduledTime" type="Data">
    <display x="-270" y="270" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="9ac750b0-dea4-41dc-9436-4d6625baaf74" name="API POST schedules to run now" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="885" w="90" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection.items.JSON:Array.id]" />
      <input type="datetime" name="Start Time" friendlyname="Start Time" narrative="produces scheduled time" expr="Now()" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="datetime" name="scheduledTime" friendlyname="scheduledTime" stage="scheduledTime" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>597c9504-5496-4dd1-a6bc-37397d15abe5</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="POST schedules to run at a given time" />
  </stage>
  <stage stageid="597c9504-5496-4dd1-a6bc-37397d15abe5" name="HTTP Status code = 202 and schedule time is returned?" type="Decision">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="930" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;202&quot;&#xA;AND&#xA;[scheduledTime]&gt;=[Start DateTime]&#xA;AND&#xA;[scheduledTime]&lt;=[End of Schedule Time]" />
    <ontrue>beeaaffd-d7a2-4486-be4e-95e2939a905e</ontrue>
    <onfalse>05a135fe-07f3-4f2d-98d6-585d21703f43</onfalse>
  </stage>
  <stage stageid="05a135fe-07f3-4f2d-98d6-585d21703f43" name="Unexpected response" type="Exception">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="105" y="930" />
    <exception localized="yes" type="Unexpected response" detail="&quot;Post schedule to run now failed to return HTTP Status Code = 202 and/or a scheduleTime&quot;" />
  </stage>
  <stage stageid="e9a6a0c2-023f-4b30-8929-f4db3f87c13d" name="API POST schedules to run now" type="Action">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="210" w="90" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection.items.JSON:Array.id]" />
      <input type="datetime" name="Start Time" friendlyname="Start Time" narrative="produces scheduled time" expr="Now()" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="datetime" name="scheduledTime" friendlyname="scheduledTime" stage="scheduledTime" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>6443512c-3ed5-4895-a86d-4c38157d22c0</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="POST schedules to run at a given time" />
  </stage>
  <stage stageid="6443512c-3ed5-4895-a86d-4c38157d22c0" name="HTTP Status code = 202 and schedule time is returned?" type="Decision">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="225" y="210" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;202&quot;&#xA;AND&#xA;[scheduledTime]&gt;=[Start DateTime]&#xA;AND&#xA;[scheduledTime]&lt;=[End of Schedule Time]" />
    <ontrue>6491d20e-148e-41ce-b69f-555518eef892</ontrue>
    <onfalse>5db2a584-48ba-4879-a15e-26300c65261c</onfalse>
  </stage>
  <stage stageid="5db2a584-48ba-4879-a15e-26300c65261c" name="Unexpected response" type="Exception">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <display x="315" y="210" />
    <exception localized="yes" type="Unexpected response" detail="&quot;Post schedule to run now failed to return HTTP Status Code = 202 and/or a scheduleTime&quot;" />
  </stage>
  <stage stageid="6491d20e-148e-41ce-b69f-555518eef892" name="Anchor13" type="Anchor">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="255" w="10" h="10" />
    <onsuccess>390170fd-ca10-4e51-ac1d-c43075e483f1</onsuccess>
  </stage>
  <stage stageid="7fde0729-763a-4ea8-8c10-23931e23989f" name="HTTP Status code = 202 and schedule time is returned?" type="Decision">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="15" y="195" w="90" h="30" />
    <decision expression="[HTTP Status Code]=&quot;202&quot;&#xA;AND&#xA;[scheduledTime]&gt;=[Start DateTime]&#xA;AND&#xA;[scheduledTime]&lt;=[End of Schedule Time]" />
    <ontrue>06014289-362f-4a58-926e-3b99b5e45603</ontrue>
    <onfalse>59b4b596-c061-4948-9aaa-0e140c2c18d6</onfalse>
  </stage>
  <stage stageid="59b4b596-c061-4948-9aaa-0e140c2c18d6" name="Unexpected response" type="Exception">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <display x="105" y="195" />
    <exception localized="yes" type="Unexpected response" detail="&quot;Post schedule to run now failed to return HTTP Status Code = 202 and/or a scheduleTime&quot;" />
  </stage>
  <stage stageid="1871f5e7-5982-41c4-a18b-7b06dfe7f467" name="API POST schedules to run now" type="Action">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="150" w="90" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection 2.items.JSON:Array.id]" />
      <input type="datetime" name="Start Time" friendlyname="Start Time" narrative="produces scheduled time" expr="Now()" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="datetime" name="scheduledTime" friendlyname="scheduledTime" stage="scheduledTime" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>7fde0729-763a-4ea8-8c10-23931e23989f</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="POST schedules to run at a given time" />
  </stage>
  <stage stageid="1eae21f9-5758-453b-8424-a34bd4316b95" name="Calculate time left" type="Calculation">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="165" w="90" h="30" />
    <onsuccess>ea06f8e4-73e0-4c95-aafb-cf3e7909b86c</onsuccess>
    <calculation expression="[End Time]-[Current time]" stage="Time span left" />
  </stage>
  <stage stageid="48e325e4-c626-4425-99d4-f9600a34ad16" name="Make end time, store current time" type="MultipleCalculation">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="90" h="30" />
    <onsuccess>1eae21f9-5758-453b-8424-a34bd4316b95</onsuccess>
    <steps>
      <calculation expression="Now()" stage="Current time" />
      <calculation expression="Now()+MakeTimeSpan(0,0,2,0)" stage="End Time" />
    </steps>
  </stage>
  <stage stageid="ea4dd532-5a83-4274-941c-892e1c4a8379" name="End of Schedule Time" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="105" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="beeaaffd-d7a2-4486-be4e-95e2939a905e" name="Pause 20 seconds" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="975" w="90" h="30" />
    <inputs>
      <input type="number" name="Duration (Seconds)" friendlyname="Duration (Seconds)" expr="20" />
    </inputs>
    <onsuccess>b7f2476e-5cf4-40b0-acbd-9890dd843888</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Pause" />
  </stage>
  <stage stageid="6d1eaa24-d3e0-4051-b924-261e7b959660" name="Utility - Date and Time Manipulation::UTC To Local" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="300" w="90" h="30" />
    <inputs>
      <input type="datetime" name="UTC" friendlyname="UTC" narrative="The UTC datetime to convert" expr="Now()" />
      <input type="text" name="Time Zone ID" friendlyname="Time Zone ID" narrative="The ID of the timezone to use; Empty means to use the time zone on the executing environment" expr="" />
    </inputs>
    <outputs>
      <output type="datetime" name="local" friendlyname="local" narrative="The converted datetime" stage="Now() (Local)" />
    </outputs>
    <onsuccess>4bc97d37-1c25-4e61-9023-ad635548be98</onsuccess>
    <resource object="Utility - Date and Time Manipulation" action="UTC To Local" />
  </stage>
  <stage stageid="a689032b-17a1-41c0-b21b-30acd3c65c85" name="Now() (Local)" type="Data">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="-135" y="-165" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6f8c3796-b52f-40a1-b6cc-7d162d3bc188" name="Add to CleanUp Collection" type="SubSheet">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="-255" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Blue Prism&quot;" />
    </inputs>
    <onsuccess>e1dceb67-b84e-4789-9467-7f205612a0d0</onsuccess>
    <processid>5bbc7468-44a2-4d4c-841e-0700b7e57a52</processid>
  </stage>
  <stage stageid="56af76f2-02f6-4e68-b81c-4811c581f653" name="Start" type="Start">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="-345" />
    <onsuccess>d2de790b-7bd4-4389-9ce8-0e9a18878f4a</onsuccess>
  </stage>
  <stage stageid="d2de790b-7bd4-4389-9ce8-0e9a18878f4a" name="Launch" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <display x="15" y="-300" w="90" h="30" />
    <outputs>
      <output type="number" name="pid" friendlyname="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>6f8c3796-b52f-40a1-b6cc-7d162d3bc188</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="e1dceb67-b84e-4789-9467-7f205612a0d0" name="Sign In Auth Server" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-210" w="90" h="30" />
    <onsuccess>543dd397-8b2c-4143-a62b-08c162219794</onsuccess>
    <resource object="Blue Prism" action="Sign in using Auth Server" />
  </stage>
  <stage stageid="543dd397-8b2c-4143-a62b-08c162219794" name="IMS Server:Attach" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-165" w="90" h="30" />
    <onsuccess>2368b529-804c-425b-9d24-107bba023952</onsuccess>
    <resource object="IMS Server" action="Attach" />
  </stage>
  <stage stageid="2368b529-804c-425b-9d24-107bba023952" name="IMS Server:Login" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" expr="&quot;Qq1234!!&quot;" />
    </inputs>
    <onsuccess>8039adb2-b691-4a94-af64-ac2576c0956f</onsuccess>
    <resource object="IMS Server" action="Login" />
  </stage>
  <stage stageid="8039adb2-b691-4a94-af64-ac2576c0956f" name="Setup Credential" type="Action">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/createcredential &quot;&quot;BPE-API-Credential&quot;&quot; ServiceAccount E3NbGuz9G/nSpQWdz6DMROZhtIDHtUhev13wsCV72fY=  /credentialtype OAuth2ClientCredentials&quot;" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="" />
    </outputs>
    <onsuccess>d78e18dd-391c-45cb-93c0-c54a57ac7344</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="a587b944-60c7-4fd4-ba7a-03645572948a" name="Credential already exists?" type="Recover">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit />
    <display x="120" y="-60" w="90" h="30" />
    <onsuccess>249779f3-50e1-4aee-b20f-aae01556fa99</onsuccess>
  </stage>
  <stage stageid="249779f3-50e1-4aee-b20f-aae01556fa99" name="Resume1" type="Resume">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit />
    <display x="120" y="0" w="90" h="30" />
    <onsuccess>d78e18dd-391c-45cb-93c0-c54a57ac7344</onsuccess>
  </stage>
  <stage stageid="d78e18dd-391c-45cb-93c0-c54a57ac7344" name="Anchor14" type="Anchor">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" w="10" h="10" />
    <onsuccess>4e99861e-f20b-478c-b5fd-ba234d51f680</onsuccess>
  </stage>
  <stage stageid="8c46413e-2743-4c2e-9f6c-b6dab4e3e30a" name="Create credential" type="Block">
    <subsheetid>fbedf4a4-75b9-45ed-a57b-eed85cda8032</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="225" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e3d488f4-e998-42fd-8e5d-cbb66fb3b7f8" name="Recover1" type="Recover">
    <loginhibit />
    <display x="180" y="180" />
    <onsuccess>d1c0bf62-ba43-4686-8fb1-43075410aec6</onsuccess>
  </stage>
  <stage stageid="89d90296-ff7d-4059-af74-5e768618f391" name="Recover2" type="Recover">
    <loginhibit />
    <display x="180" y="315" />
    <onsuccess>6eb3964c-3cee-44ca-a117-a68b7fd585f2</onsuccess>
  </stage>
  <stage stageid="71b530f0-a254-47c4-91bf-984d00f8b8d3" name="Recover3" type="Recover">
    <loginhibit />
    <display x="180" y="480" />
    <onsuccess>ba4914f7-5d9a-4f01-b755-af65b6866ebc</onsuccess>
  </stage>
  <stage stageid="012a7ea9-9846-4d8e-96d5-e246589fbc37" name="Recover4" type="Recover">
    <loginhibit />
    <display x="180" y="30" />
    <onsuccess>a44586ad-c46a-4b1c-99bb-af364e019ddf</onsuccess>
  </stage>
  <stage stageid="90860b9c-34b0-45ef-83be-8dfd7c5715b7" name="Return to collection" type="Calculation">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="495" w="90" h="30" />
    <onsuccess>78f4b36b-932d-48a1-a766-21542da495eb</onsuccess>
    <calculation expression="[Schedule log collection default.items]" stage="Schedule log collection" />
  </stage>
  <stage stageid="6186bb50-8945-4aa0-b4fc-de88ce932c59" name="Return to collection" type="Calculation">
    <subsheetid>4f7eb729-03d7-4938-a32c-efb59ec6c938</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="780" w="90" h="30" />
    <onsuccess>b6755300-a1a4-4842-b2ac-62e9773b6ef0</onsuccess>
    <calculation expression="[Schedule log collection default.items]" stage="Schedule log collection" />
  </stage>
  <stage stageid="bdf21c01-753c-4747-83d6-9046161697c2" name="Schedule log collection default" type="Collection">
    <display x="-270" y="210" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
  </stage>
  <stage stageid="8dce6e69-e42c-49eb-8d51-83584d6b4532" name="Return to collection" type="Calculation">
    <subsheetid>71723e1c-d628-474b-9e41-403a82af0221</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="435" w="90" h="30" />
    <onsuccess>7c9e026e-40ef-49e5-8589-dbef91bf6b3b</onsuccess>
    <calculation expression="[Schedule log collection default.items]" stage="Schedule log collection" />
  </stage>
  <stage stageid="22dbc6b5-8a95-4edd-9b2a-a1f25679e36a" name="Return to collection" type="Calculation">
    <subsheetid>5d2a81f4-43a6-4e26-a8c1-a3fefbfce144</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="660" w="90" h="30" />
    <onsuccess>ab23173e-5d1c-41e8-babe-f6ab34387f66</onsuccess>
    <calculation expression="[Schedule log collection default.items]" stage="Schedule log collection" />
  </stage>
</process>