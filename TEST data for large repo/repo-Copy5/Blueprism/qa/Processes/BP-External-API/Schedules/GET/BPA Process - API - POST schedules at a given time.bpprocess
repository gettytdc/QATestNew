<process name="API - POST schedules at a given time" version="1.0" bpversion="7.0.0.39659" narrative="" byrefcollection="true" preferredid="f2e8943d-fa2c-47e8-bc29-42d1f86ba7f2">
  <view>
    <camerax>-195</camerax>
    <cameray>318</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="549645e8-f436-4eb0-910c-841591a7364c" type="Normal" published="False">
    <name>Setup</name>
    <view>
      <camerax>35</camerax>
      <cameray>1275</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="9a689181-9363-4732-a986-cdb892126e91" type="Normal" published="False">
    <name>Scenario 1</name>
    <view>
      <camerax>15</camerax>
      <cameray>210</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="854991c1-47a5-44cd-96ea-192dc6ce0c4b" type="Normal" published="False">
    <name>Scenario 2</name>
    <view>
      <camerax>-57</camerax>
      <cameray>132</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="fc092510-a3bd-4aae-a7be-d0c6edbcc9f1" type="Normal" published="False">
    <name>Scenario 3</name>
    <view>
      <camerax>27</camerax>
      <cameray>345</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="cc8ab573-3654-4f19-85b6-b6dbbc97a936" type="Normal" published="False">
    <name>Add to Clean Up Collection</name>
    <view>
      <camerax>0</camerax>
      <cameray>63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="2742fecc-ff29-478b-add0-f6821c2cd14e" type="Normal" published="False">
    <name>Cleanup</name>
    <view>
      <camerax>76</camerax>
      <cameray>78</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="50a7dec0-d501-47e7-b9a4-921ec5efd1ce" name="Start" type="Start">
    <display x="15" y="-105" />
    <onsuccess>1c73167f-1598-4282-a9af-41cd348e2b04</onsuccess>
  </stage>
  <stage stageid="31d659d2-2508-4696-bf60-65146099494e" name="Stage1" type="ProcessInfo">
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="a27021fd-e6f6-4a48-af15-b82b26a0e88d" name="Setup" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="-45" w="405" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="1c73167f-1598-4282-a9af-41cd348e2b04" name="Note1" type="Note">
    <narrative>GIVEN that 2 schedules will be created
AND 1 of the schedules will run to completion but will show part exception, the other will keep Running
AND Schedule 1 will have 2 tasks which will terminate and complete.
AND Schedule 2 will have 1 task which will keep running</narrative>
    <display x="15" y="0" w="360" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>37c7c15c-7680-4404-b52a-9e1b658fd02d</onsuccess>
  </stage>
  <stage stageid="15eb9e83-d0a9-470e-936e-0f4a26ce6412" name="Setup" type="SubSheetInfo">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="-150" y="-270" w="150" h="90" />
  </stage>
  <stage stageid="654613b2-7359-4503-b376-aab6f35e111a" name="Go to Control" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="255" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>b2beb794-96b5-475e-8910-38df8dc9b484</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="b2beb794-96b5-475e-8910-38df8dc9b484" name="Select Schedules" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="300" w="90" h="30" />
    <inputs>
      <input type="text" name="Control Item to Click" friendlyname="Control Item to Click" narrative="Control Item to click in left hand side control Tree" expr="&quot;Schedules&quot;" />
    </inputs>
    <onsuccess>c66076fc-a476-42c1-98a2-7f2c67515f44</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Click Item From Control's Left Tree (Select Item)" />
  </stage>
  <stage stageid="834e96d9-f987-4bcc-a884-d1cc16caa2c8" name="Add to CleanUp Collection" type="SubSheet">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="465" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Schedule 1&quot;" />
    </inputs>
    <onsuccess>c48b8b48-8aec-4bf1-978a-02dfd8e4c921</onsuccess>
    <processid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</processid>
  </stage>
  <stage stageid="d5ac975d-3061-48e9-be17-4b6943356ac8" name="Create Schedule" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="420" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name of the schedule to create" expr="[Schedule Name 1]" />
      <input type="date" name="Start Date" friendlyname="Start Date" narrative="The start date for the schedule" expr="Today()" />
      <input type="time" name="Start Time" friendlyname="Start Time" narrative="The start time for the schedule" expr="[Start Time]" />
      <input type="collection" name="Tasks" friendlyname="Tasks" narrative="The tasks to run" expr="[Task Sessions 1]" />
      <input type="text" name="Group To Expand" friendlyname="Group To Expand" narrative="Group contianing Process" expr="&quot;Default&quot;" />
      <input type="text" name="Resource Group To Expand" friendlyname="Resource Group To Expand" narrative="Group containing resources in schedule" expr="&quot;Default&quot;" />
    </inputs>
    <onsuccess>834e96d9-f987-4bcc-a884-d1cc16caa2c8</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Create Schedule" />
  </stage>
  <stage stageid="c66076fc-a476-42c1-98a2-7f2c67515f44" name="Make Time and Store" type="MultipleCalculation">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="345" w="90" h="30" />
    <onsuccess>d5ac975d-3061-48e9-be17-4b6943356ac8</onsuccess>
    <steps>
      <calculation expression="LocalTime()+MakeTimeSpan(0, 1, 0, 0)" stage="Start Time" />
      <calculation expression="AddDays(Today(),+1)" stage="End Point" />
      <calculation expression="Now()" stage="Start DateTime" />
      <calculation expression="Today()" stage="Start Point" />
    </steps>
  </stage>
  <stage stageid="d69bb0f7-01ad-45c2-990b-981f15487c7e" name="Create a schedule 1 &amp; Create Task A" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="390" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="1b738070-b247-4437-93b9-c424f6d462d8" name="End3" type="End">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="1425" />
  </stage>
  <stage stageid="04d2f61c-50cf-4429-a2e6-581eabce62f7" name="GET schedule 1" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="1230" w="90" h="30" />
    <inputs>
      <input type="text" name="Retirement Status" friendlyname="Retirement Status" narrative="Active or Retired" expr="&quot;Active&quot;" />
      <input type="text" name="Name starts with" friendlyname="Name starts with" narrative="Schedule Name" expr="[Schedule Name 1]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 1" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 1" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>5b300779-fed5-4a59-926c-14b1223d46dc</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules" />
  </stage>
  <stage stageid="5b300779-fed5-4a59-926c-14b1223d46dc" name="Convert Response to Result Collection" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="1275" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content 1]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection 1" />
    </outputs>
    <onsuccess>fd664fd7-b8cb-4da4-9160-463d3e5ffe81</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="2dbe93c4-9f5b-4388-91eb-026a49f16d0b" name="Store Schedule IDs" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="1200" w="150" h="195" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="8a9b73b6-be78-4f9a-9591-2486012f7bab" name="Attach Control" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>cdf8a920-10c6-486e-b986-7693048cd5ee</onsuccess>
    <resource object="Blue Prism - Control Room (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="7826dfe4-a0fa-4e99-8322-23a911e07a13" name="Port" type="Data">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="-150" y="-180" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>4231</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="27314ff8-07d6-479b-ad9f-c3058ed530bc" name="pid" type="Data">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="-150" y="-150" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a8578ab6-0fac-43bf-a3b7-03c9f86fe168" name="Local variable" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-210" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="37c7c15c-7680-4404-b52a-9e1b658fd02d" name="Setup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="60" w="120" h="30" />
    <onsuccess>c6986597-a18d-4255-899d-6ff72bdf1800</onsuccess>
    <processid>549645e8-f436-4eb0-910c-841591a7364c</processid>
  </stage>
  <stage stageid="745943aa-8abb-4718-87ab-4dc9f0728b07" name="Global Variables" type="Block">
    <display x="-345" y="-45" w="150" h="210" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="7b7c11bd-36bb-4b14-a234-953928b01125" name="Start Time" type="Data">
    <display x="-270" y="-15" w="120" h="30" />
    <datatype>time</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="068ae528-ccc8-4e09-9bae-9737a23d6bbd" name="End Point" type="Data">
    <display x="-270" y="75" w="120" h="30" />
    <datatype>date</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="93026986-fbfe-489f-8cf8-7cf2605b920c" name="Start DateTime" type="Data">
    <display x="-270" y="15" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="ec2b96d5-4b21-4a3f-8169-f22cbf14d32d" name="Start Point" type="Data">
    <display x="-270" y="45" w="120" h="30" />
    <datatype>date</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="8479a19e-c6fd-4c10-aaf8-dff13275e7b7" name="Local Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-345" y="180" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5c6d5300-71e1-409e-b8ac-7f6dbae3a774" name="Failed?" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="210" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="93d14d60-5c82-4f77-bc29-0adb260f7fa2" name="Exception" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="240" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="389b3032-8d1e-4078-82c8-5d5d41c698f5" name="HTTP Status Code 1" type="Data">
    <display x="-435" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="22fe4211-343a-4e73-825c-a678880f47e2" name="Schedule Name 1" type="Data">
    <display x="-435" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Schedule BP-3113 1</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="ed2704a4-70cf-4e5a-928e-e6e678859aba" name="Task Sessions 1" type="Collection">
    <loginhibit />
    <display x="-435" y="345" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Task Name" type="text" description="The name of the task to create" />
      <field name="On Success" type="text" description="The task to perform on successful completion of the task, leave blank for default (Stop)" />
      <field name="On Failure" type="text" description="The task to perform on failure of the task, leave blank for default (Abort)" />
      <field name="Sessions" type="collection" description="The sessions to create on the task">
        <field name="Process Group" type="text" description="The group within which the process can be found, leave empty for no group" />
        <field name="Process Name" type="text" description="The name of the process to create in the session" />
        <field name="Resource Name" type="text" description="The name of the resource to run the process on" />
      </field>
      <field name="Fail Fast" type="flag" description="True to fail the task immediately on any errors; False to let other sessions run - Defaults to True" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Task Name" type="text" value="Task BP-3113 A" />
        <field name="On Success" type="text" value="Stop" />
        <field name="On Failure" type="text" value="Abort" />
        <field name="Sessions" type="collection">
          <row>
            <field name="Process Group" type="text" value="Default" />
            <field name="Process Name" type="text" value="Sub Process BP-3113 Exceptioned" />
            <field name="Resource Name" type="text" value="" />
          </row>
        </field>
        <field name="Fail Fast" type="flag" value="True" />
      </row>
    </initialvalue>
    <noalwaysinit />
  </stage>
  <stage stageid="df5cf65b-50f8-429b-aa20-b05d1c05d0dd" name="Task A" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-510" y="285" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="2bb12a38-0a4f-4ee4-9c85-3b9297663945" name="Task A Status" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-435" y="315" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Terminated</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="6db5d0e6-a0b1-4e2e-8a49-ccb233266af8" name="Task B Status" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-435" y="420" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Completed</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="fe841fd4-20cb-4127-af1a-b0b26dfcef38" name="Task B" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-510" y="390" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c9d5987e-6c1d-40b8-b934-7bdc2672f2fd" name="Task C" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-510" y="495" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="f98baa15-bf2f-40b9-8124-a3ce38b09745" name="Task C Status" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-435" y="525" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Running</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="2b7ee53b-7287-41dc-b2bb-eb21dd737d11" name="Add to Clean Up Collection" type="SubSheetInfo">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="8f101416-c66f-4325-b1dc-d36b9ff5fe06" name="Start" type="Start">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="Item Name" narrative="The name of the item you want to clean up." stage="Item Name" />
    </inputs>
    <onsuccess>73d101b7-48ef-4642-9f91-1b6a60657637</onsuccess>
  </stage>
  <stage stageid="60a3cb81-f130-49db-bad6-25e0744e760f" name="End" type="End">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="15" y="30" />
  </stage>
  <stage stageid="370c1c55-f70d-4e84-9048-6135e9a17517" name="Item Name" type="Data">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="51197242-1eda-4809-af5a-973d527be350" name="Input Variables" type="Block">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="73d101b7-48ef-4642-9f91-1b6a60657637" name="Add Row" type="Action">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;CleanUp Collection&quot;" />
    </inputs>
    <onsuccess>571774d1-079e-4a03-91e6-a103c9621195</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="2800e13f-354d-427f-b9f8-abd549680756" name="CleanUp Collection" type="Collection">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="-195" y="60" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Item Name" type="text" description="The name of the item that needs cleaning up." />
    </collectioninfo>
    <noalwaysinit />
  </stage>
  <stage stageid="d3ec6f85-8c4b-4c97-84d9-30134dcfdebb" name="Local Variables" type="Block">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="-270" y="30" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="571774d1-079e-4a03-91e6-a103c9621195" name="Add To Row" type="Calculation">
    <subsheetid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <onsuccess>60a3cb81-f130-49db-bad6-25e0744e760f</onsuccess>
    <calculation expression="[Item Name]" stage="CleanUp Collection.Item Name" />
  </stage>
  <stage stageid="5fdb2368-54cb-4d38-acea-989d61288d4f" name="Cleanup" type="SubSheetInfo">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="9976868b-946f-4676-a599-0302585f46c6" name="Start" type="Start">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>bdd82931-393e-4406-855f-492020e55c3f</onsuccess>
  </stage>
  <stage stageid="a3987424-350c-4188-a1ab-7f1925d2a751" name="Terminate" type="Action">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="210" y="150" w="90" h="30" />
    <onsuccess>98115050-8de5-4b62-b3b3-aef47c574478</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="9177abb5-1fa2-4d4e-9c8a-2589aac59108" name="To Clean" type="LoopStart">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <onsuccess>2216a102-eecf-4cc0-9396-89585f8207d7</onsuccess>
    <groupid>2d1d4698-796c-44bf-baca-c6a0ea512e8b</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Reversed CleanUp</loopdata>
  </stage>
  <stage stageid="e5d0b38b-ab5b-466e-8115-361ef1a4394b" name="To Clean" type="LoopEnd">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="15" y="225" w="90" h="30" />
    <onsuccess>c5a19914-27eb-4d58-8bad-3ff3824a1430</onsuccess>
    <groupid>2d1d4698-796c-44bf-baca-c6a0ea512e8b</groupid>
  </stage>
  <stage stageid="2216a102-eecf-4cc0-9396-89585f8207d7" name="Which Clean Up" type="ChoiceStart">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="15" y="30" w="90" h="30" />
    <groupid>d536328f-064c-496c-b618-929de9b6cdf2</groupid>
    <choices>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Resource 4231&quot;">
        <name>Resource 4231</name>
        <distance>30</distance>
        <ontrue>00a26c6e-81f5-4603-8de8-75c9861c9c87</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Schedule 1&quot;">
        <name>Schedule 1</name>
        <distance>60</distance>
        <ontrue>5fc1af96-1377-4cb8-ae15-b148548a9b21</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Schedule 2&quot;">
        <name>Schedule 2</name>
        <distance>90</distance>
        <ontrue>d9270095-4e27-46b0-8068-f35c5f99b05f</ontrue>
      </choice>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Blue Prism&quot;">
        <name>Blue Prism</name>
        <distance>120</distance>
        <ontrue>a3987424-350c-4188-a1ab-7f1925d2a751</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="a59aff4c-71b5-42f1-9d92-b6a569eb1190" name="Otherwise" type="ChoiceEnd">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="15" y="180" w="90" h="30" />
    <onsuccess>c81015ab-0f2b-46f5-b998-83a26fc9e824</onsuccess>
    <groupid>d536328f-064c-496c-b618-929de9b6cdf2</groupid>
  </stage>
  <stage stageid="c81015ab-0f2b-46f5-b998-83a26fc9e824" name="FAIL" type="Exception">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="90" y="180" w="30" h="30" />
    <exception type="" detail="&quot;You have entered a clean up item the choice doesn't recognise.&quot;" />
  </stage>
  <stage stageid="00a26c6e-81f5-4603-8de8-75c9861c9c87" name="Stop Resource" type="Action">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="330" y="60" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number whose resource should be stopped" expr="4231" />
    </inputs>
    <onsuccess>cfa2d65c-1dba-4cc1-a09e-39d97a65515b</onsuccess>
    <resource object="Resource Manager" action="Stop Resource" />
  </stage>
  <stage stageid="5ce09733-9349-4100-82b1-af67654f5c23" name="Anchor9" type="Anchor">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="405" y="225" w="10" h="10" />
    <onsuccess>e5d0b38b-ab5b-466e-8115-361ef1a4394b</onsuccess>
  </stage>
  <stage stageid="bdd82931-393e-4406-855f-492020e55c3f" name="Reverse Collection" type="Action">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" narrative="The collection to be reversed." expr="[CleanUp Collection]" />
    </inputs>
    <outputs>
      <output type="collection" name="Reversed Collection" narrative="The reversed collection." stage="Reversed CleanUp" />
    </outputs>
    <onsuccess>9177abb5-1fa2-4d4e-9c8a-2589aac59108</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Reverse Collection" />
  </stage>
  <stage stageid="846051a6-4b62-4676-a0bd-6d2a90162363" name="Reversed CleanUp" type="Collection">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="38d1fcba-4a43-4bd3-b98a-aefa3a482228" name="Local Variables" type="Block">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="cfa2d65c-1dba-4cc1-a09e-39d97a65515b" name="Anchor1" type="Anchor">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="60" w="10" h="10" />
    <onsuccess>4fbc2a30-7836-4e3b-9eec-ce34b2446179</onsuccess>
  </stage>
  <stage stageid="e7940d48-4327-430a-a8f1-1333db1a6048" name="Delete Schedule" type="Action">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="330" y="90" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" narrative="The name of the schedule which will be run" expr="[Schedule Name 1]" />
    </inputs>
    <onsuccess>4fbc2a30-7836-4e3b-9eec-ce34b2446179</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Delete Schedule" />
  </stage>
  <stage stageid="4fbc2a30-7836-4e3b-9eec-ce34b2446179" name="Anchor6" type="Anchor">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="90" w="10" h="10" />
    <onsuccess>26024c0e-c30d-4e2d-8657-5beaac9b74d3</onsuccess>
  </stage>
  <stage stageid="c5a19914-27eb-4d58-8bad-3ff3824a1430" name="End1" type="End">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="270" />
  </stage>
  <stage stageid="5fc1af96-1377-4cb8-ae15-b148548a9b21" name="Open Control Tab" type="Action">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="210" y="90" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>e7940d48-4327-430a-a8f1-1333db1a6048</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="98115050-8de5-4b62-b3b3-aef47c574478" name="Anchor3" type="Anchor">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="150" w="10" h="10" />
    <onsuccess>5ce09733-9349-4100-82b1-af67654f5c23</onsuccess>
  </stage>
  <stage stageid="c862de6e-71a0-4e21-9d26-7c3cf49aa858" name="Task Sessions 2" type="Collection">
    <loginhibit />
    <display x="-435" y="450" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Task Name" type="text" description="The name of the task to create" />
      <field name="On Success" type="text" description="The task to perform on successful completion of the task, leave blank for default (Stop)" />
      <field name="On Failure" type="text" description="The task to perform on failure of the task, leave blank for default (Abort)" />
      <field name="Sessions" type="collection" description="The sessions to create on the task">
        <field name="Process Group" type="text" description="The group within which the process can be found, leave empty for no group" />
        <field name="Process Name" type="text" description="The name of the process to create in the session" />
        <field name="Resource Name" type="text" description="The name of the resource to run the process on" />
      </field>
      <field name="Fail Fast" type="flag" description="True to fail the task immediately on any errors; False to let other sessions run - Defaults to True" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Task Name" type="text" value="Task BP-3113 B" />
        <field name="On Success" type="text" value="Task BP-3113 A" />
        <field name="On Failure" type="text" value="Abort" />
        <field name="Sessions" type="collection">
          <row>
            <field name="Process Group" type="text" value="Default" />
            <field name="Process Name" type="text" value="Sub Process BP-3113 Completed" />
            <field name="Resource Name" type="text" value="" />
          </row>
        </field>
        <field name="Fail Fast" type="flag" value="False" />
      </row>
    </initialvalue>
    <noalwaysinit />
  </stage>
  <stage stageid="1514ae3e-c4c8-4215-bf2e-a4b8c2cbf3a6" name="Task Sessions 3" type="Collection">
    <loginhibit />
    <display x="-435" y="555" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Task Name" type="text" description="The name of the task to create" />
      <field name="On Success" type="text" description="The task to perform on successful completion of the task, leave blank for default (Stop)" />
      <field name="On Failure" type="text" description="The task to perform on failure of the task, leave blank for default (Abort)" />
      <field name="Sessions" type="collection" description="The sessions to create on the task">
        <field name="Process Group" type="text" description="The group within which the process can be found, leave empty for no group" />
        <field name="Process Name" type="text" description="The name of the process to create in the session" />
        <field name="Resource Name" type="text" description="The name of the resource to run the process on" />
      </field>
      <field name="Fail Fast" type="flag" description="True to fail the task immediately on any errors; False to let other sessions run - Defaults to True" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Task Name" type="text" value="Task BP-3113 C" />
        <field name="On Success" type="text" value="Stop" />
        <field name="On Failure" type="text" value="Abort" />
        <field name="Sessions" type="collection">
          <row>
            <field name="Process Group" type="text" value="Default" />
            <field name="Process Name" type="text" value="Sub Process BP-3113 Running" />
            <field name="Resource Name" type="text" value="" />
          </row>
        </field>
        <field name="Fail Fast" type="flag" value="True" />
      </row>
    </initialvalue>
    <noalwaysinit />
  </stage>
  <stage stageid="5c55392e-379d-43e5-a338-1dbd6c85e842" name="Create Task B for Schedule 1" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="510" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="646dd884-c025-4a18-8399-dd7c33e29a86" name="Set Sessions for Task B" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="705" w="90" h="30" />
    <inputs>
      <input type="collection" name="Task(s)" friendlyname="Task(s)" narrative="Use the collection scheme provided." expr="[Task Sessions B]" />
    </inputs>
    <onsuccess>29ae5a23-7de1-4889-8d78-8e9b07dd1bef</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Set Task - Session(s)" />
  </stage>
  <stage stageid="c5c18f2d-2478-46d3-a931-055ff9a5bfca" name="Set Tasks B Config" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="660" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name you want to call the schedule." expr="[Task Sessions 2.Task Name]" />
      <input type="text" name="Description" friendlyname="Description" narrative="The description you want to give the schedule." expr="" />
      <input type="text" name="On complete" friendlyname="On complete" narrative="What do you want to do when this task completes?" expr="[Task Sessions 2.On Success]" />
      <input type="text" name="On Exception" friendlyname="On Exception" narrative="What do you want to do when this task throws an exception?" expr="[Task Sessions 2.On Failure]" />
      <input type="number" name="Post Completion Delay" friendlyname="Post Completion Delay" narrative="0 as default, do you want a delay between this task completing and the next starting." expr="" />
      <input type="flag" name="Fail Fast?" friendlyname="Fail Fast?" narrative="True as default. True or False do you want to fail fast enabled." expr="[Task Sessions 2.Fail Fast]" />
    </inputs>
    <onsuccess>646dd884-c025-4a18-8399-dd7c33e29a86</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Set Task - Basic Config" />
  </stage>
  <stage stageid="c48b8b48-8aec-4bf1-978a-02dfd8e4c921" name="Press New Task" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="540" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" narrative="The name of the schedule you want to select." expr="[Schedule Name 1]" />
    </inputs>
    <onsuccess>db588ede-928e-4ee0-aec6-050c84c31271</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Press New Task" />
  </stage>
  <stage stageid="db588ede-928e-4ee0-aec6-050c84c31271" name="Select Task B" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="615" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" narrative="The name of the schedule your task is under." expr="[Schedule Name 1]" />
      <input type="text" name="Task Name" friendlyname="Task Name" narrative="The name of the task you want to select." expr="&quot;Schedule BP-3113 1 - New Task&quot;" />
    </inputs>
    <onsuccess>c5c18f2d-2478-46d3-a931-055ff9a5bfca</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Select Task (Name)" />
  </stage>
  <stage stageid="c4c3b5e5-280f-45b1-a24b-63c6218be980" name="Set Task B Config" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="585" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="861d913c-0434-4b0f-b151-0035eaa921bb" name="Task Sessions B" type="Collection">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="-150" y="-120" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Resource" type="text" description="The resource you want to create the session on." />
      <field name="Process" type="text" description="The process you want to create a session with." />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Resource" type="text" value="" />
        <field name="Process" type="text" value="Sub Process BP-3113 Completed" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="45814eae-2d55-4257-94c6-bf65154d9bd8" name="Set Schedule - Initial Task" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="945" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name you want to call the schedule." expr="[Schedule Name 1]" />
      <input type="text" name="Description" friendlyname="Description" narrative="The description you want to give the schedule." expr="" />
      <input type="text" name="Initial Task" friendlyname="Initial Task" narrative="The initial task you want to run on the schedule." expr="[Task Sessions 2.Task Name]" />
    </inputs>
    <onsuccess>e2cd7ca3-9aaa-4a5c-8cd7-356c08731fd8</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Set Schedule - Basic Config" />
  </stage>
  <stage stageid="abc3ad07-ce1f-4e88-89a4-71edf88b1669" name="Select Schedule" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="900" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" narrative="The name of the schedule you want to select." expr="&quot;* Schedule BP-3113 1&quot;" />
    </inputs>
    <onsuccess>45814eae-2d55-4257-94c6-bf65154d9bd8</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Select Schedule" />
  </stage>
  <stage stageid="687de17e-a1de-4368-abf6-c81f9e8df06c" name="Update initial task" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="870" w="150" h="195" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c6986597-a18d-4255-899d-6ff72bdf1800" name="Note1" type="Note">
    <narrative>WHEN "POST schedules to run at a given time" API call is requested 
THEN HTTP Status Code will output 200 or 202 to indicate all is well
AND the Response Content returned will output a DateTime for scheduledTime
</narrative>
    <display x="15" y="150" w="360" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>a6b74d3d-ec43-4eda-975c-d674ccc2f708</onsuccess>
  </stage>
  <stage stageid="1e6bb2c9-c29f-4791-8164-3c58e45fdc5a" name="Scenario 1" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="105" w="405" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="8dce6d13-aeec-4167-b6dc-e7f37480b455" name="Scenario 2" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="255" w="405" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ed6bcd04-5a84-4b1f-92fd-6758f3beac26" name="Note 4" type="Note">
    <narrative>AND once the POST request was made the status will change to "Running"
AND once run to completion the status will change to "PartException" if there were processes that failed but some have passed.
</narrative>
    <display x="15" y="300" w="360" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>4578b4ec-4b29-42ae-b2ae-250f90eaf838</onsuccess>
  </stage>
  <stage stageid="fbd747a8-fbc5-4e02-821d-be1b3036325a" name="Scenario 3" type="SubSheetInfo">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="-135" y="-120" w="150" h="90" />
  </stage>
  <stage stageid="6e8e7dcd-f6e9-44be-b9a5-880a658b15fa" name="Start" type="Start">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="-150" />
    <onsuccess>3e1ab9f5-c432-483f-a5df-b3f392b8fe13</onsuccess>
  </stage>
  <stage stageid="2189c072-d1a2-4779-a472-7c69f04626a7" name="End" type="End">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="540" />
  </stage>
  <stage stageid="c5cf748d-a61f-4c41-84fb-eeeb68cc8c6b" name="Get Sessions" type="Action">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <outputs>
      <output type="collection" name="Sessions" narrative="A list of the sessions that are in the list." stage="Ran Sessions" />
    </outputs>
    <onsuccess>9ccc5ed8-4c49-4917-bbfc-00a74089db54</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Get Sessions" />
  </stage>
  <stage stageid="3e1ab9f5-c432-483f-a5df-b3f392b8fe13" name="Select Session Management" type="Action">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="-105" w="90" h="30" />
    <inputs>
      <input type="text" name="Control Item to Click" narrative="Control Item to click in left hand side control Tree" expr="&quot;Session Management&quot;" />
    </inputs>
    <onsuccess>61f53853-de65-413a-9fe9-7f0e3880119a</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Click Item from Control's Left Tree" />
  </stage>
  <stage stageid="61f53853-de65-413a-9fe9-7f0e3880119a" name="Set Last 15 Minutes" type="Action">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="text" name="Session Start Time" narrative="Allowed value can be one of the following: All, Last 15 Minutes, Last 30 Minutes, Last 1 Hour, Last 2 Hours, Last 4 Hours, Last 8 Hours, Last 12 Hours, Last 18 Hours, Last 24 Hours, Today, Last 3 Days, Last 7 Days, Last 31 Days" expr="&quot;Last 15 Minutes&quot;" />
    </inputs>
    <onsuccess>c5cf748d-a61f-4c41-84fb-eeeb68cc8c6b</onsuccess>
    <resource object="Blue Prism - Control - Session Management" action="Change Session Start Time" />
  </stage>
  <stage stageid="797eac9f-d098-4668-92f6-a056c5099d5a" name="Local Variables" type="Block">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="-210" y="-60" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ef1c1faf-96b1-4cdf-ab5c-0126febaff24" name="Found Session Running?" type="Decision">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="120" y="165" w="90" h="30" />
    <decision expression="[Ran Sessions.Process]=[Task Sessions 3.Sessions.Process Name]&#xA;AND &#xA;[Ran Sessions.Resource]=[Task Sessions 3.Sessions.Resource Name]&#xA;AND &#xA;[Ran Sessions.User]=&quot;[Scheduler]&quot; &#xA;AND &#xA;[Ran Sessions.Status]=[Task C Status]&#xA;AND&#xA;[Ran Sessions.Start Time]&gt;=[Start DateTime]&#xA;AND&#xA;[Ran Sessions.Start Time]&lt;=[endTime]" />
    <ontrue>420f99db-37da-4a98-8699-2ae50a589218</ontrue>
    <onfalse>4b91331a-724b-4c18-926a-8e7740482088</onfalse>
  </stage>
  <stage stageid="420f99db-37da-4a98-8699-2ae50a589218" name="Anchor16" type="Anchor">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="180" y="165" w="10" h="10" />
    <onsuccess>b7234c66-afdb-4d6a-abc9-01db513ce609</onsuccess>
  </stage>
  <stage stageid="b7234c66-afdb-4d6a-abc9-01db513ce609" name="Anchor18" type="Anchor">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="180" y="255" w="10" h="10" />
    <onsuccess>c3be06c1-46a7-4398-b5c0-7f7bf949190b</onsuccess>
  </stage>
  <stage stageid="9ccc5ed8-4c49-4917-bbfc-00a74089db54" name="Ran Sessions" type="LoopStart">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="90" h="30" />
    <onsuccess>fcf44f78-9e9d-4ec2-8c8b-3502676a6b65</onsuccess>
    <groupid>47f48f37-1aab-4bc6-a057-a12dec5a8291</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Ran Sessions</loopdata>
  </stage>
  <stage stageid="ddb86116-450d-4ded-8c1b-e7cb20e2190e" name="Ran Sessions" type="LoopEnd">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="495" w="90" h="30" />
    <onsuccess>2189c072-d1a2-4779-a472-7c69f04626a7</onsuccess>
    <groupid>47f48f37-1aab-4bc6-a057-a12dec5a8291</groupid>
  </stage>
  <stage stageid="c3be06c1-46a7-4398-b5c0-7f7bf949190b" name="Anchor1" type="Anchor">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="345" w="10" h="10" />
    <onsuccess>5c93bc7c-9039-4a1a-802a-292e783ed87a</onsuccess>
  </stage>
  <stage stageid="0f665d27-07be-4b29-a7f9-19c2adf79095" name="Anchor2" type="Anchor">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="465" w="10" h="10" />
    <onsuccess>2fa69d7a-e07f-46a2-8c53-04793c2629b8</onsuccess>
  </stage>
  <stage stageid="315dedd8-2fb3-4d1c-90c6-dc729d03b6ce" name="Schedule Name 2" type="Data">
    <display x="-435" y="150" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Schedule BP-3113 2</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="fa9ea2fe-d78e-4967-b3d5-44f16a2c39ce" name="Delete Schedule" type="Action">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="330" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" narrative="The name of the schedule which will be run" expr="[Schedule Name 2]" />
    </inputs>
    <onsuccess>26024c0e-c30d-4e2d-8657-5beaac9b74d3</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Delete Schedule" />
  </stage>
  <stage stageid="d9270095-4e27-46b0-8068-f35c5f99b05f" name="Open Control Tab" type="Action">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <display x="210" y="120" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>fa9ea2fe-d78e-4967-b3d5-44f16a2c39ce</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="26024c0e-c30d-4e2d-8657-5beaac9b74d3" name="Anchor5" type="Anchor">
    <subsheetid>2742fecc-ff29-478b-add0-f6821c2cd14e</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="120" w="10" h="10" />
    <onsuccess>98115050-8de5-4b62-b3b3-aef47c574478</onsuccess>
  </stage>
  <stage stageid="11c944e3-0cda-498a-beca-ff56a7b0abdd" name="Set Task A Config" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="750" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="481d2a26-27f4-4af9-ada4-cd1836c0104c" name="Set Tasks A Config" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="825" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name you want to call the schedule." expr="[Task Sessions 1.Task Name]" />
      <input type="text" name="Description" friendlyname="Description" narrative="The description you want to give the schedule." expr="" />
      <input type="text" name="On complete" friendlyname="On complete" narrative="What do you want to do when this task completes?" expr="[Task Sessions 1.On Success]" />
      <input type="text" name="On Exception" friendlyname="On Exception" narrative="What do you want to do when this task throws an exception?" expr="[Task Sessions 1.On Failure]" />
      <input type="number" name="Post Completion Delay" friendlyname="Post Completion Delay" narrative="0 as default, do you want a delay between this task completing and the next starting." expr="" />
      <input type="flag" name="Fail Fast?" friendlyname="Fail Fast?" narrative="True as default. True or False do you want to fail fast enabled." expr="[Task Sessions 1.Fail Fast]" />
    </inputs>
    <onsuccess>abc3ad07-ce1f-4e88-89a4-71edf88b1669</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Set Task - Basic Config" />
  </stage>
  <stage stageid="29ae5a23-7de1-4889-8d78-8e9b07dd1bef" name="Select Task A" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="780" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" narrative="The name of the schedule your task is under." expr="&quot;* Schedule BP-3113 1&quot;" />
      <input type="text" name="Task Name" friendlyname="Task Name" narrative="The name of the task you want to select." expr="[Task Sessions 1.Task Name]" />
    </inputs>
    <onsuccess>481d2a26-27f4-4af9-ada4-cd1836c0104c</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Select Task (Name)" />
  </stage>
  <stage stageid="06ae38c5-d79c-4e3c-86d8-e097e4f8ecf1" name="Create a Schedule 2 and Task C" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="1080" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="aee52afc-8c8e-4124-8677-d9d964130664" name="Create Schedule" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="1110" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name of the schedule to create" expr="[Schedule Name 2]" />
      <input type="date" name="Start Date" friendlyname="Start Date" narrative="The start date for the schedule" expr="Today()" />
      <input type="time" name="Start Time" friendlyname="Start Time" narrative="The start time for the schedule" expr="[Start Time]" />
      <input type="collection" name="Tasks" friendlyname="Tasks" narrative="The tasks to run" expr="[Task Sessions 3]" />
      <input type="text" name="Group To Expand" friendlyname="Group To Expand" narrative="Group contianing Process" expr="&quot;Default&quot;" />
      <input type="text" name="Resource Group To Expand" friendlyname="Resource Group To Expand" narrative="Group containing resources in schedule" expr="&quot;Default&quot;" />
    </inputs>
    <onsuccess>336dd4a3-306d-4a0e-bddd-4e10f06c9025</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Create Schedule" />
  </stage>
  <stage stageid="303f0c2f-9017-4ecd-a780-c005f16ced07" name="Schedule 1 - Part Exceptioned" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-510" y="-45" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="cc8594a5-ed25-4fa1-82a0-a70cc78df0ca" name="Response Content 2" type="Data">
    <display x="-435" y="210" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="4da1c4c1-b550-4827-946e-aa6efa5a8356" name="HTTP Status Code 2" type="Data">
    <display x="-435" y="180" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="284ff586-3332-4817-b4a2-738bf1eaae16" name="Result Collection 2" type="Collection">
    <display x="-435" y="240" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="pagingToken" type="text" />
      <field name="items" type="collection">
        <field name="JSON:Array" type="collection">
          <field name="id" type="number" />
          <field name="name" type="text" />
          <field name="description" type="text" />
          <field name="isRetired" type="flag" />
          <field name="tasksCount" type="number" />
          <field name="intervalType" type="text" />
          <field name="timePeriod" type="number" />
          <field name="startPoint" type="datetime" />
          <field name="endPoint" type="datetime" />
          <field name="dayOfWeek" type="text" />
          <field name="dayOfMonth" type="text" />
          <field name="startDate" type="datetime" />
          <field name="endDate" type="datetime" />
          <field name="calendarId" type="text" />
          <field name="calendarName" type="text" />
        </field>
      </field>
    </collectioninfo>
  </stage>
  <stage stageid="2093d4c2-a249-4a7d-967a-fb2c54f6a636" name="Schedule 2 - Running" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-510" y="120" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="fd664fd7-b8cb-4da4-9160-463d3e5ffe81" name="GET schedule 2" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="1320" w="90" h="30" />
    <inputs>
      <input type="text" name="Retirement Status" friendlyname="Retirement Status" narrative="Active or Retired" expr="&quot;Active&quot;" />
      <input type="text" name="Name starts with" friendlyname="Name starts with" narrative="Schedule Name" expr="[Schedule Name 2]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 2" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 2" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>1fc7c230-815c-4977-937b-b728fba8047b</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules" />
  </stage>
  <stage stageid="1fc7c230-815c-4977-937b-b728fba8047b" name="Convert Response to Result Collection" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="1365" w="90" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content 2]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection 2" />
    </outputs>
    <onsuccess>1b738070-b247-4437-93b9-c424f6d462d8</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="fbe44a5b-a458-475c-882d-a17e5257a6ec" name="Scenario 1" type="SubSheetInfo">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="edb25048-e3b6-422a-9131-f1a642401b11" name="Start" type="Start">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="15" y="-105" />
    <onsuccess>521941f1-a2f9-4f5d-b509-69e1b8bdbed9</onsuccess>
  </stage>
  <stage stageid="521941f1-a2f9-4f5d-b509-69e1b8bdbed9" name="Schedule 1: POST schedules to run at a given time" type="Action">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection 1.items.JSON:Array.id]" />
      <input type="datetime" name="Start Time" friendlyname="Start Time" narrative="produces scheduled time" expr="Now()" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 1" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 1" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="datetime" name="scheduledTime" friendlyname="scheduledTime" stage="scheduledTime 1" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>392096e7-1c53-46e3-a30c-f6736f616fda</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="POST schedules to run at a given time" />
  </stage>
  <stage stageid="deabd92c-14c3-4678-bcd8-48373b2f9e1c" name="Store end time" type="Calculation">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="210" w="120" h="30" />
    <onsuccess>2ed7d904-d005-4df0-ad0e-b47de127a8b6</onsuccess>
    <calculation expression="Now()" stage="endTime" />
  </stage>
  <stage stageid="5ded7b77-589d-4dc6-ab57-e96eec5551b0" name="Pause 20s" type="Action">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="165" w="120" h="30" />
    <inputs>
      <input type="number" name="Duration (Seconds)" friendlyname="Duration (Seconds)" expr="20" />
    </inputs>
    <onsuccess>deabd92c-14c3-4678-bcd8-48373b2f9e1c</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Pause" />
  </stage>
  <stage stageid="13af4d5d-498f-41e2-98e1-9e7842bb61b2" name="Check HTTP Status Code for Schedule 1" type="Decision">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="15" y="75" w="120" h="30" />
    <decision expression="[HTTP Status Code 1]=&quot;200&quot; OR&#xA;[HTTP Status Code 1]=&quot;202&quot;" />
    <ontrue>a1925f64-1fc9-4168-80dc-d5457a35cab2</ontrue>
    <onfalse>771ddc29-9c74-4148-9759-74cc8510e471</onfalse>
  </stage>
  <stage stageid="771ddc29-9c74-4148-9759-74cc8510e471" name="Bad Response Code" type="Exception">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="120" y="75" />
    <exception localized="yes" type="Unexpected Response" detail="&quot;Scenario 1 failed for Schedule 1, expected response code to be 200/202 but actual is &quot; &amp;[HTTP Status Code 1]" />
  </stage>
  <stage stageid="bb0f92ae-ac3d-4bd5-a984-92cdc94a71b9" name="scheduledTime is returned and correct for Schedule 1?" type="Decision">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="15" y="300" w="120" h="30" />
    <decision expression="[scheduledTime 1]&lt;&gt;&quot;&quot;&#xA;AND&#xA;[scheduledTime 1]&gt;[Start DateTime] &#xA;AND&#xA;[scheduledTime 1]&lt;[endTime]" />
    <ontrue>e665abd3-715c-44a2-89f0-28e24ddb5df0</ontrue>
    <onfalse>46c9676b-9586-47af-bb9f-7e9fa1bfd589</onfalse>
  </stage>
  <stage stageid="46c9676b-9586-47af-bb9f-7e9fa1bfd589" name="scheduledTime is not returned" type="Exception">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="120" y="300" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Check Scenario 1, Schedule 1: Expected scheduledTime to be returned but this is not the case&quot;" />
  </stage>
  <stage stageid="2e45b491-f36a-4b4c-a8f3-193d19678525" name="Schedule 2: POST schedules to run at a given time" type="Action">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection 2.items.JSON:Array.id]" />
      <input type="datetime" name="Start Time" friendlyname="Start Time" narrative="produces scheduled time" expr="Now()" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 2" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 2" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="datetime" name="scheduledTime" friendlyname="scheduledTime" stage="scheduledTime 2" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>13af4d5d-498f-41e2-98e1-9e7842bb61b2</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="POST schedules to run at a given time" />
  </stage>
  <stage stageid="a1925f64-1fc9-4168-80dc-d5457a35cab2" name="Check HTTP Status Code for Schedule 2" type="Decision">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="15" y="120" w="120" h="30" />
    <decision expression="[HTTP Status Code 2]=&quot;200&quot; OR&#xA;[HTTP Status Code 2]=&quot;202&quot;" />
    <ontrue>5ded7b77-589d-4dc6-ab57-e96eec5551b0</ontrue>
    <onfalse>a36be6a5-b3bd-4231-b5ee-2255a11cc176</onfalse>
  </stage>
  <stage stageid="a36be6a5-b3bd-4231-b5ee-2255a11cc176" name="Bad Response Code" type="Exception">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="120" y="120" />
    <exception localized="yes" type="Unexpected Response" detail="&quot;Scenario 1 failed for Schedule 2, expected response code to be 200/202 but actual is &quot; &amp;[HTTP Status Code 2]" />
  </stage>
  <stage stageid="a6b74d3d-ec43-4eda-975c-d674ccc2f708" name="Scenario 1" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="210" w="120" h="30" />
    <onsuccess>ed6bcd04-5a84-4b1f-92fd-6758f3beac26</onsuccess>
    <processid>9a689181-9363-4732-a986-cdb892126e91</processid>
  </stage>
  <stage stageid="5fd87701-b5b9-451a-ae0e-9092a263fef7" name="Scenario 2" type="SubSheetInfo">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="3c0509d8-f550-466a-9a9d-74af132d7bfb" name="Start" type="Start">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="15" y="-150" />
    <onsuccess>61687dc1-7afe-4445-a4cc-d39ce671d1e5</onsuccess>
  </stage>
  <stage stageid="33f5f4ee-60f4-43b5-8f66-8cad36b1e64d" name="End" type="End">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="15" y="375" />
  </stage>
  <stage stageid="57c2b181-22b6-43c8-b394-9b3ebb462aba" name="GET schedules log" type="Action">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection 2.items.JSON:Array.id]" />
      <input type="number" name="Items per page" friendlyname="Items per page" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 2" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 2" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>9c8bec8a-82ad-455d-8f11-84f2dc9d931d</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules log" />
  </stage>
  <stage stageid="9c8bec8a-82ad-455d-8f11-84f2dc9d931d" name="Convert Response to Schedule log collection" type="Action">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content 2]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Schedule log 2 default" />
    </outputs>
    <onsuccess>62b2a4cd-b4c7-459e-b0a3-789ed2ff1e9a</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="739dadca-54c0-4fdd-ad4e-09c92cf7f186" name="Check status, startTime, ID and HTTP status code" type="Decision">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="15" y="75" w="120" h="30" />
    <decision expression="IsNumber([Schedule log 2.JSON:Array.scheduleLogId])&#xA;AND&#xA;[Schedule log 2.JSON:Array.status]=&quot;Running&quot;&#xA;AND&#xA;[Schedule log 2.JSON:Array.startTime]&gt;=[Start DateTime]&#xA;AND&#xA;[HTTP Status Code 2]=&quot;200&quot;&#xA;OR&#xA;[HTTP Status Code 2]=&quot;202&quot;" />
    <ontrue>179b51ce-e0c0-4193-9b30-af050dde1c25</ontrue>
    <onfalse>98be9cca-2195-4df8-8218-f2203c0eaf79</onfalse>
  </stage>
  <stage stageid="98be9cca-2195-4df8-8218-f2203c0eaf79" name="FAIL" type="Exception">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="120" y="75" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Check scenario 2, Schedule 1 for Schedule Log values returned, check id, starTime, status and HTTP status code&quot;" />
  </stage>
  <stage stageid="4578b4ec-4b29-42ae-b2ae-250f90eaf838" name="Scenario 2" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="360" w="120" h="30" />
    <onsuccess>d138f72f-f124-482a-b0a2-ebb645cdda31</onsuccess>
    <processid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</processid>
  </stage>
  <stage stageid="d708e155-41ff-4d7e-bf2d-c4a7dade09c8" name="scheduledTime is returned and correct for Schedule 2?" type="Decision">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="15" y="390" w="120" h="30" />
    <decision expression="[scheduledTime 2]&lt;&gt;&quot;&quot;&#xA;AND&#xA;[scheduledTime 2]&gt;[Start DateTime] &#xA;AND&#xA;[scheduledTime 2]&lt;[endTime]" />
    <ontrue>ff96c708-3467-4845-b993-17fa59d413eb</ontrue>
    <onfalse>9e51d34d-30df-49bb-94ae-99ca87e1bc0a</onfalse>
  </stage>
  <stage stageid="9e51d34d-30df-49bb-94ae-99ca87e1bc0a" name="scheduledTime is not returned" type="Exception">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="120" y="390" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Check Scenario 1, Schedule 2: Expected scheduledTime to be returned but this is not the case&quot;" />
  </stage>
  <stage stageid="ff96c708-3467-4845-b993-17fa59d413eb" name="End2" type="End">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="435" />
  </stage>
  <stage stageid="69905dc1-8b70-4180-a7d6-07d4be62ba9b" name="Scenario 3" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="420" w="405" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ec7322d7-ec81-4a05-8a51-6a6aa9f3c2f1" name="Note 4" type="Note">
    <narrative>AND the schedule should follow the set order of tasks which the user configured in the thick client control room. This should be Task B (terminated) &gt; Task A (completed) for Schedule 1</narrative>
    <display x="15" y="450" w="360" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>0989ab26-6391-4030-be66-f1a7de34f259</onsuccess>
  </stage>
  <stage stageid="0989ab26-6391-4030-be66-f1a7de34f259" name="Scenario 3" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="510" w="120" h="30" />
    <onsuccess>94599cac-fe79-4e46-95eb-bb491bcb06d3</onsuccess>
    <processid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</processid>
  </stage>
  <stage stageid="61687dc1-7afe-4445-a4cc-d39ce671d1e5" name="Note2" type="Note">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <narrative>Once POST request is executed the status should change to running. Schedule 2 will show this.</narrative>
    <display x="15" y="-105" w="210" h="30" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>57c2b181-22b6-43c8-b394-9b3ebb462aba</onsuccess>
  </stage>
  <stage stageid="956a77c5-8a98-4fe2-b093-8b3f84b6355e" name="scheduledTime 2" type="Data">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="-195" y="75" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="10c3e3d2-7491-4ebe-a60e-58bdaf1272d4" name="scheduledTime 1" type="Data">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <display x="-195" y="0" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f12f7dfc-8489-4810-b0e5-abafa82e26a2" name="Schedule 1 Local variable" type="Block">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-30" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5d59c1ee-0f87-427c-b7ba-3fd6fde8b8c8" name="Schedule 2 Local variable" type="Block">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="80fb5989-8eaf-45a7-83b3-d25a051380f2" name="Schedule log 2" type="Collection">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="-195" y="105" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="JSON:Array" type="collection">
        <field name="scheduleLogId" type="number" />
        <field name="status" type="text" />
        <field name="startTime" type="datetime" />
        <field name="endTime" type="datetime" />
        <field name="serverName" type="text" />
        <field name="scheduleId" type="number" />
        <field name="scheduleName" type="text" />
      </field>
    </collectioninfo>
  </stage>
  <stage stageid="bd896919-b0ac-495b-8fa6-ea1926dd3653" name="Schedule 1 Local variable" type="Block">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="1f7f80b4-b38a-4eb2-a364-dab3119c05f0" name="Schedule 2 Local variable" type="Block">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="75" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="aed00749-ec17-4d8d-84fe-dcab4147e03e" name="Schedule log 1" type="Collection">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="-195" y="0" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="JSON:Array" type="collection">
        <field name="scheduleLogId" type="number" />
        <field name="status" type="text" />
        <field name="startTime" type="datetime" />
        <field name="endTime" type="datetime" />
        <field name="serverName" type="text" />
        <field name="scheduleId" type="number" />
        <field name="scheduleName" type="text" />
      </field>
    </collectioninfo>
  </stage>
  <stage stageid="4301ef7a-4ab4-46b6-9579-95c78b77ce96" name="Found Session Terminated?" type="Decision">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="120" y="255" w="90" h="30" />
    <decision expression="[Ran Sessions.Process]=[Task Sessions 1.Sessions.Process Name]&#xA;AND&#xA;[Ran Sessions.Resource]=[Task Sessions 1.Sessions.Resource Name]&#xA;AND &#xA;[Ran Sessions.User]=&quot;[Scheduler]&quot; &#xA;AND &#xA;[Ran Sessions.Status]=[Task A Status]&#xA;AND &#xA;[Ran Sessions.Start Time]&gt;=[Start DateTime]&#xA;AND&#xA;[Ran Sessions.Start Time]&lt;=[endTime]&#xA;AND&#xA;[Ran Sessions.Start Time]&gt;=[Start DateTime]" />
    <ontrue>b7234c66-afdb-4d6a-abc9-01db513ce609</ontrue>
    <onfalse>5c59638c-ab15-406d-b371-12f841a5142a</onfalse>
  </stage>
  <stage stageid="3b62eac7-a824-4588-8e68-d3142c0a234e" name="GET schedules log" type="Action">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="195" w="120" h="30" />
    <inputs>
      <input type="number" name="Schedule ID" friendlyname="Schedule ID" expr="[Result Collection 1.items.JSON:Array.id]" />
      <input type="number" name="Items per page" friendlyname="Items per page" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 1" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 1" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
    </outputs>
    <onsuccess>1cb883b8-88d9-40c6-87b0-53848fd834ec</onsuccess>
    <resource object="Blue Prism - API - Schedules" action="GET schedules log" />
  </stage>
  <stage stageid="1cb883b8-88d9-40c6-87b0-53848fd834ec" name="Convert Response to Schedule log collection" type="Action">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="240" w="120" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content 1]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Schedule log 1 default" />
    </outputs>
    <onsuccess>e242bd8c-236e-401f-9540-1efce2c78944</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="45190001-ecd1-47d9-af40-eec3bd1e918a" name="Check status,startTime, endTime, ID and HTTP status code" type="Decision">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="15" y="330" w="120" h="30" />
    <decision expression="IsNumber([Schedule log 1.JSON:Array.scheduleLogId])&#xA;AND&#xA;[Schedule log 1.JSON:Array.status]=&quot;PartExceptioned&quot;&#xA;AND&#xA;[Schedule log 1.JSON:Array.startTime]&gt;=[Start DateTime]&#xA;AND&#xA;[Schedule log 1.JSON:Array.endTime]&lt;=[endTime]&#xA;AND&#xA;[HTTP Status Code 2]=&quot;200&quot;&#xA;OR&#xA;[HTTP Status Code 2]=&quot;202&quot;" />
    <ontrue>33f5f4ee-60f4-43b5-8f66-8cad36b1e64d</ontrue>
    <onfalse>8fec0c0c-2bf9-44d6-aee3-d6665668f5b8</onfalse>
  </stage>
  <stage stageid="8fec0c0c-2bf9-44d6-aee3-d6665668f5b8" name="FAIL" type="Exception">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="120" y="330" />
    <exception localized="yes" type="Unexpected Response Values" detail="&quot;Check scenario 2, Schedule 2 for Schedule Log values returned, check id, status and HTTP status code&quot;" />
  </stage>
  <stage stageid="179b51ce-e0c0-4193-9b30-af050dde1c25" name="Note2" type="Note">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <narrative>Once POST request is executed and the schedule can run to completion, but there are some failed tests and some passed. Then PartExceptioned will show. Schedule 1 will show this.</narrative>
    <display x="15" y="135" w="210" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>3b62eac7-a824-4588-8e68-d3142c0a234e</onsuccess>
  </stage>
  <stage stageid="ad0c2b28-4c5f-413b-9751-34f765ba5acf" name="Resume Setup" type="Resume">
    <loginhibit />
    <display x="345" y="60" />
    <onsuccess>280c881a-9dee-4df2-ab3f-eb67cf5246d1</onsuccess>
  </stage>
  <stage stageid="f1d3ea19-5722-4bc9-bdf1-6e262a489439" name="Get Exception Setup" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="270" y="60" />
    <onsuccess>ad0c2b28-4c5f-413b-9751-34f765ba5acf</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot;,Setup Failed. Exception details: &quot;&amp;ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="fa099e1d-0551-4a85-93c6-f93603a91a23" name="Resume Scenario 1" type="Resume">
    <loginhibit />
    <display x="270" y="255" />
    <onsuccess>280c881a-9dee-4df2-ab3f-eb67cf5246d1</onsuccess>
  </stage>
  <stage stageid="c548a089-b986-4235-8a7b-db165e27ee5c" name="Get Exception 1" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="270" y="210" />
    <onsuccess>fa099e1d-0551-4a85-93c6-f93603a91a23</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot;,Scenario 1 Failed. Exception details: &quot;&amp;ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="d138f72f-f124-482a-b0a2-ebb645cdda31" name="Anchor7" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="405" w="10" h="10" />
    <onsuccess>ec7322d7-ec81-4a05-8a51-6a6aa9f3c2f1</onsuccess>
  </stage>
  <stage stageid="854021c5-9b08-43f3-b06b-fe0be952ed22" name="Resume Scenario 2" type="Resume">
    <loginhibit />
    <display x="270" y="405" />
    <onsuccess>d138f72f-f124-482a-b0a2-ebb645cdda31</onsuccess>
  </stage>
  <stage stageid="b0e2bf8d-09d4-4fd9-8d6d-34ea9530d6bd" name="Get Exception 2" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="270" y="360" />
    <onsuccess>854021c5-9b08-43f3-b06b-fe0be952ed22</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot;,Scenario 2 Failed. Exception details: &quot;&amp;ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="280c881a-9dee-4df2-ab3f-eb67cf5246d1" name="Anchor8" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="345" y="255" w="10" h="10" />
    <onsuccess>6bba1008-3251-4411-94de-b4c49880ab7b</onsuccess>
  </stage>
  <stage stageid="6bba1008-3251-4411-94de-b4c49880ab7b" name="Anchor10" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="345" y="570" w="10" h="10" />
    <onsuccess>a9094021-6d81-42b9-916a-64e72c134df6</onsuccess>
  </stage>
  <stage stageid="7c53c593-d938-4b0f-9051-e79441a570cc" name="Resume Scenario 3" type="Resume">
    <loginhibit />
    <display x="285" y="555" />
    <onsuccess>94599cac-fe79-4e46-95eb-bb491bcb06d3</onsuccess>
  </stage>
  <stage stageid="3d62c0c2-e1a9-4407-8e77-82f1fd61408a" name="Get Exception 3" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="285" y="510" />
    <onsuccess>7c53c593-d938-4b0f-9051-e79441a570cc</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="[Exception]&amp;&quot;,Scenario 3 Failed. Exception details: &quot;&amp;ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="451c9214-bb51-4ba8-bb22-dd8926885b94" name="End" type="End">
    <display x="15" y="690" />
  </stage>
  <stage stageid="508e94c2-9a56-4b43-9de4-521b5f5b2d14" name="CleanUp" type="SubSheet">
    <display x="15" y="600" w="120" h="30" />
    <onsuccess>7e5a70e0-b93a-477b-ac6e-0dbaabc71424</onsuccess>
    <processid>2742fecc-ff29-478b-add0-f6821c2cd14e</processid>
  </stage>
  <stage stageid="7e5a70e0-b93a-477b-ac6e-0dbaabc71424" name="Failed?" type="Decision">
    <display x="15" y="645" w="90" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>957d990c-4cd4-432c-8eb0-4ffaeea8ed7c</ontrue>
    <onfalse>451c9214-bb51-4ba8-bb22-dd8926885b94</onfalse>
  </stage>
  <stage stageid="957d990c-4cd4-432c-8eb0-4ffaeea8ed7c" name="RETHROW" type="Exception">
    <display x="105" y="645" />
    <exception type="RETHROW" detail="[Exception]" />
  </stage>
  <stage stageid="4c095eb9-82e3-4ee3-9859-25ac8d6fdff7" name="Anchor36" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="600" w="10" h="10" />
    <font family="Segoe UI" size="10" style="Regular" color="993366" />
    <onsuccess>508e94c2-9a56-4b43-9de4-521b5f5b2d14</onsuccess>
  </stage>
  <stage stageid="a9094021-6d81-42b9-916a-64e72c134df6" name="Anchor11" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="570" w="10" h="10" />
    <onsuccess>508e94c2-9a56-4b43-9de4-521b5f5b2d14</onsuccess>
  </stage>
  <stage stageid="94599cac-fe79-4e46-95eb-bb491bcb06d3" name="Anchor12" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="555" w="10" h="10" />
    <onsuccess>a9094021-6d81-42b9-916a-64e72c134df6</onsuccess>
  </stage>
  <stage stageid="b927f4a4-50cf-4dac-b307-92db8e27a33f" name="Ran Sessions" type="Collection">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="-135" y="-30" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="ID" type="number" />
      <field name="Process" type="text" />
      <field name="Resource" type="text" />
      <field name="User" type="text" />
      <field name="Status" type="text" />
      <field name="Start Time" type="datetime" />
      <field name="End Time" type="datetime" />
      <field name="Latest Stage" type="text" />
      <field name="Stage Started" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="fcf44f78-9e9d-4ec2-8c8b-3502676a6b65" name="Is the session too old?" type="Decision">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="75" w="90" h="30" />
    <decision expression="[Ran Sessions.Start Time]&lt;[Start DateTime]" />
    <ontrue>1c5a08d6-33f3-4e5a-aef2-bdfcc8372bbd</ontrue>
    <onfalse>f9f29a19-b493-4fc0-8cc5-a30286e70f49</onfalse>
  </stage>
  <stage stageid="1c5a08d6-33f3-4e5a-aef2-bdfcc8372bbd" name="Anchor13" type="Anchor">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="75" w="10" h="10" />
    <onsuccess>0f665d27-07be-4b29-a7f9-19c2adf79095</onsuccess>
  </stage>
  <stage stageid="2fa69d7a-e07f-46a2-8c53-04793c2629b8" name="Anchor4" type="Anchor">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="465" w="10" h="10" />
    <onsuccess>ddb86116-450d-4ded-8c1b-e7cb20e2190e</onsuccess>
  </stage>
  <stage stageid="ad958efc-e216-4b03-82f1-2f9201e0ede8" name="Found Session Completed?" type="Decision">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="120" y="345" w="90" h="30" />
    <decision expression="[Ran Sessions.Process]=[Task Sessions 2.Sessions.Process Name]&#xA;AND&#xA;[Ran Sessions.Resource]=[Task Sessions 2.Sessions.Resource Name]&#xA;AND &#xA;[Ran Sessions.User]=&quot;[Scheduler]&quot; &#xA;AND &#xA;[Ran Sessions.Status]=[Task B Status]&#xA;AND &#xA;[Ran Sessions.Start Time]&lt;=[endTime]&#xA;AND&#xA;[Ran Sessions.Start Time]&gt;=[Start DateTime]" />
    <ontrue>c3be06c1-46a7-4398-b5c0-7f7bf949190b</ontrue>
    <onfalse>901a9079-c9fa-4f06-a24a-dbc1ddb4a144</onfalse>
  </stage>
  <stage stageid="e2cd7ca3-9aaa-4a5c-8cd7-356c08731fd8" name="Press Apply" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="990" w="90" h="30" />
    <onsuccess>aee52afc-8c8e-4124-8677-d9d964130664</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Press Apply" />
  </stage>
  <stage stageid="52a174aa-ff2d-44a0-bed2-587dada3ad40" name="Result Collection 1" type="Collection">
    <display x="-435" y="75" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="pagingToken" type="text" />
      <field name="items" type="collection">
        <field name="JSON:Array" type="collection">
          <field name="id" type="number" />
          <field name="name" type="text" />
          <field name="description" type="text" />
          <field name="isRetired" type="flag" />
          <field name="tasksCount" type="number" />
          <field name="intervalType" type="text" />
          <field name="timePeriod" type="number" />
          <field name="startPoint" type="datetime" />
          <field name="endPoint" type="datetime" />
          <field name="dayOfWeek" type="text" />
          <field name="dayOfMonth" type="text" />
          <field name="startDate" type="datetime" />
          <field name="endDate" type="datetime" />
          <field name="calendarId" type="text" />
          <field name="calendarName" type="text" />
        </field>
      </field>
    </collectioninfo>
  </stage>
  <stage stageid="8864ff37-255c-4600-8ee6-42f7e0d9753e" name="Add to CleanUp Collection" type="SubSheet">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="210" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Resource 4231&quot;" />
    </inputs>
    <onsuccess>654613b2-7359-4503-b376-aab6f35e111a</onsuccess>
    <processid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</processid>
  </stage>
  <stage stageid="cdf8a920-10c6-486e-b986-7693048cd5ee" name="Resource Manager: Start Resource" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="90" h="30" />
    <inputs>
      <input type="flag" name="SSO" friendlyname="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="&quot;False&quot;" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="&quot;admin&quot;" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to use for the resource. Only used if Username is given" expr="&quot;admin&quot;" />
      <input type="number" name="Port" friendlyname="Port" narrative="The port number on which the resource PC should listen" expr="[Port]" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" friendlyname="Process ID" narrative="The PID of the newly created process" stage="" />
    </outputs>
    <onsuccess>29917e62-6fc8-4ba4-8ac6-37056c392bca</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="29917e62-6fc8-4ba4-8ac6-37056c392bca" name="Store resource name" type="MultipleCalculation">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="165" w="90" h="30" />
    <onsuccess>8864ff37-255c-4600-8ee6-42f7e0d9753e</onsuccess>
    <steps>
      <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;) &amp; &quot;:&quot; &amp; [Port]" stage="Task Sessions 1.Sessions.Resource Name" />
      <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;) &amp; &quot;:&quot; &amp; [Port]" stage="Task Sessions 2.Sessions.Resource Name" />
      <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;) &amp; &quot;:&quot; &amp; [Port]" stage="Task Sessions 3.Sessions.Resource Name" />
      <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;) &amp; &quot;:&quot; &amp; [Port]" stage="Task Sessions B.Resource" />
    </steps>
  </stage>
  <stage stageid="336dd4a3-306d-4a0e-bddd-4e10f06c9025" name="Add to CleanUp Collection" type="SubSheet">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="1155" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Schedule 2&quot;" />
    </inputs>
    <onsuccess>04d2f61c-50cf-4429-a2e6-581eabce62f7</onsuccess>
    <processid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</processid>
  </stage>
  <stage stageid="0f8c8ce2-5ab3-4cec-bb5b-9134442a0a68" name="Is this row 1?" type="Decision">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="165" w="90" h="30" />
    <decision expression="[Row]=1" />
    <ontrue>ef1c1faf-96b1-4cdf-ab5c-0126febaff24</ontrue>
    <onfalse>c21fda50-4ad2-4389-a3cb-75815096f679</onfalse>
  </stage>
  <stage stageid="49783d73-bea0-4036-a6fe-cf5896516cff" name="Row" type="Data">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-135" y="0" w="90" h="30" />
    <datatype>number</datatype>
    <initialvalue>1</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c21fda50-4ad2-4389-a3cb-75815096f679" name="Is this row 2?" type="Decision">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="255" w="90" h="30" />
    <decision expression="[Row]=2" />
    <ontrue>4301ef7a-4ab4-46b6-9579-95c78b77ce96</ontrue>
    <onfalse>712aa71d-fc1c-4a0c-ad21-5e0296584719</onfalse>
  </stage>
  <stage stageid="712aa71d-fc1c-4a0c-ad21-5e0296584719" name="Is this row 3?" type="Decision">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="15" y="345" w="90" h="30" />
    <decision expression="[Row]=3" />
    <ontrue>ad958efc-e216-4b03-82f1-2f9201e0ede8</ontrue>
    <onfalse>e496ce1a-0183-4203-bbf0-d91a6907f90a</onfalse>
  </stage>
  <stage stageid="1602079c-0e99-4dda-a380-77c57a9e810e" name="Found a matching row so add to Row+1" type="Calculation">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="435" w="90" h="30" />
    <onsuccess>e496ce1a-0183-4203-bbf0-d91a6907f90a</onsuccess>
    <calculation expression="[Row]+1" stage="Row" />
  </stage>
  <stage stageid="5c93bc7c-9039-4a1a-802a-292e783ed87a" name="Anchor14" type="Anchor">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="435" w="10" h="10" />
    <onsuccess>1602079c-0e99-4dda-a380-77c57a9e810e</onsuccess>
  </stage>
  <stage stageid="e496ce1a-0183-4203-bbf0-d91a6907f90a" name="Anchor15" type="Anchor">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="435" w="10" h="10" />
    <onsuccess>2fa69d7a-e07f-46a2-8c53-04793c2629b8</onsuccess>
  </stage>
  <stage stageid="392096e7-1c53-46e3-a30c-f6736f616fda" name="Pause 60s" type="Action">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="number" name="Duration (Seconds)" friendlyname="Duration (Seconds)" expr="60" />
    </inputs>
    <onsuccess>2e45b491-f36a-4b4c-a8f3-193d19678525</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Pause" />
  </stage>
  <stage stageid="5c59638c-ab15-406d-b371-12f841a5142a" name="FAIL" type="Exception">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="120" y="300" />
    <exception localized="yes" type="SystemException" detail="&quot;Could not find terminated Session, session found was &quot;&amp;[Ran Sessions.Status]&amp;&quot; Scenario 3 failed&quot;" />
  </stage>
  <stage stageid="4b91331a-724b-4c18-926a-8e7740482088" name="FAIL" type="Exception">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="120" y="210" />
    <exception localized="yes" type="SystemException" detail="&quot;Could not find running Session, session found was &quot;&amp;[Ran Sessions.Status]&amp;&quot; Scenario 3 failed&quot;" />
  </stage>
  <stage stageid="901a9079-c9fa-4f06-a24a-dbc1ddb4a144" name="FAIL" type="Exception">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <display x="120" y="390" />
    <exception localized="yes" type="SystemException" detail="&quot;Could not find completed Session, session found was &quot;&amp;[Ran Sessions.Status]&amp;&quot; Scenario 3 failed&quot;" />
  </stage>
  <stage stageid="2ed7d904-d005-4df0-ad0e-b47de127a8b6" name="Convert back to UTC" type="Action">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="255" w="120" h="30" />
    <inputs>
      <input type="datetime" name="local" friendlyname="local" narrative="The local datetime to convert" expr="[scheduledTime 1]" />
      <input type="text" name="Time Zone ID" friendlyname="Time Zone ID" narrative="The ID of the timezone to use; Empty means to use the time zone on the executing environment" expr="" />
    </inputs>
    <outputs>
      <output type="datetime" name="UTC" friendlyname="UTC" narrative="The converted datetime" stage="scheduledTime 1" />
    </outputs>
    <onsuccess>bb0f92ae-ac3d-4bd5-a984-92cdc94a71b9</onsuccess>
    <resource object="Utility - Date and Time Manipulation" action="Local To UTC" />
  </stage>
  <stage stageid="6616c43d-18a2-43a9-a9f7-d655f831d9b5" name="endTime" type="Data">
    <display x="-270" y="105" w="120" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="66a66d6b-eb63-47db-b256-b1d575668911" name="Response Content 1" type="Data">
    <display x="-435" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="e665abd3-715c-44a2-89f0-28e24ddb5df0" name="Convert back to UTC" type="Action">
    <subsheetid>9a689181-9363-4732-a986-cdb892126e91</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="345" w="120" h="30" />
    <inputs>
      <input type="datetime" name="local" friendlyname="local" narrative="The local datetime to convert" expr="[scheduledTime 2]" />
      <input type="text" name="Time Zone ID" friendlyname="Time Zone ID" narrative="The ID of the timezone to use; Empty means to use the time zone on the executing environment" expr="" />
    </inputs>
    <outputs>
      <output type="datetime" name="UTC" friendlyname="UTC" narrative="The converted datetime" stage="scheduledTime 2" />
    </outputs>
    <onsuccess>d708e155-41ff-4d7e-bf2d-c4a7dade09c8</onsuccess>
    <resource object="Utility - Date and Time Manipulation" action="Local To UTC" />
  </stage>
  <stage stageid="f9f29a19-b493-4fc0-8cc5-a30286e70f49" name="Convert back to UTC" type="Action">
    <subsheetid>fc092510-a3bd-4aae-a7be-d0c6edbcc9f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="90" h="30" />
    <inputs>
      <input type="datetime" name="local" friendlyname="local" narrative="The local datetime to convert" expr="[Ran Sessions.Start Time]" />
      <input type="text" name="Time Zone ID" friendlyname="Time Zone ID" narrative="The ID of the timezone to use; Empty means to use the time zone on the executing environment" expr="" />
    </inputs>
    <outputs>
      <output type="datetime" name="UTC" friendlyname="UTC" narrative="The converted datetime" stage="Ran Sessions.Start Time" />
    </outputs>
    <onsuccess>0f8c8ce2-5ab3-4cec-bb5b-9134442a0a68</onsuccess>
    <resource object="Utility - Date and Time Manipulation" action="Local To UTC" />
  </stage>
  <stage stageid="02ae2af3-cd69-4eeb-ac87-1c9a7878a13b" name="Recover" type="Recover">
    <loginhibit />
    <display x="180" y="510" />
    <onsuccess>3d62c0c2-e1a9-4407-8e77-82f1fd61408a</onsuccess>
  </stage>
  <stage stageid="de00e5c5-9404-4492-9594-85e62619babc" name="Recover" type="Recover">
    <loginhibit />
    <display x="180" y="360" />
    <onsuccess>b0e2bf8d-09d4-4fd9-8d6d-34ea9530d6bd</onsuccess>
  </stage>
  <stage stageid="d065dad4-378b-42ff-8e35-146838932250" name="Recover" type="Recover">
    <loginhibit />
    <display x="180" y="210" />
    <onsuccess>c548a089-b986-4235-8a7b-db165e27ee5c</onsuccess>
  </stage>
  <stage stageid="60786611-abd8-497e-82c4-071300b6f1ee" name="Recover" type="Recover">
    <loginhibit />
    <display x="180" y="60" />
    <onsuccess>f1d3ea19-5722-4bc9-bdf1-6e262a489439</onsuccess>
  </stage>
  <stage stageid="f0f8e42c-fd63-43da-b931-610d4487920a" name="Add to CleanUp Collection" type="SubSheet">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="-210" w="90" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Blue Prism&quot;" />
    </inputs>
    <onsuccess>8dc8b055-5cf9-4b98-b38e-94d7302b3e83</onsuccess>
    <processid>cc8ab573-3654-4f19-85b6-b6dbbc97a936</processid>
  </stage>
  <stage stageid="a3d2aa8e-9d8e-4bb2-9431-2c64e2d93db3" name="Start" type="Start">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="-300" />
    <onsuccess>f5c82995-bf2e-47ef-89c5-4ef29cf0cef7</onsuccess>
  </stage>
  <stage stageid="f5c82995-bf2e-47ef-89c5-4ef29cf0cef7" name="Launch" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <display x="15" y="-255" w="90" h="30" />
    <outputs>
      <output type="number" name="pid" friendlyname="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>f0f8e42c-fd63-43da-b931-610d4487920a</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="8dc8b055-5cf9-4b98-b38e-94d7302b3e83" name="Sign In Auth Server" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-165" w="90" h="30" />
    <onsuccess>c548f600-636d-4439-ae1a-8f79ed88867b</onsuccess>
    <resource object="Blue Prism" action="Sign in using Auth Server" />
  </stage>
  <stage stageid="c548f600-636d-4439-ae1a-8f79ed88867b" name="IMS Server:Attach" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" w="90" h="30" />
    <onsuccess>e6458201-cc1b-40d6-82c3-d19422a1e752</onsuccess>
    <resource object="IMS Server" action="Attach" />
  </stage>
  <stage stageid="e6458201-cc1b-40d6-82c3-d19422a1e752" name="IMS Server:Login" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" expr="&quot;Qq1234!!&quot;" />
    </inputs>
    <onsuccess>f32322e0-f457-4aba-a5f5-b92aca999da1</onsuccess>
    <resource object="IMS Server" action="Login" />
  </stage>
  <stage stageid="f32322e0-f457-4aba-a5f5-b92aca999da1" name="Setup Credential" type="Action">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/createcredential &quot;&quot;BPE-API-Credential&quot;&quot; ServiceAccount E3NbGuz9G/nSpQWdz6DMROZhtIDHtUhev13wsCV72fY=  /credentialtype OAuth2ClientCredentials&quot;" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="" />
    </outputs>
    <onsuccess>cfb4bdc4-43b2-47ec-882f-c503d19d7292</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="a2b9fd7a-c719-408e-9d84-37bd96b1e5cd" name="Credential already exists?" type="Recover">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit />
    <display x="120" y="-15" w="90" h="30" />
    <onsuccess>2ce34db3-8545-4513-bf72-92b31e4b7ba6</onsuccess>
  </stage>
  <stage stageid="2ce34db3-8545-4513-bf72-92b31e4b7ba6" name="Resume1" type="Resume">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit />
    <display x="120" y="45" w="90" h="30" />
    <onsuccess>cfb4bdc4-43b2-47ec-882f-c503d19d7292</onsuccess>
  </stage>
  <stage stageid="cfb4bdc4-43b2-47ec-882f-c503d19d7292" name="Anchor14" type="Anchor">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" w="10" h="10" />
    <onsuccess>8a9b73b6-be78-4f9a-9591-2486012f7bab</onsuccess>
  </stage>
  <stage stageid="d9636e4c-bed9-493c-8634-902e22f0cd1f" name="Create credential" type="Block">
    <subsheetid>549645e8-f436-4eb0-910c-841591a7364c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-45" w="225" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="dcdccd8c-edad-4d9a-b9ab-99f037cbd5eb" name="Schedule log 2 default" type="Collection">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="-195" y="135" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="62b2a4cd-b4c7-459e-b0a3-789ed2ff1e9a" name="Return to collection" type="Calculation">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <onsuccess>739dadca-54c0-4fdd-ad4e-09c92cf7f186</onsuccess>
    <calculation expression="[Schedule log 2 default.items]" stage="Schedule log 2" />
  </stage>
  <stage stageid="355fd488-8faa-497f-9084-b2c3c8f8b312" name="Schedule log 1 default" type="Collection">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <display x="-195" y="30" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e242bd8c-236e-401f-9540-1efce2c78944" name="Return to collection" type="Calculation">
    <subsheetid>854991c1-47a5-44cd-96ea-192dc6ce0c4b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="285" w="120" h="30" />
    <onsuccess>45190001-ecd1-47d9-af40-eec3bd1e918a</onsuccess>
    <calculation expression="[Schedule log 1 default.items]" stage="Schedule log 1" />
  </stage>
</process>