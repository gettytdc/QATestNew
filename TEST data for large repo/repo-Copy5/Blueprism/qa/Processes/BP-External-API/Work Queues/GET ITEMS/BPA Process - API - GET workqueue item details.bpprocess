<process name="API - GET workqueue item details" version="1.0" bpversion="7.0.0.39397" narrative="" byrefcollection="true" preferredid="e7a46144-e829-4f41-a6e6-837a82281f9d">
  <view>
    <camerax>-6</camerax>
    <cameray>-156</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="35e4a25d-3be4-4079-9172-6a5adeca098f" type="Normal" published="False">
    <name>Setup</name>
    <view>
      <camerax>124</camerax>
      <cameray>-390</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="c83656e3-48f4-49ac-b778-ec9d5eecb7ab" type="Normal" published="False">
    <name>validate HTTP responses</name>
    <view>
      <camerax>-43</camerax>
      <cameray>462</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ab4ccde0-4082-4083-98a8-a036be8b3e37" type="Normal" published="False">
    <name>Get Un-Encrypted Item</name>
    <view>
      <camerax>705</camerax>
      <cameray>729.8</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b0418fea-7d2d-43d1-81f5-f37dafbcbebd" type="Normal" published="False">
    <name>Get Encrypted Item</name>
    <view>
      <camerax>750</camerax>
      <cameray>1519.8</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="cc63b4ab-15cd-4e6f-a366-a3167a4fa91c" type="Normal" published="False">
    <name>Add to Cleanup</name>
    <view>
      <camerax>91</camerax>
      <cameray>-3</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="86c68210-f036-4137-95d7-f70cc6db3783" type="Normal" published="False">
    <name>Cleanup</name>
    <view>
      <camerax>986</camerax>
      <cameray>45</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="43eb6e5d-030d-453a-894c-1c6e09e52732" name="Start" type="Start">
    <display x="15" y="-405" />
    <onsuccess>631ce758-4e64-4093-9d37-2b75c0b509ee</onsuccess>
  </stage>
  <stage stageid="6b7ae773-943d-4f66-bb0a-3746d0fca712" name="Stage1" type="ProcessInfo">
    <display x="-270" y="-210" w="150" h="90" />
  </stage>
  <stage stageid="e85873f5-c2f6-4ad0-a169-e69be2ecc800" name="End1" type="End">
    <loginhibit onsuccess="true" />
    <display x="15" y="390" />
  </stage>
  <stage stageid="f5798412-80be-487a-9afa-ad7468cf894c" name="Global Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-465" y="-150" w="270" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="f6360219-a1f1-4612-bb06-624c50d8f06f" name="Setup" type="SubSheetInfo">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <display x="-135" y="-1110" w="150" h="90" />
  </stage>
  <stage stageid="95d8a8b4-41c6-45bc-939a-d1b9241f0630" name="Setup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="-300" w="360" h="30" />
    <onsuccess>cc37e739-4c27-49c2-aa74-8b5a31b16c41</onsuccess>
    <processid>35e4a25d-3be4-4079-9172-6a5adeca098f</processid>
  </stage>
  <stage stageid="74c5c67a-0e2f-4c93-96a1-d4a874e6bdf7" name="Local Variables" type="Block">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-1050" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="8eb96d59-6c97-4ca1-bb3c-58b86b18ffe7" name="Get Un-Encrypted Item" type="SubSheetInfo">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-150" y="-600" w="150" h="90" />
  </stage>
  <stage stageid="6af4d1a5-b593-4997-b84c-6c4132855a90" name="Start (Get UN-encrypted item page)" type="Start">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="15" y="-975" />
    <onsuccess>79aba039-35ca-45a4-b754-faedb635b195</onsuccess>
  </stage>
  <stage stageid="88833a9b-0b14-4e30-b3ee-39e5989d987f" name="pid" type="Data">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <display x="-135" y="-1020" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="23bcc485-b52d-4826-ba0c-1e06b12ada07" name="Browse to Workflow" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-480" w="120" h="30" />
    <inputs>
      <input type="text" name="Tree Name" friendlyname="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Workflow&quot;" />
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Work Queues&quot;" />
      <input type="text" name="Sub Item Name" friendlyname="Sub Item Name" narrative="Name of the sub item to be clicked on." expr="" />
      <input type="flag" name="Select Item Method?" friendlyname="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" friendlyname="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" friendlyname="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>d7ca0488-4eb4-4470-8a21-dfa9d170a213</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="d7ca0488-4eb4-4470-8a21-dfa9d170a213" name="Create Queue 1" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-435" w="120" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name of the work queue" expr="[Queue Name (1)]" />
      <input type="text" name="Key Field" friendlyname="Key Field" narrative="The key field for the work queue" expr="" />
      <input type="flag" name="Active" friendlyname="Active" narrative="Flag indicating if the work queue should be made active or not - default is True, ie. Active" expr="" />
      <input type="number" name="Max Attempts" friendlyname="Max Attempts" narrative="The maximum number of attempts to allow on this queue" expr="" />
      <input type="flag" name="Set Encryption?" friendlyname="Set Encryption?" narrative="This is a flag to tick the encryption tickbox for a queue." expr="False" />
      <input type="text" name="Scheme Name" friendlyname="Scheme Name" narrative="This is the name of the scheme in which you wish to encrypt the queue with." expr="" />
      <input type="flag" name="Set Active Queue" friendlyname="Set Active Queue" narrative="True or False, do you want to make this an active queue." expr="" />
      <input type="text" name="Assigned Process" friendlyname="Assigned Process" narrative="The name of the proccess you wish to assign to the active queue." expr="" />
      <input type="text" name="Assigned Resource Group" friendlyname="Assigned Resource Group" narrative="The name of the resoruce group you want to assign to the active queue." expr="" />
    </inputs>
    <onsuccess>3e9fde55-cc60-4f74-a083-eb968057d326</onsuccess>
    <resource object="Blue Prism - System - Workflow" action="Create Work Queue" />
  </stage>
  <stage stageid="3e9fde55-cc60-4f74-a083-eb968057d326" name="Create Queue 2" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-390" w="120" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name of the work queue" expr="[Queue Name (2)]" />
      <input type="text" name="Key Field" friendlyname="Key Field" narrative="The key field for the work queue" expr="" />
      <input type="flag" name="Active" friendlyname="Active" narrative="Flag indicating if the work queue should be made active or not - default is True, ie. Active" expr="" />
      <input type="number" name="Max Attempts" friendlyname="Max Attempts" narrative="The maximum number of attempts to allow on this queue" expr="" />
      <input type="flag" name="Set Encryption?" friendlyname="Set Encryption?" narrative="This is a flag to tick the encryption tickbox for a queue." expr="True" />
      <input type="text" name="Scheme Name" friendlyname="Scheme Name" narrative="This is the name of the scheme in which you wish to encrypt the queue with." expr="[Scheme Name]" />
      <input type="flag" name="Set Active Queue" friendlyname="Set Active Queue" narrative="True or False, do you want to make this an active queue." expr="" />
      <input type="text" name="Assigned Process" friendlyname="Assigned Process" narrative="The name of the proccess you wish to assign to the active queue." expr="" />
      <input type="text" name="Assigned Resource Group" friendlyname="Assigned Resource Group" narrative="The name of the resoruce group you want to assign to the active queue." expr="" />
    </inputs>
    <onsuccess>4ece936f-1e9b-4b52-bc9a-36b3bf34f51d</onsuccess>
    <resource object="Blue Prism - System - Workflow" action="Create Work Queue" />
  </stage>
  <stage stageid="95a79b4b-07a8-4175-80ea-25d5175378c8" name="Browse to Encryption Schemes" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-600" w="120" h="30" />
    <inputs>
      <input type="text" name="Tree Name" friendlyname="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Security&quot;" />
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Encryption Schemes&quot;" />
      <input type="text" name="Sub Item Name" friendlyname="Sub Item Name" narrative="Name of the sub item to be clicked on." expr="" />
      <input type="flag" name="Select Item Method?" friendlyname="Select Item Method?" narrative="True by Default. Selects the node from system tab using Select Item approach. If the node is not available (Greyed out) an exception will be thrown. Use this method if you are certain the node is available for selection." expr="" />
      <input type="flag" name="Retry MouseClick?" friendlyname="Retry MouseClick?" narrative="Default to True. Retries Global Mouse Click up to 3 times." expr="" />
      <input type="flag" name="Clean Up?" friendlyname="Clean Up?" narrative="False by Default. Set True if clean up is required at the beginning of the Action." expr="" />
    </inputs>
    <onsuccess>8ebdd8f8-142c-4770-b8b3-f4944f40091b</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="8ebdd8f8-142c-4770-b8b3-f4944f40091b" name="Create Encryption Scheme" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-555" w="120" h="30" />
    <inputs>
      <input type="text" name="Scheme Name" friendlyname="Scheme Name" narrative="The name in which you want to call your encrpytion scheme." expr="[Scheme Name]" />
      <input type="flag" name="Available?" friendlyname="Available?" narrative="This will tick a box that allows the encryption scheme to become available." expr="True" />
      <input type="flag" name="Database?" friendlyname="Database?" narrative="Mark as true if you want to store the scheme on the database. Please note that this will default to true." expr="True" />
      <input type="text" name="Method" friendlyname="Method" narrative="The encryption method used with the scheme." expr="&quot;AES-256 AesCryptoService (256 bit)&quot;" />
    </inputs>
    <onsuccess>23bcc485-b52d-4826-ba0c-1e06b12ada07</onsuccess>
    <resource object="Blue Prism - System - Security" action="Encryption Schemes - Create Encryption Scheme" />
  </stage>
  <stage stageid="12c06fb8-c8ae-4c08-83e9-e3f4cdbcbf95" name="Scheme Name" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="-120" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Encryption Scheme (BP-1873)</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="2041873a-bae6-4632-85f2-2fef1e98a8ab" name="Create Encryption Scheme" type="Block">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-630" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b59a1dd8-3a77-4105-8b30-ffc79020f434" name="Create Queues" type="Block">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-510" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
  </stage>
  <stage stageid="be126bb3-384a-47c2-8b45-9e16fba5d2eb" name="Cleanup" type="SubSheetInfo">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="150" y="-120" w="150" h="90" />
  </stage>
  <stage stageid="3a9b03c7-2d4f-429f-a57d-818a3597773a" name="Cleanup Block" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-180" y="-330" w="495" h="420" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ed75dfdf-67ad-47fd-a5a2-34de3d8f6b22" name="Cleanup" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="15" y="285" w="360" h="30" />
    <onsuccess>1ac14194-bc23-4eba-8d05-4f20c9bc9a9c</onsuccess>
    <processid>86c68210-f036-4137-95d7-f70cc6db3783</processid>
  </stage>
  <stage stageid="34b9ddb6-8c39-412f-b5d4-43be9097a411" name="Local Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-345" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4b28d2b6-e550-4eb5-bc24-a19c72604e56" name="Failed?" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="60" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="11023205-eac8-4d11-9fd7-4efab2234d2b" name="Exception" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c2c13b44-cae6-4e0d-bc3a-d0f8f652fed4" name="Resume" type="Resume">
    <loginhibit />
    <display x="255" y="-90" w="90" h="30" />
    <onsuccess>9f044ac9-9da9-4522-a001-e6ccbc73efe1</onsuccess>
  </stage>
  <stage stageid="fa92fa3b-ad01-4038-96c1-377000f74faf" name="Get Exception" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="255" y="-135" w="90" h="30" />
    <onsuccess>c2c13b44-cae6-4e0d-bc3a-d0f8f652fed4</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="1ac14194-bc23-4eba-8d05-4f20c9bc9a9c" name="Failed?" type="Decision">
    <display x="15" y="345" w="210" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>1ebdc55d-f97f-4b58-ae2e-e00e40e01462</ontrue>
    <onfalse>e85873f5-c2f6-4ad0-a169-e69be2ecc800</onfalse>
  </stage>
  <stage stageid="1ebdc55d-f97f-4b58-ae2e-e00e40e01462" name="RETHROW" type="Exception">
    <display x="165" y="345" />
    <exception localized="yes" type="Test Fail" detail="[Exception]" />
  </stage>
  <stage stageid="9f044ac9-9da9-4522-a001-e6ccbc73efe1" name="Anchor31" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="255" y="120" w="10" h="10" />
    <onsuccess>4a8c19c6-a023-4409-9dad-d65736fc81ad</onsuccess>
  </stage>
  <stage stageid="d0caa9b7-11ad-47a9-90ea-f8c10c24a32b" name="Add to Cleanup" type="SubSheetInfo">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="-120" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="ec54aa7a-3afd-4669-af4b-3b9747f0d047" name="Start" type="Start">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="Item Name" narrative="The name of the item you want to clean up." stage="Item Name" />
    </inputs>
    <onsuccess>c3731248-ccec-470b-b343-d0975a8e577b</onsuccess>
  </stage>
  <stage stageid="66bf6301-e024-46e2-be09-6662fa73dd53" name="End" type="End">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="15" y="30" />
  </stage>
  <stage stageid="2e7c1fa2-59f3-413a-96d7-66ca96d11cbe" name="Item Name" type="Data">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="-120" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b3a6c719-236b-4090-bfb0-444748c67e34" name="Input Variables" type="Block">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="-195" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c3731248-ccec-470b-b343-d0975a8e577b" name="Add Row" type="Action">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="15" y="-60" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;CleanUp Collection&quot;" />
    </inputs>
    <onsuccess>d6d3bca6-37fe-43e7-9a6a-48059ac4f906</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="2647d19c-537e-43cd-92ec-527a69ca305a" name="CleanUp Collection" type="Collection">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="-120" y="90" w="120" h="30" />
    <datatype>collection</datatype>
    <collectioninfo>
      <field name="Item Name" type="text" description="The name of the item that needs cleaning up." />
    </collectioninfo>
    <noalwaysinit />
  </stage>
  <stage stageid="968551c1-3af1-44ea-a0e8-f39933cdb728" name="Local Variables" type="Block">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="-195" y="60" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="d6d3bca6-37fe-43e7-9a6a-48059ac4f906" name="Add To Row" type="Calculation">
    <subsheetid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <onsuccess>66bf6301-e024-46e2-be09-6662fa73dd53</onsuccess>
    <calculation expression="[Item Name]" stage="CleanUp Collection.Item Name" />
  </stage>
  <stage stageid="bb02b3db-b90e-4023-b6cd-c95f268dd201" name="Start" type="Start">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="405" y="-375" />
    <onsuccess>fac33ecf-b5f8-43fe-adc5-5713f1db8154</onsuccess>
  </stage>
  <stage stageid="964530ec-2719-4bac-9fc6-5ca741df631d" name="To Clean" type="LoopStart">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="405" y="-60" w="90" h="30" />
    <onsuccess>d353ee09-009a-49b3-a634-bd699182d928</onsuccess>
    <groupid>bd5bd337-4424-4179-a44d-4c48da756b6c</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Reversed CleanUp</loopdata>
  </stage>
  <stage stageid="07d59d4b-d6ec-417e-b9c9-38ad777698c7" name="To Clean" type="LoopEnd">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="405" y="210" w="90" h="30" />
    <onsuccess>df759bdb-c7cd-498e-9b37-8c4c3a8fa627</onsuccess>
    <groupid>bd5bd337-4424-4179-a44d-4c48da756b6c</groupid>
  </stage>
  <stage stageid="d353ee09-009a-49b3-a634-bd699182d928" name="Which Clean Up" type="ChoiceStart">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="405" y="-15" w="90" h="30" />
    <groupid>edbe5d1c-d361-447d-b78b-7c4fa7fad056</groupid>
    <choices>
      <choice expression="[Reversed CleanUp.Item Name]=&quot;Blue Prism&quot;">
        <name>Blue Prism</name>
        <distance>30</distance>
        <ontrue>f421d0b2-e72c-4d11-8af9-4706f1381f39</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="6d7fa260-b134-42a3-b574-831856b366a7" name="Otherwise" type="ChoiceEnd">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="405" y="165" w="90" h="30" />
    <onsuccess>987b14e1-cb18-4bfd-9fba-ebc0a0ef212d</onsuccess>
    <groupid>edbe5d1c-d361-447d-b78b-7c4fa7fad056</groupid>
  </stage>
  <stage stageid="987b14e1-cb18-4bfd-9fba-ebc0a0ef212d" name="FAIL" type="Exception">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="630" y="165" />
    <exception type="" detail="&quot;You have entered a clean up item the choice doesn't recognise.&quot;" />
  </stage>
  <stage stageid="4f109f33-6345-4696-af97-7258a6d53f06" name="Reverse Collection" type="Action">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="405" y="-105" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" narrative="The collection to be reversed." expr="[CleanUp Collection]" />
    </inputs>
    <outputs>
      <output type="collection" name="Reversed Collection" narrative="The reversed collection." stage="Reversed CleanUp" />
    </outputs>
    <onsuccess>964530ec-2719-4bac-9fc6-5ca741df631d</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Reverse Collection" />
  </stage>
  <stage stageid="c663609e-7f6f-4879-91c5-d0ca261f6df1" name="Reversed CleanUp" type="Collection">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="150" y="-30" w="150" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="527959ca-c647-4d5e-9ace-5d87c0d401ef" name="Local Variables" type="Block">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="60" y="-60" w="180" h="75" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="dc358008-8b20-4a1f-8cf1-139d6757a0a3" name="Anchor5" type="Anchor">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="1320" y="210" w="10" h="10" />
    <onsuccess>07d59d4b-d6ec-417e-b9c9-38ad777698c7</onsuccess>
  </stage>
  <stage stageid="573da9ad-8f1f-47da-aaf7-452e48665923" name="Terminate" type="Action">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="1110" y="15" w="90" h="30" />
    <onsuccess>2c459cc4-9cb6-4ae9-a112-30b4bbcec180</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="f421d0b2-e72c-4d11-8af9-4706f1381f39" name="Close all child windows" type="Action">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="990" y="15" w="90" h="30" />
    <onsuccess>573da9ad-8f1f-47da-aaf7-452e48665923</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Close All Child Windows" />
  </stage>
  <stage stageid="2c459cc4-9cb6-4ae9-a112-30b4bbcec180" name="Anchor9" type="Anchor">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="1320" y="15" w="10" h="10" />
    <onsuccess>dc358008-8b20-4a1f-8cf1-139d6757a0a3</onsuccess>
  </stage>
  <stage stageid="df759bdb-c7cd-498e-9b37-8c4c3a8fa627" name="End1" type="End">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <display x="405" y="255" />
  </stage>
  <stage stageid="a80a0601-bea7-476a-af21-ea22f3bc2133" name="Recover2" type="Recover">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <loginhibit />
    <display x="315" y="210" />
    <onsuccess>ba991f70-14ee-4160-9e3a-f5a75a45b330</onsuccess>
  </stage>
  <stage stageid="ba991f70-14ee-4160-9e3a-f5a75a45b330" name="Resume2" type="Resume">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <loginhibit />
    <display x="315" y="255" />
    <onsuccess>df759bdb-c7cd-498e-9b37-8c4c3a8fa627</onsuccess>
  </stage>
  <stage stageid="89a4e8eb-2d13-4295-9b5e-43f896cd52b8" name="Add to Cleanup" type="SubSheet">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-990" w="120" h="30" />
    <inputs>
      <input type="text" name="Item Name" friendlyname="Item Name" narrative="The name of the item you want to clean up." expr="&quot;Blue Prism&quot;" />
    </inputs>
    <onsuccess>7fdf7e83-19c0-4bae-9e99-d150383ae810</onsuccess>
    <processid>cc63b4ab-15cd-4e6f-a366-a3167a4fa91c</processid>
  </stage>
  <stage stageid="7f2b4791-c2f1-421d-9da5-0d10b88b23af" name="Get Encrypted Item" type="SubSheetInfo">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-120" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="749100da-ab52-44c5-ba44-aa2954577d6d" name="Queue Name (2)" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="-30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Queue 2 (BP-1873)</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="e216375b-9012-42fb-a2dd-99154f533f78" name="Queue Name (1)" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-270" y="-60" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Queue 1 (BP-1873)</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="79aba039-35ca-45a4-b754-faedb635b195" name="Add item 1 To Queue" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="15" y="-810" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name (1)]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Dummy Queue Item Data]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="MakeDate(1, 1, 2025)" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="6" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;New Tag&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="&quot;Running&quot;" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="">
        <validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" />
      </input>
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="workqueue Item 1 ID" />
    </outputs>
    <onsuccess>85cc9db9-d6a7-4e38-9e22-f9cd68d70bd2</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="d00ae412-7925-4cab-af49-e90a8afd80a7" name="Dummy Queue Item Data" type="Collection">
    <display x="-270" y="-90" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="Collection" type="collection">
        <field name="Nested Text" type="text" />
      </field>
      <field name="Date" type="date" />
      <field name="DateTime" type="datetime" />
      <field name="Flag" type="flag" />
      <field name="Number" type="number" />
      <field name="Password" type="password" />
      <field name="Text" type="text" />
      <field name="Time" type="time" />
      <field name="TimeSpan" type="timespan" />
      <field name="Image" type="image" />
      <field name="Binary" type="binary" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Collection" type="collection">
          <row>
            <field name="Nested Text" type="text" value="Text Nested Text" />
          </row>
        </field>
        <field name="Date" type="date" value="2020/10/16" />
        <field name="DateTime" type="datetime" value="2020-10-25 02:00:51Z" />
        <field name="Flag" type="flag" value="False" />
        <field name="Number" type="number" value="42" />
        <field name="Password" type="password" encvalue="aCpGKl8qTyp6KlgqQypZKkcqBCppKkUqRypHKkUqRCoEKnkqTypJKl8qWCpDKl4qUyoEKnkqQypHKloqRipPKmUqSCpMKl8qWSpJKksqXipFKlgq:SCpFKkgqGyoYKhkq" />
        <field name="Text" type="text" value="Some Text" />
        <field name="Time" type="time" value="03:08:16" />
        <field name="TimeSpan" type="timespan" value="9.08:07:06" />
        <field name="Image" type="image" value="16,16,137224,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAYUlEQVQ4T8WQUQoAIQhEPfocraOt4SiZLWtf+xDEqYeRjBsATEFbE4HcCytMC295T1ifxEi71yE/CpydyJPA2U+NlFvVX+JdI2/bBV4q8LgvxJ7fBO1RxqfAuSRT8NYryAO75ehBLgm9rgAAAABJRU5ErkJggg==" />
        <field name="Binary" type="binary" value="Qk32AAAAAAAAAHYAAAAoAAAAEAAAABAAAAABAAQAAAAAAIAAAADEDgAAxA4AAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AHIiIiIiIiIih3cAJ3cAJ3KHdwAiIgAncod3AAAAACdyh3cAAAAAJ3KHdwAAAAAncod3AAAAAHdyh3d3AAAnd3KHciIAAHIiIod3ACd3dwAih3cAIiJ3ACIAAHcAAAB3AAAAdwAAAHcAh3d3d3d3d3KHd3d3d3d3coiIiIiIiIiH" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="3dc21b95-0b51-4a26-8c17-e7be3509dcb7" name="Note1" type="Note">
    <narrative>GIVEN I push a GET unencrypted workqueues items request to the Blue Prism API
WHEN The response is received
THEN it contains the appropriate HTTP Status Code
AND the property values that I expect to receive for the work queue item are correctly returned</narrative>
    <display x="15" y="-120" w="360" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>8fe1c27f-69bb-499b-a8b5-f76a2463c12e</onsuccess>
  </stage>
  <stage stageid="8fe1c27f-69bb-499b-a8b5-f76a2463c12e" name="Get Un-Encrypted Item" type="SubSheet">
    <display x="15" y="-60" w="360" h="30" />
    <onsuccess>29235470-32a7-427e-bee6-7ecc733abd67</onsuccess>
    <processid>ab4ccde0-4082-4083-98a8-a036be8b3e37</processid>
  </stage>
  <stage stageid="98643028-3c86-4c0a-9709-a83d0403f542" name="Get Encrypted Item" type="SubSheet">
    <display x="15" y="60" w="360" h="30" />
    <onsuccess>4a8c19c6-a023-4409-9dad-d65736fc81ad</onsuccess>
    <processid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</processid>
  </stage>
  <stage stageid="29235470-32a7-427e-bee6-7ecc733abd67" name="Note1" type="Note">
    <narrative>GIVEN I push a GET encrypted workqueues items request to the Blue Prism API
WHEN The response is received
THEN it contains the appropriate HTTP Status Code
AND the property values that I expect to receive for the work queue item are correctly returned</narrative>
    <display x="15" y="0" w="360" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>98643028-3c86-4c0a-9709-a83d0403f542</onsuccess>
  </stage>
  <stage stageid="77f4a0be-aa0e-401c-8d50-1661193ca6d3" name="Convert Response to Collection" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" w="120" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection" />
    </outputs>
    <onsuccess>24f161b7-04a0-4f19-8430-240e7e147047</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="f5703e83-2041-49c1-88ce-c32ac8c8eabf" name="Response Code as Expected?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="15" y="-135" w="120" h="30" />
    <decision expression="[HTTP Status Code]=&quot;200&quot;" />
    <ontrue>77f4a0be-aa0e-401c-8d50-1661193ca6d3</ontrue>
    <onfalse>8430f6ab-790f-4626-a4eb-f45ae5417ed5</onfalse>
  </stage>
  <stage stageid="8430f6ab-790f-4626-a4eb-f45ae5417ed5" name="Incorrect HTTP Status Code Response" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="120" y="-135" />
    <exception localized="yes" type="Response Code Error" detail="&quot;It was expected that HTTP status code 200 would be returned. Actual returned HTTP status code was: &quot;&amp;[HTTP Status Code]" />
  </stage>
  <stage stageid="e2cd4d55-157d-41ac-8272-691c193e48d5" name="GET Work Queues Item" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-285" w="120" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 1 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>8e2c1bbe-0a9b-4b5c-9180-be53496bb72e</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="7f59a47a-361e-4aee-bfab-4d6a12209a3e" name="HTTP Status Code" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-390" y="-375" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9a3391cf-133d-45d5-8185-e83a6930aabf" name="Local Variables" type="Block">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-465" y="-540" w="390" h="480" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e49c8695-5461-4b25-a56c-3e75dcb5599e" name="Clear Ident Field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="135" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Ident&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection" />
    </outputs>
    <onsuccess>cec0b0c5-6017-4d55-9585-4f3f545fb666</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="00de690c-983f-4850-b9c9-17d5f569f3a0" name="Response Content" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-390" y="-315" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="025e439d-b4da-4332-ba42-a02a7ca1f107" name="Expected Response Content" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-390" y="-255" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">[{"id":"tempGUID","priority":6.0,"ident":0.0,"state":"Deferred","keyValue":"","status":"Running","tags":["New Tag"],"attemptNumber":1.0,"loadedDate":"0001-01-01T00:00:00Z","deferredDate":"2025-01-01T00:00:00Z","lockedDate":"0001-01-01T00:00:00Z","completedDate":"0001-01-01T00:00:00Z","exceptionedDate":"0001-01-01T00:00:00Z","lastUpdated":"0001-01-01T00:00:00Z","workTimeInSeconds":0.0,"attemptWorkTimeInSeconds":0.0,"data":[{"rows":[[{"Collection":[{"value":[{"rows":[[{"Nested Text":[{"value":"Text Nested Text","valueType":"Text"}]}]]}],"valueType":"Collection"}],"Date":[{"value":"2020-10-16T00:00:00Z","valueType":"Date"}],"DateTime":[{"value":"2020-10-25T02:00:51Z","valueType":"DateTime"}],"Flag":[{"value":false,"valueType":"Flag"}],"Number":[{"value":42.0,"valueType":"Number"}],"Password":[{"value":"bob123","valueType":"Password"}],"Text":[{"value":"Some Text","valueType":"Text"}],"Time":[{"value":"0001-01-01T03:08:16Z","valueType":"Time"}],"TimeSpan":[{"value":"9.08:07:06","valueType":"TimeSpan"}],"Image":[{"value":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABhSURBVDhPxZBRCgAhCEQ9+hyto63hKJkta1/7EMSph5GMGwBMQVsTgdwLK0wLb3lPWJ/ESLvXIT8KnJ3Ik8DZT42UW9Vf4l0jb9sFXirwuC/Ent8E7VHGp8C5JFPw1ivIA7vl6EEuCb2uAAAAAElFTkSuQmCCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==","valueType":"Image"}],"Binary":[{"value":"Qk32AAAAAAAAAHYAAAAoAAAAEAAAABAAAAABAAQAAAAAAIAAAADEDgAAxA4AAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AHIiIiIiIiIih3cAJ3cAJ3KHdwAiIgAncod3AAAAACdyh3cAAAAAJ3KHdwAAAAAncod3AAAAAHdyh3d3AAAnd3KHciIAAHIiIod3ACd3dwAih3cAIiJ3ACIAAHcAAAB3AAAAdwAAAHcAh3d3d3d3d3KHd3d3d3d3coiIiIiIiIiH","valueType":"Binary"}]}]]}],"exceptionReason":"","resource":""}]</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9202165d-6bf2-44eb-805d-60e01b34403e" name="Does data match?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="15" y="645" w="120" h="30" />
    <decision expression="[Response Content]=[Expected Response Content]" />
    <ontrue>22b9a95c-e25b-4b0e-ad5d-5245f31b92da</ontrue>
    <onfalse>eec20ebe-9c96-4cb4-a502-b2cc438e50f6</onfalse>
  </stage>
  <stage stageid="eec20ebe-9c96-4cb4-a502-b2cc438e50f6" name="Failed" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="120" y="645" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;the work queue item data returned is incorrect for work item 1 of the unencrypted work queue&quot;" />
  </stage>
  <stage stageid="4da4dcfa-3204-4250-9a03-a4ef421e33ff" name="End3" type="End">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="735" />
  </stage>
  <stage stageid="4ece936f-1e9b-4b52-bc9a-36b3bf34f51d" name="End2" type="End">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-315" />
  </stage>
  <stage stageid="d105aa9b-ec4c-4f00-8b4f-519b68460a8a" name="Convert Collection to Json" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="600" w="120" h="30" />
    <inputs>
      <input type="collection" name="Data" friendlyname="Data" expr="[Result Collection]" />
    </inputs>
    <outputs>
      <output type="text" name="JSON" friendlyname="JSON" stage="Response Content" />
    </outputs>
    <onsuccess>9202165d-6bf2-44eb-805d-60e01b34403e</onsuccess>
    <resource object="Utility - JSON" action="Collection to JSON" />
  </stage>
  <stage stageid="cec0b0c5-6017-4d55-9585-4f3f545fb666" name="Clear loaded Date field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="180" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;loadedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection" />
    </outputs>
    <onsuccess>68d4f344-87a5-4d36-b17a-d137934ab027</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="b3aceef3-0891-4923-8f38-3155ee67e4bc" name="Update GUID" type="Calculation">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="555" w="120" h="30" />
    <onsuccess>d105aa9b-ec4c-4f00-8b4f-519b68460a8a</onsuccess>
    <calculation expression="Replace([Expected Response Content], &quot;tempGUID&quot;, [workqueue Item 1 ID.Item ID])" stage="Expected Response Content" />
  </stage>
  <stage stageid="5f6ca5d1-35b9-4a41-ac2b-f2f27beb9af2" name="Recover3" type="Recover">
    <loginhibit />
    <display x="255" y="-180" w="90" h="30" />
    <onsuccess>fa92fa3b-ad01-4038-96c1-377000f74faf</onsuccess>
  </stage>
  <stage stageid="1442fb74-d976-4759-9c0e-2cc80e43e2b6" name="Recover4" type="Recover">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit />
    <display x="120" y="-285" />
    <onsuccess>b73a7d91-0a65-4dfa-a959-cb6e10812903</onsuccess>
  </stage>
  <stage stageid="b73a7d91-0a65-4dfa-a959-cb6e10812903" name="Resume3" type="Resume">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit />
    <display x="120" y="-240" />
    <onsuccess>e39f410c-88d8-4065-aa58-0176866d08c7</onsuccess>
  </stage>
  <stage stageid="e39f410c-88d8-4065-aa58-0176866d08c7" name="GET Work Queues Item" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="-180" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 1 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>8e2c1bbe-0a9b-4b5c-9180-be53496bb72e</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="8e2c1bbe-0a9b-4b5c-9180-be53496bb72e" name="Anchor1" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-180" w="10" h="10" />
    <onsuccess>f5703e83-2041-49c1-88ce-c32ac8c8eabf</onsuccess>
  </stage>
  <stage stageid="c652a782-48db-4bcd-adef-ba88a803c4ca" name="Get Work Queues (item 1)" type="Block">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-315" w="225" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="68d4f344-87a5-4d36-b17a-d137934ab027" name="Clear last updated field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="225" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;lastUpdated&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection" />
    </outputs>
    <onsuccess>8ac90dca-9e96-486a-bc55-492746541a54</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="7c23741e-68cb-47e1-9991-685eab03a750" name="Clear resource name field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="510" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;resource&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection" />
    </outputs>
    <onsuccess>b3aceef3-0891-4923-8f38-3155ee67e4bc</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="265b391f-44db-4dd7-ac3e-764d5402af72" name="validate HTTP responses" type="SubSheetInfo">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="-225" y="-270" w="150" h="90" />
  </stage>
  <stage stageid="ff81852e-8119-4185-9099-6360749c2537" name="validate HTTP responses" type="SubSheet">
    <display x="15" y="-180" w="360" h="30" />
    <onsuccess>3dc21b95-0b51-4a26-8c17-e7be3509dcb7</onsuccess>
    <processid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</processid>
  </stage>
  <stage stageid="cc37e739-4c27-49c2-aa74-8b5a31b16c41" name="Note2" type="Note">
    <narrative>Given that when either an non existant, or incorrect formated work queue item GUID is supplied to the API, the correct documented response in the form of a HTTP status code is returned.</narrative>
    <display x="15" y="-240" w="360" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="339966" />
    <onsuccess>ff81852e-8119-4185-9099-6360749c2537</onsuccess>
  </stage>
  <stage stageid="f4edd9b0-2a52-4ae5-b73b-1579c57e91ab" name="Start" type="Start">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <preconditions>
      <condition narrative="testdefs.json will import a release with a work queue included to allow this test to occur" />
    </preconditions>
    <display x="90" y="-690" />
    <onsuccess>a6a28c77-616e-4324-993e-177bcd287f4d</onsuccess>
  </stage>
  <stage stageid="f2652351-f734-468e-9eb7-15c4fecf15af" name="End" type="End">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="90" y="690" />
  </stage>
  <stage stageid="a6a28c77-616e-4324-993e-177bcd287f4d" name="Given:" type="Note">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <narrative>Given: That as a user I wish to submit an API request to GET the details of the specified workqueue item and the user supplies a non guid</narrative>
    <display x="90" y="-630" w="180" h="60" />
    <onsuccess>8d325e27-b5ba-49a2-a687-66c15b53917b</onsuccess>
  </stage>
  <stage stageid="8d325e27-b5ba-49a2-a687-66c15b53917b" name="When:" type="Note">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <narrative>When: The submitted request contains a non guid</narrative>
    <display x="90" y="-540" w="180" h="60" />
    <onsuccess>4aa2d713-d941-4b24-8cea-bbb4b23a4cd6</onsuccess>
  </stage>
  <stage stageid="9d5d8faf-c87d-4e6a-80c2-0ddb91b79c75" name="Then:" type="Note">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <narrative>Then: No workqueue item details are returned, and a status code of 400 is returned.</narrative>
    <display x="90" y="-360" w="180" h="60" />
    <onsuccess>0d5498ad-92cc-4249-828a-2ff5632fbfbe</onsuccess>
  </stage>
  <stage stageid="4aa2d713-d941-4b24-8cea-bbb4b23a4cd6" name="Blue Prism API::POST Work Queues" type="Action">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="-480" w="90" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[non guid]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>325ed7f4-0e49-42af-aea8-8d8991a522b5</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="9db51283-7cbe-4c79-978b-abb59c7720b0" name="non guid" type="Data">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="-165" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Pants</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="96dd16d8-b95b-497a-be31-ff7f37f1e661" name="Attempt 1 to use a non guid input parameter" type="Block">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-585" w="315" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0d5498ad-92cc-4249-828a-2ff5632fbfbe" name="Error code of 400 returned?" type="Decision">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="90" y="-285" />
    <decision expression="InStr(ExceptionDetail(), &quot;HTTP Status Code: 400&quot;)&lt;&gt;0&#xA;AND&#xA;InStr(ExceptionDetail(), &quot;The request is invalid&quot;)&lt;&gt;0" />
    <ontrue>36e8a173-a4d9-4fb5-bdaf-031af62afae4</ontrue>
    <onfalse>cc2ac900-f347-4183-9e1b-24103f7077b2</onfalse>
  </stage>
  <stage stageid="05a2f9f9-3ed3-4c0c-b082-164cbbc58a09" name="local variables" type="Block">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="-195" w="180" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="36e8a173-a4d9-4fb5-bdaf-031af62afae4" name="Resume Test process following a negative test scenario" type="Resume">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit />
    <display x="90" y="-240" />
    <onsuccess>7355611d-4ffe-4b84-a8a8-487d1c3974c7</onsuccess>
  </stage>
  <stage stageid="8fb30a85-c953-48f2-b071-49cd8a1bb720" name="Given:" type="Note">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <narrative>Given: That as a user I wish to submit an API request to GET the details of the specified workqueue item and the user supplies a guid of a workqueue item that does not exist in the database</narrative>
    <display x="90" y="240" w="180" h="60" />
    <onsuccess>a90955a4-fe4a-447e-99e0-efb378f0a17f</onsuccess>
  </stage>
  <stage stageid="a90955a4-fe4a-447e-99e0-efb378f0a17f" name="When:" type="Note">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <narrative>When: The submitted request contains a valid guid, but one that does not exist in the database</narrative>
    <display x="90" y="330" w="180" h="60" />
    <onsuccess>71366612-04c6-4b52-a057-5b16343295b5</onsuccess>
  </stage>
  <stage stageid="8a11496a-5323-4559-9f8f-6f3fe34f6327" name="Then:" type="Note">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <narrative>Then: No workqueue item details are returned, and a status code of 404 is returned.</narrative>
    <display x="90" y="510" w="180" h="60" />
    <onsuccess>2f6e0c2a-59de-4647-9dab-eb8990cad529</onsuccess>
  </stage>
  <stage stageid="71366612-04c6-4b52-a057-5b16343295b5" name="Blue Prism API::POST Work Queues" type="Action">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="390" w="90" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[non existent guid]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>b777e30c-9cab-42b5-b798-7e1307dca3c4</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="20fa9864-b21d-4727-adc3-4b0048ddba3f" name="Attempt to use a non existent guid" type="Block">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="285" w="300" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b777e30c-9cab-42b5-b798-7e1307dca3c4" name="Exception when attempting to use a non existent guid" type="Exception">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="375" y="390" w="90" h="60" />
    <exception localized="yes" type="" detail="&quot;Exception as expected when attempting to use a non existent guid&quot;" />
  </stage>
  <stage stageid="597bbd4a-6007-47c8-83ed-1f623a6858f2" name="Recover from exception when attempting to use a non existent guid " type="Recover">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit />
    <display x="90" y="435" w="120" h="30" />
    <onsuccess>8a11496a-5323-4559-9f8f-6f3fe34f6327</onsuccess>
  </stage>
  <stage stageid="2f6e0c2a-59de-4647-9dab-eb8990cad529" name="Error code of 400 returned?" type="Decision">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="90" y="585" />
    <decision expression="InStr(ExceptionDetail(), &quot;HTTP Status Code: 404&quot;)&lt;&gt;0&#xA;AND&#xA;InStr(ExceptionDetail(), &quot;A queue item with the given ID could not be found&quot;)&lt;&gt;0" />
    <ontrue>79a023da-d590-4aa7-94fd-2f82ca467bfb</ontrue>
    <onfalse>da803683-217d-40a4-a075-4e7320d2ed33</onfalse>
  </stage>
  <stage stageid="da803683-217d-40a4-a075-4e7320d2ed33" name="Https status code of 404 not returned as expected" type="Exception">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="195" y="585" w="90" h="60" />
    <exception localized="yes" type="Bug" detail="&quot;The expected responses from the api, when attempting to use a non guid as an input parameter, was not seen&quot;" />
  </stage>
  <stage stageid="79a023da-d590-4aa7-94fd-2f82ca467bfb" name="Resume Test process following a negative test scenario" type="Resume">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit />
    <display x="90" y="630" />
    <onsuccess>f2652351-f734-468e-9eb7-15c4fecf15af</onsuccess>
  </stage>
  <stage stageid="49d2d423-8cfa-4ec6-a946-87cb96a65692" name="non existent guid" type="Data">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="-120" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">00000000-0000-0000-0000-000000000000</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="85cc9db9-d6a7-4e38-9e22-f9cd68d70bd2" name="Add item 2 To Queue" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="15" y="-765" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name (1)]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Dummy Queue Item Data]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="99" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;test tag&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="&quot;QA&quot;" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="">
        <validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" />
      </input>
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="workqueue Item 2 ID" />
    </outputs>
    <onsuccess>5229aa93-1c68-49e0-b05e-65d6c4112aa2</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="5229aa93-1c68-49e0-b05e-65d6c4112aa2" name="Add item 3 To Queue" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="15" y="-720" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name (1)]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Dummy Queue Item Data]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="6" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;New Tag&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="&quot;Running&quot;" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="">
        <validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" />
      </input>
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="workqueue Item 3 ID" />
    </outputs>
    <onsuccess>52db6928-87be-48e0-af2d-e9306831dd6d</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="b723804f-ca40-48b2-998c-a65e25daefe5" name="add items to work queue" type="Block">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-885" w="225" h="240" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0b904a9a-bf8d-4013-b6b3-da97f0be3cfa" name="Work Queues::Mark Exception (item 2)" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="15" y="-495" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[workqueue Item 2 ID.Item ID]" />
      <input type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="A description of the reason for the exception" expr="&quot;QA exception test&quot;" />
      <input type="flag" name="Retry" friendlyname="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="False" />
      <input type="flag" name="Keep Locked" friendlyname="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="True" />
    </inputs>
    <outputs>
      <output type="text" name="New Item ID" friendlyname="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="" />
    </outputs>
    <onsuccess>aafa919c-1a3a-4d1d-bb56-e6838aaa56ee</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" />
  </stage>
  <stage stageid="8f828066-2af9-4395-8e9c-2d8efa2fadbc" name="Work Queues::Mark Completed (item 3)" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Marks the item as completed, by updating the Completed timestamp and setting Locked to null. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="15" y="-360" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[workqueue Item 3 ID.Item ID]" />
    </inputs>
    <onsuccess>e2cd4d55-157d-41ac-8272-691c193e48d5</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Completed" />
  </stage>
  <stage stageid="f25e83dd-7ed5-49ac-b0f2-0b5f791491bf" name="create workqueue items that are not &quot;pending&quot;" type="Block">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-630" w="225" h="300" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4a8c19c6-a023-4409-9dad-d65736fc81ad" name="Anchor2" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="15" y="120" w="10" h="10" />
    <onsuccess>8bb6efa7-4d59-4701-aa84-0abe30dc3287</onsuccess>
  </stage>
  <stage stageid="52db6928-87be-48e0-af2d-e9306831dd6d" name="Work Queues::Get Item By ID (item 2)" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>This action gets the item corresponding to the Id</narrative>
    <display x="15" y="-585" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue." expr="[Queue Name (1)]" />
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The Id of the queue item" expr="[workqueue Item 2 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>0b904a9a-bf8d-4013-b6b3-da97f0be3cfa</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item By ID" />
  </stage>
  <stage stageid="aafa919c-1a3a-4d1d-bb56-e6838aaa56ee" name="Work Queues::Get Item By ID (item 3)" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>This action gets the item corresponding to the Id</narrative>
    <display x="15" y="-450" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue." expr="[Queue Name (1)]" />
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The Id of the queue item" expr="[workqueue Item 3 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>8f828066-2af9-4395-8e9c-2d8efa2fadbc</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item By ID" />
  </stage>
  <stage stageid="17db3b0c-a51c-47b7-9691-e0c84cacf061" name="Note3" type="Note">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>Item 2 can't have a defer date value else I cannot turn it into an item with an exception later in the process</narrative>
    <display x="300" y="-765" w="240" h="30" />
  </stage>
  <stage stageid="53ce9f32-15a4-403c-8ced-2641f02444cd" name="Note3" type="Note">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>Item 3 can't have a defer date value else I cannot turn it into an item that is marked as completed  later in the process</narrative>
    <display x="300" y="-720" w="240" h="30" />
  </stage>
  <stage stageid="b65ce8d4-90e6-4cb3-903b-bfe492725315" name="why do we clear the indent field??" type="Note">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>We clear the indent field as we cannot determine what the value will be each time, especially due to the tests that will have been run previously in the nightly test run.</narrative>
    <display x="180" y="135" w="150" h="90" />
  </stage>
  <stage stageid="b0779ed2-b67d-4bcf-a6e3-4f22b2710d2d" name="why do we clear the loaded field??" type="Note">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>We clear the loaded field as we cannot determine what the value will be each time, even when de bugging and using the NOW() function there can be 1/2 seconds difference between the datetime recorded by the NOW calc stage, and the datetime in the database. We'could' use trim. But because that 1/2 second diffence might affect, the minute or hour (or indeed date if executed around mindnight) we would probably get a high failure rate because of it. So the "safe" option is to trim it out. </narrative>
    <display x="-180" y="180" w="150" h="90" />
  </stage>
  <stage stageid="626690c1-b720-4c36-bcd5-8134417db2e9" name="why do we clear the loaded field??" type="Note">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>We clear the lastupdated field as we cannot determine what the value will be each time, even when de bugging and using the NOW() function there can be 1/2 seconds difference between the datetime recorded by the NOW calc stage, and the datetime in the database. We'could' use trim. But because that 1/2 second diffence might affect, the minute or hour (or indeed date if executed around mindnight) we would probably get a high failure rate because of it. So the "safe" option is to trim it out. </narrative>
    <display x="180" y="240" w="150" h="90" />
  </stage>
  <stage stageid="631ce758-4e64-4093-9d37-2b75c0b509ee" name="get resource name" type="Calculation">
    <loginhibit onsuccess="true" />
    <display x="15" y="-360" w="90" h="30" />
    <onsuccess>95d8a8b4-41c6-45bc-939a-d1b9241f0630</onsuccess>
    <calculation expression="GetResourceName()" stage="resourceName" />
  </stage>
  <stage stageid="49ee0809-e6fc-40fd-bb12-798751c7f23f" name="workqueue Item 1 ID" type="Collection">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-390" y="-345" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="465b7219-b1b1-40a1-927f-12a840cdc286" name="workqueue Item 2 ID" type="Collection">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-270" y="-345" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="1747ea59-8e83-434c-a269-15dcfaa36531" name="workqueue Item 3 ID" type="Collection">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-150" y="-345" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="8ac90dca-9e96-486a-bc55-492746541a54" name="Note4" type="Note">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>Now, clear out the resourcename field to allow the other fields to be verified. Because we can't use functions to check the value of the field "resourcename" easily once it is a block of JSON, And this seems the neatest solution for now. </narrative>
    <display x="15" y="450" w="210" h="60" />
    <onsuccess>7c23741e-68cb-47e1-9991-685eab03a750</onsuccess>
  </stage>
  <stage stageid="17edc222-1378-4788-8a73-34681ee74d0e" name="Convert Response to Collection" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="-90" w="120" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content 2]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection 2" />
    </outputs>
    <onsuccess>74b689e2-867c-4c58-bc48-cc1ef88728ae</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="6b6c79fb-3687-4122-a14b-a4cebcab13da" name="Response Code as Expected?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="435" y="-135" w="120" h="30" />
    <decision expression="[HTTP Status Code 2]=&quot;200&quot;" />
    <ontrue>17edc222-1378-4788-8a73-34681ee74d0e</ontrue>
    <onfalse>5c3b29fe-75db-4fe2-b119-43c7973c753b</onfalse>
  </stage>
  <stage stageid="5c3b29fe-75db-4fe2-b119-43c7973c753b" name="Incorrect HTTP Status Code Response" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="540" y="-135" />
    <exception localized="yes" type="Response Code Error" detail="&quot;It was expected that HTTP status code 200 would be returned. Actual returned HTTP status code was: &quot;&amp;[HTTP Status Code]" />
  </stage>
  <stage stageid="a7b09864-5300-4fb8-955e-e27f170eab9c" name="GET Work Queues Item 2" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="-285" w="120" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 2 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 2" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 2" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>e307f8e3-f5aa-4e97-ae97-d7eee86f2add</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="d3566fa0-89d3-4305-9684-b66f7259d95f" name="Clear Ident Field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="150" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Ident&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>d40c431d-41d5-40d4-8f18-abef6c293425</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="96547160-e4bd-4a95-b864-fab5ddccaabc" name="Does data match?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="435" y="645" w="120" h="30" />
    <decision expression="[Response Content 2]=[Expected Response Content 2]" />
    <ontrue>ca08032e-5a9c-49cb-ba84-6e379eb777af</ontrue>
    <onfalse>7f46be50-2a0d-46a4-b9eb-d5f082154aef</onfalse>
  </stage>
  <stage stageid="7f46be50-2a0d-46a4-b9eb-d5f082154aef" name="Failed" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="540" y="645" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;the work queue item data returned is incorrect for work item 2 of the unencrypted work queue&quot;" />
  </stage>
  <stage stageid="35863a08-0e49-4023-938e-b87010a459b8" name="Convert Collection to Json" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="600" w="120" h="30" />
    <inputs>
      <input type="collection" name="Data" friendlyname="Data" expr="[Result Collection 2]" />
    </inputs>
    <outputs>
      <output type="text" name="JSON" friendlyname="JSON" stage="Response Content 2" />
    </outputs>
    <onsuccess>96547160-e4bd-4a95-b864-fab5ddccaabc</onsuccess>
    <resource object="Utility - JSON" action="Collection to JSON" />
  </stage>
  <stage stageid="653662a8-e526-4de6-a08e-35f0334fbf3c" name="Clear loaded Date field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="240" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;loadedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>b7f88910-5925-4c7d-9344-5eb0818582ca</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="828c9826-bb57-4fdb-a536-b921e5ae5602" name="Update GUID" type="Calculation">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="555" w="120" h="30" />
    <onsuccess>35863a08-0e49-4023-938e-b87010a459b8</onsuccess>
    <calculation expression="Replace([Expected Response Content 2], &quot;tempGUID&quot;, [workqueue Item 2 ID.Item ID])" stage="Expected Response Content 2" />
  </stage>
  <stage stageid="370d288f-6ebf-40c9-bf55-225a3fb6a50b" name="Recover4" type="Recover">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit />
    <display x="540" y="-285" />
    <onsuccess>a18287a3-071e-4285-bd94-622063e8f595</onsuccess>
  </stage>
  <stage stageid="a18287a3-071e-4285-bd94-622063e8f595" name="Resume3" type="Resume">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit />
    <display x="540" y="-240" />
    <onsuccess>c1f74aa7-f0dd-4a81-8355-40cd5a4e8e5a</onsuccess>
  </stage>
  <stage stageid="c1f74aa7-f0dd-4a81-8355-40cd5a4e8e5a" name="GET Work Queues Item 2" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="540" y="-180" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 2 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 2" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 2" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>e307f8e3-f5aa-4e97-ae97-d7eee86f2add</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="e307f8e3-f5aa-4e97-ae97-d7eee86f2add" name="Anchor1" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="-180" w="10" h="10" />
    <onsuccess>6b6c79fb-3687-4122-a14b-a4cebcab13da</onsuccess>
  </stage>
  <stage stageid="46821527-4ea8-4a47-929d-cf14780d79ad" name="Get Work Queues (item 2)" type="Block">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="360" y="-315" w="225" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b7f88910-5925-4c7d-9344-5eb0818582ca" name="Clear last updated field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="285" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;lastUpdated&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>abda4f38-d265-4cfc-9ba1-f25335fc7ac0</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="a922373a-cd42-4914-9e60-2ea9db5c08c8" name="Clear resource name field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="510" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;resource&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>828c9826-bb57-4fdb-a536-b921e5ae5602</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="85de334f-3d81-4e38-bb50-b00ace1e8255" name="Note4" type="Note">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>Now, clear out the resourcename field to allow the other fields to be verified. Because we can't use functions to check the value of the field "resourcename" easily once it is a block of JSON, And this seems the neatest solution for now. </narrative>
    <display x="435" y="435" w="210" h="60" />
    <onsuccess>a922373a-cd42-4914-9e60-2ea9db5c08c8</onsuccess>
  </stage>
  <stage stageid="22b9a95c-e25b-4b0e-ad5d-5245f31b92da" name="Anchor3" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="690" w="10" h="10" />
    <onsuccess>8e6bce28-97ac-43bf-b7a2-27733d48a3c6</onsuccess>
  </stage>
  <stage stageid="8e6bce28-97ac-43bf-b7a2-27733d48a3c6" name="Anchor7" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="690" w="10" h="10" />
    <onsuccess>8990df0d-04bf-422b-b342-bbde0afc4f0b</onsuccess>
  </stage>
  <stage stageid="8990df0d-04bf-422b-b342-bbde0afc4f0b" name="Anchor8" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="-135" w="10" h="10" />
    <onsuccess>3571badf-7623-41c5-8c66-1e9c5b070abf</onsuccess>
  </stage>
  <stage stageid="3571badf-7623-41c5-8c66-1e9c5b070abf" name="Anchor10" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="-360" w="10" h="10" />
    <onsuccess>3e7f8863-ed59-42de-b50f-2cee4b6e0edf</onsuccess>
  </stage>
  <stage stageid="3e7f8863-ed59-42de-b50f-2cee4b6e0edf" name="Anchor11" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="-360" w="10" h="10" />
    <onsuccess>a7b09864-5300-4fb8-955e-e27f170eab9c</onsuccess>
  </stage>
  <stage stageid="43dd2127-2a1b-40a4-8e2d-821d1a9be0f1" name="Expected Response Content 2" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-270" y="-255" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">[{"id":"tempGUID","priority":99.0,"ident":0.0,"state":"Exceptioned","keyValue":"","status":"QA","tags":["test tag","Exception: QA exception test"],"attemptNumber":1.0,"loadedDate":"0001-01-01T00:00:00Z","deferredDate":"0001-01-01T00:00:00Z","lockedDate":"0001-01-01T00:00:00Z","completedDate":"0001-01-01T00:00:00Z","exceptionedDate":"0001-01-01T00:00:00Z","lastUpdated":"0001-01-01T00:00:00Z","workTimeInSeconds":0.0,"attemptWorkTimeInSeconds":0.0,"data":[{"rows":[[{"Collection":[{"value":[{"rows":[[{"Nested Text":[{"value":"Text Nested Text","valueType":"Text"}]}]]}],"valueType":"Collection"}],"Date":[{"value":"2020-10-16T00:00:00Z","valueType":"Date"}],"DateTime":[{"value":"2020-10-25T02:00:51Z","valueType":"DateTime"}],"Flag":[{"value":false,"valueType":"Flag"}],"Number":[{"value":42.0,"valueType":"Number"}],"Password":[{"value":"bob123","valueType":"Password"}],"Text":[{"value":"Some Text","valueType":"Text"}],"Time":[{"value":"0001-01-01T03:08:16Z","valueType":"Time"}],"TimeSpan":[{"value":"9.08:07:06","valueType":"TimeSpan"}],"Image":[{"value":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABhSURBVDhPxZBRCgAhCEQ9+hyto63hKJkta1/7EMSph5GMGwBMQVsTgdwLK0wLb3lPWJ/ESLvXIT8KnJ3Ik8DZT42UW9Vf4l0jb9sFXirwuC/Ent8E7VHGp8C5JFPw1ivIA7vl6EEuCb2uAAAAAElFTkSuQmCCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==","valueType":"Image"}],"Binary":[{"value":"Qk32AAAAAAAAAHYAAAAoAAAAEAAAABAAAAABAAQAAAAAAIAAAADEDgAAxA4AAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AHIiIiIiIiIih3cAJ3cAJ3KHdwAiIgAncod3AAAAACdyh3cAAAAAJ3KHdwAAAAAncod3AAAAAHdyh3d3AAAnd3KHciIAAHIiIod3ACd3dwAih3cAIiJ3ACIAAHcAAAB3AAAAdwAAAHcAh3d3d3d3d3KHd3d3d3d3coiIiIiIiIiH","valueType":"Binary"}]}]]}],"exceptionReason":"QA exception test","resource":""}]</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="15ee2ebb-29ea-4db5-a06c-b4e5bb6fbebf" name="Response Content 2" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-270" y="-315" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0a44be0f-ac28-4f71-ba87-0dfa3dd7bd2b" name="HTTP Status Code 2" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-270" y="-375" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d7f98d23-0634-4af3-bebb-3bbae42d02f8" name="HTTP Status Code 3" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-150" y="-375" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9bf368c4-34e0-4a5b-acf2-13fca37342b7" name="Expected Response Content 3" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-150" y="-255" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">[{"id":"tempGUID","priority":6.0,"ident":0.0,"state":"Completed","keyValue":"","status":"Running","tags":["New Tag"],"attemptNumber":1.0,"loadedDate":"0001-01-01T00:00:00Z","deferredDate":"0001-01-01T00:00:00Z","lockedDate":"0001-01-01T00:00:00Z","completedDate":"0001-01-01T00:00:00Z","exceptionedDate":"0001-01-01T00:00:00Z","lastUpdated":"0001-01-01T00:00:00Z","workTimeInSeconds":0.0,"attemptWorkTimeInSeconds":0.0,"data":[{"rows":[[{"Collection":[{"value":[{"rows":[[{"Nested Text":[{"value":"Text Nested Text","valueType":"Text"}]}]]}],"valueType":"Collection"}],"Date":[{"value":"2020-10-16T00:00:00Z","valueType":"Date"}],"DateTime":[{"value":"2020-10-25T02:00:51Z","valueType":"DateTime"}],"Flag":[{"value":false,"valueType":"Flag"}],"Number":[{"value":42.0,"valueType":"Number"}],"Password":[{"value":"bob123","valueType":"Password"}],"Text":[{"value":"Some Text","valueType":"Text"}],"Time":[{"value":"0001-01-01T03:08:16Z","valueType":"Time"}],"TimeSpan":[{"value":"9.08:07:06","valueType":"TimeSpan"}],"Image":[{"value":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABhSURBVDhPxZBRCgAhCEQ9+hyto63hKJkta1/7EMSph5GMGwBMQVsTgdwLK0wLb3lPWJ/ESLvXIT8KnJ3Ik8DZT42UW9Vf4l0jb9sFXirwuC/Ent8E7VHGp8C5JFPw1ivIA7vl6EEuCb2uAAAAAElFTkSuQmCCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==","valueType":"Image"}],"Binary":[{"value":"Qk32AAAAAAAAAHYAAAAoAAAAEAAAABAAAAABAAQAAAAAAIAAAADEDgAAxA4AAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AHIiIiIiIiIih3cAJ3cAJ3KHdwAiIgAncod3AAAAACdyh3cAAAAAJ3KHdwAAAAAncod3AAAAAHdyh3d3AAAnd3KHciIAAHIiIod3ACd3dwAih3cAIiJ3ACIAAHcAAAB3AAAAdwAAAHcAh3d3d3d3d3KHd3d3d3d3coiIiIiIiIiH","valueType":"Binary"}]}]]}],"exceptionReason":"","resource":""}]</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="80c5ee31-b62d-438d-b55b-0aeff84e62c7" name="Response Content 3" type="Data">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-150" y="-315" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="37f2bc3c-5bce-46a8-bba6-b7a85d90193d" name="Convert Response to Collection" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="-90" w="120" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content 3]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection 3" />
    </outputs>
    <onsuccess>1f2b41bd-5904-4886-9762-c44e60f8c791</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="7860b1b7-9df7-4fe8-bb06-e2d5da90b994" name="Response Code as Expected?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="840" y="-135" w="120" h="30" />
    <decision expression="[HTTP Status Code 3]=&quot;200&quot;" />
    <ontrue>37f2bc3c-5bce-46a8-bba6-b7a85d90193d</ontrue>
    <onfalse>b84f1b57-294e-4f11-96e2-ddf30424b47c</onfalse>
  </stage>
  <stage stageid="b84f1b57-294e-4f11-96e2-ddf30424b47c" name="Incorrect HTTP Status Code Response" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="945" y="-135" />
    <exception localized="yes" type="Response Code Error" detail="&quot;It was expected that HTTP status code 200 would be returned. Actual returned HTTP status code was: &quot;&amp;[HTTP Status Code]" />
  </stage>
  <stage stageid="3ef4bd7b-ef0e-4621-98e0-75feddfa8944" name="GET Work Queues Item 3" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="-285" w="120" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 3 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 3" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 3" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>644620e3-c8ef-4351-a0ae-087f425773ca</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="f29b72d6-9572-435c-930d-ac776a35f290" name="Clear Ident Field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="150" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Ident&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>03e2c679-a80b-4586-9f67-d668324225e3</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="3cd8a0de-0682-414a-9f0e-89235fc82728" name="Does data match?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="840" y="630" w="120" h="30" />
    <decision expression="[Response Content 3]=[Expected Response Content 3]" />
    <ontrue>4da4dcfa-3204-4250-9a03-a4ef421e33ff</ontrue>
    <onfalse>49151cab-55a6-4b6e-8e92-233686373655</onfalse>
  </stage>
  <stage stageid="49151cab-55a6-4b6e-8e92-233686373655" name="Failed" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="975" y="630" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;the work queue item data returned is incorrect for work item 3 of the unencrypted work queue&quot;" />
  </stage>
  <stage stageid="0b7eaf7a-771b-4be1-91ed-efe3e882715b" name="Convert Collection to Json" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="585" w="120" h="30" />
    <inputs>
      <input type="collection" name="Data" friendlyname="Data" expr="[Result Collection 3]" />
    </inputs>
    <outputs>
      <output type="text" name="JSON" friendlyname="JSON" stage="Response Content 3" />
    </outputs>
    <onsuccess>3cd8a0de-0682-414a-9f0e-89235fc82728</onsuccess>
    <resource object="Utility - JSON" action="Collection to JSON" />
  </stage>
  <stage stageid="03e2c679-a80b-4586-9f67-d668324225e3" name="Clear loaded Date field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="195" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;loadedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>ef539e7a-e35f-4ebf-a9d0-5388ce220b09</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="fb8a9b8c-f3c7-4863-8b01-4bec5e9f94ad" name="Update GUID" type="Calculation">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="540" w="120" h="30" />
    <onsuccess>0b7eaf7a-771b-4be1-91ed-efe3e882715b</onsuccess>
    <calculation expression="Replace([Expected Response Content 3], &quot;tempGUID&quot;, [workqueue Item 3 ID.Item ID])" stage="Expected Response Content 3" />
  </stage>
  <stage stageid="5841f01f-e1c0-41f0-9ea1-5e0b0d32b134" name="Recover4" type="Recover">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit />
    <display x="945" y="-285" />
    <onsuccess>f8f88eba-9b40-4927-aee5-4238c08822f1</onsuccess>
  </stage>
  <stage stageid="f8f88eba-9b40-4927-aee5-4238c08822f1" name="Resume3" type="Resume">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit />
    <display x="945" y="-240" />
    <onsuccess>b29de00f-0383-4d6e-8007-0e6fa5a9a97e</onsuccess>
  </stage>
  <stage stageid="b29de00f-0383-4d6e-8007-0e6fa5a9a97e" name="GET Work Queues Item 3" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="945" y="-180" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 3 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 3" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 3" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>644620e3-c8ef-4351-a0ae-087f425773ca</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="644620e3-c8ef-4351-a0ae-087f425773ca" name="Anchor1" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="-180" w="10" h="10" />
    <onsuccess>7860b1b7-9df7-4fe8-bb06-e2d5da90b994</onsuccess>
  </stage>
  <stage stageid="1472f5ec-c10a-41f6-9689-beddd5d46fb7" name="Get Work Queues (item 3)" type="Block">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="765" y="-315" w="225" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="458127a0-284e-4ff0-8edc-576945ae33f8" name="Clear last updated field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="285" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;lastUpdated&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>2b158187-5336-4660-8e1e-6aa10fa560a1</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="fc57be51-7057-4d03-a626-ca6d53213f94" name="Clear resource name field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="495" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;resource&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>fb8a9b8c-f3c7-4863-8b01-4bec5e9f94ad</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="1347fc17-2ef9-491e-9c13-4a3df28219a5" name="Note4" type="Note">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <narrative>Now, clear out the resourcename field to allow the other fields to be verified. Because we can't use functions to check the value of the field "resourcename" easily once it is a block of JSON, And this seems the neatest solution for now. </narrative>
    <display x="840" y="435" w="210" h="60" />
    <onsuccess>fc57be51-7057-4d03-a626-ca6d53213f94</onsuccess>
  </stage>
  <stage stageid="ec4d87c6-324e-4e0b-ad0e-afa8633704cd" name="Anchor7" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="705" y="690" w="10" h="10" />
    <onsuccess>c156253a-428f-467b-bc2d-496a8b4b3938</onsuccess>
  </stage>
  <stage stageid="c156253a-428f-467b-bc2d-496a8b4b3938" name="Anchor8" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="705" y="-135" w="10" h="10" />
    <onsuccess>761d8978-c056-45fb-9f9d-7c2dfcdda12d</onsuccess>
  </stage>
  <stage stageid="761d8978-c056-45fb-9f9d-7c2dfcdda12d" name="Anchor10" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="705" y="-360" w="10" h="10" />
    <onsuccess>5a58b069-6a06-4878-b6c8-d2ee94e66a89</onsuccess>
  </stage>
  <stage stageid="5a58b069-6a06-4878-b6c8-d2ee94e66a89" name="Anchor11" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="-360" w="10" h="10" />
    <onsuccess>3ef4bd7b-ef0e-4621-98e0-75feddfa8944</onsuccess>
  </stage>
  <stage stageid="ca08032e-5a9c-49cb-ba84-6e379eb777af" name="Anchor12" type="Anchor">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="690" w="10" h="10" />
    <onsuccess>ec4d87c6-324e-4e0b-ad0e-afa8633704cd</onsuccess>
  </stage>
  <stage stageid="d40c431d-41d5-40d4-8f18-abef6c293425" name="Clear exceptionedDate Field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="195" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;exceptionedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>653662a8-e526-4de6-a08e-35f0334fbf3c</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="ef539e7a-e35f-4ebf-a9d0-5388ce220b09" name="Clear completedDate field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="240" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;completedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>458127a0-284e-4ff0-8edc-576945ae33f8</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="abda4f38-d265-4cfc-9ba1-f25335fc7ac0" name="Clear workTimeInSeconds field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="330" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;workTimeInSeconds&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0.0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>d57963c3-b7d0-4b27-98a9-6afe75e14903</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="d57963c3-b7d0-4b27-98a9-6afe75e14903" name="Clear last attemptWorkTimeInSeconds field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="435" y="375" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;attemptWorkTimeInSeconds&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0.0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>85de334f-3d81-4e38-bb50-b00ace1e8255</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="2b158187-5336-4660-8e1e-6aa10fa560a1" name="Clear workTimeInSeconds field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="330" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;workTimeInSeconds&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0.0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>e709cb76-6604-4a98-a3b6-535285429acb</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="e709cb76-6604-4a98-a3b6-535285429acb" name="Clear last attemptWorkTimeInSeconds field" type="Action">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="840" y="375" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;attemptWorkTimeInSeconds&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0.0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>1347fc17-2ef9-491e-9c13-4a3df28219a5</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="fac33ecf-b5f8-43fe-adc5-5713f1db8154" name="Note5" type="Note">
    <subsheetid>86c68210-f036-4137-95d7-f70cc6db3783</subsheetid>
    <narrative>The "rule" is that any automated test must tidy up after itself to leave the environment is the smae state it was in when the test started to run. However,
I can't deliete the encryption scheme because queue 2 is using the encryption scheme
I cannot delete queue 2 as it has items within it
I cannot delete all the items in queue 2 because there is 1 defered pending item. I cannot reset the refer date as the item needs to be "locked" but I cannot lock the item because it is defered. The "destroy queue" in the queue utils work object, does not work, and generates an automate C error. 

I cannot delete queue 1 as it has items within it
I cannot delete all the items in queue 1 because there is 1 defered pending item. I cannot reset the refer date as the item needs to be "locked" but I cannot lock the item because it is defered. The "destroy queue" in the queue utils work object, does not work, and generates an automate C error. </narrative>
    <display x="405" y="-240" w="300" h="210" />
    <onsuccess>4f109f33-6345-4696-af97-7258a6d53f06</onsuccess>
  </stage>
  <stage stageid="325ed7f4-0e49-42af-aea8-8d8991a522b5" name="Exception when attempting to use a non guid as an input parameter" type="Exception">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="390" y="-480" w="90" h="60" />
    <exception localized="yes" type="" detail="&quot;Exception as expected when attempting to use a non guid as an input parameter&quot;" />
  </stage>
  <stage stageid="de8b15d3-344c-43be-9142-a07500a3acd6" name="Recover from exception when attempting to use a non guid input parameter" type="Recover">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit />
    <display x="90" y="-435" w="120" h="30" />
    <onsuccess>9d5d8faf-c87d-4e6a-80c2-0ddb91b79c75</onsuccess>
  </stage>
  <stage stageid="c4948aed-0790-41ef-b28b-5a417f12204c" name="Result Collection" type="Collection">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-390" y="-285" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="id" type="text" />
      <field name="priority" type="number" />
      <field name="ident" type="number" />
      <field name="state" type="text" />
      <field name="position" type="number" />
      <field name="keyValue" type="text" />
      <field name="status" type="text" />
      <field name="tags" type="collection" />
      <field name="attemptNumber" type="number" />
      <field name="loadedDate" type="datetime" />
      <field name="deferredDate" type="datetime" />
      <field name="lockedDate" type="datetime" />
      <field name="completedDate" type="datetime" />
      <field name="exceptionedDate" type="datetime" />
      <field name="lastUpdated" type="datetime" />
      <field name="workTimeInSeconds" type="number" />
      <field name="attemptWorkTimeInSeconds" type="number" />
      <field name="data" type="collection" />
      <field name="exceptionReason" type="text" />
      <field name="resource" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="24f161b7-04a0-4f19-8430-240e7e147047" name="did the expected resource name match what was returned by the api?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="15" y="45" w="90" h="30" />
    <decision expression="[Result Collection.resource]=[resourceName]" />
    <ontrue>e49c8695-5461-4b25-a56c-3e75dcb5599e</ontrue>
    <onfalse>0f02fc15-7d6b-410d-812e-5332a4231782</onfalse>
  </stage>
  <stage stageid="0f02fc15-7d6b-410d-812e-5332a4231782" name="Incorrect resource for item 1" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="120" y="45" />
    <exception localized="yes" type="Response Code Error" detail="&quot;it seems that the value for the field 'resource' in returned collection for item 1 was NOT as expected&quot;" />
  </stage>
  <stage stageid="0c9209b5-7cb2-45be-b690-adc1ce7edf82" name="resourceName" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-405" y="-120" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="74b689e2-867c-4c58-bc48-cc1ef88728ae" name="did the expected resource name match what was returned by the api?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="435" y="105" w="90" h="30" />
    <decision expression="[Result Collection 2.resource]=[resourceName]" />
    <ontrue>d3566fa0-89d3-4305-9684-b66f7259d95f</ontrue>
    <onfalse>12318f4c-942f-49dc-8153-21d9268ea9f4</onfalse>
  </stage>
  <stage stageid="12318f4c-942f-49dc-8153-21d9268ea9f4" name="Incorrect resource for item 1" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="540" y="105" />
    <exception localized="yes" type="Response Code Error" detail="&quot;it seems that the value for the field 'resource' in returned collection for item 1 was NOT as expected&quot;" />
  </stage>
  <stage stageid="a31aaedf-73cf-4f8d-81fd-24de555ad364" name="Result Collection 2" type="Collection">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-270" y="-285" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="id" type="text" />
      <field name="priority" type="number" />
      <field name="ident" type="number" />
      <field name="state" type="text" />
      <field name="position" type="number" />
      <field name="keyValue" type="text" />
      <field name="status" type="text" />
      <field name="tags" type="collection" />
      <field name="attemptNumber" type="number" />
      <field name="loadedDate" type="datetime" />
      <field name="deferredDate" type="datetime" />
      <field name="lockedDate" type="datetime" />
      <field name="completedDate" type="datetime" />
      <field name="exceptionedDate" type="datetime" />
      <field name="lastUpdated" type="datetime" />
      <field name="workTimeInSeconds" type="number" />
      <field name="attemptWorkTimeInSeconds" type="number" />
      <field name="data" type="collection" />
      <field name="exceptionReason" type="text" />
      <field name="resource" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="a2336f20-e940-43f8-b270-af06a8e53ca0" name="Result Collection 3" type="Collection">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="-150" y="-285" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="id" type="text" />
      <field name="priority" type="number" />
      <field name="ident" type="number" />
      <field name="state" type="text" />
      <field name="position" type="number" />
      <field name="keyValue" type="text" />
      <field name="status" type="text" />
      <field name="tags" type="collection" />
      <field name="attemptNumber" type="number" />
      <field name="loadedDate" type="datetime" />
      <field name="deferredDate" type="datetime" />
      <field name="lockedDate" type="datetime" />
      <field name="completedDate" type="datetime" />
      <field name="exceptionedDate" type="datetime" />
      <field name="lastUpdated" type="datetime" />
      <field name="workTimeInSeconds" type="number" />
      <field name="attemptWorkTimeInSeconds" type="number" />
      <field name="data" type="collection" />
      <field name="exceptionReason" type="text" />
      <field name="resource" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="1f2b41bd-5904-4886-9762-c44e60f8c791" name="did the expected resource name match what was returned by the api?" type="Decision">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="840" y="105" w="90" h="30" />
    <decision expression="[Result Collection 3.resource]=[resourceName]" />
    <ontrue>f29b72d6-9572-435c-930d-ac776a35f290</ontrue>
    <onfalse>b2bf435d-e962-4ea6-9cba-c58ed4b5705a</onfalse>
  </stage>
  <stage stageid="b2bf435d-e962-4ea6-9cba-c58ed4b5705a" name="Incorrect resource for item 1" type="Exception">
    <subsheetid>ab4ccde0-4082-4083-98a8-a036be8b3e37</subsheetid>
    <display x="945" y="105" />
    <exception localized="yes" type="Response Code Error" detail="&quot;it seems that the value for the field 'resource' in returned collection for item 1 was NOT as expected&quot;" />
  </stage>
  <stage stageid="7bac721a-bcd3-4e52-93b2-da06d7a29d72" name="Start (get encrypted item page)" type="Start">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="60" y="-135" />
    <onsuccess>af5f41fd-f24d-40ee-ba03-bbae52ff84d0</onsuccess>
  </stage>
  <stage stageid="af5f41fd-f24d-40ee-ba03-bbae52ff84d0" name="Add item 1 To Queue" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="60" y="30" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name (2)]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Dummy Queue Item Data]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="MakeDate(1, 1, 2025)" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="6" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;New Tag&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="&quot;Running&quot;" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="">
        <validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" />
      </input>
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="workqueue Item 1 ID" />
    </outputs>
    <onsuccess>4d466ae4-eb27-4cad-9098-499202f2d574</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="ab37d92a-3a06-42cf-bea6-4195fdcbc536" name="Convert Response to Collection" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="750" w="120" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection" />
    </outputs>
    <onsuccess>3e554a90-3f63-40fe-b824-8a0dce772017</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="ebcfafb6-504d-42af-99a8-8a162306fda3" name="Response Code as Expected?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="60" y="705" w="120" h="30" />
    <decision expression="[HTTP Status Code]=&quot;200&quot;" />
    <ontrue>ab37d92a-3a06-42cf-bea6-4195fdcbc536</ontrue>
    <onfalse>a952fb37-8a1f-466e-b203-92dd6b64395f</onfalse>
  </stage>
  <stage stageid="a952fb37-8a1f-466e-b203-92dd6b64395f" name="Incorrect HTTP Status Code Response" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="165" y="705" />
    <exception localized="yes" type="Response Code Error" detail="&quot;It was expected that HTTP status code 200 would be returned. Actual returned HTTP status code was: &quot;&amp;[HTTP Status Code]" />
  </stage>
  <stage stageid="7a0f2973-7421-464d-9080-07d76bb37e34" name="GET Work Queues Item" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="555" w="120" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 1 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>ab93a8d1-0ac8-46cf-b480-0130089d9f31</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="73eba74a-d04e-4b03-8cf7-d5ce252411fe" name="HTTP Status Code" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-345" y="465" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="233af11b-52cc-4da1-8689-c992c4c12942" name="Local Variables" type="Block">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-420" y="300" w="390" h="480" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="8a44a670-6cd5-48e4-869e-8ff43cea5c0c" name="Clear Ident Field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="975" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Ident&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection" />
    </outputs>
    <onsuccess>41087513-d78b-4791-a9d7-32b7809d952f</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="dc2b342a-df32-4623-a70b-6a28a0876065" name="Response Content" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-345" y="525" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4c002cf8-a094-4c00-858a-ed4a59a934b8" name="Expected Response Content" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-345" y="585" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">[{"id":"tempGUID","priority":6.0,"ident":0.0,"state":"Deferred","keyValue":"","status":"Running","tags":["New Tag"],"attemptNumber":1.0,"loadedDate":"0001-01-01T00:00:00Z","deferredDate":"2025-01-01T00:00:00Z","lockedDate":"0001-01-01T00:00:00Z","completedDate":"0001-01-01T00:00:00Z","exceptionedDate":"0001-01-01T00:00:00Z","lastUpdated":"0001-01-01T00:00:00Z","workTimeInSeconds":0.0,"attemptWorkTimeInSeconds":0.0,"data":[{"rows":[[{"Collection":[{"value":[{"rows":[[{"Nested Text":[{"value":"Text Nested Text","valueType":"Text"}]}]]}],"valueType":"Collection"}],"Date":[{"value":"2020-10-16T00:00:00Z","valueType":"Date"}],"DateTime":[{"value":"2020-10-25T02:00:51Z","valueType":"DateTime"}],"Flag":[{"value":false,"valueType":"Flag"}],"Number":[{"value":42.0,"valueType":"Number"}],"Password":[{"value":"bob123","valueType":"Password"}],"Text":[{"value":"Some Text","valueType":"Text"}],"Time":[{"value":"0001-01-01T03:08:16Z","valueType":"Time"}],"TimeSpan":[{"value":"9.08:07:06","valueType":"TimeSpan"}],"Image":[{"value":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABhSURBVDhPxZBRCgAhCEQ9+hyto63hKJkta1/7EMSph5GMGwBMQVsTgdwLK0wLb3lPWJ/ESLvXIT8KnJ3Ik8DZT42UW9Vf4l0jb9sFXirwuC/Ent8E7VHGp8C5JFPw1ivIA7vl6EEuCb2uAAAAAElFTkSuQmCCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==","valueType":"Image"}],"Binary":[{"value":"Qk32AAAAAAAAAHYAAAAoAAAAEAAAABAAAAABAAQAAAAAAIAAAADEDgAAxA4AAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AHIiIiIiIiIih3cAJ3cAJ3KHdwAiIgAncod3AAAAACdyh3cAAAAAJ3KHdwAAAAAncod3AAAAAHdyh3d3AAAnd3KHciIAAHIiIod3ACd3dwAih3cAIiJ3ACIAAHcAAAB3AAAAdwAAAHcAh3d3d3d3d3KHd3d3d3d3coiIiIiIiIiH","valueType":"Binary"}]}]]}],"exceptionReason":"","resource":""}]</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b5f66118-20a9-4810-a3ea-d5156c218bbd" name="Does data match?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="60" y="1485" w="120" h="30" />
    <decision expression="[Response Content]=[Expected Response Content]" />
    <ontrue>a24269ca-155f-460a-a761-07ad34791f8f</ontrue>
    <onfalse>a48864b2-4871-48ed-8515-6ba377627ebc</onfalse>
  </stage>
  <stage stageid="a48864b2-4871-48ed-8515-6ba377627ebc" name="Failed" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="165" y="1485" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;the work queue item data returned is incorrect for work item 1 of the unencrypted work queue&quot;" />
  </stage>
  <stage stageid="f4931904-cb1f-45d9-908d-a648a8cb1ca3" name="End3" type="End">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1575" />
  </stage>
  <stage stageid="479b1938-87e3-405c-85b9-49a8625222d5" name="Convert Collection to Json" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="1440" w="120" h="30" />
    <inputs>
      <input type="collection" name="Data" friendlyname="Data" expr="[Result Collection]" />
    </inputs>
    <outputs>
      <output type="text" name="JSON" friendlyname="JSON" stage="Response Content" />
    </outputs>
    <onsuccess>b5f66118-20a9-4810-a3ea-d5156c218bbd</onsuccess>
    <resource object="Utility - JSON" action="Collection to JSON" />
  </stage>
  <stage stageid="41087513-d78b-4791-a9d7-32b7809d952f" name="Clear loaded Date field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="1020" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;loadedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection" />
    </outputs>
    <onsuccess>4ee35b42-4105-4dc8-9abc-91ae46ed486a</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="cf934b11-6620-4bb5-a702-c70b461d0b16" name="Update GUID" type="Calculation">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="1395" w="120" h="30" />
    <onsuccess>479b1938-87e3-405c-85b9-49a8625222d5</onsuccess>
    <calculation expression="Replace([Expected Response Content], &quot;tempGUID&quot;, [workqueue Item 1 ID.Item ID])" stage="Expected Response Content" />
  </stage>
  <stage stageid="0e392dbd-4d41-4e11-a49d-31d96f75ff0b" name="Recover4" type="Recover">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit />
    <display x="165" y="555" />
    <onsuccess>96b25c4b-e2e4-4920-8d72-332f7a68a5ed</onsuccess>
  </stage>
  <stage stageid="96b25c4b-e2e4-4920-8d72-332f7a68a5ed" name="Resume3" type="Resume">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit />
    <display x="165" y="600" />
    <onsuccess>dfcdf0cb-e963-4e3a-b07f-80856aa604c5</onsuccess>
  </stage>
  <stage stageid="dfcdf0cb-e963-4e3a-b07f-80856aa604c5" name="GET Work Queues Item" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="165" y="660" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 1 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>ab93a8d1-0ac8-46cf-b480-0130089d9f31</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="ab93a8d1-0ac8-46cf-b480-0130089d9f31" name="Anchor1" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="660" w="10" h="10" />
    <onsuccess>ebcfafb6-504d-42af-99a8-8a162306fda3</onsuccess>
  </stage>
  <stage stageid="c39024c5-af17-4e3f-be94-52c3824fdc48" name="Get Work Queues (item 1)" type="Block">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="525" w="225" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4ee35b42-4105-4dc8-9abc-91ae46ed486a" name="Clear last updated field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="1065" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;lastUpdated&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection" />
    </outputs>
    <onsuccess>5bff1024-e6be-4f6e-a872-869f08cd895e</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="8ef10cc8-d1aa-46ed-84c5-49468f6c0fe0" name="Clear resource name field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="1350" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;resource&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection" />
    </outputs>
    <onsuccess>cf934b11-6620-4bb5-a702-c70b461d0b16</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="4d466ae4-eb27-4cad-9098-499202f2d574" name="Add item 2 To Queue" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="60" y="75" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name (2)]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Dummy Queue Item Data]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="99" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;test tag&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="&quot;QA&quot;" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="">
        <validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" />
      </input>
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="workqueue Item 2 ID" />
    </outputs>
    <onsuccess>279afac6-9b00-4098-a243-690a023df943</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="279afac6-9b00-4098-a243-690a023df943" name="Add item 3 To Queue" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="60" y="120" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Queue Name (2)]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Dummy Queue Item Data]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="6" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;New Tag&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="&quot;Running&quot;" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="">
        <validator type="BluePrism.AutomateProcessCore.RangeParameterValidation" parameter="0:25000" />
      </input>
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="workqueue Item 3 ID" />
    </outputs>
    <onsuccess>c8c426c2-1acf-4fb1-b618-5e0e654bc918</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="d3cffeb6-d549-4d2b-8750-5d768bc2742d" name="add items to work queue" type="Block">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-45" w="225" h="240" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="75de0d16-d641-4feb-a5ef-ae0f28aafce0" name="Work Queues::Mark Exception (item 2)" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="60" y="345" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[workqueue Item 2 ID.Item ID]" />
      <input type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="A description of the reason for the exception" expr="&quot;QA exception test&quot;" />
      <input type="flag" name="Retry" friendlyname="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="False" />
      <input type="flag" name="Keep Locked" friendlyname="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="True" />
    </inputs>
    <outputs>
      <output type="text" name="New Item ID" friendlyname="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="" />
    </outputs>
    <onsuccess>031934b3-f028-4dfb-a589-428a94ad85bb</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" />
  </stage>
  <stage stageid="20ec1893-047f-412c-b885-e47ccd663aab" name="Work Queues::Mark Completed (item 3)" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Marks the item as completed, by updating the Completed timestamp and setting Locked to null. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="60" y="480" w="120" h="30" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[workqueue Item 3 ID.Item ID]" />
    </inputs>
    <onsuccess>7a0f2973-7421-464d-9080-07d76bb37e34</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Completed" />
  </stage>
  <stage stageid="ce35f8ae-cf12-4700-8076-ead12d665080" name="create workqueue items that are not &quot;pending&quot;" type="Block">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="210" w="225" h="300" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c8c426c2-1acf-4fb1-b618-5e0e654bc918" name="Work Queues::Get Item By ID (item 2)" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>This action gets the item corresponding to the Id</narrative>
    <display x="60" y="255" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue." expr="[Queue Name (2)]" />
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The Id of the queue item" expr="[workqueue Item 2 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>75de0d16-d641-4feb-a5ef-ae0f28aafce0</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item By ID" />
  </stage>
  <stage stageid="031934b3-f028-4dfb-a589-428a94ad85bb" name="Work Queues::Get Item By ID (item 3)" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>This action gets the item corresponding to the Id</narrative>
    <display x="60" y="390" w="120" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue." expr="[Queue Name (2)]" />
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The Id of the queue item" expr="[workqueue Item 3 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>20ec1893-047f-412c-b885-e47ccd663aab</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item By ID" />
  </stage>
  <stage stageid="469a987e-522a-4058-b335-bb0bea405591" name="Note3" type="Note">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>Item 2 can't have a defer date value else I cannot turn it into an item with an exception later in the process</narrative>
    <display x="345" y="75" w="240" h="30" />
  </stage>
  <stage stageid="2bb0a42f-9e12-4414-ad26-864887a47034" name="Note3" type="Note">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>Item 3 can't have a defer date value else I cannot turn it into an item that is marked as completed  later in the process</narrative>
    <display x="345" y="120" w="240" h="30" />
  </stage>
  <stage stageid="88274e20-2374-4e98-ac16-c2723b00be8b" name="why do we clear the indent field??" type="Note">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>We clear the indent field as we cannot determine what the value will be each time, especially due to the tests that will have been run previously in the nightly test run.</narrative>
    <display x="225" y="975" w="150" h="90" />
  </stage>
  <stage stageid="8a5ed41e-c07b-43f9-b533-bd668eec270f" name="why do we clear the loaded field??" type="Note">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>We clear the loaded field as we cannot determine what the value will be each time, even when de bugging and using the NOW() function there can be 1/2 seconds difference between the datetime recorded by the NOW calc stage, and the datetime in the database. We'could' use trim. But because that 1/2 second diffence might affect, the minute or hour (or indeed date if executed around mindnight) we would probably get a high failure rate because of it. So the "safe" option is to trim it out. </narrative>
    <display x="-135" y="1020" w="150" h="90" />
  </stage>
  <stage stageid="55ad5869-00d0-4d32-aaf8-6447373bf54f" name="why do we clear the loaded field??" type="Note">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>We clear the lastupdated field as we cannot determine what the value will be each time, even when de bugging and using the NOW() function there can be 1/2 seconds difference between the datetime recorded by the NOW calc stage, and the datetime in the database. We'could' use trim. But because that 1/2 second diffence might affect, the minute or hour (or indeed date if executed around mindnight) we would probably get a high failure rate because of it. So the "safe" option is to trim it out. </narrative>
    <display x="225" y="1080" w="150" h="90" />
  </stage>
  <stage stageid="c9a19d69-4e1c-4e87-bf7d-725f90557eb2" name="workqueue Item 1 ID" type="Collection">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-345" y="495" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="64d69c58-78a1-489b-af79-9208ae44db55" name="workqueue Item 2 ID" type="Collection">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-225" y="495" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="fbaea1c9-99bd-4ba0-9e28-f4f643c082c5" name="workqueue Item 3 ID" type="Collection">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-105" y="495" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="5bff1024-e6be-4f6e-a872-869f08cd895e" name="Note4" type="Note">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>Now, clear out the resourcename field to allow the other fields to be verified. Because we can't use functions to check the value of the field "resourcename" easily once it is a block of JSON, And this seems the neatest solution for now. </narrative>
    <display x="60" y="1290" w="210" h="60" />
    <onsuccess>8ef10cc8-d1aa-46ed-84c5-49468f6c0fe0</onsuccess>
  </stage>
  <stage stageid="98d6bbf4-44bf-4395-affa-d1120230b444" name="Convert Response to Collection" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="750" w="120" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content 2]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection 2" />
    </outputs>
    <onsuccess>0089190c-4ff6-4a5a-9be9-0760c86d8b62</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="ac7a5293-2a8e-408f-b79e-898339e2db15" name="Response Code as Expected?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="480" y="705" w="120" h="30" />
    <decision expression="[HTTP Status Code 2]=&quot;200&quot;" />
    <ontrue>98d6bbf4-44bf-4395-affa-d1120230b444</ontrue>
    <onfalse>0c3cfb23-d7f6-47f5-a33b-0fd7acbde3e9</onfalse>
  </stage>
  <stage stageid="0c3cfb23-d7f6-47f5-a33b-0fd7acbde3e9" name="Incorrect HTTP Status Code Response" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="585" y="705" />
    <exception localized="yes" type="Response Code Error" detail="&quot;It was expected that HTTP status code 200 would be returned. Actual returned HTTP status code was: &quot;&amp;[HTTP Status Code]" />
  </stage>
  <stage stageid="b9ac04c9-472e-457b-96f5-b3ffed446b54" name="GET Work Queues Item 2" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="555" w="120" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 2 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 2" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 2" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>c283c757-4b77-48d7-9134-b050c6352be4</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="e772fe35-dbd8-47ce-a7ec-095c086a6d3a" name="Clear Ident Field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="990" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Ident&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>b96b33da-2ced-41d0-852d-317d304ce56a</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="123f391b-8917-4cd2-86a0-73b6ba55c593" name="Does data match?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="480" y="1485" w="120" h="30" />
    <decision expression="[Response Content 2]=[Expected Response Content 2]" />
    <ontrue>87d88596-55d0-4395-833a-0f2987b8fa30</ontrue>
    <onfalse>bd4cff94-3d26-4337-b790-be80ba2a5c05</onfalse>
  </stage>
  <stage stageid="bd4cff94-3d26-4337-b790-be80ba2a5c05" name="Failed" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="585" y="1485" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;the work queue item data returned is incorrect for work item 2 of the unencrypted work queue&quot;" />
  </stage>
  <stage stageid="e707adf6-508c-4f0f-9aee-5b23353c49ef" name="Convert Collection to Json" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1440" w="120" h="30" />
    <inputs>
      <input type="collection" name="Data" friendlyname="Data" expr="[Result Collection 2]" />
    </inputs>
    <outputs>
      <output type="text" name="JSON" friendlyname="JSON" stage="Response Content 2" />
    </outputs>
    <onsuccess>123f391b-8917-4cd2-86a0-73b6ba55c593</onsuccess>
    <resource object="Utility - JSON" action="Collection to JSON" />
  </stage>
  <stage stageid="615bd10b-019e-4284-89b2-aa434d3baf3c" name="Clear loaded Date field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1080" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;loadedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>9c657cc2-3cc7-458b-9bcd-b71c5e59d8fd</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="2d625c79-4c83-4189-ad98-4fa635dce1ee" name="Update GUID" type="Calculation">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1395" w="120" h="30" />
    <onsuccess>e707adf6-508c-4f0f-9aee-5b23353c49ef</onsuccess>
    <calculation expression="Replace([Expected Response Content 2], &quot;tempGUID&quot;, [workqueue Item 2 ID.Item ID])" stage="Expected Response Content 2" />
  </stage>
  <stage stageid="ab4dc93d-bd4f-4631-845b-1f20b4f1f0cd" name="Recover4" type="Recover">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit />
    <display x="585" y="555" />
    <onsuccess>a4403e25-3e77-4689-9328-1e9652404d3e</onsuccess>
  </stage>
  <stage stageid="a4403e25-3e77-4689-9328-1e9652404d3e" name="Resume3" type="Resume">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit />
    <display x="585" y="600" />
    <onsuccess>dc7b0dc7-7214-46b6-9bc7-18b2577fed62</onsuccess>
  </stage>
  <stage stageid="dc7b0dc7-7214-46b6-9bc7-18b2577fed62" name="GET Work Queues Item 2" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="585" y="660" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 2 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 2" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 2" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>c283c757-4b77-48d7-9134-b050c6352be4</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="c283c757-4b77-48d7-9134-b050c6352be4" name="Anchor1" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="660" w="10" h="10" />
    <onsuccess>ac7a5293-2a8e-408f-b79e-898339e2db15</onsuccess>
  </stage>
  <stage stageid="3e01f65e-0ee1-41cf-a706-1ae1d3787376" name="Get Work Queues (item 2)" type="Block">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="525" w="225" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="9c657cc2-3cc7-458b-9bcd-b71c5e59d8fd" name="Clear last updated field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1125" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;lastUpdated&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>65955633-8dfc-4c43-9a00-b2724ebc98ba</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="d445e5d0-46a8-4e7f-99e5-de73ca2ebc8c" name="Clear resource name field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1350" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;resource&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>2d625c79-4c83-4189-ad98-4fa635dce1ee</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="365bd6d1-a70a-42f5-8310-e417e6737b67" name="Note4" type="Note">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>Now, clear out the resourcename field to allow the other fields to be verified. Because we can't use functions to check the value of the field "resourcename" easily once it is a block of JSON, And this seems the neatest solution for now. </narrative>
    <display x="480" y="1275" w="210" h="60" />
    <onsuccess>d445e5d0-46a8-4e7f-99e5-de73ca2ebc8c</onsuccess>
  </stage>
  <stage stageid="a24269ca-155f-460a-a761-07ad34791f8f" name="Anchor3" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="1530" w="10" h="10" />
    <onsuccess>d0327128-0060-4feb-b652-0207229cc55d</onsuccess>
  </stage>
  <stage stageid="d0327128-0060-4feb-b652-0207229cc55d" name="Anchor7" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="345" y="1530" w="10" h="10" />
    <onsuccess>3b11cc24-2304-424d-9b08-16661d958a0b</onsuccess>
  </stage>
  <stage stageid="3b11cc24-2304-424d-9b08-16661d958a0b" name="Anchor8" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="345" y="705" w="10" h="10" />
    <onsuccess>a5352710-bd5a-49f7-9bcc-5b363bd543d0</onsuccess>
  </stage>
  <stage stageid="a5352710-bd5a-49f7-9bcc-5b363bd543d0" name="Anchor10" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="345" y="480" w="10" h="10" />
    <onsuccess>35c4f542-6384-46ca-8329-817b4215945d</onsuccess>
  </stage>
  <stage stageid="35c4f542-6384-46ca-8329-817b4215945d" name="Anchor11" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="480" w="10" h="10" />
    <onsuccess>b9ac04c9-472e-457b-96f5-b3ffed446b54</onsuccess>
  </stage>
  <stage stageid="1a013e3b-cf4d-4927-b670-876132c37ff4" name="Expected Response Content 2" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-225" y="585" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">[{"id":"tempGUID","priority":99.0,"ident":0.0,"state":"Exceptioned","keyValue":"","status":"QA","tags":["test tag","Exception: QA exception test"],"attemptNumber":1.0,"loadedDate":"0001-01-01T00:00:00Z","deferredDate":"0001-01-01T00:00:00Z","lockedDate":"0001-01-01T00:00:00Z","completedDate":"0001-01-01T00:00:00Z","exceptionedDate":"0001-01-01T00:00:00Z","lastUpdated":"0001-01-01T00:00:00Z","workTimeInSeconds":0.0,"attemptWorkTimeInSeconds":0.0,"data":[{"rows":[[{"Collection":[{"value":[{"rows":[[{"Nested Text":[{"value":"Text Nested Text","valueType":"Text"}]}]]}],"valueType":"Collection"}],"Date":[{"value":"2020-10-16T00:00:00Z","valueType":"Date"}],"DateTime":[{"value":"2020-10-25T02:00:51Z","valueType":"DateTime"}],"Flag":[{"value":false,"valueType":"Flag"}],"Number":[{"value":42.0,"valueType":"Number"}],"Password":[{"value":"bob123","valueType":"Password"}],"Text":[{"value":"Some Text","valueType":"Text"}],"Time":[{"value":"0001-01-01T03:08:16Z","valueType":"Time"}],"TimeSpan":[{"value":"9.08:07:06","valueType":"TimeSpan"}],"Image":[{"value":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABhSURBVDhPxZBRCgAhCEQ9+hyto63hKJkta1/7EMSph5GMGwBMQVsTgdwLK0wLb3lPWJ/ESLvXIT8KnJ3Ik8DZT42UW9Vf4l0jb9sFXirwuC/Ent8E7VHGp8C5JFPw1ivIA7vl6EEuCb2uAAAAAElFTkSuQmCCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==","valueType":"Image"}],"Binary":[{"value":"Qk32AAAAAAAAAHYAAAAoAAAAEAAAABAAAAABAAQAAAAAAIAAAADEDgAAxA4AAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AHIiIiIiIiIih3cAJ3cAJ3KHdwAiIgAncod3AAAAACdyh3cAAAAAJ3KHdwAAAAAncod3AAAAAHdyh3d3AAAnd3KHciIAAHIiIod3ACd3dwAih3cAIiJ3ACIAAHcAAAB3AAAAdwAAAHcAh3d3d3d3d3KHd3d3d3d3coiIiIiIiIiH","valueType":"Binary"}]}]]}],"exceptionReason":"QA exception test","resource":""}]</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="16aa589d-ec0b-4674-924b-600320efb020" name="Response Content 2" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-225" y="525" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b85f905a-8ae0-459d-bdd7-442183ac0fa8" name="HTTP Status Code 2" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-225" y="465" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="30588ec9-950b-4595-893a-6184bc962b6a" name="HTTP Status Code 3" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-105" y="465" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0f3e0743-2f07-4251-9203-69ca400cd4a3" name="Expected Response Content 3" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-105" y="585" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">[{"id":"tempGUID","priority":6.0,"ident":0.0,"state":"Completed","keyValue":"","status":"Running","tags":["New Tag"],"attemptNumber":1.0,"loadedDate":"0001-01-01T00:00:00Z","deferredDate":"0001-01-01T00:00:00Z","lockedDate":"0001-01-01T00:00:00Z","completedDate":"0001-01-01T00:00:00Z","exceptionedDate":"0001-01-01T00:00:00Z","lastUpdated":"0001-01-01T00:00:00Z","workTimeInSeconds":0.0,"attemptWorkTimeInSeconds":0.0,"data":[{"rows":[[{"Collection":[{"value":[{"rows":[[{"Nested Text":[{"value":"Text Nested Text","valueType":"Text"}]}]]}],"valueType":"Collection"}],"Date":[{"value":"2020-10-16T00:00:00Z","valueType":"Date"}],"DateTime":[{"value":"2020-10-25T02:00:51Z","valueType":"DateTime"}],"Flag":[{"value":false,"valueType":"Flag"}],"Number":[{"value":42.0,"valueType":"Number"}],"Password":[{"value":"bob123","valueType":"Password"}],"Text":[{"value":"Some Text","valueType":"Text"}],"Time":[{"value":"0001-01-01T03:08:16Z","valueType":"Time"}],"TimeSpan":[{"value":"9.08:07:06","valueType":"TimeSpan"}],"Image":[{"value":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABhSURBVDhPxZBRCgAhCEQ9+hyto63hKJkta1/7EMSph5GMGwBMQVsTgdwLK0wLb3lPWJ/ESLvXIT8KnJ3Ik8DZT42UW9Vf4l0jb9sFXirwuC/Ent8E7VHGp8C5JFPw1ivIA7vl6EEuCb2uAAAAAElFTkSuQmCCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==","valueType":"Image"}],"Binary":[{"value":"Qk32AAAAAAAAAHYAAAAoAAAAEAAAABAAAAABAAQAAAAAAIAAAADEDgAAxA4AAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AHIiIiIiIiIih3cAJ3cAJ3KHdwAiIgAncod3AAAAACdyh3cAAAAAJ3KHdwAAAAAncod3AAAAAHdyh3d3AAAnd3KHciIAAHIiIod3ACd3dwAih3cAIiJ3ACIAAHcAAAB3AAAAdwAAAHcAh3d3d3d3d3KHd3d3d3d3coiIiIiIiIiH","valueType":"Binary"}]}]]}],"exceptionReason":"","resource":""}]</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a34a79ae-7951-4eff-8e35-2e2020ecda88" name="Response Content 3" type="Data">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-105" y="525" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2b89efe6-8b2a-4870-b356-8354a4f230d9" name="Convert Response to Collection" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="750" w="120" h="30" />
    <inputs>
      <input type="text" name="json" friendlyname="json" expr="[Response Content 3]" />
    </inputs>
    <outputs>
      <output type="collection" name="Result" friendlyname="Result" stage="Result Collection 3" />
    </outputs>
    <onsuccess>7c5d09b1-6a7a-4188-be62-2f3036bdd599</onsuccess>
    <resource object="Utility - JSON" action="JSON to Collection" />
  </stage>
  <stage stageid="dd599050-065f-48b1-b07f-c5ee85ec5454" name="Response Code as Expected?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="885" y="705" w="120" h="30" />
    <decision expression="[HTTP Status Code 3]=&quot;200&quot;" />
    <ontrue>2b89efe6-8b2a-4870-b356-8354a4f230d9</ontrue>
    <onfalse>0af9018b-443d-4e80-83f7-d68b2297e95c</onfalse>
  </stage>
  <stage stageid="0af9018b-443d-4e80-83f7-d68b2297e95c" name="Incorrect HTTP Status Code Response" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="990" y="705" />
    <exception localized="yes" type="Response Code Error" detail="&quot;It was expected that HTTP status code 200 would be returned. Actual returned HTTP status code was: &quot;&amp;[HTTP Status Code]" />
  </stage>
  <stage stageid="daae3f81-f256-4c88-8f22-57b40e67e2c9" name="GET Work Queues Item 3" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="555" w="120" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 3 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 3" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 3" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>3caeadc8-1358-44dc-952c-4def10476c38</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="32003ffa-3a5a-4abc-9d43-6246ca7638dd" name="Clear Ident Field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="990" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;Ident&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>1d097695-2084-4837-83d1-99c1e5cbb32c</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="e44cd7cb-6927-42ba-ae14-a77c751b402d" name="Does data match?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="885" y="1470" w="120" h="30" />
    <decision expression="[Response Content 3]=[Expected Response Content 3]" />
    <ontrue>f4931904-cb1f-45d9-908d-a648a8cb1ca3</ontrue>
    <onfalse>78bea5fe-918b-4250-82b9-d36994b546b2</onfalse>
  </stage>
  <stage stageid="78bea5fe-918b-4250-82b9-d36994b546b2" name="Failed" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="1020" y="1470" />
    <exception localized="yes" type="&quot;System Exception&quot;" detail="&quot;the work queue item data returned is incorrect for work item 3 of the unencrypted work queue&quot;" />
  </stage>
  <stage stageid="b0cb455d-4bee-455f-856e-d75ce5bbf833" name="Convert Collection to Json" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1425" w="120" h="30" />
    <inputs>
      <input type="collection" name="Data" friendlyname="Data" expr="[Result Collection 3]" />
    </inputs>
    <outputs>
      <output type="text" name="JSON" friendlyname="JSON" stage="Response Content 3" />
    </outputs>
    <onsuccess>e44cd7cb-6927-42ba-ae14-a77c751b402d</onsuccess>
    <resource object="Utility - JSON" action="Collection to JSON" />
  </stage>
  <stage stageid="1d097695-2084-4837-83d1-99c1e5cbb32c" name="Clear loaded Date field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1035" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;loadedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>bbf8bf5a-810a-4aa5-acdc-2cf9dd01a294</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="4841c50e-7ffa-4c97-bf8c-6acd026bb353" name="Update GUID" type="Calculation">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1380" w="120" h="30" />
    <onsuccess>b0cb455d-4bee-455f-856e-d75ce5bbf833</onsuccess>
    <calculation expression="Replace([Expected Response Content 3], &quot;tempGUID&quot;, [workqueue Item 3 ID.Item ID])" stage="Expected Response Content 3" />
  </stage>
  <stage stageid="43481d2a-20f3-481f-884d-ae7bc4c6cb40" name="Recover4" type="Recover">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit />
    <display x="990" y="555" />
    <onsuccess>4a0d0f5f-ccaa-4791-a663-de8c0c78ae82</onsuccess>
  </stage>
  <stage stageid="4a0d0f5f-ccaa-4791-a663-de8c0c78ae82" name="Resume3" type="Resume">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit />
    <display x="990" y="600" />
    <onsuccess>127591a2-9138-4d9c-8612-21e3c37b0f6d</onsuccess>
  </stage>
  <stage stageid="127591a2-9138-4d9c-8612-21e3c37b0f6d" name="GET Work Queues Item 3" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="990" y="660" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[workqueue Item 3 ID.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="Response Content 3" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="HTTP Status Code 3" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>3caeadc8-1358-44dc-952c-4def10476c38</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="3caeadc8-1358-44dc-952c-4def10476c38" name="Anchor1" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="660" w="10" h="10" />
    <onsuccess>dd599050-065f-48b1-b07f-c5ee85ec5454</onsuccess>
  </stage>
  <stage stageid="4da8d9f0-9f2f-4007-a14b-4be32e3093b7" name="Get Work Queues (item 3)" type="Block">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="810" y="525" w="225" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="d00abd80-b20b-45fe-a783-034aad69cfbe" name="Clear last updated field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1125" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;lastUpdated&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>c569af25-edef-453e-bca9-8b0abc49c97e</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="8e740f5e-38a1-46e2-92f4-c4e25d7d054c" name="Clear resource name field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1335" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;resource&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>4841c50e-7ffa-4c97-bf8c-6acd026bb353</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="1421474d-0f23-4954-bafa-97498420aae9" name="Note4" type="Note">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <narrative>Now, clear out the resourcename field to allow the other fields to be verified. Because we can't use functions to check the value of the field "resourcename" easily once it is a block of JSON, And this seems the neatest solution for now. </narrative>
    <display x="885" y="1275" w="210" h="60" />
    <onsuccess>8e740f5e-38a1-46e2-92f4-c4e25d7d054c</onsuccess>
  </stage>
  <stage stageid="9cc16130-1b2f-4e84-997f-b076d5763aa6" name="Anchor7" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="750" y="1530" w="10" h="10" />
    <onsuccess>39199d55-dfa3-4189-aecd-fc80ef76ade2</onsuccess>
  </stage>
  <stage stageid="39199d55-dfa3-4189-aecd-fc80ef76ade2" name="Anchor8" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="750" y="705" w="10" h="10" />
    <onsuccess>7a4f8405-cad7-4e1c-a12f-34891f07c327</onsuccess>
  </stage>
  <stage stageid="7a4f8405-cad7-4e1c-a12f-34891f07c327" name="Anchor10" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="750" y="480" w="10" h="10" />
    <onsuccess>1e709f8d-a269-4487-8bf9-84f96ad8d1b9</onsuccess>
  </stage>
  <stage stageid="1e709f8d-a269-4487-8bf9-84f96ad8d1b9" name="Anchor11" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="480" w="10" h="10" />
    <onsuccess>daae3f81-f256-4c88-8f22-57b40e67e2c9</onsuccess>
  </stage>
  <stage stageid="87d88596-55d0-4395-833a-0f2987b8fa30" name="Anchor12" type="Anchor">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1530" w="10" h="10" />
    <onsuccess>9cc16130-1b2f-4e84-997f-b076d5763aa6</onsuccess>
  </stage>
  <stage stageid="b96b33da-2ced-41d0-852d-317d304ce56a" name="Clear exceptionedDate Field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1035" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;exceptionedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>615bd10b-019e-4284-89b2-aa434d3baf3c</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="bbf8bf5a-810a-4aa5-acdc-2cf9dd01a294" name="Clear completedDate field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1080" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;completedDate&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0001-01-01T00:00:00&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>d00abd80-b20b-45fe-a783-034aad69cfbe</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="65955633-8dfc-4c43-9a00-b2724ebc98ba" name="Clear workTimeInSeconds field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1170" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;workTimeInSeconds&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0.0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>fefa0dd4-8e62-4742-a8c7-ecaab35a4ae1</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="fefa0dd4-8e62-4742-a8c7-ecaab35a4ae1" name="Clear last attemptWorkTimeInSeconds field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="1215" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 2]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;attemptWorkTimeInSeconds&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0.0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 2" />
    </outputs>
    <onsuccess>365bd6d1-a70a-42f5-8310-e417e6737b67</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="c569af25-edef-453e-bca9-8b0abc49c97e" name="Clear workTimeInSeconds field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1170" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;workTimeInSeconds&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0.0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>acef824e-3a32-4085-a6e9-3cea09319b07</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="acef824e-3a32-4085-a6e9-3cea09319b07" name="Clear last attemptWorkTimeInSeconds field" type="Action">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="885" y="1215" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection to append a field to." expr="[Result Collection 3]" />
      <input type="text" name="Field Name" friendlyname="Field Name" narrative="The name of the new field." expr="&quot;attemptWorkTimeInSeconds&quot;" />
      <input type="text" name="Value" friendlyname="Value" narrative="The value to be put in the new field." expr="&quot;0.0&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Appended Collection" friendlyname="Appended Collection" narrative="The collection with field appended." stage="Result Collection 3" />
    </outputs>
    <onsuccess>1421474d-0f23-4954-bafa-97498420aae9</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Field (Text)" />
  </stage>
  <stage stageid="e966d4be-1353-45e8-b1f8-12f32cc3f77e" name="Result Collection" type="Collection">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-345" y="555" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="id" type="text" />
      <field name="priority" type="number" />
      <field name="ident" type="number" />
      <field name="state" type="text" />
      <field name="position" type="number" />
      <field name="keyValue" type="text" />
      <field name="status" type="text" />
      <field name="tags" type="collection" />
      <field name="attemptNumber" type="number" />
      <field name="loadedDate" type="datetime" />
      <field name="deferredDate" type="datetime" />
      <field name="lockedDate" type="datetime" />
      <field name="completedDate" type="datetime" />
      <field name="exceptionedDate" type="datetime" />
      <field name="lastUpdated" type="datetime" />
      <field name="workTimeInSeconds" type="number" />
      <field name="attemptWorkTimeInSeconds" type="number" />
      <field name="data" type="collection" />
      <field name="exceptionReason" type="text" />
      <field name="resource" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="3e554a90-3f63-40fe-b824-8a0dce772017" name="did the expected resource name match what was returned by the api?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="60" y="885" w="90" h="30" />
    <decision expression="[Result Collection.resource]=[resourceName]" />
    <ontrue>8a44a670-6cd5-48e4-869e-8ff43cea5c0c</ontrue>
    <onfalse>659ea4b6-e863-4565-a451-cfbaffc0cae2</onfalse>
  </stage>
  <stage stageid="0089190c-4ff6-4a5a-9be9-0760c86d8b62" name="did the expected resource name match what was returned by the api?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="480" y="945" w="90" h="30" />
    <decision expression="[Result Collection 2.resource]=[resourceName]" />
    <ontrue>e772fe35-dbd8-47ce-a7ec-095c086a6d3a</ontrue>
    <onfalse>9e3c9876-cff4-4ad4-9d46-a9313b58b217</onfalse>
  </stage>
  <stage stageid="9e3c9876-cff4-4ad4-9d46-a9313b58b217" name="Incorrect resource for item 1" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="585" y="945" />
    <exception localized="yes" type="Response Code Error" detail="&quot;it seems that the value for the field 'resource' in returned collection for item 1 was NOT as expected&quot;" />
  </stage>
  <stage stageid="a5dbd86d-04ef-4aad-828c-26256af2735d" name="Result Collection 2" type="Collection">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-225" y="555" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="id" type="text" />
      <field name="priority" type="number" />
      <field name="ident" type="number" />
      <field name="state" type="text" />
      <field name="position" type="number" />
      <field name="keyValue" type="text" />
      <field name="status" type="text" />
      <field name="tags" type="collection" />
      <field name="attemptNumber" type="number" />
      <field name="loadedDate" type="datetime" />
      <field name="deferredDate" type="datetime" />
      <field name="lockedDate" type="datetime" />
      <field name="completedDate" type="datetime" />
      <field name="exceptionedDate" type="datetime" />
      <field name="lastUpdated" type="datetime" />
      <field name="workTimeInSeconds" type="number" />
      <field name="attemptWorkTimeInSeconds" type="number" />
      <field name="data" type="collection" />
      <field name="exceptionReason" type="text" />
      <field name="resource" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="2ed5bde7-9c28-4975-8b86-193f78c5c3a7" name="Result Collection 3" type="Collection">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="-105" y="555" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="id" type="text" />
      <field name="priority" type="number" />
      <field name="ident" type="number" />
      <field name="state" type="text" />
      <field name="position" type="number" />
      <field name="keyValue" type="text" />
      <field name="status" type="text" />
      <field name="tags" type="collection" />
      <field name="attemptNumber" type="number" />
      <field name="loadedDate" type="datetime" />
      <field name="deferredDate" type="datetime" />
      <field name="lockedDate" type="datetime" />
      <field name="completedDate" type="datetime" />
      <field name="exceptionedDate" type="datetime" />
      <field name="lastUpdated" type="datetime" />
      <field name="workTimeInSeconds" type="number" />
      <field name="attemptWorkTimeInSeconds" type="number" />
      <field name="data" type="collection" />
      <field name="exceptionReason" type="text" />
      <field name="resource" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="7c5d09b1-6a7a-4188-be62-2f3036bdd599" name="did the expected resource name match what was returned by the api?" type="Decision">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="885" y="945" w="90" h="30" />
    <decision expression="[Result Collection 3.resource]=[resourceName]" />
    <ontrue>32003ffa-3a5a-4abc-9d43-6246ca7638dd</ontrue>
    <onfalse>40daadab-cd20-4e7b-9864-816c94cbefe1</onfalse>
  </stage>
  <stage stageid="40daadab-cd20-4e7b-9864-816c94cbefe1" name="Incorrect resource for item 1" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="990" y="945" />
    <exception localized="yes" type="Response Code Error" detail="&quot;it seems that the value for the field 'resource' in returned collection for item 1 was NOT as expected&quot;" />
  </stage>
  <stage stageid="8bb6efa7-4d59-4701-aa84-0abe30dc3287" name="Note6" type="Note">
    <narrative>Currenlty it is not possible to test the behaviour when the work queue in question is pasued. So a manual test (C2632005) has been created. The priority at this time to to complete QA for the Febuary 2021 MVP / Beta, release</narrative>
    <display x="15" y="180" w="300" h="90" />
    <onsuccess>ed75dfdf-67ad-47fd-a5a2-34de3d8f6b22</onsuccess>
  </stage>
  <stage stageid="cc2ac900-f347-4183-9e1b-24103f7077b2" name="Note7" type="Note">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <narrative>check the api hasn't time out as it's the first time it's been executed this run, by trying a second time</narrative>
    <display x="330" y="-285" w="120" h="60" />
    <onsuccess>d14c32d1-97d2-4149-991a-2430696c5116</onsuccess>
  </stage>
  <stage stageid="d14c32d1-97d2-4149-991a-2430696c5116" name="When:" type="Note">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <narrative>When: The submitted request contains a non guid</narrative>
    <display x="330" y="-195" w="180" h="60" />
    <onsuccess>439bb5fd-05e0-4d85-ad9b-a6b8e675b674</onsuccess>
  </stage>
  <stage stageid="439bb5fd-05e0-4d85-ad9b-a6b8e675b674" name="Blue Prism API::POST Work Queues" type="Action">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="330" y="-135" w="90" h="30" />
    <inputs>
      <input type="text" name="workQueueItemId" friendlyname="workQueueItemId" expr="[non guid]" />
    </inputs>
    <outputs>
      <output type="text" name="Response Content" friendlyname="Response Content" stage="" />
      <output type="text" name="HTTP Status Code" friendlyname="HTTP Status Code" stage="" />
      <output type="collection" name="Response Headers" friendlyname="Response Headers" stage="" />
      <output type="text" name="Request Data" friendlyname="Request Data" stage="" />
    </outputs>
    <onsuccess>0fa8488d-ed0a-46b8-8b65-85d56e2dbea6</onsuccess>
    <resource object="Blue Prism - API - Work Queues" action="GET Work Queues Item" />
  </stage>
  <stage stageid="179f2fb2-51f3-4fac-8449-60ee7caabcdc" name="Attempt 2 to use a non guid input parameter" type="Block">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="-240" w="315" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0fa8488d-ed0a-46b8-8b65-85d56e2dbea6" name="Exception when attempting to use a non guid as an input parameter" type="Exception">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="630" y="-135" w="90" h="60" />
    <exception localized="yes" type="" detail="&quot;Exception as expected when attempting to use a non guid as an input parameter&quot;" />
  </stage>
  <stage stageid="71b30fec-5f3f-4629-b075-27820141e95a" name="Recover from exception when attempting to use a non guid input parameter" type="Recover">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit />
    <display x="330" y="-90" w="120" h="30" />
    <onsuccess>4184157d-3472-4aab-9f97-fcf9431cf309</onsuccess>
  </stage>
  <stage stageid="8169fcca-f0d7-4cff-b06b-6e683b9fb5bb" name="Https status code of 400 not returned as expected" type="Exception">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="435" y="-15" w="90" h="60" />
    <exception localized="yes" type="Bug" detail="&quot;The expected responses from the api, when attempting to use a non guid as an input parameter, was not seen&quot;" />
  </stage>
  <stage stageid="4184157d-3472-4aab-9f97-fcf9431cf309" name="Error code of 400 returned?" type="Decision">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <display x="330" y="-15" />
    <decision expression="InStr(ExceptionDetail(), &quot;HTTP Status Code: 400&quot;)&lt;&gt;0&#xA;AND&#xA;InStr(ExceptionDetail(), &quot;The request is invalid&quot;)&lt;&gt;0" />
    <ontrue>80439c52-79f5-463d-b4f0-99b2eab873bf</ontrue>
    <onfalse>8169fcca-f0d7-4cff-b06b-6e683b9fb5bb</onfalse>
  </stage>
  <stage stageid="7355611d-4ffe-4b84-a8a8-487d1c3974c7" name="Anchor4" type="Anchor">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="-15" w="10" h="10" />
    <onsuccess>8fb30a85-c953-48f2-b071-49cd8a1bb720</onsuccess>
  </stage>
  <stage stageid="80439c52-79f5-463d-b4f0-99b2eab873bf" name="Resume Test process following a negative test scenario" type="Resume">
    <subsheetid>c83656e3-48f4-49ac-b778-ec9d5eecb7ab</subsheetid>
    <loginhibit />
    <display x="255" y="-15" />
    <onsuccess>7355611d-4ffe-4b84-a8a8-487d1c3974c7</onsuccess>
  </stage>
  <stage stageid="659ea4b6-e863-4565-a451-cfbaffc0cae2" name="Incorrect resource for item 1" type="Exception">
    <subsheetid>b0418fea-7d2d-43d1-81f5-f37dafbcbebd</subsheetid>
    <display x="165" y="885" />
    <exception localized="yes" type="Response Code Error" detail="&quot;it seems that the value for the field 'resource' in returned collection for item 1 was NOT as expected&quot;" />
  </stage>
  <stage stageid="35cae19d-ad39-489b-a523-45ac27499df0" name="Start" type="Start">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <display x="15" y="-1080" />
    <onsuccess>2e6a8b42-5e8c-4088-a6c0-790ca4785fcc</onsuccess>
  </stage>
  <stage stageid="2e6a8b42-5e8c-4088-a6c0-790ca4785fcc" name="Launch" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <display x="15" y="-1035" w="120" h="30" />
    <outputs>
      <output type="number" name="pid" friendlyname="pid" narrative="PID of the process" stage="pid" />
    </outputs>
    <onsuccess>89a4e8eb-2d13-4295-9b5e-43f896cd52b8</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="7fdf7e83-19c0-4bae-9e99-d150383ae810" name="Attach to System" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <display x="15" y="-945" w="120" h="30" />
    <inputs>
      <input type="number" name="pid" friendlyname="pid" narrative="PID to attach to" expr="[pid]" />
    </inputs>
    <onsuccess>7a66f2e5-30f8-4861-bdc5-05653ce0a270</onsuccess>
    <resource object="Blue Prism - System (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="7a66f2e5-30f8-4861-bdc5-05653ce0a270" name="Sign In Auth Server" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-900" w="120" h="30" />
    <onsuccess>4871b57c-1d4d-4d84-bc7f-aee22615efed</onsuccess>
    <resource object="Blue Prism" action="Sign in using Auth Server" />
  </stage>
  <stage stageid="4871b57c-1d4d-4d84-bc7f-aee22615efed" name="IMS Server:Attach" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-855" w="120" h="30" />
    <onsuccess>597b9517-3015-4205-b6a0-98481a9af80a</onsuccess>
    <resource object="IMS Server" action="Attach" />
  </stage>
  <stage stageid="597b9517-3015-4205-b6a0-98481a9af80a" name="IMS Server:Login" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-810" w="120" h="30" />
    <inputs>
      <input type="text" name="Username" friendlyname="Username" expr="&quot;admin&quot;" />
      <input type="text" name="Password" friendlyname="Password" expr="&quot;Qq1234!!&quot;" />
    </inputs>
    <onsuccess>9a3c663b-53ee-4c6b-ac09-4991295e51de</onsuccess>
    <resource object="IMS Server" action="Login" />
  </stage>
  <stage stageid="a22cc574-fb41-4344-bdaa-0eefba979ef3" name="Browse to System" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <display x="15" y="-660" w="120" h="30" />
    <inputs>
      <input type="text" name="Tab Name" friendlyname="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>95a79b4b-07a8-4175-80ea-25d5175378c8</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="9a3c663b-53ee-4c6b-ac09-4991295e51de" name="Setup Credential" type="Action">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-750" w="90" h="30" />
    <inputs>
      <input type="flag" name="Requires Login" friendlyname="Requires Login" narrative="Flag indicating if the login info should be given too" expr="True" />
      <input type="text" name="Arguments" friendlyname="Arguments" narrative="The arguments to pass to automatec, not including the authentication info" expr="&quot;/createcredential &quot;&quot;BPE-API-Credential&quot;&quot; ServiceAccount E3NbGuz9G/nSpQWdz6DMROZhtIDHtUhev13wsCV72fY=  /credentialtype OAuth2ClientCredentials&quot;" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username that you want to authenticate against." expr="" />
      <input type="text" name="Password" friendlyname="Password" narrative="The password for the username." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Output" friendlyname="Output" narrative="The output from the command" stage="" />
    </outputs>
    <onsuccess>8a03e708-9913-48ed-ae12-a5bb8b604379</onsuccess>
    <resource object="Call AutomateC" action="Call AutomateC" />
  </stage>
  <stage stageid="2f3b54de-d1c4-49e3-858b-b2aab772454c" name="Credential already exists?" type="Recover">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit />
    <display x="120" y="-750" w="90" h="30" />
    <onsuccess>e34fa017-0b2e-405f-8deb-c9ef98ebcec1</onsuccess>
  </stage>
  <stage stageid="e34fa017-0b2e-405f-8deb-c9ef98ebcec1" name="Resume1" type="Resume">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit />
    <display x="120" y="-690" w="90" h="30" />
    <onsuccess>8a03e708-9913-48ed-ae12-a5bb8b604379</onsuccess>
  </stage>
  <stage stageid="8a03e708-9913-48ed-ae12-a5bb8b604379" name="Anchor14" type="Anchor">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-690" w="10" h="10" />
    <onsuccess>a22cc574-fb41-4344-bdaa-0eefba979ef3</onsuccess>
  </stage>
  <stage stageid="e1612a7b-9847-4a00-a7b4-69110d69690c" name="Create credential" type="Block">
    <subsheetid>35e4a25d-3be4-4079-9172-6a5adeca098f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-780" w="225" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
</process>