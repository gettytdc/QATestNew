<process name="Audit Log Test - Scheduler" version="1.0" bpversion="6.11.0.34321" narrative="Testing audit log for process manipulation." byrefcollection="true" preferredid="b90dd348-c2c0-4ded-ac44-6c7b904f84bd">
  <view>
    <camerax>15</camerax>
    <cameray>-1247</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="f2127935-8599-46f6-b942-990e12a48796" type="Normal" published="False">
    <name>Setup</name>
    <view>
      <camerax>0</camerax>
      <cameray>495</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5" type="Normal" published="False">
    <name>Audit - Create Schedule</name>
    <view>
      <camerax>0</camerax>
      <cameray>44</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="45dc96dc-a141-4db5-ac44-1169bdb30fe7" type="Normal" published="False">
    <name>Audit - Edit Schedule</name>
    <view>
      <camerax>0</camerax>
      <cameray>84</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="2e5d3b18-db3c-4988-9585-264fc77e013f" type="Normal" published="False">
    <name>Audit - Delete Schedule</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="6a7958c3-eb61-4d5b-b354-738be89bb263" type="Normal" published="False">
    <name>Compare Collections</name>
    <view>
      <camerax>0</camerax>
      <cameray>84</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="73efd86a-ba69-4d45-885d-704597548f6a" type="Normal" published="False">
    <name>Get Audit Log</name>
    <view>
      <camerax>0</camerax>
      <cameray>63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ae5004f8-45e0-439a-9f14-38e1d1232c95" type="Normal" published="False">
    <name>CleanUp</name>
    <view>
      <camerax>0</camerax>
      <cameray>-21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="542de988-14bf-414c-b734-a384d34ff81a" name="Stage1" type="ProcessInfo">
    <display x="-165" y="-1440" w="150" h="90" />
  </stage>
  <stage stageid="76470549-20b5-4594-8ab9-d809ea2d103a" name="CleanUp" type="SubSheetInfo">
    <subsheetid>ae5004f8-45e0-439a-9f14-38e1d1232c95</subsheetid>
    <narrative>Logs out of Blue Prism and Logs back in immediately.</narrative>
    <display x="-165" y="-75" w="150" h="90" />
  </stage>
  <stage stageid="1a676fa1-1713-4ee3-a121-b484fce51507" name="Start" type="Start">
    <subsheetid>ae5004f8-45e0-439a-9f14-38e1d1232c95</subsheetid>
    <preconditions>
      <condition narrative="None." />
    </preconditions>
    <postconditions>
      <condition narrative="None." />
    </postconditions>
    <display x="-15" y="-105" w="90" h="30" />
    <onsuccess>36c88964-2cd4-4873-b6c8-d77e9b855694</onsuccess>
  </stage>
  <stage stageid="1a84c265-9d0c-4cb2-8b5b-c5cf45cd7df6" name="End" type="End">
    <subsheetid>ae5004f8-45e0-439a-9f14-38e1d1232c95</subsheetid>
    <display x="-15" y="30" w="90" h="30" />
  </stage>
  <stage stageid="6e29bf0e-491f-46ee-90ba-3c744324b740" name="Get Audit Log" type="SubSheetInfo">
    <subsheetid>73efd86a-ba69-4d45-885d-704597548f6a</subsheetid>
    <narrative>Gets Content of Audit Log table.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="d78f33bd-4788-4408-b618-028c4c7c84b7" name="Start" type="Start">
    <subsheetid>73efd86a-ba69-4d45-885d-704597548f6a</subsheetid>
    <preconditions>
      <condition narrative="None." />
    </preconditions>
    <postconditions>
      <condition narrative="None." />
    </postconditions>
    <display x="-45" y="-135" w="90" h="30" />
    <onsuccess>d88a5280-4ebf-4851-820a-f50772a7d365</onsuccess>
  </stage>
  <stage stageid="c5ce0b84-7e6d-4fa8-95e4-1c940e26fbe4" name="End" type="End">
    <subsheetid>73efd86a-ba69-4d45-885d-704597548f6a</subsheetid>
    <display x="-45" y="90" w="90" h="30" />
  </stage>
  <stage stageid="d88a5280-4ebf-4851-820a-f50772a7d365" name="Go to System" type="Action">
    <subsheetid>73efd86a-ba69-4d45-885d-704597548f6a</subsheetid>
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;System&quot;" />
    </inputs>
    <onsuccess>e8a6aa43-499e-431a-a737-a5f35cf57237</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="e8a6aa43-499e-431a-a737-a5f35cf57237" name="Select Audit Logs" type="Action">
    <subsheetid>73efd86a-ba69-4d45-885d-704597548f6a</subsheetid>
    <display x="-45" y="-45" w="90" h="30" />
    <inputs>
      <input type="text" name="Tree Name" narrative="Name of the tree to be extended." expr="&quot;Audit&quot;" />
      <input type="text" name="Item Name" narrative="Name of the item to be clicked on." expr="&quot;Audit Logs&quot;" />
    </inputs>
    <onsuccess>17ed75ef-a55e-43ae-b6aa-93c3106c30c1</onsuccess>
    <resource object="Blue Prism - System - Basic Actions" action="Click Item From System Tree" />
  </stage>
  <stage stageid="17ed75ef-a55e-43ae-b6aa-93c3106c30c1" name="Get Audit Log Table" type="Action">
    <subsheetid>73efd86a-ba69-4d45-885d-704597548f6a</subsheetid>
    <display x="-45" y="0" w="90" h="30" />
    <inputs>
      <input type="date" name="Audit Date" narrative="Date for the Audit to View" expr="Today()" />
    </inputs>
    <outputs>
      <output type="collection" name="Audit Log Table" narrative="Contents of the Audit Log Viewer" stage="Audit Log Table" />
    </outputs>
    <onsuccess>f7e34b91-a269-4ac5-83a6-7105fef1dd4d</onsuccess>
    <resource object="Blue Prism - System - Audit" action="Get View Log Content for Audit Log" />
  </stage>
  <stage stageid="f7e34b91-a269-4ac5-83a6-7105fef1dd4d" name="Reverse Collection" type="Action">
    <subsheetid>73efd86a-ba69-4d45-885d-704597548f6a</subsheetid>
    <display x="-45" y="45" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" narrative="The collection to be reversed." expr="[Audit Log Table]" />
    </inputs>
    <outputs>
      <output type="collection" name="Reversed Collection" narrative="The reversed collection." stage="Audit Log Table" />
    </outputs>
    <onsuccess>c5ce0b84-7e6d-4fa8-95e4-1c940e26fbe4</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Reverse Collection" />
  </stage>
  <stage stageid="4e2a8a29-7e88-41c7-a32c-58d553f9d692" name="Compare Collections" type="SubSheetInfo">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <narrative>Compares values recorded in Audit Log against values that are EXPECTED in Audit Log.</narrative>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="16aecce5-4f1b-4b0f-b1b3-474f0d5c6c75" name="Start" type="Start">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <preconditions>
      <condition narrative="None." />
    </preconditions>
    <postconditions>
      <condition narrative="None." />
    </postconditions>
    <display x="-45" y="-135" w="90" h="30" />
    <inputs>
      <input type="collection" name="Expected Audit" narrative="Expected Audit Log" stage="Expected Audit Log" />
    </inputs>
    <onsuccess>6b4c9712-d418-4ea9-8263-da1a818efd38</onsuccess>
  </stage>
  <stage stageid="df29c3d3-3e29-4d88-a197-a07dec8ce500" name="End" type="End">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="-45" y="180" w="90" h="30" />
  </stage>
  <stage stageid="20970d30-7c6d-42a4-8f17-8c383b8263b5" name="Expected Audit Log" type="Collection">
    <display x="-330" y="-1140" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="Narrative" type="text" />
      <field name="Comments" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="891f6bf9-f367-496a-93b4-288aa8a46456" name="Audit Log Table" type="LoopStart">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="-45" y="-45" w="90" h="30" />
    <onsuccess>1d06d2a5-45ac-4ec6-93aa-23dfcdb4d84a</onsuccess>
    <groupid>c3aea702-52cd-4961-beeb-0459c26d1642</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Audit Log Table</loopdata>
  </stage>
  <stage stageid="f8889b13-4551-46fd-9a8c-e4c66103a97c" name="Audit Log Table" type="LoopEnd">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="-45" y="90" w="90" h="30" />
    <onsuccess>ab45794f-9ec7-45f5-abcf-365f59dcefa0</onsuccess>
    <groupid>c3aea702-52cd-4961-beeb-0459c26d1642</groupid>
  </stage>
  <stage stageid="1d06d2a5-45ac-4ec6-93aa-23dfcdb4d84a" name="Correct Time?" type="Decision">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="-45" y="0" w="90" h="30" />
    <decision expression="ToTime([Audit Log Table.Time (Local)]) &gt; [Current UTC Time]" />
    <ontrue>bc2d056a-caae-434a-ab71-9e5f96cf5a3c</ontrue>
    <onfalse>60119ecd-0a9f-40ea-b42a-fa795caae253</onfalse>
  </stage>
  <stage stageid="6b4c9712-d418-4ea9-8263-da1a818efd38" name="Expected Audit Log" type="LoopStart">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="-45" y="-90" w="90" h="30" />
    <onsuccess>891f6bf9-f367-496a-93b4-288aa8a46456</onsuccess>
    <groupid>6b15c03c-3628-4774-9b68-9f005f4f6e72</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Expected Audit Log</loopdata>
  </stage>
  <stage stageid="ab45794f-9ec7-45f5-abcf-365f59dcefa0" name="Expected Audit Log" type="LoopEnd">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="-45" y="135" w="90" h="30" />
    <onsuccess>df29c3d3-3e29-4d88-a197-a07dec8ce500</onsuccess>
    <groupid>6b15c03c-3628-4774-9b68-9f005f4f6e72</groupid>
  </stage>
  <stage stageid="bc2d056a-caae-434a-ab71-9e5f96cf5a3c" name="Found Match?" type="Decision">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="-45" y="45" w="90" h="30" />
    <decision expression="(InStr([Audit Log Table.Comments], [Expected Audit Log.Comments]) &gt; 0&#xA;AND&#xA;InStr([Audit Log Table.Narrative], [Expected Audit Log.Narrative]) &gt; 0)&#xA;OR&#xA;([Audit Log Table.Comments] = [Expected Audit Log.Comments]&#xA;AND&#xA;InStr([Audit Log Table.Narrative], [Expected Audit Log.Narrative]) &gt; 0)" />
    <ontrue>d66503c1-7fce-463e-ab3b-89146813f3f7</ontrue>
    <onfalse>f8889b13-4551-46fd-9a8c-e4c66103a97c</onfalse>
  </stage>
  <stage stageid="60119ecd-0a9f-40ea-b42a-fa795caae253" name="Result Not Found" type="Exception">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="75" y="0" w="90" h="30" />
    <exception type="System Exception" detail="&quot;Following Record was not found in Audit log: Narrative containing &lt;&quot; &amp; [Expected Audit Log.Narrative] &amp; &quot;&gt; and Comment containing &lt;&quot; &amp; [Expected Audit Log.Comments] &amp; &quot;&gt;&quot;" />
  </stage>
  <stage stageid="d66503c1-7fce-463e-ab3b-89146813f3f7" name="Anchor1" type="Anchor">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="30" y="45" w="10" h="10" />
    <onsuccess>bbb3ae82-79f0-471a-a27b-82a3e2f4da2c</onsuccess>
  </stage>
  <stage stageid="bbb3ae82-79f0-471a-a27b-82a3e2f4da2c" name="Anchor2" type="Anchor">
    <subsheetid>6a7958c3-eb61-4d5b-b354-738be89bb263</subsheetid>
    <display x="30" y="135" w="10" h="10" />
    <onsuccess>ab45794f-9ec7-45f5-abcf-365f59dcefa0</onsuccess>
  </stage>
  <stage stageid="56702721-b009-4c7d-8911-8401754012e1" name="Scheduler Variables" type="Block">
    <display x="-405" y="-1380" w="150" h="330" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="2f8f8384-8f94-4966-ba56-4e2935a3d7ca" name="RuntimeResPID" type="Data">
    <display x="-165" y="-1260" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="6c2eff51-e9b4-4a83-987f-2ad544a298a3" name="Time" type="Data">
    <display x="-330" y="-1110" w="120" h="30" />
    <datatype>time</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="ff79e8ae-52cb-4d0f-bea3-76f2e44d82f0" name="Tasks" type="Collection">
    <loginhibit />
    <display x="-330" y="-1290" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="Task Name" type="text" description="The name of the task to create" />
      <field name="On Success" type="text" description="The task to perform on successful completion of the task, leave blank for default (Stop)" />
      <field name="On Failure" type="text" description="The task to perform on failure of the task, leave blank for default (Abort)" />
      <field name="Sessions" type="collection" description="The sessions to create on the task">
        <field name="Process Group" type="text" description="The group within which the process can be found, leave empty for no group" />
        <field name="Process Name" type="text" description="The name of the process to create in the session" />
        <field name="Resource Name" type="text" description="The name of the resource to run the process on" />
      </field>
      <field name="Fail Fast" type="flag" description="True to fail the task immediately on any errors; False to let other sessions run - Defaults to True" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Task Name" type="text" value="myAuditTestTask" />
        <field name="On Success" type="text" value="" />
        <field name="On Failure" type="text" value="" />
        <field name="Sessions" type="collection" />
        <field name="Fail Fast" type="flag" value="" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="0bc7e280-c66a-44a3-b5b4-df88431c257d" name="Port" type="Data">
    <display x="-165" y="-1230" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>9826</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="c0dd1887-ff5f-4ccc-9a7a-16b67c7976b5" name="Resource Name" type="Data">
    <display x="-330" y="-1200" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="04f1c634-8b4d-40b9-a423-df09562b5a1e" name="Schedule Name" type="Data">
    <display x="-330" y="-1350" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">My Audit Test Schedule</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="41c32c1a-4a03-4f64-9fc9-5f1d8dde38a2" name="Command PID" type="Data">
    <display x="-165" y="-1200" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="d3bafb31-5fa5-40bb-bdfe-d62668368f1e" name="Username" type="Data">
    <display x="-165" y="-1350" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">admin</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="d6e61fce-67a5-40ea-ab55-be2b7df06c80" name="Password" type="Data">
    <display x="-165" y="-1320" w="120" h="30" />
    <datatype>password</datatype>
    <initialvalueenc>32,17,25,89,3</initialvalueenc>
    <alwaysinit />
  </stage>
  <stage stageid="12cf2ec5-ae19-4a5e-9d7a-a4e5710fa3a3" name="Global Variables" type="Block">
    <display x="-240" y="-1380" w="150" h="210" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="459c6e33-9da9-4c16-a896-68e2c4f135be" name="BluePrism PID" type="Data">
    <display x="-165" y="-1290" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="66d5bd4e-b8ee-47fc-90a4-d8fda4bf5775" name="Audit Log Table" type="Collection">
    <display x="-330" y="-1170" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="Time (Local)" type="text" />
      <field name="Narrative" type="text" />
      <field name="Comments" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="6c6899a3-9124-4656-92da-ab91119ad512" name="Current UserName" type="Data">
    <display x="-330" y="-1260" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="bb256380-dec0-48af-a61a-d137624b3d19" name="Current UTC Time" type="Data">
    <display x="-330" y="-1230" w="120" h="30" />
    <datatype>time</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="e42a8feb-73af-4189-ac00-56678b0edc53" name="Process Name" type="Data">
    <display x="-330" y="-1320" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Audit Log Test</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="d56b77d5-8adc-4e92-acc1-63bc1c96ded8" name="Setup" type="SubSheetInfo">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="0384962d-13ca-453e-9c93-6cc82c3e1d7c" name="Start" type="Start">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>fa75ab7d-2e74-4bf5-97a0-3b8be70dcc64</onsuccess>
  </stage>
  <stage stageid="bf7f9243-bf52-415b-b9b8-4d05ec8f712a" name="End" type="End">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="495" />
  </stage>
  <stage stageid="588b44f8-99fb-47a5-b857-9af9fe97f45a" name="Launch BP" type="Action">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="0" w="90" h="30" />
    <outputs>
      <output type="number" name="pid" narrative="PID of the process" stage="BluePrism PID" />
    </outputs>
    <onsuccess>0db064f1-ed8c-481c-9cdd-1d0448d7f999</onsuccess>
    <resource object="Blue Prism" action="Launch and Get PID" />
  </stage>
  <stage stageid="bff76489-de7e-4d14-9366-67df720de0d4" name="Sign In" type="Action">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="180" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" expr="[Username]" />
      <input type="password" name="Password" expr="[Password]" />
      <input type="password" name="New Password" narrative="If this is your first login it will prompt you to change the password." expr="" />
    </inputs>
    <onsuccess>ff5f3a6a-2e86-4cdb-a433-505b89d2dc2b</onsuccess>
    <resource object="Blue Prism" action="Sign In" />
  </stage>
  <stage stageid="fa75ab7d-2e74-4bf5-97a0-3b8be70dcc64" name="Get Username" type="Calculation">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="-90" w="90" h="30" />
    <onsuccess>65654a28-926c-4eb3-b671-970cd5329ab2</onsuccess>
    <calculation expression="GetUserName()" stage="Current UserName" />
  </stage>
  <stage stageid="65654a28-926c-4eb3-b671-970cd5329ab2" name="Get UTC Time" type="Calculation">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="-45" w="90" h="30" />
    <onsuccess>588b44f8-99fb-47a5-b857-9af9fe97f45a</onsuccess>
    <calculation expression="UTCTime()" stage="Current UTC Time" />
  </stage>
  <stage stageid="584f7543-57d8-4f8c-b937-1cc7f0f8c4cf" name="Start Resource" type="Action">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="270" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number on which the resource PC should listen" expr="[Port]" />
      <input type="flag" name="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="False" />
      <input type="text" name="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="[Username]" />
      <input type="password" name="Password" narrative="The password to use for the resource. Only used if Username is given" expr="[Password]" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" narrative="The PID of the newly created process" stage="RuntimeResPID" />
    </outputs>
    <onsuccess>be763e1c-619c-4ac6-8f5a-0385cf5d1cab</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="d4a3745b-45d0-4569-aa34-d88f54d77a46" name="Get Time" type="Calculation">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="405" w="90" h="30" />
    <onsuccess>d757883c-9dd1-4102-902f-ab745cea30d4</onsuccess>
    <calculation expression="LocalTime()+MakeTimeSpan(0, 0, 2, 0, 0)" stage="Time" />
  </stage>
  <stage stageid="d757883c-9dd1-4102-902f-ab745cea30d4" name="Get Resource Name" type="Calculation">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="450" w="90" h="30" />
    <onsuccess>bf7f9243-bf52-415b-b9b8-4d05ec8f712a</onsuccess>
    <calculation expression="Replace(GetResourceName(), &quot;_debug&quot;, &quot;&quot;)" stage="Resource Name" />
  </stage>
  <stage stageid="8b649cb4-e21d-443c-aa40-41fc6f7117db" name="Publish Process" type="Action">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="345" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" narrative="The name of the process to publish" expr="&quot;Audit wait two minutes&quot;" />
    </inputs>
    <onsuccess>d4a3745b-45d0-4569-aa34-d88f54d77a46</onsuccess>
    <resource object="Blue Prism - Studio - Process / Object" action="Publish Process" />
  </stage>
  <stage stageid="a193693f-5180-499c-8af7-fb5bfd33ca68" name="Catch" type="Block">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-105" y="315" w="210" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="326cc5a4-dd36-4430-b0dd-3caa761d3374" name="Recover1" type="Recover">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="60" y="345" />
    <onsuccess>6dfacc9f-b857-4645-9fe9-bb809571699e</onsuccess>
  </stage>
  <stage stageid="6dfacc9f-b857-4645-9fe9-bb809571699e" name="Resume1" type="Resume">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="150" y="345" />
    <onsuccess>754d55ca-8138-43ef-a2b9-e10eff219d26</onsuccess>
  </stage>
  <stage stageid="754d55ca-8138-43ef-a2b9-e10eff219d26" name="Anchor4" type="Anchor">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="150" y="405" w="10" h="10" />
    <onsuccess>4ecb7a1b-c44e-4dc7-af53-579c8dd3e83b</onsuccess>
  </stage>
  <stage stageid="4ecb7a1b-c44e-4dc7-af53-579c8dd3e83b" name="Note2" type="Note">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <narrative>Ignore exception - already published</narrative>
    <display x="75" y="405" w="90" h="30" />
    <onsuccess>d4a3745b-45d0-4569-aa34-d88f54d77a46</onsuccess>
  </stage>
  <stage stageid="0db064f1-ed8c-481c-9cdd-1d0448d7f999" name="Attach Studio" type="Action">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="45" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[BluePrism PID]" />
    </inputs>
    <onsuccess>c37b9d43-77da-4b9c-bbab-8411c6d46a1c</onsuccess>
    <resource object="Blue Prism - Studio (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="c37b9d43-77da-4b9c-bbab-8411c6d46a1c" name="Attach System" type="Action">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="90" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[BluePrism PID]" />
    </inputs>
    <onsuccess>863bbecf-0ae6-4537-a424-dc6539bd6713</onsuccess>
    <resource object="Blue Prism - System (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="863bbecf-0ae6-4537-a424-dc6539bd6713" name="Attach Control" type="Action">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="135" w="90" h="30" />
    <inputs>
      <input type="number" name="pid" narrative="PID to attach to" expr="[BluePrism PID]" />
    </inputs>
    <onsuccess>bff76489-de7e-4d14-9366-67df720de0d4</onsuccess>
    <resource object="Blue Prism - Control Room (Parent)" action="Attach to Pid" />
  </stage>
  <stage stageid="79cdebc6-3b9e-4fe9-bae8-990dc0e042af" name="Start Resource (SSO)" type="Action">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="60" y="270" w="90" h="30" />
    <inputs>
      <input type="number" name="Port" narrative="The port number on which the resource PC should listen" expr="[Port]" />
      <input type="flag" name="SSO" narrative="True to login using Active Directory authentication. If this is False and Username is empty, a public resource PC is started" expr="True" />
      <input type="text" name="Username" narrative="The username to use for the resource PC. Ignored if SSO is True. If this is empty and SSO is False, this will create a public resource" expr="" />
      <input type="password" name="Password" narrative="The password to use for the resource. Only used if Username is given" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Process ID" narrative="The PID of the newly created process" stage="RuntimeResPID" />
    </outputs>
    <onsuccess>eeba310a-81f8-4955-874a-c8984412b666</onsuccess>
    <resource object="Resource Manager" action="Start Resource" />
  </stage>
  <stage stageid="ff5f3a6a-2e86-4cdb-a433-505b89d2dc2b" name="SSO?" type="Decision">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <display x="-45" y="225" w="90" h="30" />
    <decision expression="SingleSignon()" />
    <ontrue>299f013d-5722-4f51-b769-a314cee3e29d</ontrue>
    <onfalse>584f7543-57d8-4f8c-b937-1cc7f0f8c4cf</onfalse>
  </stage>
  <stage stageid="299f013d-5722-4f51-b769-a314cee3e29d" name="Anchor3" type="Anchor">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="225" w="10" h="10" />
    <onsuccess>79cdebc6-3b9e-4fe9-bae8-990dc0e042af</onsuccess>
  </stage>
  <stage stageid="eeba310a-81f8-4955-874a-c8984412b666" name="Anchor5" type="Anchor">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="300" w="10" h="10" />
    <onsuccess>be763e1c-619c-4ac6-8f5a-0385cf5d1cab</onsuccess>
  </stage>
  <stage stageid="be763e1c-619c-4ac6-8f5a-0385cf5d1cab" name="Anchor9" type="Anchor">
    <subsheetid>f2127935-8599-46f6-b942-990e12a48796</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="300" w="10" h="10" />
    <onsuccess>8b649cb4-e21d-443c-aa40-41fc6f7117db</onsuccess>
  </stage>
  <stage stageid="36c88964-2cd4-4873-b6c8-d77e9b855694" name="Sign Out" type="Action">
    <subsheetid>ae5004f8-45e0-439a-9f14-38e1d1232c95</subsheetid>
    <display x="-15" y="-60" w="90" h="30" />
    <onsuccess>8e7cbb14-8c39-4e24-bc00-8ba506ab06a0</onsuccess>
    <resource object="Blue Prism" action="Sign Out" />
  </stage>
  <stage stageid="8e7cbb14-8c39-4e24-bc00-8ba506ab06a0" name="Exit Blue Prism" type="Action">
    <subsheetid>ae5004f8-45e0-439a-9f14-38e1d1232c95</subsheetid>
    <display x="-15" y="-15" w="90" h="30" />
    <onsuccess>1a84c265-9d0c-4cb2-8b5b-c5cf45cd7df6</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="718afcae-b530-49ee-94fa-5597d3063e4a" name="Audit - Create Schedule" type="SubSheetInfo">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="8544ab01-8332-4835-b028-b9911e6405e6" name="Start" type="Start">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>d9c917e3-d68f-4af4-abfd-0ec2d8c8f171</onsuccess>
  </stage>
  <stage stageid="4c777a46-6d21-4cdd-8f96-2964f9edaaa8" name="End" type="End">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="315" />
  </stage>
  <stage stageid="eddf82f8-50c4-4c85-9647-97812700789c" name="Audit - Edit Schedule" type="SubSheetInfo">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="415c2d08-f668-4625-8e6f-937acf0767e6" name="Start" type="Start">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>6ab4744b-ab78-43c4-8c97-22f08414b1ae</onsuccess>
  </stage>
  <stage stageid="99282397-46f4-42a4-9264-6a11a9d097ce" name="Audit - Delete Schedule" type="SubSheetInfo">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="f406d338-be55-4d2e-9793-ee9b1e5bfcba" name="Start" type="Start">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>e20d7a6f-fd26-4c08-abcb-7a88082f5013</onsuccess>
  </stage>
  <stage stageid="02f4ea3c-9d58-4259-8853-e18e842e044d" name="End" type="End">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-45" y="225" />
  </stage>
  <stage stageid="b0dbb180-0c58-4c25-8179-a8e7f8aaae3e" name="Get Audit Log" type="SubSheet">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="135" w="90" h="30" />
    <onsuccess>60832e65-2927-4907-bd1b-b59e19ed49f5</onsuccess>
    <processid>73efd86a-ba69-4d45-885d-704597548f6a</processid>
  </stage>
  <stage stageid="60832e65-2927-4907-bd1b-b59e19ed49f5" name="Add Row" type="Action">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="180" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Expected Audit Log&quot;" />
    </inputs>
    <onsuccess>d6e68e39-14b3-43d6-a224-26f01d92f4a0</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="d6e68e39-14b3-43d6-a224-26f01d92f4a0" name="Populate Collection" type="MultipleCalculation">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="225" w="90" h="30" />
    <onsuccess>4326da21-cc54-4c5e-adf7-91fb2de3ff4c</onsuccess>
    <steps>
      <calculation expression="&quot;The user '&quot; &amp; [Current UserName] &amp; &quot;' created the schedule '&quot; &amp; [Schedule Name] &amp; &quot;'&quot;" stage="Expected Audit Log.Narrative" />
      <calculation expression="&quot;&quot;" stage="Expected Audit Log.Comments" />
    </steps>
  </stage>
  <stage stageid="4326da21-cc54-4c5e-adf7-91fb2de3ff4c" name="Compare Collections" type="SubSheet">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="270" w="90" h="30" />
    <inputs>
      <input type="collection" name="Expected Audit" narrative="Expected Audit Log" expr="[Expected Audit Log]" />
    </inputs>
    <onsuccess>4c777a46-6d21-4cdd-8f96-2964f9edaaa8</onsuccess>
    <processid>6a7958c3-eb61-4d5b-b354-738be89bb263</processid>
  </stage>
  <stage stageid="218de12c-5648-49fd-8cd4-cf27e3c3bbb9" name="Create Schedule" type="Action">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="90" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" narrative="The name of the schedule to create" expr="[Schedule Name]" />
      <input type="date" name="Start Date" narrative="The start date for the schedule" expr="Today()" />
      <input type="time" name="Start Time" narrative="The start time for the schedule" expr="[Time]" />
      <input type="collection" name="Tasks" narrative="The tasks to run" expr="[Tasks]" />
      <input type="text" name="Group To Expand" narrative="Group contianing Process" expr="" />
      <input type="text" name="Resource Group To Expand" narrative="Group containing resources in schedule" expr="" />
    </inputs>
    <onsuccess>b0dbb180-0c58-4c25-8179-a8e7f8aaae3e</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Create Schedule" />
  </stage>
  <stage stageid="d9c917e3-d68f-4af4-abfd-0ec2d8c8f171" name="Sessions.AddRow()" type="Action">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <loginhibit />
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Tasks.Sessions&quot;" />
    </inputs>
    <onsuccess>e759380a-78fc-4486-b0b6-4e60a5e237ea</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="e759380a-78fc-4486-b0b6-4e60a5e237ea" name="Set Session Details" type="MultipleCalculation">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <loginhibit />
    <display x="-45" y="-45" w="90" h="30" />
    <onsuccess>716cc0d2-d36a-4973-af26-ce232b702aae</onsuccess>
    <steps>
      <calculation expression="&quot;Audit wait two minutes&quot;" stage="Tasks.Sessions.Process Name" />
      <calculation expression="[Resource Name]&amp;&quot;:&quot;&amp;[Port]" stage="Tasks.Sessions.Resource Name" />
    </steps>
  </stage>
  <stage stageid="fcb99b12-f03b-4828-80e6-af2ecf27310a" name="Open Control Tab" type="Action">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="45" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>218de12c-5648-49fd-8cd4-cf27e3c3bbb9</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="716cc0d2-d36a-4973-af26-ce232b702aae" name="Go Home Tab" type="Action">
    <subsheetid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</subsheetid>
    <display x="-45" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Home&quot;" />
    </inputs>
    <onsuccess>fcb99b12-f03b-4828-80e6-af2ecf27310a</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="e20d7a6f-fd26-4c08-abcb-7a88082f5013" name="Delete Schedule" type="Action">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Username" narrative="BP Username" expr="[Username]" />
      <input type="text" name="Password" narrative="BP Password" expr="[Password]" />
      <input type="text" name="Schedule Name" narrative="Name of the Schedule" expr="[Schedule Name Updated]" />
      <input type="text" name="Parameter Command" narrative="Parameter commands for Schedule. Example:  /startschedule, /deleteschedule, /viewschedtimetable and /viewschedreport" expr="&quot;/deleteschedule&quot;" />
    </inputs>
    <outputs>
      <output type="number" name="PID" narrative="Process ID" stage="Command PID" />
    </outputs>
    <onsuccess>1112dc5c-a6e9-44b1-8e4c-8598cce7a08d</onsuccess>
    <resource object="Blue Prism - Commands" action="Schedule Commands" />
  </stage>
  <stage stageid="f881cf63-c4ec-42a9-a6d2-f70514727052" name="Remove Rows" type="Action">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-45" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Expected Audit Log&quot;" />
    </inputs>
    <onsuccess>9572771f-d22d-4a91-a2f5-eb40f1db7b16</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" />
  </stage>
  <stage stageid="9572771f-d22d-4a91-a2f5-eb40f1db7b16" name="Add Row" type="Action">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-45" y="45" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Expected Audit Log&quot;" />
    </inputs>
    <onsuccess>ffe9370f-92bf-4d1c-815d-821648e8a68b</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="ffe9370f-92bf-4d1c-815d-821648e8a68b" name="Populate Collection" type="MultipleCalculation">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-45" y="90" w="90" h="30" />
    <onsuccess>0b9ffed0-1a44-4eb7-9784-c29f6721b7a4</onsuccess>
    <steps>
      <calculation expression="&quot;The user '&quot; &amp; [Current UserName] &amp; &quot;' deleted the schedule '&quot; &amp; [Schedule Name Updated] &amp; &quot;'&quot;" stage="Expected Audit Log.Narrative" />
      <calculation expression="&quot;&quot;" stage="Expected Audit Log.Comments" />
    </steps>
  </stage>
  <stage stageid="dbf229ee-9e1b-4760-81aa-243fc1e40cf0" name="Compare Collections" type="SubSheet">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-45" y="180" w="90" h="30" />
    <inputs>
      <input type="collection" name="Expected Audit" narrative="Expected Audit Log" expr="[Expected Audit Log]" />
    </inputs>
    <onsuccess>02f4ea3c-9d58-4259-8853-e18e842e044d</onsuccess>
    <processid>6a7958c3-eb61-4d5b-b354-738be89bb263</processid>
  </stage>
  <stage stageid="0b9ffed0-1a44-4eb7-9784-c29f6721b7a4" name="Get Audit Log" type="SubSheet">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <display x="-45" y="135" w="90" h="30" />
    <onsuccess>dbf229ee-9e1b-4760-81aa-243fc1e40cf0</onsuccess>
    <processid>73efd86a-ba69-4d45-885d-704597548f6a</processid>
  </stage>
  <stage stageid="1112dc5c-a6e9-44b1-8e4c-8598cce7a08d" name="Pause 60" type="Action">
    <subsheetid>2e5d3b18-db3c-4988-9585-264fc77e013f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-45" w="90" h="30" />
    <inputs>
      <input type="number" name="Duration (Seconds)" friendlyname="Duration (Seconds)" expr="60" />
    </inputs>
    <onsuccess>f881cf63-c4ec-42a9-a6d2-f70514727052</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Pause" />
  </stage>
  <stage stageid="fadadbd2-e497-4a07-b2b9-8cad9d2c22cd" name="Start" type="Start">
    <display x="75" y="-1455" />
    <onsuccess>0164f287-9287-4a82-9fa2-d35182007b55</onsuccess>
  </stage>
  <stage stageid="8106cd70-ac4c-4fb6-bdd4-c573d7b5bd4d" name="End" type="End">
    <display x="75" y="-930" />
  </stage>
  <stage stageid="90d9b74a-8508-4b9c-9917-55a0348c8fd3" name="Cleanup" type="Block">
    <display x="-75" y="-1425" w="375" h="375" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="2e445f6c-33af-4ad0-bef5-3a5599dc36b3" name="Failed?" type="Decision">
    <display x="75" y="-975" w="90" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>cfa79ab9-54c9-41c9-ab42-b5c3167a53c2</ontrue>
    <onfalse>8106cd70-ac4c-4fb6-bdd4-c573d7b5bd4d</onfalse>
  </stage>
  <stage stageid="cfa79ab9-54c9-41c9-ab42-b5c3167a53c2" name="RETHROW" type="Exception">
    <display x="165" y="-975" />
    <exception type="RETHROW" detail="[Exception]" />
  </stage>
  <stage stageid="35c8633b-c561-4ab4-943c-ac6849b7a113" name="Recover" type="Recover">
    <display x="255" y="-1170" />
    <onsuccess>03d5c2f9-ca8b-4f99-9aa1-bf1fe7b6448a</onsuccess>
  </stage>
  <stage stageid="1defb55a-a9fe-4bde-8dbf-305b230a7949" name="Resume" type="Resume">
    <display x="255" y="-1080" />
    <onsuccess>b92c5d80-6293-40df-84d7-7cb4bdf7aaf7</onsuccess>
  </stage>
  <stage stageid="03d5c2f9-ca8b-4f99-9aa1-bf1fe7b6448a" name="Exception Calc" type="MultipleCalculation">
    <display x="255" y="-1125" />
    <onsuccess>1defb55a-a9fe-4bde-8dbf-305b230a7949</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="51208aac-f208-48c2-84e7-14f81d8b45ac" name="Setup" type="SubSheet">
    <display x="75" y="-1350" w="270" h="30" />
    <onsuccess>38c8a4c8-2538-4745-ab5d-0a6d6581df64</onsuccess>
    <processid>f2127935-8599-46f6-b942-990e12a48796</processid>
  </stage>
  <stage stageid="ab7066a1-99ae-421d-b139-b7c218c1d992" name="Audit - Edit Schedule" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="75" y="-1170" w="270" h="30" />
    <onsuccess>71284b5d-5f2a-4dc9-86d5-dc01115881f6</onsuccess>
    <processid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</processid>
  </stage>
  <stage stageid="0164f287-9287-4a82-9fa2-d35182007b55" name="Note1" type="Note">
    <narrative>GIVEN There is a published process and a resource available</narrative>
    <display x="75" y="-1395" w="270" h="30" />
    <onsuccess>51208aac-f208-48c2-84e7-14f81d8b45ac</onsuccess>
  </stage>
  <stage stageid="38c8a4c8-2538-4745-ab5d-0a6d6581df64" name="Note1" type="Note">
    <narrative>WHEN I create a new schedule
THEN and audit log is registered for the setup schedule
</narrative>
    <display x="75" y="-1305" w="270" h="30" />
    <onsuccess>94e0fd9b-73da-403e-b2b8-8e5ce9b0d784</onsuccess>
  </stage>
  <stage stageid="b92c5d80-6293-40df-84d7-7cb4bdf7aaf7" name="Anchor7" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="255" y="-1020" w="10" h="10" />
    <onsuccess>3e690161-14ad-4746-8074-d794599b39ee</onsuccess>
  </stage>
  <stage stageid="86ae3c32-410a-4c56-82ab-986e68876fbc" name="Note2" type="Note">
    <narrative>WHEN I edit the schedule
THEN and audit log is registered for the modified schedule</narrative>
    <display x="75" y="-1215" w="270" h="30" />
    <onsuccess>ab7066a1-99ae-421d-b139-b7c218c1d992</onsuccess>
  </stage>
  <stage stageid="94e0fd9b-73da-403e-b2b8-8e5ce9b0d784" name="Audit - Create Schedule" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="75" y="-1260" w="270" h="30" />
    <onsuccess>86ae3c32-410a-4c56-82ab-986e68876fbc</onsuccess>
    <processid>bd960ea0-fa1c-4b5c-b5da-fdd49437f8e5</processid>
  </stage>
  <stage stageid="3e690161-14ad-4746-8074-d794599b39ee" name="Terminate" type="Action">
    <display x="75" y="-1020" w="90" h="30" />
    <onsuccess>2e445f6c-33af-4ad0-bef5-3a5599dc36b3</onsuccess>
    <resource object="Blue Prism" action="Exit Application" />
  </stage>
  <stage stageid="55fb1eb1-6bb9-4ccc-b3ee-1b2e29530f9d" name="Audit - Delete Schedule" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="75" y="-1080" w="270" h="30" />
    <onsuccess>3e690161-14ad-4746-8074-d794599b39ee</onsuccess>
    <processid>2e5d3b18-db3c-4988-9585-264fc77e013f</processid>
  </stage>
  <stage stageid="71284b5d-5f2a-4dc9-86d5-dc01115881f6" name="Note2" type="Note">
    <narrative>WHEN I delete the schedule
THEN and audit log is registered for the deleted schedule</narrative>
    <display x="75" y="-1125" w="270" h="30" />
    <onsuccess>55fb1eb1-6bb9-4ccc-b3ee-1b2e29530f9d</onsuccess>
  </stage>
  <stage stageid="94f8ffb9-d66e-459f-abb9-5a0a2009b060" name="Local Variables" type="Block">
    <display x="-240" y="-1140" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="dadd83c9-2f3c-4aa9-b9ce-ffea78c2f89f" name="Failed?" type="Data">
    <display x="-165" y="-1110" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="e09444f6-de00-4fb0-a6a6-eb19b3d36560" name="Exception" type="Data">
    <display x="-165" y="-1080" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="6ab4744b-ab78-43c4-8c97-22f08414b1ae" name="Go to Control" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>3e3b5df5-5b58-4cad-91d8-af485c9eb9e6</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="3e3b5df5-5b58-4cad-91d8-af485c9eb9e6" name="Select Schedule" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-30" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" narrative="The name of the schedule you want to select." expr="[Schedule Name]" />
    </inputs>
    <onsuccess>0a3f5a37-3e84-45bf-b223-bb7e4397d549</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Select Schedule" />
  </stage>
  <stage stageid="0a3f5a37-3e84-45bf-b223-bb7e4397d549" name="Modify Schedule" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="15" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name you want to call the schedule." expr="[Schedule Name Updated]" />
      <input type="text" name="Description" friendlyname="Description" narrative="The description you want to give the schedule." expr="[Schedule Description]" />
      <input type="text" name="Initial Task" friendlyname="Initial Task" narrative="The initial task you want to run on the schedule." expr="[Tasks.Task Name]" />
    </inputs>
    <onsuccess>8e7e4ffe-aa0b-4f45-9482-efd0f6d82183</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Set Schedule - Basic Config" />
  </stage>
  <stage stageid="a77e6587-df8e-415f-be90-98a0a8339e7b" name="Remove Rows" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="-45" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Expected Audit Log&quot;" />
    </inputs>
    <onsuccess>2f50a5b7-6b66-425e-99b6-633e6318975e</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" />
  </stage>
  <stage stageid="2f50a5b7-6b66-425e-99b6-633e6318975e" name="Add Row" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="-45" y="150" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Expected Audit Log&quot;" />
    </inputs>
    <onsuccess>0c36d5d2-ab05-4c93-a163-3116629b969b</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="0c36d5d2-ab05-4c93-a163-3116629b969b" name="Populate Collection" type="MultipleCalculation">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="-45" y="195" w="90" h="30" />
    <onsuccess>1267a868-8810-4de1-82e4-9e02efb24ad8</onsuccess>
    <steps>
      <calculation expression="&quot;The user '&quot; &amp; [Current UserName] &amp; &quot;' modified the schedule '&quot; &amp; [Schedule Name Updated] &amp; &quot;'&quot;" stage="Expected Audit Log.Narrative" />
      <calculation expression="&quot;Name value changed (Old Value: &quot;&quot;&quot; &amp; [Schedule Name] &amp;&quot;&quot;&quot;, New Value: &quot;&quot;&quot; &amp; [Schedule Name Updated] &amp; &quot;&quot;&quot;); Description value changed (Old Value: &quot;&quot;&quot; &amp; &quot;&quot;&quot;&quot; &amp;&quot;, New Value: &quot;&quot;&quot; &amp; [Schedule Description] &amp; &quot;&quot;&quot;);&quot; " stage="Expected Audit Log.Comments" />
    </steps>
  </stage>
  <stage stageid="b49013f3-e9df-4b34-b364-be52963d3ef9" name="Compare Collections" type="SubSheet">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="-45" y="285" w="90" h="30" />
    <inputs>
      <input type="collection" name="Expected Audit" narrative="Expected Audit Log" expr="[Expected Audit Log]" />
    </inputs>
    <onsuccess>970805e9-7e8e-40c1-ba79-8c98ee2e008d</onsuccess>
    <processid>6a7958c3-eb61-4d5b-b354-738be89bb263</processid>
  </stage>
  <stage stageid="1267a868-8810-4de1-82e4-9e02efb24ad8" name="Get Audit Log" type="SubSheet">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="-45" y="240" w="90" h="30" />
    <onsuccess>b49013f3-e9df-4b34-b364-be52963d3ef9</onsuccess>
    <processid>73efd86a-ba69-4d45-885d-704597548f6a</processid>
  </stage>
  <stage stageid="841adacc-142d-4541-8f9a-13659d857996" name="Schedule Description" type="Data">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Adding schedule description</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2e1d18fc-9079-405e-a4b4-8b48f530d4bc" name="Task Name" type="Data">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">My Edited Schedule Task</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6fc9f9e2-7aac-4e8e-93c2-dc949cf69c61" name="End" type="End">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="105" y="345" />
  </stage>
  <stage stageid="de123022-fc6a-41fa-8eec-fa8fe78db5af" name="Modify Schedule Task" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="105" y="15" w="90" h="30" />
    <inputs>
      <input type="text" name="Name" friendlyname="Name" narrative="The name you want to call the schedule." expr="[Task Name]" />
      <input type="text" name="Description" friendlyname="Description" narrative="The description you want to give the schedule." expr="[Task Description]" />
      <input type="text" name="On complete" friendlyname="On complete" narrative="What do you want to do when this task completes?" expr="" />
      <input type="text" name="On Exception" friendlyname="On Exception" narrative="What do you want to do when this task throws an exception?" expr="" />
      <input type="number" name="Post Completion Delay" friendlyname="Post Completion Delay" narrative="0 as default, do you want a delay between this task completing and the next starting." expr="10" />
      <input type="flag" name="Fail Fast?" friendlyname="Fail Fast?" narrative="True as default. True or False do you want to fail fast enabled." expr="False" />
    </inputs>
    <onsuccess>4dc9065a-aa29-49eb-85ec-9cd1be0a7be1</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Set Task - Basic Config" />
  </stage>
  <stage stageid="319b8b6e-b60c-4084-a91c-37e3fee3ffa8" name="Remove Rows" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="105" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Expected Audit Log&quot;" />
    </inputs>
    <onsuccess>10253739-0728-44d4-81d5-f62768fd8d4f</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" />
  </stage>
  <stage stageid="10253739-0728-44d4-81d5-f62768fd8d4f" name="Add Row" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="105" y="150" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Expected Audit Log&quot;" />
    </inputs>
    <onsuccess>cdedbcf4-f266-4dd6-98da-099c1354630e</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="cdedbcf4-f266-4dd6-98da-099c1354630e" name="Populate Collection" type="MultipleCalculation">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="105" y="195" w="90" h="30" />
    <onsuccess>8448fedd-2238-469d-89cf-2aee3dd0dfd7</onsuccess>
    <steps>
      <calculation expression="&quot;The user '&quot; &amp; [Current UserName] &amp; &quot;' modified the task '&quot; &amp; [Task Name] &amp; &quot;' on the schedule '&quot; &amp; [Schedule Name Updated] &amp; &quot;'.&quot;" stage="Expected Audit Log.Narrative" />
      <calculation expression="&quot;Name value changed (Old Value: &quot;&quot;&quot; &amp; [Tasks.Task Name] &amp;&quot;&quot;&quot;, New Value: &quot;&quot;&quot; &amp; [Task Name] &amp; &quot;&quot;&quot;); Description value changed (Old Value: &quot;&quot;&quot; &amp; &quot;&quot;&quot;&quot; &amp;&quot;, New Value: &quot;&quot;&quot; &amp; [Task Description] &amp; &quot;&quot;&quot;);&quot; &amp; &quot; Fail Fast On Error value changed (Old Value: &quot;&quot;True&quot;&quot;, New Value: &quot;&quot;False&quot;&quot;); Delay After End value changed (Old Value: &quot;&quot;0&quot;&quot;, New Value: &quot;&quot;10&quot;&quot;);&quot;" stage="Expected Audit Log.Comments" />
    </steps>
  </stage>
  <stage stageid="50ca2bb8-955a-4d89-881c-be08ddaa4225" name="Compare Collections" type="SubSheet">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="105" y="285" w="90" h="30" />
    <inputs>
      <input type="collection" name="Expected Audit" narrative="Expected Audit Log" expr="[Expected Audit Log]" />
    </inputs>
    <onsuccess>6fc9f9e2-7aac-4e8e-93c2-dc949cf69c61</onsuccess>
    <processid>6a7958c3-eb61-4d5b-b354-738be89bb263</processid>
  </stage>
  <stage stageid="8448fedd-2238-469d-89cf-2aee3dd0dfd7" name="Get Audit Log" type="SubSheet">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="105" y="240" w="90" h="30" />
    <onsuccess>50ca2bb8-955a-4d89-881c-be08ddaa4225</onsuccess>
    <processid>73efd86a-ba69-4d45-885d-704597548f6a</processid>
  </stage>
  <stage stageid="970805e9-7e8e-40c1-ba79-8c98ee2e008d" name="Anchor8" type="Anchor">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="330" w="10" h="10" />
    <onsuccess>ac8b41ba-9731-4650-a09f-4243b85c46e0</onsuccess>
  </stage>
  <stage stageid="ac8b41ba-9731-4650-a09f-4243b85c46e0" name="Anchor10" type="Anchor">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="330" w="10" h="10" />
    <onsuccess>7f96f703-bc94-4df0-8d7d-4c31dd0317cc</onsuccess>
  </stage>
  <stage stageid="7f96f703-bc94-4df0-8d7d-4c31dd0317cc" name="Anchor11" type="Anchor">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="-120" w="10" h="10" />
    <onsuccess>bd287969-471c-43b1-9bc2-a9d1b744f4c8</onsuccess>
  </stage>
  <stage stageid="bd287969-471c-43b1-9bc2-a9d1b744f4c8" name="Anchor12" type="Anchor">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="105" y="-120" w="10" h="10" />
    <onsuccess>d1afc6c0-e383-4dca-bb93-b823a4e671d5</onsuccess>
  </stage>
  <stage stageid="da908637-703f-484e-bcf6-a02b6ba916b2" name="Task Description" type="Data">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">This is a schedule task description</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c5c306d5-4393-40aa-a938-fc6e36066b63" name="Edit Schedule" type="Block">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-105" y="-60" w="120" h="375" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="9ec69bb1-c543-441c-82c3-f7d8baf7e16d" name="Edit Schedule Task" type="Block">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="-60" w="120" h="375" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="41adb719-b1e2-4b8a-9203-7cc9cdb6c37a" name="Local variables" type="Block">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="8e7e4ffe-aa0b-4f45-9482-efd0f6d82183" name="Press Apply" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="60" w="90" h="30" />
    <onsuccess>a77e6587-df8e-415f-be90-98a0a8339e7b</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Press Apply" />
  </stage>
  <stage stageid="4dc9065a-aa29-49eb-85ec-9cd1be0a7be1" name="Press Apply" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="105" y="60" w="90" h="30" />
    <onsuccess>319b8b6e-b60c-4084-a91c-37e3fee3ffa8</onsuccess>
    <resource object="Blue Prism - Control - Basic Actions" action="Press Apply" />
  </stage>
  <stage stageid="d1afc6c0-e383-4dca-bb93-b823a4e671d5" name="Go to Control" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <display x="105" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="Tab Name" narrative="Name of Tab to Click" expr="&quot;Control&quot;" />
    </inputs>
    <onsuccess>6c6ea04e-46c8-44ad-97d9-e12dbcd6d63a</onsuccess>
    <resource object="Blue Prism - Basic Actions" action="Go to Tab" />
  </stage>
  <stage stageid="6c6ea04e-46c8-44ad-97d9-e12dbcd6d63a" name="Select Schedule Task" type="Action">
    <subsheetid>45dc96dc-a141-4db5-ac44-1169bdb30fe7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="105" y="-30" w="90" h="30" />
    <inputs>
      <input type="text" name="Schedule Name" friendlyname="Schedule Name" narrative="The name of the schedule your task is under." expr="[Schedule Name Updated]" />
      <input type="text" name="Task Name" friendlyname="Task Name" narrative="The name of the task you want to select." expr="[Tasks.Task Name]" />
    </inputs>
    <onsuccess>de123022-fc6a-41fa-8eec-fa8fe78db5af</onsuccess>
    <resource object="Blue Prism - Control - Scheduler" action="Select Task (Name)" />
  </stage>
  <stage stageid="4e2f40f9-68d3-400e-945e-4c6fe9e99fbc" name="Schedule Name Updated" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-330" y="-1080" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">My Edited Audit Test Schedule</initialvalue>
    <alwaysinit />
  </stage>
</process>