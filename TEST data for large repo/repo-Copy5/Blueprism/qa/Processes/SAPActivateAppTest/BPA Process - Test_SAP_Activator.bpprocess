<process name="Test_SAP_Activator" version="1.0" bpversion="6.9.0.23334" narrative="SAP" byrefcollection="true" preferredid="7ba1468b-2827-4e5d-b95d-c1d959887cb7" published="true">
  <view>
    <camerax>-1777</camerax>
    <cameray>-1830</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="a54cf85a-63ea-4faf-b324-49fb83430233" type="Normal" published="False">
    <name>Launch Applications</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="d234fa14-b6aa-47b4-87c4-e7f45996f3a3" type="Normal" published="False">
    <name>Clean Up</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="047f5535-b273-4601-a242-0da7aa0b05b0" type="Normal" published="False">
    <name>Activate  Applications</name>
    <view>
      <camerax>283</camerax>
      <cameray>-33</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="73e00691-3aab-4910-a346-c99ffe2df1de" name="Start" type="Start">
    <display x="-1860" y="-2490" />
    <onsuccess>88d1fa76-9c4e-44a2-8336-5a99530ea8bb</onsuccess>
  </stage>
  <stage stageid="5f74dd78-2df3-46c6-9fcd-751b35d07699" name="End" type="End">
    <display x="-1860" y="-1830" />
  </stage>
  <stage stageid="3ca686d9-3cb2-4357-a6ed-81ceffdd0151" name="Stage1" type="ProcessInfo">
    <display x="-2265" y="-2400" w="270" h="90" />
  </stage>
  <stage stageid="88d1fa76-9c4e-44a2-8336-5a99530ea8bb" name="Note1" type="Note">
    <narrative>Given I have applications like SAP760, Notepad and MSPaint that needs to be brought into focus (activated)

When I use the activate action (which uses the new version of activator.exe)

Then these application should be brought into focus and be ready to use when the action is complete consistently without any crash.</narrative>
    <display x="-1860" y="-2400" w="540" h="90" />
    <font family="Segoe UI" size="11" style="Bold" color="333300" />
    <onsuccess>a1e2c592-bf6d-480b-b37e-0414807ab7b9</onsuccess>
  </stage>
  <stage stageid="09ee8b91-4951-42f0-b4cb-d22b4a20bc8e" name="Launch Applications" type="SubSheetInfo">
    <subsheetid>a54cf85a-63ea-4faf-b324-49fb83430233</subsheetid>
    <display x="-405" y="-165" w="150" h="90" />
  </stage>
  <stage stageid="64ac9e09-b481-49f6-90eb-0f40ab8215c2" name="Start" type="Start">
    <subsheetid>a54cf85a-63ea-4faf-b324-49fb83430233</subsheetid>
    <display x="-120" y="-195" />
    <onsuccess>8e49c7f8-0fc8-4d77-beb2-10efe13da8f2</onsuccess>
  </stage>
  <stage stageid="2d8a1e26-c81f-4a37-89c8-dd6f62405d0c" name="End" type="End">
    <subsheetid>a54cf85a-63ea-4faf-b324-49fb83430233</subsheetid>
    <display x="-120" y="60" />
  </stage>
  <stage stageid="8e49c7f8-0fc8-4d77-beb2-10efe13da8f2" name="Launch Notepad Application" type="Action">
    <subsheetid>a54cf85a-63ea-4faf-b324-49fb83430233</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-120" y="-135" w="180" h="30" />
    <onsuccess>86ff9ad8-dc6b-4e94-8d68-1146e5766e0b</onsuccess>
    <resource object="Test_Notepad" action="Launch Notepad" />
  </stage>
  <stage stageid="86ff9ad8-dc6b-4e94-8d68-1146e5766e0b" name="Launch SAP Application " type="Action">
    <subsheetid>a54cf85a-63ea-4faf-b324-49fb83430233</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-120" y="-75" w="180" h="30" />
    <onsuccess>bde81cf7-f06e-492b-8463-efafbcde2f43</onsuccess>
    <resource object="Test_SAP" action="SAP Application Launch" />
  </stage>
  <stage stageid="bde81cf7-f06e-492b-8463-efafbcde2f43" name="Launch Paint Application" type="Action">
    <subsheetid>a54cf85a-63ea-4faf-b324-49fb83430233</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-120" y="-15" w="180" h="30" />
    <onsuccess>2d8a1e26-c81f-4a37-89c8-dd6f62405d0c</onsuccess>
    <resource object="Test_Paint" action="Launch Paint" />
  </stage>
  <stage stageid="2978b3cf-6c96-4f46-8ee6-ee5a0af5b6f3" name="Clean Up" type="SubSheetInfo">
    <subsheetid>d234fa14-b6aa-47b4-87c4-e7f45996f3a3</subsheetid>
    <display x="-420" y="-150" w="150" h="90" />
  </stage>
  <stage stageid="048e3ee7-688d-4cfa-bbc0-5a094ac719e6" name="Start" type="Start">
    <subsheetid>d234fa14-b6aa-47b4-87c4-e7f45996f3a3</subsheetid>
    <display x="-195" y="-165" />
    <onsuccess>5f39c921-81cd-4a1e-905b-45a9f4f60477</onsuccess>
  </stage>
  <stage stageid="1b568309-34bd-4d45-8d02-b78e9a8dd6e5" name="End" type="End">
    <subsheetid>d234fa14-b6aa-47b4-87c4-e7f45996f3a3</subsheetid>
    <display x="-195" y="75" />
  </stage>
  <stage stageid="5f39c921-81cd-4a1e-905b-45a9f4f60477" name="Close Paint Application" type="Action">
    <subsheetid>d234fa14-b6aa-47b4-87c4-e7f45996f3a3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-105" w="210" h="30" />
    <onsuccess>cfc5a0e5-60b2-4151-805a-c28113ed20ef</onsuccess>
    <resource object="Test_Paint" action="Close Paint" />
  </stage>
  <stage stageid="cfc5a0e5-60b2-4151-805a-c28113ed20ef" name="Close Notepad Application" type="Action">
    <subsheetid>d234fa14-b6aa-47b4-87c4-e7f45996f3a3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-45" w="210" h="30" />
    <onsuccess>9f9c2eb8-3dd1-4190-8434-0b778fd27929</onsuccess>
    <resource object="Test_Notepad" action="Close" />
  </stage>
  <stage stageid="9f9c2eb8-3dd1-4190-8434-0b778fd27929" name="Close SAP Application" type="Action">
    <subsheetid>d234fa14-b6aa-47b4-87c4-e7f45996f3a3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="15" w="210" h="30" />
    <onsuccess>1b568309-34bd-4d45-8d02-b78e9a8dd6e5</onsuccess>
    <resource object="Test_SAP" action="Close SAP Application" />
  </stage>
  <stage stageid="a1e2c592-bf6d-480b-b37e-0414807ab7b9" name="Launch Applications" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="-1860" y="-2310" w="270" h="30" />
    <onsuccess>0cb5fd22-9f43-42b5-9694-188f9d45f98e</onsuccess>
    <processid>a54cf85a-63ea-4faf-b324-49fb83430233</processid>
  </stage>
  <stage stageid="0cb5fd22-9f43-42b5-9694-188f9d45f98e" name="Activate  Applications" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="-1860" y="-2235" w="270" h="30" />
    <onsuccess>e2f11159-bc70-42ad-9871-9571c110fbe4</onsuccess>
    <processid>047f5535-b273-4601-a242-0da7aa0b05b0</processid>
  </stage>
  <stage stageid="c9bffc81-4ef9-4f17-88f4-c3a403f725d4" name="Fail?" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-2280" y="-2190" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="69e8daf6-18b2-41a2-9560-cc39cc6ad339" name="Exception" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-2265" y="-2250" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f34f4615-b633-481d-9ac1-5d612f44e25e" name="FAIL?" type="Decision">
    <display x="-1860" y="-1890" />
    <decision expression="[Fail?]" />
    <ontrue>1fe5f088-f628-41b4-a0e0-413e94405318</ontrue>
    <onfalse>5f74dd78-2df3-46c6-9fcd-751b35d07699</onfalse>
  </stage>
  <stage stageid="1fe5f088-f628-41b4-a0e0-413e94405318" name="FAIL" type="Exception">
    <display x="-1740" y="-1890" />
    <exception localized="yes" type="SystemException" detail="[Exception]" />
  </stage>
  <stage stageid="3ed0e73c-b8ab-4425-8e5b-c54db973ed07" name="Clean Up" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="-1860" y="-2010" w="270" h="30" />
    <onsuccess>3dbe08b8-267d-4dec-ae0c-839575c2a664</onsuccess>
    <processid>d234fa14-b6aa-47b4-87c4-e7f45996f3a3</processid>
  </stage>
  <stage stageid="b2cf1ba6-fad9-4ca9-9931-f77cbd7510d9" name="Exceptions" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="-1620" y="-2175" />
    <onsuccess>92699fc6-712f-4081-a9e0-9402fff8378b</onsuccess>
    <steps>
      <calculation expression="True" stage="Fail?" />
      <calculation expression="[Exception] &amp; &quot;  -----Activate &amp; Action on Application Block Failed------  &quot; &amp; ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="ca5d3335-33cb-436c-a201-1fe6ce7be1e7" name="Active App" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-2115" y="-2280" w="615" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="92699fc6-712f-4081-a9e0-9402fff8378b" name="Resume1" type="Resume">
    <loginhibit />
    <display x="-1620" y="-2130" />
    <onsuccess>bedce997-847e-492a-9345-0b4f380485fa</onsuccess>
  </stage>
  <stage stageid="bedce997-847e-492a-9345-0b4f380485fa" name="Anchor1" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="-1860" y="-2130" w="10" h="10" />
    <onsuccess>3ed0e73c-b8ab-4425-8e5b-c54db973ed07</onsuccess>
  </stage>
  <stage stageid="9b604545-a1f1-421b-95c7-25590849bac1" name="Exceptions" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="-1635" y="-1980" />
    <onsuccess>e532ef7a-d01d-4ca4-a0b1-3fb7d68c8504</onsuccess>
    <steps>
      <calculation expression="True" stage="Fail?" />
      <calculation expression="[Exception] &amp; &quot;  -----Closing Application Block Failed------  &quot; &amp; ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="c0a4bba6-04b3-486d-ac14-74aba9edf5e9" name="Close App" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-2115" y="-2085" w="615" h="165" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e532ef7a-d01d-4ca4-a0b1-3fb7d68c8504" name="Resume1" type="Resume">
    <loginhibit />
    <display x="-1635" y="-1935" />
    <onsuccess>3dbe08b8-267d-4dec-ae0c-839575c2a664</onsuccess>
  </stage>
  <stage stageid="3dbe08b8-267d-4dec-ae0c-839575c2a664" name="Anchor1" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="-1860" y="-1935" w="10" h="10" />
    <onsuccess>f34f4615-b633-481d-9ac1-5d612f44e25e</onsuccess>
  </stage>
  <stage stageid="7eba7565-fe28-4d3a-a177-fadbf0328be7" name="Output Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-2400" y="-2295" w="255" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="f7be05d4-11a0-4a54-924c-0c40eb5f4215" name="Recover2" type="Recover">
    <loginhibit />
    <display x="-1620" y="-2220" />
    <onsuccess>b2cf1ba6-fad9-4ca9-9931-f77cbd7510d9</onsuccess>
  </stage>
  <stage stageid="5a7e2e2b-e16b-4cc9-b404-731577003719" name="Recover3" type="Recover">
    <loginhibit />
    <display x="-1635" y="-2025" />
    <onsuccess>9b604545-a1f1-421b-95c7-25590849bac1</onsuccess>
  </stage>
  <stage stageid="fd09e78b-b97d-42e6-92e3-76293e17b5fc" name="Activate  Applications" type="SubSheetInfo">
    <subsheetid>047f5535-b273-4601-a242-0da7aa0b05b0</subsheetid>
    <display x="-210" y="-105" w="180" h="90" />
  </stage>
  <stage stageid="9dfa7f3b-1669-4874-90b5-e6b64e39f9b1" name="Start" type="Start">
    <subsheetid>047f5535-b273-4601-a242-0da7aa0b05b0</subsheetid>
    <display x="150" y="-180" />
    <onsuccess>faac3ba8-0c55-4f0b-9a85-0e20c401bd4a</onsuccess>
  </stage>
  <stage stageid="2b34c002-a086-45a3-bbfd-cfa2303ccd48" name="End" type="End">
    <subsheetid>047f5535-b273-4601-a242-0da7aa0b05b0</subsheetid>
    <display x="150" y="60" />
  </stage>
  <stage stageid="faac3ba8-0c55-4f0b-9a85-0e20c401bd4a" name="Activate Notepad Application" type="Action">
    <subsheetid>047f5535-b273-4601-a242-0da7aa0b05b0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-135" w="270" h="30" />
    <onsuccess>97af662e-66c4-4a41-9533-f61ba3642bdc</onsuccess>
    <resource object="Test_Notepad" action="Activate Notepad Application" />
  </stage>
  <stage stageid="97af662e-66c4-4a41-9533-f61ba3642bdc" name="Activat  SAP  Application" type="Action">
    <subsheetid>047f5535-b273-4601-a242-0da7aa0b05b0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-75" w="270" h="30" />
    <onsuccess>e2a6108b-5fc1-4649-bf54-7cdec858c3e1</onsuccess>
    <resource object="Test_SAP" action="Activat  SAP  Application" />
  </stage>
  <stage stageid="e2a6108b-5fc1-4649-bf54-7cdec858c3e1" name="Activate Paint Application" type="Action">
    <subsheetid>047f5535-b273-4601-a242-0da7aa0b05b0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-15" w="270" h="30" />
    <onsuccess>2b34c002-a086-45a3-bbfd-cfa2303ccd48</onsuccess>
    <resource object="Test_Paint" action="Activate Paint Application" />
  </stage>
  <stage stageid="e2f11159-bc70-42ad-9871-9571c110fbe4" name="Loop To 50?" type="Decision">
    <display x="-1860" y="-2190" />
    <decision expression="[Count] = 50" />
    <ontrue>bedce997-847e-492a-9345-0b4f380485fa</ontrue>
    <onfalse>c779c2e9-1446-4b89-ac6d-cc0ba0b4927b</onfalse>
  </stage>
  <stage stageid="3f338740-70e6-4ff2-bee4-93fb75a28528" name="Count" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-2280" y="-2100" w="90" h="30" />
    <datatype>number</datatype>
    <initialvalue>1</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c779c2e9-1446-4b89-ac6d-cc0ba0b4927b" name="Count++" type="Calculation">
    <loginhibit onsuccess="true" />
    <display x="-1965" y="-2190" />
    <onsuccess>59025bb1-ef58-4ec6-93c8-31ff2a075a53</onsuccess>
    <calculation expression="[Count] +1" stage="Count" />
  </stage>
  <stage stageid="59025bb1-ef58-4ec6-93c8-31ff2a075a53" name="Anchor2" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="-2040" y="-2190" w="10" h="10" />
    <onsuccess>9c8893a8-3080-4f66-ab6c-fce951ef28c1</onsuccess>
  </stage>
  <stage stageid="9c8893a8-3080-4f66-ab6c-fce951ef28c1" name="Anchor3" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="-2040" y="-2235" w="10" h="10" />
    <onsuccess>0cb5fd22-9f43-42b5-9694-188f9d45f98e</onsuccess>
  </stage>
  <stage stageid="58e3c3e9-2b76-43c3-9293-53f8d862d1b8" name="Local Variable" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-2400" y="-2130" w="255" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
</process>