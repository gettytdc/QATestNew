<process name="MS Word Attach - Detach - Show - Hide Instance" version="1.0" bpversion="6.9.0.25101" narrative="Automated process to check  Attach / Detach and Show / Hide instance functionality in MS Word" byrefcollection="true" preferredid="41fd62e3-bcd8-4b0d-8415-dd6b00536a19">
  <view>
    <camerax>-133</camerax>
    <cameray>330</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="465649d8-2997-4e16-ba88-85b39c3402ff" type="Normal" published="False">
    <name>Attach Instance _ Detach Instance</name>
    <view>
      <camerax>99</camerax>
      <cameray>300</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="237a8efa-3100-4831-9bf2-3652dccd47b4" type="Normal" published="False">
    <name>Show_Hide Instance</name>
    <view>
      <camerax>115</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="97136c22-e8d6-4aa3-85a9-2a35a65b64b6" name="Stage1" type="ProcessInfo">
    <display x="-300" y="-45" w="150" h="90" />
  </stage>
  <stage stageid="35baaf5b-7159-47e8-bc7a-876db5668511" name="Start" type="Start">
    <display x="-45" y="-75" />
    <onsuccess>6d3bc4b2-63c1-43f2-b606-c478e5bb7e63</onsuccess>
  </stage>
  <stage stageid="9ea9ad18-ad59-4899-b692-f64bee26177d" name="QA Root" type="Data">
    <display x="-300" y="150" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="ec01c944-0bf0-4da6-b47b-85ad74226d95" name="Global Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-375" y="120" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4239d351-a2ee-4e0e-be02-5268cdfe4f53" name="Exception" type="Data">
    <display x="-300" y="75" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5a14ce32-0f0e-4bbb-8118-8e8295e8a5ce" name="Failed?" type="Data">
    <display x="-300" y="45" w="150" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="85b89dd5-4b5a-4fe4-9967-ee4ac42af8c1" name="Local Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-375" y="15" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="36fd2e8d-c3ea-467c-88e3-29bae9104cdd" name="Doc File Path" type="Data">
    <display x="-300" y="180" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">\Processes\MS Office\MS Word Sample Doc\TestDoc US-1664-4.docx</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="6faf6c85-9be3-459b-9eb0-6262918ea591" name="handle" type="Data">
    <display x="-300" y="210" w="150" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="ecfb3899-4d28-42f8-a056-d56bb3926e6b" name="End" type="End">
    <display x="-45" y="330" />
  </stage>
  <stage stageid="d4309e85-09b6-419c-9d81-1a9c607d6332" name="Failed?" type="Decision">
    <display x="-45" y="285" w="90" h="30" />
    <decision expression="[Failed?]" />
    <ontrue>b5b892d2-021b-4094-959b-ca0fba94357a</ontrue>
    <onfalse>ecfb3899-4d28-42f8-a056-d56bb3926e6b</onfalse>
  </stage>
  <stage stageid="b5b892d2-021b-4094-959b-ca0fba94357a" name="Re-Throw" type="Exception">
    <display x="60" y="285" />
    <exception localized="yes" type="RETHROW" detail="[Exception]" />
  </stage>
  <stage stageid="230ecfae-b0c3-4b17-890a-486f0443e4eb" name="Anchor1" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="135" y="240" w="10" h="10" />
    <onsuccess>f5e39b1c-e88b-4781-9793-76254cf23412</onsuccess>
  </stage>
  <stage stageid="0353eb82-1446-4b31-b52b-004ce40fe9aa" name="Exception" type="MultipleCalculation">
    <loginhibit onsuccess="true" />
    <display x="135" y="60" w="90" h="30" />
    <onsuccess>b3c55bc4-2d2e-4157-91d5-6036b8839f87</onsuccess>
    <steps>
      <calculation expression="True" stage="Failed?" />
      <calculation expression="ExceptionDetail()" stage="Exception" />
    </steps>
  </stage>
  <stage stageid="b3c55bc4-2d2e-4157-91d5-6036b8839f87" name="Resume" type="Resume">
    <loginhibit />
    <display x="135" y="105" />
    <onsuccess>230ecfae-b0c3-4b17-890a-486f0443e4eb</onsuccess>
  </stage>
  <stage stageid="0df9bf2a-0aa0-4c83-aa56-a7a9060bc1aa" name="Scenarios" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-210" y="-45" w="405" h="255" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5deabf80-88e4-4d7f-8dae-40e0681edc37" name="Recover1" type="Recover">
    <loginhibit />
    <display x="135" y="15" />
    <onsuccess>0353eb82-1446-4b31-b52b-004ce40fe9aa</onsuccess>
  </stage>
  <stage stageid="863aafc2-cb28-4e9e-8016-a9f5c1ee8ce6" name="Attach Instance _ Detach Instance" type="SubSheetInfo">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="ae67c448-d7d6-4a81-9c93-070f94ce2097" name="Start" type="Start">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>d630bd48-c144-4aa8-b5b1-c0a288bd92eb</onsuccess>
  </stage>
  <stage stageid="a798a4f5-6fbd-4e7d-aef4-0e87ce85daae" name="End" type="End">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <display x="-45" y="300" />
  </stage>
  <stage stageid="969d083a-6320-4127-8c04-a978514b878d" name="Detach Instance " type="Action">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-45" w="90" h="30" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The handle to the instance to be detached from" expr="[handle]" />
    </inputs>
    <onsuccess>98b36b2f-9e9f-4ab7-93e8-8a159c4d0715</onsuccess>
    <resource object="MS Word VBO" action="Detach Instance" />
  </stage>
  <stage stageid="6d3bc4b2-63c1-43f2-b606-c478e5bb7e63" name="Note1" type="Note">
    <narrative>GIVEN I have access to MS Word

WHEN  I Attach an Instance
THEN the instance is successfully attached 

WHEN  I Detach the Instance
THEN the instance is successfully detached</narrative>
    <display x="-45" y="15" w="270" h="90" />
    <onsuccess>74c151ef-adb3-486d-995e-abef744f1646</onsuccess>
  </stage>
  <stage stageid="74c151ef-adb3-486d-995e-abef744f1646" name="Attach Instance _ Detach Instance" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="-45" y="90" w="270" h="30" />
    <onsuccess>364019de-ec46-4a26-9e89-de70b59759b5</onsuccess>
    <processid>465649d8-2997-4e16-ba88-85b39c3402ff</processid>
  </stage>
  <stage stageid="a8afa008-5419-4297-add2-b92f5db5b72e" name="Show_Hide Instance" type="SubSheetInfo">
    <subsheetid>237a8efa-3100-4831-9bf2-3652dccd47b4</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="364019de-ec46-4a26-9e89-de70b59759b5" name="Note1" type="Note">
    <narrative>AND WHEN  I use Show or Hide instance
THEN the instance is shown or hiden</narrative>
    <display x="-45" y="135" w="270" h="30" />
    <onsuccess>dafa7caf-64c7-4fef-9258-fd61fd6b5f5f</onsuccess>
  </stage>
  <stage stageid="dafa7caf-64c7-4fef-9258-fd61fd6b5f5f" name="Show Hide Instance" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="-45" y="180" w="270" h="30" />
    <onsuccess>f5e39b1c-e88b-4781-9793-76254cf23412</onsuccess>
    <processid>237a8efa-3100-4831-9bf2-3652dccd47b4</processid>
  </stage>
  <stage stageid="d630bd48-c144-4aa8-b5b1-c0a288bd92eb" name="Attach Instance " type="Action">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="text" name="File Name" friendlyname="File Name" narrative="The full path and filename of the document that the instance should attach to, empty indicates that the topmost Word instance be attached to" expr="[QA Root] &amp; [Doc File Path]" />
    </inputs>
    <outputs>
      <output type="number" name="handle" friendlyname="handle" narrative="The handle to the newly created instance, attached to either an existing Word window or a new one." stage="handle" />
    </outputs>
    <onsuccess>969d083a-6320-4127-8c04-a978514b878d</onsuccess>
    <resource object="MS Word VBO" action="Attach Instance" />
  </stage>
  <stage stageid="b0e46144-7a73-49ef-b851-06928d5d292c" name="Start" type="Start">
    <subsheetid>237a8efa-3100-4831-9bf2-3652dccd47b4</subsheetid>
    <display x="-45" y="-135" />
    <onsuccess>ed90418b-6d6e-451f-88f9-37ba71103b4e</onsuccess>
  </stage>
  <stage stageid="8b543f19-2b5d-44f4-9b9a-5ce986ab42e1" name="End" type="End">
    <subsheetid>237a8efa-3100-4831-9bf2-3652dccd47b4</subsheetid>
    <display x="-45" y="45" />
  </stage>
  <stage stageid="58f44de6-972d-47fd-bdc4-59e0576e2fc9" name="Show Instance " type="Action">
    <subsheetid>237a8efa-3100-4831-9bf2-3652dccd47b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-45" w="90" h="30" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" expr="[handle]" />
    </inputs>
    <onsuccess>c36450d3-d8f1-4679-9c98-c931d47069f1</onsuccess>
    <resource object="MS Word VBO" action="Show" />
  </stage>
  <stage stageid="ed90418b-6d6e-451f-88f9-37ba71103b4e" name="Hide Instance " type="Action">
    <subsheetid>237a8efa-3100-4831-9bf2-3652dccd47b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="90" h="30" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" expr="[handle]" />
    </inputs>
    <onsuccess>58f44de6-972d-47fd-bdc4-59e0576e2fc9</onsuccess>
    <resource object="MS Word VBO" action="Hide" />
  </stage>
  <stage stageid="98b36b2f-9e9f-4ab7-93e8-8a159c4d0715" name="Open Instance" type="Action">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="15" w="90" h="30" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" expr="[handle]" />
      <input type="text" name="File Name" friendlyname="File Name" expr="[QA Root] &amp; [Doc File Path]" />
    </inputs>
    <outputs>
      <output type="text" name="Document Name" friendlyname="Document Name" stage="" />
    </outputs>
    <onsuccess>b40f75a6-85b9-4508-b4d6-cb0b83f3dffa</onsuccess>
    <resource object="MS Word VBO" action="Open" />
  </stage>
  <stage stageid="2bd2748e-8e77-4a86-8e05-76a583c6d68c" name="Recover2" type="Recover">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <loginhibit />
    <display x="-45" y="60" w="90" h="30" />
    <onsuccess>509cae76-494f-45e8-afb4-20d88b8799b2</onsuccess>
  </stage>
  <stage stageid="7498b39b-cdec-44d4-be95-e34b796f4544" name="Resume1" type="Resume">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <loginhibit />
    <display x="-45" y="150" w="90" h="30" />
    <onsuccess>27617d18-2bd0-4f62-9529-eb74c987254e</onsuccess>
  </stage>
  <stage stageid="509cae76-494f-45e8-afb4-20d88b8799b2" name="Error Correct?" type="Decision">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <display x="-45" y="105" w="90" h="30" />
    <decision expression="InStr(ExceptionDetail(),&quot;Could not execute code stage because exception thrown by code stage: A valid attachment to the application cannot been detected. Please check that Blue Prism is attached to an instance of the application.&quot;)&lt;&gt;0" />
    <ontrue>7498b39b-cdec-44d4-be95-e34b796f4544</ontrue>
    <onfalse>fb80aa32-15ec-4fa1-b779-23e88b181db6</onfalse>
  </stage>
  <stage stageid="fb80aa32-15ec-4fa1-b779-23e88b181db6" name="Error Failure" type="Exception">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <display x="30" y="105" w="30" h="30" />
    <exception localized="yes" type="Failed Test" detail="&quot;The error displayed is not the error expected&quot;" />
  </stage>
  <stage stageid="b40f75a6-85b9-4508-b4d6-cb0b83f3dffa" name="Fail" type="Exception">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <display x="30" y="15" w="30" h="30" />
    <exception localized="yes" type="Failed Test" detail="&quot;Expected error not displayed&quot;" />
  </stage>
  <stage stageid="a06003e3-2db5-4861-a02c-89888e9a57c2" name="Negative testing scenario" type="Block">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-105" y="-15" w="165" h="195" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="27617d18-2bd0-4f62-9529-eb74c987254e" name="Attach Instance " type="Action">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="210" w="90" h="30" />
    <inputs>
      <input type="text" name="File Name" friendlyname="File Name" narrative="The full path and filename of the document that the instance should attach to, empty indicates that the topmost Word instance be attached to" expr="[QA Root] &amp; [Doc File Path]" />
    </inputs>
    <outputs>
      <output type="number" name="handle" friendlyname="handle" narrative="The handle to the newly created instance, attached to either an existing Word window or a new one." stage="" />
    </outputs>
    <onsuccess>4170ff10-2537-40ab-af4c-fdc0a13c993c</onsuccess>
    <resource object="MS Word VBO" action="Attach Instance" />
  </stage>
  <stage stageid="4170ff10-2537-40ab-af4c-fdc0a13c993c" name="Open Instance" type="Action">
    <subsheetid>465649d8-2997-4e16-ba88-85b39c3402ff</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="255" w="90" h="30" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" expr="[handle]" />
      <input type="text" name="File Name" friendlyname="File Name" expr="[QA Root] &amp; [Doc File Path]" />
    </inputs>
    <outputs>
      <output type="text" name="Document Name" friendlyname="Document Name" stage="" />
    </outputs>
    <onsuccess>a798a4f5-6fbd-4e7d-aef4-0e87ce85daae</onsuccess>
    <resource object="MS Word VBO" action="Open" />
  </stage>
  <stage stageid="f5e39b1c-e88b-4781-9793-76254cf23412" name="Exit Instance " type="Action">
    <loginhibit onsuccess="true" />
    <display x="-45" y="240" w="90" h="30" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" expr="[handle]" />
    </inputs>
    <onsuccess>d4309e85-09b6-419c-9d81-1a9c607d6332</onsuccess>
    <resource object="MS Word VBO" action="Exit" />
  </stage>
  <stage stageid="c36450d3-d8f1-4679-9c98-c931d47069f1" name="Close Instance " type="Action">
    <subsheetid>237a8efa-3100-4831-9bf2-3652dccd47b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="0" w="90" h="30" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" expr="[handle]" />
      <input type="text" name="documentname" friendlyname="documentname" expr="&quot;TestDoc US-1664-4.docx&quot;" />
    </inputs>
    <onsuccess>8b543f19-2b5d-44f4-9b9a-5ce986ab42e1</onsuccess>
    <resource object="MS Word VBO" action="Close" />
  </stage>
</process>