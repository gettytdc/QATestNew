startapplication path="testapps\vs2005testapp.exe" hook=False
$AbortIfNot OK

#Wait for the application to appear...
wait timeout=30000 {checkwindow windowtext="Automated Test Form in VS2005"}=True
$AbortIf RESULT:0

#Select an item in the list box...
selectitem y=93 classname="WindowsForms10.LISTBOX" newtext="My list box item at row 3"
$AbortIfNot OK

#Read the text box, which the app should change when the list box item is selected
#as a result of the selectedindexchanged message...
getwindowtext ClassName="WindowsForms10.EDIT" X=183 Visible="True" Enabled="True"
$AbortIfNot RESULT:My list box item at row 3

#Open font recognition form...
pressbutton windowtext="Font Tests..."
wait timeout=10000 {checkwindow windowtext="Font Test Images"}=True
$AbortIf RESULT:0

#Read some text...
readtext x=12 y=12 pwindowtext="Font Test Images" startx=104 starty=3 endx=222 endy=21 font=BarclaysCS
$AbortIfNot RESULT:£1,130.75DR

#Read some more text...
readtext x=12 y=42 pwindowtext="Font Test Images" startx=138 starty=39 endx=190 endy=51 font=System
$AbortIfNot RESULT:V582059

#Read some more text... (The 1015 is actually 10:15 in the image, the colon is missed - see bug #3519)
readtext x=12 y=42 pwindowtext="Font Test Images" startx=238 starty=39 endx=390 endy=51 font=System
$AbortIfNot RESULT:New1015


#Read some more text, in a different colour...
readtext x=12 y=42 pwindowtext="Font Test Images" startx=138 starty=56 endx=190 endy=68 font=System colour=FFFFFF
$AbortIfNot RESULT:V502075

#Read some text related to bug #3549
readtext x=12 y=145 pwindowtext="Font Test Images" startx=57 starty=42 endx=273 endy=55 font=System colour=000000
$AbortIfNot RESULT:IeaeattempttotaetIpatertor

#Close font recognition form...
pressbutton windowtext=Close pwindowtext="Font Test Images"

#Close the app
closewindow windowtext="Automated Test Form in VS2005"

#Finished!
